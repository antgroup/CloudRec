"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1207],{31732:function(Q,h,r){var y=r(97857),d=r.n(y),O=r(66309),A=r(62435),j=r(86074);h.Z=function(p){var o=p.text,c=p.style;return(0,j.jsx)(O.Z,{style:d()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},c),children:o})}},59999:function(Q,h,r){r.d(h,{j:function(){return j}});var y=r(62435),d=r(96486),O=r.n(d),A=r(45830),j=function(o){var c=o.platformList,m=o.form,v=o.onPlatformChange,D=o.requestResourceTypeList,I=o.requestCloudAccountBaseInfoList,R=o.platformFieldName,C=R===void 0?"platformList":R,n=o.resourceTypeFieldName,M=n===void 0?"resourceTypeList":n,T=(0,A.useLocation)(),k=T.search,B=new URLSearchParams(k),P=B.get("platform");(0,y.useEffect)(function(){var E;if(!(!c||c.length===0)&&(0,d.isEmpty)(P)){var w=m.getFieldValue(C);if((0,d.isEmpty)(w)){var L=((E=c[0])===null||E===void 0?void 0:E.value)||c[0];if(L){var f=[L];m.setFieldValue(C,f),M&&m.setFieldValue(M,null),v&&v(f),D&&D(f),I&&I({platformList:f})}}}},[c,P,m,v,D,I,C,M])}},57207:function(Q,h,r){r.d(h,{Z:function(){return de}});var y=r(5574),d=r.n(y),O=r(87426),A=r(39421),j=r(24163),p=r(71448),o=r(24482),c=r(50322),m=r(22145),v=r(96364),D=r(77603),I=r(72028),R=r(29448),C=r(87462),n=r(62435),M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 000-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"}}]},name:"share-alt",theme:"outlined"},T=M,k=r(84089),B=function(g,b){return n.createElement(k.Z,(0,C.Z)({},g,{ref:b,icon:T}))},P=n.forwardRef(B),E=P,w=r(99611),L=r(45742),f=r(93410),V=r(45830),se=r(25593),Z=r(68872),le=r(85265),u=r(86250),J=r(83062),F=r(83622),ie=r(42075),ae=r(66309),oe=r(21532),S=r(18922),X=r(47908),t=r(86074),x=se.Z.Text,ne=function(g){var b,U,W,N,K,$,z=g.riskDrawerVisible,l=g.riskDrawerInfo,ue=g.setRiskDrawerVisible,me=g.locate,ve=(0,V.useModel)("rule"),fe=ve.platformList,xe=(0,V.useModel)("tenant"),G=xe.tenantListAll,s=(0,V.useIntl)(),ge=(0,n.useState)(!1),Y=d()(ge,2),he=Y[0],ye=Y[1],je=(0,n.useState)(!1),q=d()(je,2),pe=q[0],_=q[1],De=(0,n.useState)(!1),ee=d()(De,2),Ie=ee[0],te=ee[1],Re=function(){ue(!1)},H=(0,V.useRequest)(function(i){return(0,I.queryRiskDetailById)({riskId:i})},{manual:!0,formatResult:function(a){return a.content||{}}}),e=H.data,Ce=H.run,Me=H.loading,Ee=function(){Re()},Ze=(0,n.useCallback)(function(){if(!(l!=null&&l.id)){Z.ZP.error(s.formatMessage({id:"common.message.text.copy.failed"}));return}var i="".concat(window.location.origin,"/riskManagement/riskDetail?id=").concat(l.id);navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(i).then(function(){Z.ZP.success(s.formatMessage({id:"common.message.text.copy.success"}))}).catch(function(){re(i)}):re(i)},[l==null?void 0:l.id,s]),re=(0,n.useCallback)(function(i){var a=document.createElement("textarea");a.value=i,a.style.top="0",a.style.left="0",a.style.position="fixed",a.style.opacity="0",a.style.pointerEvents="none",a.style.zIndex="-1",document.body.appendChild(a),a.focus(),a.select();try{var be=document.execCommand("copy");be?Z.ZP.success(s.formatMessage({id:"common.message.text.copy.success"})):Z.ZP.error(s.formatMessage({id:"common.message.text.copy.failed"}))}catch(Oe){console.error("Fallback copy failed:",Oe),Z.ZP.error(s.formatMessage({id:"common.message.text.copy.failed"}))}finally{document.body.contains(a)&&document.body.removeChild(a)}},[s]);return(0,n.useEffect)(function(){z&&l!==null&&l!==void 0&&l.id&&Ce(l.id)},[z,l]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(le.Z,{title:(0,t.jsxs)(u.Z,{justify:"space-between",align:"center",children:[(0,t.jsx)("span",{children:s.formatMessage({id:"risk.module.text.detail.info"})}),(0,t.jsx)(J.Z,{title:s.formatMessage({id:"common.button.text.share"}),children:(0,t.jsx)(F.ZP,{type:"text",icon:(0,t.jsx)(E,{}),onClick:Ze,style:{marginRight:-8},"aria-label":s.formatMessage({id:"common.button.text.share"})})})]}),width:"50%",open:z,onClose:Ee,loading:Me,children:[(0,t.jsxs)(f.Z,{style:{marginBottom:20},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,t.jsx)(u.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,t.jsxs)("span",{children:[(0,t.jsx)(x,{style:{marginRight:12},children:(0,t.jsx)(F.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(e==null?void 0:e.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(e==null||(b=e.ruleVO)===null||b===void 0?void 0:b.ruleName)||"-"})}),(0,t.jsxs)(ie.Z,{children:[(0,t.jsx)("span",{children:(0,R.Ff)(v.MW,e==null?void 0:e.status)}),(e==null?void 0:e.ignoreReasonType)&&(0,t.jsxs)("span",{children:[(0,t.jsxs)(x,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[s.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,t.jsx)(ae.Z,{color:"geekblue",children:((U=v.$G.find(function(i){return i.value===(e==null?void 0:e.ignoreReasonType)}))===null||U===void 0?void 0:U.label)||"-"})]}),(e==null?void 0:e.ignoreReason)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[s.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,t.jsx)(j.Z,{rows:1,text:e==null?void 0:e.ignoreReason,maxWidth:64})]}),(e==null?void 0:e.whitedId)&&(0,t.jsx)(F.ZP,{type:"link",size:"small",icon:(0,t.jsx)(w.Z,{}),onClick:function(){return te(!0)},style:{padding:"0 4px",height:"auto",color:"#1890ff"}})]})]})}),(0,t.jsxs)(u.Z,{vertical:!0,gap:10,children:[(0,t.jsxs)(u.Z,{align:"center",children:[(0,t.jsx)("img",{src:A.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[s.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:e==null?void 0:e.gmtModified})]}),(0,t.jsxs)(x,{children:[(0,t.jsx)("img",{src:O.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[s.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:e==null?void 0:e.gmtCreate})]})]}),(0,t.jsxs)(u.Z,{align:"center",style:{margin:"10px 0 6px 0"},children:[(0,t.jsxs)("span",{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[s.formatMessage({id:"common.select.label.cloudAccount"}),"\xA0:\xA0"]}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)",marginRight:16},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",marginRight:16},children:(e==null?void 0:e.alias)||"-"})]}),(0,t.jsxs)(u.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,t.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,R.fD)(e==null?void 0:e.platform,fe)}),(0,t.jsx)(x,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(e==null?void 0:e.resourceType)||"-"}),(0,t.jsxs)(u.Z,{align:"center",children:[(0,t.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(e==null?void 0:e.resourceName)+" / "+(e==null?void 0:e.resourceId)}),me==="risk"&&(0,t.jsx)(J.Z,{title:s.formatMessage({id:"asset.extend.text.detail"}),children:(0,t.jsx)("span",{className:X.Z.iconWrap,onClick:function(){return _(!0)},children:(0,t.jsx)(L.Z,{className:X.Z.resourceInstance})})})]}),(0,t.jsx)(x,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(G==null||(W=G.find(function(i){return i.value===(e==null?void 0:e.tenantId)}))===null||W===void 0?void 0:W.label)||"-"})]})]}),(0,t.jsx)(oe.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,t.jsxs)(S.Z,{children:[(0,t.jsx)(S.Z.Item,{label:s.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(e==null||(N=e.ruleVO)===null||N===void 0?void 0:N.advice)||"-"})}),(0,t.jsx)(S.Z.Item,{label:s.formatMessage({id:"risk.module.text.reference.link"}),children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(e==null||(K=e.ruleVO)===null||K===void 0?void 0:K.link)||"-"})}),(0,t.jsx)(S.Z.Item,{label:s.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(e==null||($=e.ruleVO)===null||$===void 0?void 0:$.ruleDesc)||"-"})})]})}),(0,t.jsx)(p.Z,{riskDrawerInfo:l}),(0,t.jsx)(c.Z,{riskDrawerInfo:l})]}),(0,t.jsx)(o.Z,{evaluateDrawerVisible:he,setEvaluateDrawerVisible:ye,riskDrawerInfo:l}),(0,t.jsx)(m.Z,{resourceDrawerVisible:pe,setResourceDrawerVisible:_,riskDrawerInfo:l}),(e==null?void 0:e.whitedId)&&(0,t.jsx)(D.Z,{editDrawerVisible:Ie,setEditDrawerVisible:te,whiteListDrawerInfo:{id:e.whitedId,isEditMode:!1}})]})},de=ne}}]);
