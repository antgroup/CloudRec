"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1207],{31732:function(H,h,s){var y=s(97857),d=s.n(y),O=s(66309),A=s(62435),j=s(86074);h.Z=function(D){var n=D.text,c=D.style;return(0,j.jsx)(O.Z,{style:d()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},c),children:n})}},59999:function(H,h,s){s.d(h,{j:function(){return j}});var y=s(62435),d=s(96486),O=s.n(d),A=s(45830),j=function(n){var c=n.platformList,m=n.form,v=n.onPlatformChange,p=n.requestResourceTypeList,R=n.requestCloudAccountBaseInfoList,C=n.platformFieldName,I=C===void 0?"platformList":C,o=n.resourceTypeFieldName,M=o===void 0?"resourceTypeList":o,T=(0,A.useLocation)(),k=T.search,w=new URLSearchParams(k),P=w.get("platform");(0,y.useEffect)(function(){var E;if(!(!c||c.length===0)&&(0,d.isEmpty)(P)){var B=m.getFieldValue(I);if((0,d.isEmpty)(B)){var L=((E=c[0])===null||E===void 0?void 0:E.value)||c[0];if(L){var f=[L];m.setFieldValue(I,f),M&&m.setFieldValue(M,null),v&&v(f),p&&p(f),R&&R({platformList:f})}}}},[c,P,m,v,p,R,I,M])}},57207:function(H,h,s){s.d(h,{Z:function(){return de}});var y=s(5574),d=s.n(y),O=s(87426),A=s(39421),j=s(24163),D=s(71448),n=s(24482),c=s(50322),m=s(22145),v=s(96364),p=s(77603),R=s(72028),C=s(29448),I=s(87462),o=s(62435),M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 000-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"}}]},name:"share-alt",theme:"outlined"},T=M,k=s(84089),w=function(x,b){return o.createElement(k.Z,(0,I.Z)({},x,{ref:b,icon:T}))},P=o.forwardRef(w),E=P,B=s(99611),L=s(45742),f=s(93410),V=s(45830),re=s(25593),Z=s(68872),le=s(85265),u=s(86250),J=s(83062),F=s(83622),ie=s(42075),ae=s(66309),ne=s(21532),S=s(99859),X=s(47908),t=s(86074),g=re.Z.Text,oe=function(x){var b,U,W,N,K,$,z=x.riskDrawerVisible,l=x.riskDrawerInfo,ue=x.setRiskDrawerVisible,me=x.locate,ve=(0,V.useModel)("rule"),fe=ve.platformList,ge=(0,V.useModel)("tenant"),G=ge.tenantListAll,r=(0,V.useIntl)(),xe=(0,o.useState)(!1),Y=d()(xe,2),he=Y[0],ye=Y[1],je=(0,o.useState)(!1),q=d()(je,2),De=q[0],_=q[1],pe=(0,o.useState)(!1),ee=d()(pe,2),Re=ee[0],te=ee[1],Ce=function(){ue(!1)},Q=(0,V.useRequest)(function(i){return(0,R.queryRiskDetailById)({riskId:i})},{manual:!0,formatResult:function(a){return a.content||{}}}),e=Q.data,Ie=Q.run,Me=Q.loading,Ee=function(){Ce()},Ze=(0,o.useCallback)(function(){if(!(l!=null&&l.id)){Z.ZP.error(r.formatMessage({id:"common.message.text.copy.failed"}));return}var i="".concat(window.location.origin,"/riskManagement/riskDetail?id=").concat(l.id);navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(i).then(function(){Z.ZP.success(r.formatMessage({id:"common.message.text.copy.success"}))}).catch(function(){se(i)}):se(i)},[l==null?void 0:l.id,r]),se=(0,o.useCallback)(function(i){var a=document.createElement("textarea");a.value=i,a.style.top="0",a.style.left="0",a.style.position="fixed",a.style.opacity="0",a.style.pointerEvents="none",a.style.zIndex="-1",document.body.appendChild(a),a.focus(),a.select();try{var be=document.execCommand("copy");be?Z.ZP.success(r.formatMessage({id:"common.message.text.copy.success"})):Z.ZP.error(r.formatMessage({id:"common.message.text.copy.failed"}))}catch(Oe){console.error("Fallback copy failed:",Oe),Z.ZP.error(r.formatMessage({id:"common.message.text.copy.failed"}))}finally{document.body.contains(a)&&document.body.removeChild(a)}},[r]);return(0,o.useEffect)(function(){z&&l!==null&&l!==void 0&&l.id&&Ie(l.id)},[z,l]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(le.Z,{title:(0,t.jsxs)(u.Z,{justify:"space-between",align:"center",children:[(0,t.jsx)("span",{children:r.formatMessage({id:"risk.module.text.detail.info"})}),(0,t.jsx)(J.Z,{title:r.formatMessage({id:"common.button.text.share"}),children:(0,t.jsx)(F.ZP,{type:"text",icon:(0,t.jsx)(E,{}),onClick:Ze,style:{marginRight:-8},"aria-label":r.formatMessage({id:"common.button.text.share"})})})]}),width:"50%",open:z,onClose:Ee,loading:Me,children:[(0,t.jsxs)(f.Z,{style:{marginBottom:20},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,t.jsx)(u.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,t.jsxs)("span",{children:[(0,t.jsx)(g,{style:{marginRight:12},children:(0,t.jsx)(F.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(e==null?void 0:e.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(e==null||(b=e.ruleVO)===null||b===void 0?void 0:b.ruleName)||"-"})}),(0,t.jsxs)(ie.Z,{children:[(0,t.jsx)("span",{children:(0,C.Ff)(v.MW,e==null?void 0:e.status)}),(e==null?void 0:e.ignoreReasonType)&&(0,t.jsxs)("span",{children:[(0,t.jsxs)(g,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[r.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,t.jsx)(ae.Z,{color:"geekblue",children:((U=v.$G.find(function(i){return i.value===(e==null?void 0:e.ignoreReasonType)}))===null||U===void 0?void 0:U.label)||"-"})]}),(e==null?void 0:e.ignoreReason)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(g,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[r.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,t.jsx)(j.Z,{rows:1,text:e==null?void 0:e.ignoreReason,maxWidth:64})]}),(e==null?void 0:e.whitedId)&&(0,t.jsx)(F.ZP,{type:"link",size:"small",icon:(0,t.jsx)(B.Z,{}),onClick:function(){return te(!0)},style:{padding:"0 4px",height:"auto",color:"#1890ff"}})]})]})}),(0,t.jsxs)(u.Z,{vertical:!0,gap:10,children:[(0,t.jsxs)(u.Z,{align:"center",children:[(0,t.jsx)("img",{src:A.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[r.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:e==null?void 0:e.gmtModified})]}),(0,t.jsxs)(g,{children:[(0,t.jsx)("img",{src:O.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[r.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:e==null?void 0:e.gmtCreate})]})]}),(0,t.jsxs)(u.Z,{align:"center",style:{margin:"10px 0 6px 0"},children:[(0,t.jsxs)("span",{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[r.formatMessage({id:"common.select.label.cloudAccount"}),"\xA0:\xA0"]}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)",marginRight:16},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",marginRight:16},children:(e==null?void 0:e.alias)||"-"})]}),(0,t.jsxs)(u.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,t.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,C.fD)(e==null?void 0:e.platform,fe)}),(0,t.jsx)(g,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(e==null?void 0:e.resourceType)||"-"}),(0,t.jsxs)(u.Z,{align:"center",children:[(0,t.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(e==null?void 0:e.resourceName)+" / "+(e==null?void 0:e.resourceId)}),me==="risk"&&(0,t.jsx)(J.Z,{title:r.formatMessage({id:"asset.extend.text.detail"}),children:(0,t.jsx)("span",{className:X.Z.iconWrap,onClick:function(){return _(!0)},children:(0,t.jsx)(L.Z,{className:X.Z.resourceInstance})})})]}),(0,t.jsx)(g,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(G==null||(W=G.find(function(i){return i.value===(e==null?void 0:e.tenantId)}))===null||W===void 0?void 0:W.label)||"-"})]})]}),(0,t.jsx)(ne.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,t.jsxs)(S.Z,{children:[(0,t.jsx)(S.Z.Item,{label:r.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(e==null||(N=e.ruleVO)===null||N===void 0?void 0:N.advice)||"-"})}),(0,t.jsx)(S.Z.Item,{label:r.formatMessage({id:"risk.module.text.reference.link"}),children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(e==null||(K=e.ruleVO)===null||K===void 0?void 0:K.link)||"-"})}),(0,t.jsx)(S.Z.Item,{label:r.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(e==null||($=e.ruleVO)===null||$===void 0?void 0:$.ruleDesc)||"-"})})]})}),(0,t.jsx)(D.Z,{riskDrawerInfo:l}),(0,t.jsx)(c.Z,{riskDrawerInfo:l})]}),(0,t.jsx)(n.Z,{evaluateDrawerVisible:he,setEvaluateDrawerVisible:ye,riskDrawerInfo:l}),(0,t.jsx)(m.Z,{resourceDrawerVisible:De,setResourceDrawerVisible:_,riskDrawerInfo:l}),(e==null?void 0:e.whitedId)&&(0,t.jsx)(p.Z,{editDrawerVisible:Re,setEditDrawerVisible:te,whiteListDrawerInfo:{id:e.whitedId,isEditMode:!1}})]})},de=oe}}]);
