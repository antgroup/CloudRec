(self.webpackChunk=self.webpackChunk||[]).push([[8647],{8751:function(p,j,e){"use strict";e.d(j,{Z:function(){return f}});var o=e(87462),r=e(62435),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},n=i,u=e(84089),s=function(m,x){return r.createElement(u.Z,(0,o.Z)({},m,{ref:x,icon:n}))},t=r.forwardRef(s),f=t},18429:function(p,j,e){"use strict";e.d(j,{Z:function(){return f}});var o=e(87462),r=e(62435),i={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},n=i,u=e(84089),s=function(m,x){return r.createElement(u.Z,(0,o.Z)({},m,{ref:x,icon:n}))},t=r.forwardRef(s),f=t},56477:function(p,j,e){"use strict";e.d(j,{Z:function(){return f}});var o=e(87462),r=e(62435),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"},n=i,u=e(84089),s=function(m,x){return r.createElement(u.Z,(0,o.Z)({},m,{ref:x,icon:n}))},t=r.forwardRef(s),f=t},61011:function(p,j,e){"use strict";e.d(j,{Z:function(){return f}});var o=e(87462),r=e(62435),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M666.7 505.5l-246-178A8 8 0 00408 334v46.9c0 10.2 4.9 19.9 13.2 25.9L566.6 512 421.2 617.2c-8.3 6-13.2 15.6-13.2 25.9V690c0 6.5 7.4 10.3 12.7 6.5l246-178c4.4-3.2 4.4-9.8 0-13z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"right-circle",theme:"outlined"},n=i,u=e(84089),s=function(m,x){return r.createElement(u.Z,(0,o.Z)({},m,{ref:x,icon:n}))},t=r.forwardRef(s),f=t},81569:function(p,j,e){"use strict";var o=e(56477),r=e(61011),i=e(86074);j.Z=function(n){var u=n.expanded,s=n.onExpand,t=n.record;return u?(0,i.jsx)(o.Z,{style:{color:"#457aff",fontSize:14},onClick:function(S){return s(t,S)}}):(0,i.jsx)(r.Z,{style:{color:"#457aff",fontSize:14},onClick:function(S){return s(t,S)}})}},52078:function(p,j,e){"use strict";var o=e(97857),r=e.n(o),i=e(27997),n=e(62435),u=e(86074),s=function(f){i.Mj.register({id:"json"});var S=f.value,m=S===void 0?"{}":S,x=f.onChange,E=f.editorStyle,V=E===void 0?{}:E,l=f.editorKey,B=l===void 0?"json-editor":l,M=f.readOnly,P=M===void 0?!1:M,O=(0,n.useRef)(),d=(0,n.useRef)(),Z=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(W),W}catch(R){return console.warn("Invalid JSON string:",R),"{}"}};return(0,n.useEffect)(function(){if(O.current)return d.current?d.current.setValue(m):(d.current=i.j6.create(O.current,{value:Z(m),language:"json",theme:"vs",readOnly:P,folding:!0,automaticLayout:!0}),d.current.onDidChangeModelContent(function(){var I=d.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:I}),x==null||x(I)})),function(){if(d!=null&&d.current){var I;d==null||(I=d.current)===null||I===void 0||I.dispose(),d.current=null}}},[]),(0,n.useEffect)(function(){d.current&&m!==d.current.getValue()&&d.current.setValue(Z(m))},[m]),(0,u.jsx)("div",{ref:O,style:r()({height:360,borderRadius:4,overflow:"hidden"},V)},B)};j.Z=s},29297:function(p,j,e){"use strict";e.d(j,{q9:function(){return o.Z},Wy:function(){return f},mi:function(){return E}});var o=e(52078),r=e(97857),i=e.n(r),n=e(55171),u=e.n(n),s=e(86074),t=function(l){var B=l.value,M=l.viewerStyle,P=M===void 0?{}:M,O=l.displayDataTypes,d=O===void 0?!1:O,Z=l.name,I=Z===void 0?"output json":Z;return(0,s.jsx)(u(),{src:B,name:I,collapsed:!1,displayDataTypes:d,style:i()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},P)})},f=t,S=e(27997),m=e(62435),x=function(l){S.Mj.register({id:"rego"});var B=l.value,M=l.onChange,P=l.editorStyle,O=P===void 0?{}:P,d=l.editorKey,Z=l.readOnly,I=Z===void 0?!1:Z,W=(0,m.useRef)(),R=(0,m.useRef)();return(0,m.useEffect)(function(){if(W.current)return R.current||(R.current=S.j6.create(W.current,{value:B,language:"rego",theme:"vs",readOnly:I,automaticLayout:!0}),R.current.onDidChangeModelContent(function(){M==null||M(R.current.getValue())})),function(){if(R.current){var J;(J=R.current)===null||J===void 0||J.dispose(),R.current=null}}},[]),(0,s.jsx)("div",{ref:W,style:i()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},O)},d)},E=x},57695:function(p,j,e){"use strict";e.d(j,{ym:function(){return je},g1:function(){return Ee},vr:function(){return Ie},Uk:function(){return De},UL:function(){return Se},GD:function(){return Oe}});var o=e(55375),r=e(8751),i=e(18429),n=e(45830),u=e(42075),s=e(25593),t=e(86074),f=function(N){var C=N.enable;return(0,t.jsx)(t.Fragment,{children:C?(0,t.jsxs)(u.Z,{size:4,children:[(0,t.jsx)(r.Z,{style:{color:o.qY}}),(0,t.jsx)(s.Z.Text,{children:(0,t.jsx)(n.FormattedMessage,{id:"common.tag.text.enabled"})})]}):(0,t.jsxs)(u.Z,{size:4,children:[(0,t.jsx)(i.Z,{style:{color:o.jS}}),(0,t.jsx)(s.Z.Text,{children:(0,t.jsx)(n.FormattedMessage,{id:"common.tag.text.disabled"})})]})})},S=e(21171),m=e(29448),x=e(93410),E=e(99859),V=e(71230),l=e(15746),B=e(86250),M=e(27484),P=e.n(M),O=e(62435),d=function(){var C,c,v,g,h,D,F,z,K,A=(0,n.useLocation)(),T=new URLSearchParams(A.search),y=T.get("id"),U=(0,n.useModel)("rule"),w=U.platformList,L=(0,n.useIntl)(),H=(0,n.useRequest)(function(G){return(0,S.queryIdentityDetailById)({id:G})},{manual:!0,formatResult:function(Y){return Y==null?void 0:Y.content}}),pe=H.run,a=H.data,Me=H.loading;return(0,O.useEffect)(function(){y&&pe(Number(y))},[y]),(0,t.jsx)(x.Z,{loading:Me,title:L.formatMessage({id:"rule.module.text.basic.info"}),children:(0,t.jsx)(E.Z,{layout:"vertical",children:(0,t.jsxs)(V.Z,{children:[(0,t.jsx)(l.Z,{span:12,children:(0,t.jsx)(E.Z.Item,{label:L.formatMessage({id:"asset.module.text.account.name"}),children:(a==null||(C=a.userInfo)===null||C===void 0?void 0:C.userName)||"-"})}),(0,t.jsx)(l.Z,{span:12,children:(0,t.jsx)(E.Z.Item,{label:L.formatMessage({id:"cloudAccount.extend.title.cloud.platform"}),children:(0,t.jsx)(B.Z,{children:(0,m.fD)(a==null||(c=a.userInfo)===null||c===void 0?void 0:c.platform,w)})})}),(0,t.jsx)(l.Z,{span:12,children:(0,t.jsx)(E.Z.Item,{label:L.formatMessage({id:"asset.module.text.email"}),children:(a==null||(v=a.userInfo)===null||v===void 0?void 0:v.email)||"-"})}),(0,t.jsx)(l.Z,{span:12,children:(0,t.jsx)(E.Z.Item,{label:L.formatMessage({id:"rule.table.columns.text.status"}),children:(a==null||(g=a.userInfo)===null||g===void 0?void 0:g.status)||"-"})}),(0,t.jsx)(l.Z,{span:12,children:(0,t.jsx)(E.Z.Item,{label:L.formatMessage({id:"cloudAccount.extend.title.createTime"}),children:a!=null&&(h=a.userInfo)!==null&&h!==void 0&&h.createDate?P()(a==null||(D=a.userInfo)===null||D===void 0?void 0:D.createDate).format("YYYY-MM-DD HH:mm:ss"):"-"})}),(0,t.jsx)(l.Z,{span:12,children:(0,t.jsx)(E.Z.Item,{label:L.formatMessage({id:"asset.module.text.last.login"}),children:a!=null&&(F=a.userInfo)!==null&&F!==void 0&&F.lastLoginDate?P()(a==null||(z=a.userInfo)===null||z===void 0?void 0:z.lastLoginDate).format("YYYY-MM-DD HH:mm:ss"):"-"})}),(0,t.jsx)(l.Z,{span:12,children:(0,t.jsx)(E.Z.Item,{label:L.formatMessage({id:"asset.module.text.mfa.status"}),children:(0,t.jsx)(f,{enable:a==null||(K=a.userInfo)===null||K===void 0?void 0:K.mfastatus})})})]})})})},Z=d,I=e(32983),W=function(){return(0,t.jsx)(x.Z,{children:(0,t.jsx)(I.Z,{image:I.Z.PRESENTED_IMAGE_SIMPLE})})},R=W,J=e(81569),b=e(29297),Q=function(C){var c=C.record;return(0,t.jsx)("div",{children:c.policyDocument&&(0,t.jsx)(b.q9,{editorKey:"POLICY_DOCUMENT_CONFIG_INSTANCE",value:JSON.stringify(JSON.parse(c.policyDocument),null,4)||"",readOnly:!0,editorStyle:{height:240}})})},X=Q,q=e(21532),_=e(89094),ee=function(){var C=(0,n.useLocation)(),c=new URLSearchParams(C.search),v=c.get("id"),g=(0,n.useIntl)(),h=(0,n.useRequest)(function(A){return(0,S.queryIdentityDetailById)({id:A})},{manual:!0,formatResult:function(T){return T==null?void 0:T.content}}),D=h.run,F=h.data,z=h.loading;(0,O.useEffect)(function(){v&&D(Number(v))},[v]);var K=[{title:g.formatMessage({id:"asset.module.text.policy.name"}),dataIndex:"policyName",key:"policyName"},{title:g.formatMessage({id:"asset.module.text.policy.description"}),dataIndex:"description",key:"description"},{title:g.formatMessage({id:"asset.module.text.policy.type"}),dataIndex:"policyType",key:"policyType"},{title:g.formatMessage({id:"asset.module.text.source"}),dataIndex:"source",key:"source",render:function(T,y){return(y==null?void 0:y.source)||"-"}}];return(0,t.jsx)(x.Z,{loading:z,title:g.formatMessage({id:"asset.module.text.permission.policy"}),children:(0,t.jsx)(q.ZP,{theme:{components:{Table:{headerBg:"#FFF"}}},children:(0,t.jsx)(_.Z,{pagination:{size:"small"},dataSource:(F==null?void 0:F.policies)||[],columns:K,expandable:{expandedRowRender:function(T){return(0,t.jsx)(X,{record:T})},columnTitle:(0,t.jsx)("div",{style:{width:30,textAlign:"center"}}),columnWidth:30,rowExpandable:function(){return!0},expandIcon:J.Z}})})})},te=ee,ne=e(97857),k=e.n(ne),re=e(5574),ae=e.n(re),ie=e(47221),oe=function(){var C=(0,n.useLocation)(),c=new URLSearchParams(C.search),v=c.get("id"),g=(0,O.useState)({}),h=ae()(g,2),D=h[0],F=h[1],z=(0,n.useRequest)(function(y){return(0,S.queryRiskInfo)({id:y})},{manual:!0,formatResult:function(U){return U==null?void 0:U.content}}),K=z.run,A=z.data,T=z.loading;return(0,O.useEffect)(function(){v&&K(Number(v))},[v]),(0,t.jsx)(x.Z,{loading:T,title:(0,t.jsx)(n.FormattedMessage,{id:"asset.module.text.risk.information"}),children:A==null?void 0:A.map(function(y,U){return(0,t.jsx)(ie.Z,{style:{marginBottom:12},expandIconPosition:"end",collapsible:"header",activeKey:D==null?void 0:D[U],onChange:function(L){F(k()(k()({},D),{},{index:L}))},items:[{key:"1",label:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:(y==null?void 0:y.ruleName)||"-"}),(0,t.jsx)("div",{children:(y==null?void 0:y.ruleDesc)||"-"})]}),children:(0,t.jsx)(t.Fragment,{children:y.context&&(0,t.jsx)(b.q9,{editorKey:"IDENTITY_CONFIG_INSTANCE",value:JSON.stringify(JSON.parse(y.context),null,4)||"",readOnly:!0,editorStyle:{height:240}})})}]},U)})})},se=oe,le=e(87547),de=e(42952),ue=e(24019),ce=e(87462),ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},fe=ve,me=e(84089),ge=function(C,c){return O.createElement(me.Z,(0,ce.Z)({},C,{ref:c,icon:fe}))},ye=O.forwardRef(ge),xe=ye,$=e(96486),he={false:"invalid",true:"valid"},je={ascend:"ASC",descend:"DESC"},Se=function(C,c){var v=(0,$.cloneDeep)(C);for(var g in v)if(v.hasOwnProperty(g)){var h=v[g];!(0,$.isEmpty)(h)&&Array.isArray(h)?h.forEach(function(D){D.status=he[D.status],D.platform=c.platform,D.resourceType=c.resourceType}):h===void 0&&(v[g]=[])}return v},Ce={invalid:!1,valid:!0},Oe=function(C){var c=(0,$.cloneDeep)(C);for(var v in c)if(c.hasOwnProperty(v)){var g=c[v];!(0,$.isEmpty)(g)&&Array.isArray(g)&&g.forEach(function(h){h.status=Ce[h.status]})}return c},De={linkIcon:"https://mdn.alipayobjects.com/huamei_f8hv0x/afts/img/A*a8O4QrNtEvwAAAAAAAAAAAAADiiJAQ/original"},Ie={components:{Input:{colorBgContainerDisabled:"#FFF",colorTextDisabled:"rgba(0, 0, 0, 0.88)",algorithm:!0}}},Re=null,Ee=[{key:"ACCOUNT",label:(0,t.jsx)(n.FormattedMessage,{id:"asset.module.text.account.info"}),icon:(0,t.jsx)(le.Z,{}),children:(0,t.jsx)(Z,{})},{key:"PERMISSION",label:(0,t.jsx)(n.FormattedMessage,{id:"asset.module.text.permission"}),icon:(0,t.jsx)(de.Z,{}),children:(0,t.jsx)(te,{})},{key:"LOG",label:(0,t.jsx)(n.FormattedMessage,{id:"asset.module.text.activity.log"}),icon:(0,t.jsx)(ue.Z,{}),children:(0,t.jsx)(R,{})},{key:"RISK",label:(0,t.jsx)(n.FormattedMessage,{id:"asset.module.text.risks"}),icon:(0,t.jsx)(xe,{}),children:(0,t.jsx)(se,{})}]},85674:function(p,j,e){var o={"./simpleWorker":18352,"./simpleWorker.js":18352};function r(i){return Promise.resolve().then(function(){if(!e.o(o,i)){var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}var u=o[i];return e(u)})}r.keys=function(){return Object.keys(o)},r.id=85674,p.exports=r},10131:function(p,j,e){var o={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function r(i){if(!e.o(o,i))return Promise.resolve().then(function(){var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s});var n=o[i],u=n[0];return Promise.all(n.slice(1).map(e.e)).then(function(){return e(u)})}r.keys=function(){return Object.keys(o)},r.id=10131,p.exports=r}}]);
