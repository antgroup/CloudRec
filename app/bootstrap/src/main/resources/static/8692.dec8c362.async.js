(self.webpackChunk=self.webpackChunk||[]).push([[8692],{81569:function(N,O,t){"use strict";var v=t(56477),m=t(61011),d=t(86074);O.Z=function(n){var h=n.expanded,x=n.onExpand,e=n.record;return h?(0,d.jsx)(v.Z,{style:{color:"#457aff",fontSize:14},onClick:function(f){return x(e,f)}}):(0,d.jsx)(m.Z,{style:{color:"#457aff",fontSize:14},onClick:function(f){return x(e,f)}})}},52078:function(N,O,t){"use strict";var v=t(97857),m=t.n(v),d=t(27997),n=t(62435),h=t(86074),x=function(p){d.Mj.register({id:"json"});var f=p.value,R=p.onChange,A=p.editorStyle,S=A===void 0?{}:A,B=p.editorKey,r=p.readOnly,F=r===void 0?!1:r,D=(0,n.useRef)(),i=(0,n.useRef)();return(0,n.useEffect)(function(){if(D.current)return i.current?i.current.setValue(f):(i.current=d.j6.create(D.current,{value:f,language:"json",theme:"vs",readOnly:F,folding:!0,automaticLayout:!0}),i.current.onDidChangeModelContent(function(){R==null||R(i.current.getValue())})),function(){if(i!=null&&i.current){var j;i==null||(j=i.current)===null||j===void 0||j.dispose(),i.current=null}}},[]),(0,n.useEffect)(function(){i.current&&f!==i.current.getValue()&&i.current.setValue(f)},[f]),(0,h.jsx)("div",{ref:D,style:m()({height:360,borderRadius:4,overflow:"hidden"},S)},B)};O.Z=x},29297:function(N,O,t){"use strict";t.d(O,{q9:function(){return v.Z},Wy:function(){return p},mi:function(){return S}});var v=t(52078),m=t(97857),d=t.n(m),n=t(55171),h=t.n(n),x=t(86074),e=function(r){var F=r.value,D=r.viewerStyle,i=D===void 0?{}:D,j=r.displayDataTypes,b=j===void 0?!1:j,U=r.name,W=U===void 0?"output json":U;return(0,x.jsx)(h(),{src:F,name:W,collapsed:!1,displayDataTypes:b,style:d()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},i)})},p=e,f=t(27997),R=t(62435),A=function(r){f.Mj.register({id:"rego"});var F=r.value,D=r.onChange,i=r.editorStyle,j=i===void 0?{}:i,b=r.editorKey,U=r.readOnly,W=U===void 0?!1:U,k=(0,R.useRef)(),C=(0,R.useRef)();return(0,R.useEffect)(function(){if(k.current)return C.current||(C.current=f.j6.create(k.current,{value:F,language:"rego",theme:"vs",readOnly:W,automaticLayout:!0}),C.current.onDidChangeModelContent(function(){D==null||D(C.current.getValue())})),function(){if(C.current){var Y;(Y=C.current)===null||Y===void 0||Y.dispose(),C.current=null}}},[]),(0,x.jsx)("div",{ref:k,style:d()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},j)},b)},S=A},96987:function(N,O,t){"use strict";t.d(O,{ym:function(){return fe},g1:function(){return he},vr:function(){return je},Uk:function(){return xe},UL:function(){return me},GD:function(){return ge}});var v=t(55375),m=t(8751),d=t(18429),n=t(92016),h=t(42075),x=t(25593),e=t(86074),p=function(Z){var y=Z.enable;return(0,e.jsx)(e.Fragment,{children:y?(0,e.jsxs)(h.Z,{size:4,children:[(0,e.jsx)(m.Z,{style:{color:v.qY}}),(0,e.jsx)(x.Z.Text,{children:(0,e.jsx)(n.FormattedMessage,{id:"common.tag.text.enabled"})})]}):(0,e.jsxs)(h.Z,{size:4,children:[(0,e.jsx)(d.Z,{style:{color:v.jS}}),(0,e.jsx)(x.Z.Text,{children:(0,e.jsx)(n.FormattedMessage,{id:"common.tag.text.disabled"})})]})})},f=t(21171),R=t(29448),A=t(93410),S=t(23323),B=t(71230),r=t(15746),F=t(86250),D=t(27484),i=t.n(D),j=t(62435),b=function(){var y,u,a,s,c,g,T,P,K,I=(0,n.useLocation)(),E=new URLSearchParams(I.search),l=E.get("id"),L=(0,n.useModel)("rule"),G=L.platformList,M=(0,n.useIntl)(),$=(0,n.useRequest)(function(Q){return(0,f.queryIdentityDetailById)({id:Q})},{manual:!0,formatResult:function(z){return z==null?void 0:z.content}}),Se=$.run,o=$.data,De=$.loading;return(0,j.useEffect)(function(){l&&Se(Number(l))},[l]),(0,e.jsx)(A.Z,{loading:De,title:M.formatMessage({id:"rule.module.text.basic.info"}),children:(0,e.jsx)(S.Z,{layout:"vertical",children:(0,e.jsxs)(B.Z,{children:[(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(S.Z.Item,{label:M.formatMessage({id:"asset.module.text.account.name"}),children:(o==null||(y=o.userInfo)===null||y===void 0?void 0:y.userName)||"-"})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(S.Z.Item,{label:M.formatMessage({id:"cloudAccount.extend.title.cloud.platform"}),children:(0,e.jsx)(F.Z,{children:(0,R.fD)(o==null||(u=o.userInfo)===null||u===void 0?void 0:u.platform,G)})})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(S.Z.Item,{label:M.formatMessage({id:"asset.module.text.email"}),children:(o==null||(a=o.userInfo)===null||a===void 0?void 0:a.email)||"-"})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(S.Z.Item,{label:M.formatMessage({id:"rule.table.columns.text.status"}),children:(o==null||(s=o.userInfo)===null||s===void 0?void 0:s.status)||"-"})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(S.Z.Item,{label:M.formatMessage({id:"cloudAccount.extend.title.createTime"}),children:o!=null&&(c=o.userInfo)!==null&&c!==void 0&&c.createDate?i()(o==null||(g=o.userInfo)===null||g===void 0?void 0:g.createDate).format("YYYY-MM-DD HH:mm:ss"):"-"})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(S.Z.Item,{label:M.formatMessage({id:"asset.module.text.last.login"}),children:o!=null&&(T=o.userInfo)!==null&&T!==void 0&&T.lastLoginDate?i()(o==null||(P=o.userInfo)===null||P===void 0?void 0:P.lastLoginDate).format("YYYY-MM-DD HH:mm:ss"):"-"})}),(0,e.jsx)(r.Z,{span:12,children:(0,e.jsx)(S.Z.Item,{label:M.formatMessage({id:"asset.module.text.mfa.status"}),children:(0,e.jsx)(p,{enable:o==null||(K=o.userInfo)===null||K===void 0?void 0:K.mfastatus})})})]})})})},U=b,W=t(32983),k=function(){return(0,e.jsx)(A.Z,{children:(0,e.jsx)(W.Z,{image:W.Z.PRESENTED_IMAGE_SIMPLE})})},C=k,Y=t(81569),J=t(29297),X=function(y){var u=y.record;return(0,e.jsx)("div",{children:u.policyDocument&&(0,e.jsx)(J.q9,{editorKey:"POLICY_DOCUMENT_CONFIG_INSTANCE",value:JSON.stringify(JSON.parse(u.policyDocument),null,4)||"",readOnly:!0,editorStyle:{height:240}})})},w=X,q=t(21532),_=t(89094),ee=function(){var y=(0,n.useLocation)(),u=new URLSearchParams(y.search),a=u.get("id"),s=(0,n.useIntl)(),c=(0,n.useRequest)(function(I){return(0,f.queryIdentityDetailById)({id:I})},{manual:!0,formatResult:function(E){return E==null?void 0:E.content}}),g=c.run,T=c.data,P=c.loading;(0,j.useEffect)(function(){a&&g(Number(a))},[a]);var K=[{title:s.formatMessage({id:"asset.module.text.policy.name"}),dataIndex:"policyName",key:"policyName"},{title:s.formatMessage({id:"asset.module.text.policy.description"}),dataIndex:"description",key:"description"},{title:s.formatMessage({id:"asset.module.text.policy.type"}),dataIndex:"policyType",key:"policyType"},{title:s.formatMessage({id:"asset.module.text.source"}),dataIndex:"source",key:"source",render:function(E,l){return(l==null?void 0:l.source)||"-"}}];return(0,e.jsx)(A.Z,{loading:P,title:s.formatMessage({id:"asset.module.text.permission.policy"}),children:(0,e.jsx)(q.ZP,{theme:{components:{Table:{headerBg:"#FFF"}}},children:(0,e.jsx)(_.Z,{pagination:{size:"small"},dataSource:(T==null?void 0:T.policies)||[],columns:K,expandable:{expandedRowRender:function(E){return(0,e.jsx)(w,{record:E})},columnTitle:(0,e.jsx)("div",{style:{width:30,textAlign:"center"}}),columnWidth:30,rowExpandable:function(){return!0},expandIcon:Y.Z}})})})},te=ee,ne=t(97857),H=t.n(ne),oe=t(5574),ie=t.n(oe),re=t(47221),ae=function(){var y=(0,n.useLocation)(),u=new URLSearchParams(y.search),a=u.get("id"),s=(0,j.useState)({}),c=ie()(s,2),g=c[0],T=c[1],P=(0,n.useRequest)(function(l){return(0,f.queryRiskInfo)({id:l})},{manual:!0,formatResult:function(L){return L==null?void 0:L.content}}),K=P.run,I=P.data,E=P.loading;return(0,j.useEffect)(function(){a&&K(Number(a))},[a]),(0,e.jsx)(A.Z,{loading:E,title:(0,e.jsx)(n.FormattedMessage,{id:"asset.module.text.risk.information"}),children:I==null?void 0:I.map(function(l,L){return(0,e.jsx)(re.Z,{style:{marginBottom:12},expandIconPosition:"end",collapsible:"header",activeKey:g==null?void 0:g[L],onChange:function(M){T(H()(H()({},g),{},{index:M}))},items:[{key:"1",label:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:(l==null?void 0:l.ruleName)||"-"}),(0,e.jsx)("div",{children:(l==null?void 0:l.ruleDesc)||"-"})]}),children:(0,e.jsx)(e.Fragment,{children:l.context&&(0,e.jsx)(J.q9,{editorKey:"IDENTITY_CONFIG_INSTANCE",value:JSON.stringify(JSON.parse(l.context),null,4)||"",readOnly:!0,editorStyle:{height:240}})})}]},L)})})},se=ae,le=t(87547),de=t(42952),ue=t(24019),ce=t(28058),V=t(96486),ve={false:"invalid",true:"valid"},fe={ascend:"ASC",descend:"DESC"},me=function(y,u){var a=(0,V.cloneDeep)(y);for(var s in a)if(a.hasOwnProperty(s)){var c=a[s];!(0,V.isEmpty)(c)&&Array.isArray(c)?c.forEach(function(g){g.status=ve[g.status],g.platform=u.platform,g.resourceType=u.resourceType}):c===void 0&&(a[s]=[])}return a},ye={invalid:!1,valid:!0},ge=function(y){var u=(0,V.cloneDeep)(y);for(var a in u)if(u.hasOwnProperty(a)){var s=u[a];!(0,V.isEmpty)(s)&&Array.isArray(s)&&s.forEach(function(c){c.status=ye[c.status]})}return u},xe={linkIcon:"https://mdn.alipayobjects.com/huamei_f8hv0x/afts/img/A*a8O4QrNtEvwAAAAAAAAAAAAADiiJAQ/original"},je={components:{Input:{colorBgContainerDisabled:"#FFF",colorTextDisabled:"rgba(0, 0, 0, 0.88)",algorithm:!0}}},pe=null,he=[{key:"ACCOUNT",label:(0,e.jsx)(n.FormattedMessage,{id:"asset.module.text.account.info"}),icon:(0,e.jsx)(le.Z,{}),children:(0,e.jsx)(U,{})},{key:"PERMISSION",label:(0,e.jsx)(n.FormattedMessage,{id:"asset.module.text.permission"}),icon:(0,e.jsx)(de.Z,{}),children:(0,e.jsx)(te,{})},{key:"LOG",label:(0,e.jsx)(n.FormattedMessage,{id:"asset.module.text.activity.log"}),icon:(0,e.jsx)(ue.Z,{}),children:(0,e.jsx)(C,{})},{key:"RISK",label:(0,e.jsx)(n.FormattedMessage,{id:"asset.module.text.risks"}),icon:(0,e.jsx)(ce.Z,{}),children:(0,e.jsx)(se,{})}]},85674:function(N,O,t){var v={"./simpleWorker":18352,"./simpleWorker.js":18352};function m(d){return Promise.resolve().then(function(){if(!t.o(v,d)){var n=new Error("Cannot find module '"+d+"'");throw n.code="MODULE_NOT_FOUND",n}var h=v[d];return t(h)})}m.keys=function(){return Object.keys(v)},m.id=85674,N.exports=m},10131:function(N,O,t){var v={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function m(d){if(!t.o(v,d))return Promise.resolve().then(function(){var x=new Error("Cannot find module '"+d+"'");throw x.code="MODULE_NOT_FOUND",x});var n=v[d],h=n[0];return Promise.all(n.slice(1).map(t.e)).then(function(){return t(h)})}m.keys=function(){return Object.keys(v)},m.id=10131,N.exports=m}}]);
