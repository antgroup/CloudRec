(self.webpackChunk=self.webpackChunk||[]).push([[3231],{8751:function(K,T,t){"use strict";t.d(T,{Z:function(){return m}});var B=t(87462),p=t(62435),I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},W=I,y=t(84089),c=function(L,M){return p.createElement(y.Z,(0,B.Z)({},L,{ref:M,icon:W}))},A=p.forwardRef(c),m=A},18429:function(K,T,t){"use strict";t.d(T,{Z:function(){return m}});var B=t(87462),p=t(62435),I={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},W=I,y=t(84089),c=function(L,M){return p.createElement(y.Z,(0,B.Z)({},L,{ref:M,icon:W}))},A=p.forwardRef(c),m=A},56477:function(K,T,t){"use strict";t.d(T,{Z:function(){return m}});var B=t(87462),p=t(62435),I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"},W=I,y=t(84089),c=function(L,M){return p.createElement(y.Z,(0,B.Z)({},L,{ref:M,icon:W}))},A=p.forwardRef(c),m=A},61011:function(K,T,t){"use strict";t.d(T,{Z:function(){return m}});var B=t(87462),p=t(62435),I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M666.7 505.5l-246-178A8 8 0 00408 334v46.9c0 10.2 4.9 19.9 13.2 25.9L566.6 512 421.2 617.2c-8.3 6-13.2 15.6-13.2 25.9V690c0 6.5 7.4 10.3 12.7 6.5l246-178c4.4-3.2 4.4-9.8 0-13z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"right-circle",theme:"outlined"},W=I,y=t(84089),c=function(L,M){return p.createElement(y.Z,(0,B.Z)({},L,{ref:M,icon:W}))},A=p.forwardRef(c),m=A},28058:function(K,T,t){"use strict";t.d(T,{Z:function(){return m}});var B=t(87462),p=t(62435),I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},W=I,y=t(84089),c=function(L,M){return p.createElement(y.Z,(0,B.Z)({},L,{ref:M,icon:W}))},A=p.forwardRef(c),m=A},3859:function(K,T,t){"use strict";var B=t(97857),p=t.n(B),I=t(66309),W=t(62435),y=t(53846),c=t(86074);T.Z=function(A){var m,z=A.text,L=A.style,M=A.level;return(0,c.jsx)(I.Z,{className:y.Z[M==="HIGH"?"riskHigh":(m=["MEDIUM","MIDDLE"])!==null&&m!==void 0&&m.includes(M)?"riskMedium":M==="LOW"?"riskLow":""],style:p()({},L),children:z})}},31732:function(K,T,t){"use strict";var B=t(97857),p=t.n(B),I=t(66309),W=t(62435),y=t(86074);T.Z=function(c){var A=c.text,m=c.style;return(0,y.jsx)(I.Z,{style:p()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},m),children:A})}},92834:function(K,T,t){"use strict";t.r(T),t.d(T,{default:function(){return xt}});var B=t(15009),p=t.n(B),I=t(99289),W=t.n(I),y=t(97857),c=t.n(y),A=t(5574),m=t.n(A),z=t(81569),L=t(3859),M=t(31732),J=t(53846),Oe=t(24163),ce=t(21171),ee=t(29448),Se=t(45742),me=t(93410),b=t(92016),ye=t(25593),Ee=t(85265),Be=t(83062),Ve=t(86250),We=t(92398),E=t(62435),j=t(24732),De=t(29297),s=t(96486),e=t(86074),ke=function(R){var r=R.assetInstanceVisible,x=R.assetInfo,g=R.setAssetInstanceVisible,h=(0,E.useState)(""),u=m()(h,2),v=u[0],V=u[1],N=(0,b.useIntl)(),se=function(){g(!1),V("")},S=function(){se()};return(0,E.useEffect)(function(){if(r&&!(0,s.isEmpty)(x)){var O=JSON.stringify(x==null?void 0:x.instance,null,4);(0,s.isEmpty)(O)||V(O)}},[r]),(0,e.jsx)(Ee.Z,{title:N.formatMessage({id:"asset.extend.text.detail"}),width:"42%",destroyOnClose:!0,open:r,onClose:S,children:!(0,s.isEmpty)(v)&&(0,e.jsx)(De.q9,{editorKey:"assetInstance",value:v,readOnly:!0,editorStyle:{height:"100%"}})})},rt=ke,ve=t(92086),ie=t(96364),Me=t(72028),te=t(17910),fe=t(90498),oe=t(66309),X=t(83622),Ce=function(R){var r=R.assetInfo,x=(0,E.useRef)(),g=(0,E.useRef)(),h=(0,E.useState)(!1),u=m()(h,2),v=u[0],V=u[1],N=(0,E.useRef)({}),se=[{title:"\u8D44\u6E90\u540D\u79F0",dataIndex:"resourceName",valueType:"text",align:"center",render:function(O,i){return(0,e.jsx)(Oe.Z,{text:i!=null&&i.resourceExist?i.resourceName:"(\u4E0D\u5B58\u5728) "+i.resourceName,maxWidth:280})}},{title:"\u8D44\u6E90\u7C7B\u578B",dataIndex:"resourceType",valueType:"text",align:"center",render:function(O,i){return(0,e.jsx)(oe.Z,{color:"geekblue",children:i==null?void 0:i.resourceType})}},{title:"\u89C4\u5219\u540D\u79F0",dataIndex:"ruleName",valueType:"text",align:"center",render:function(O,i){var o;return(0,e.jsx)("span",{children:i==null||(o=i.ruleVO)===null||o===void 0?void 0:o.ruleName})}},{title:"\u89C4\u5219\u7EC4",dataIndex:"groupName",valueType:"text",align:"center",render:function(O,i){var o;return(0,e.jsx)("span",{children:i==null||(o=i.ruleVO)===null||o===void 0?void 0:o.groupName})}},{title:"\u98CE\u9669\u7B49\u7EA7",dataIndex:"riskLevel",valueType:"text",align:"center",render:function(O,i){var o=te.I9===null||te.I9===void 0?void 0:te.I9.find(function(f){var U;return f.value===(i==null||(U=i.ruleVO)===null||U===void 0?void 0:U.riskLevel)});return(0,e.jsx)(oe.Z,{color:o==null?void 0:o.color,children:(o==null?void 0:o.text)||"-"})}},{title:"\u98CE\u9669\u72B6\u6001",dataIndex:"status",valueType:"text",align:"center",render:function(O,i){var o=ie.MW===null||ie.MW===void 0?void 0:ie.MW.find(function(f){return f.value===(i==null?void 0:i.status)});return(0,e.jsx)(oe.Z,{color:o==null?void 0:o.color,children:(o==null?void 0:o.label)||"-"})}},{title:"\u6700\u8FD1\u626B\u63CF\u547D\u4E2D",dataIndex:"gmtModified",valueType:"text",align:"center"},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",align:"center",render:function(O,i){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(X.ZP,{type:"link",onClick:function(){N.current=c()({},i),V(!0)},children:"\u8BE6\u60C5"})})}}];return(0,e.jsxs)(me.Z,{boxShadow:!0,bodyStyle:{padding:"32px 4px 12px 4px"},children:[(0,e.jsx)(fe.Z,{tableStyle:{padding:0},scroll:{x:"max-content"},rowKey:"id",search:!1,options:!1,actionRef:x,formRef:g,columns:se,request:function(){var S=W()(p()().mark(function O(i){var o,f,U,re,Z,d,de,$,he;return p()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return o=i.pageSize,f=i.current,U=i.cloudAccountId,re=i.resourceId,Z=i.platform,d={page:f,size:o,cloudAccountId:U,resourceId:re,platformList:[Z]},ne.next=4,(0,Me.queryRiskList)(d);case 4:return de=ne.sent,$=de.content,he=de.code,ne.abrupt("return",{data:($==null?void 0:$.data)||[],total:($==null?void 0:$.total)||0,success:he===200||!1});case 8:case"end":return ne.stop()}},O)}));return function(O){return S.apply(this,arguments)}}(),params:c()({},r),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1,showTotal:function(O){return"\u5171 ".concat(O," \u6761")}}}),(0,e.jsx)(ve.Z,{locate:"asset",riskDrawerVisible:v,setRiskDrawerVisible:V,riskDrawerInfo:N.current,tableActionRef:x})]})},Y=Ce,xe=t(32983),F=t(23323),Ze=ye.Z.Text,Fe=function(R){var r=(0,b.useAccess)(),x=r.isAdmin,g=R.assetInfo;return(0,e.jsx)("div",{children:x?(0,e.jsx)(X.ZP,{type:"link",size:"small",href:"/assetManagement/asseConfig?id=".concat(g==null?void 0:g.id),target:"_blank",children:"\u914D\u7F6E\u8BE6\u60C5"}):(0,e.jsx)(e.Fragment,{})})},Ne=function(R){var r,x,g,h,u=R.assetInfo;return(0,e.jsx)(me.Z,{boxShadow:!0,extra:(0,e.jsx)(Fe,{assetInfo:u}),bodyStyle:{paddingBlockStart:0},children:(0,s.isEmpty)(u==null||(r=u.resourceDetailConfigMap)===null||r===void 0?void 0:r.BASE_INFO)&&(0,s.isEmpty)(u==null||(x=u.resourceDetailConfigMap)===null||x===void 0?void 0:x.NETWORK)?(0,e.jsx)(xe.Z,{image:xe.Z.PRESENTED_IMAGE_SIMPLE}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ze,{style:{marginBottom:6,display:"block",color:"#377df7"},children:"\u57FA\u672C\u4FE1\u606F:"}),u==null||(g=u.resourceDetailConfigMap)===null||g===void 0||(g=g.BASE_INFO)===null||g===void 0?void 0:g.map(function(v,V){return(0,e.jsx)(F.Z.Item,{label:v==null?void 0:v.name,children:v.value},V)}),(0,e.jsx)(Ze,{style:{marginBottom:6,display:"block",color:"#377df7"},children:"\u7F51\u7EDC\u4FE1\u606F:"}),u==null||(h=u.resourceDetailConfigMap)===null||h===void 0||(h=h.NETWORK)===null||h===void 0?void 0:h.map(function(v,V){return(0,e.jsx)(F.Z.Item,{label:v==null?void 0:v.name,children:v.value},V)})]})})},je=Ne,w=ye.Z.Text,Ke=function(R){var r,x=R.assetDrawerVisible,g=R.assetDrawerInfo,h=R.setAssetDrawerVisible,u=(0,b.useModel)("rule"),v=u.platformList,V=(0,b.useModel)("asset"),N=V.assetList,se=(0,E.useState)(!1),S=m()(se,2),O=S[0],i=S[1],o=(0,b.useRequest)(function(ae){return(0,ce.queryResourceDetailById)({id:ae})},{manual:!0,formatResult:function(pe){return pe.content||{}}}),f=o.data,U=o.run,re=o.loading,Z=(0,E.useState)("BasicAsset"),d=m()(Z,2),de=d[0],$=d[1],he=[{key:"BasicAsset",label:"\u8D44\u4EA7\u4FE1\u606F",children:(0,e.jsx)(je,{assetInfo:f})},{key:"AssociateRisk",label:"\u98CE\u9669\u4FE1\u606F",children:(0,e.jsx)(Y,{assetInfo:f})}],be=function(pe){$(pe)},ne=function(){h(!1),$("BasicAsset")},Pe=function(){ne()};return(0,E.useEffect)(function(){x&&g!==null&&g!==void 0&&g.id&&U(g.id)},[x,g]),(0,e.jsxs)(Ee.Z,{title:"\u8D44\u4EA7\u8BE6\u60C5",width:"50%",open:x,onClose:Pe,loading:re,children:[(0,e.jsxs)(me.Z,{boxShadow:!0,style:{marginBottom:16},bodyStyle:{paddingBlock:6},children:[(0,e.jsxs)(w,{className:j.Z.customText,children:["\u8D44\u6E90\u540D\u79F0: ",(f==null?void 0:f.resourceName)||"-"]}),(0,e.jsxs)(w,{className:j.Z.customText,children:["\u8D44\u6E90id: ",(f==null?void 0:f.resourceId)||"-",(0,e.jsx)(Be.Z,{title:"\u8D44\u6E90\u8BE6\u60C5",children:(0,e.jsx)("span",{className:j.Z.iconWrap,onClick:function(){return i(!0)},children:(0,e.jsx)(Se.Z,{className:j.Z.resourceInstance})})})]}),(0,e.jsx)(w,{className:j.Z.customText,children:(0,e.jsxs)(Ve.Z,{children:["\u4E91\u670D\u52A1:",(0,e.jsx)("span",{style:{margin:"0 12px 0 6px"},children:(0,ee.fD)(f==null?void 0:f.platform,v)}),(0,e.jsx)("span",{children:f==null?void 0:f.platform})]})}),(0,e.jsxs)(w,{className:j.Z.customText,children:["\u8D44\u6E90\u7C7B\u578B:",(0,e.jsx)("span",{style:{color:"#0958d9",marginLeft:"4px"},children:(N==null||(r=N.find(function(ae){return ae.value===(f==null?void 0:f.resourceType)}))===null||r===void 0?void 0:r.label)||"-"})]})]}),(0,e.jsx)(We.Z,{activeKey:de,items:he,onChange:be,destroyInactiveTabPane:!0}),(0,e.jsx)(rt,{assetInstanceVisible:O,setAssetInstanceVisible:i,assetInfo:f})]})},Te=Ke,we=function(R){var r=R.assetInformVisible,x=R.assetInfo,g=R.setAssetInformVisible,h=(0,E.useState)(""),u=m()(h,2),v=u[0],V=u[1],N=(0,b.useIntl)(),se=function(){g(!1)},S=(0,b.useRequest)(function(o){return(0,ce.queryResourceDetailById)({id:o})},{manual:!0,formatResult:function(f){var U=f.content,re=JSON.stringify(U==null?void 0:U.instance,null,4);(0,s.isEmpty)(re)||V(re)}}),O=S.run,i=S.loading;return(0,E.useEffect)(function(){r&&x!==null&&x!==void 0&&x.id&&O(Number(x.id))},[r,x]),(0,e.jsx)(Ee.Z,{title:N.formatMessage({id:"asset.extend.text.detail"}),width:"46%",open:r,onClose:se,destroyOnClose:!0,loading:i,children:v&&(0,e.jsx)(De.q9,{editorKey:"ASSET_CONFIG_INSTANCE",value:v,readOnly:!0,editorStyle:{height:"100%"}})})},Ue=we,ze=t(96987),Re=t(92635),$e=t(79930),Le=t(86548),He=t(39380),_e=t(42075),l=t(3303),ge=t(71230),P=t(15746),Qe=t(84567),q=t(34041),Ge=t(57381),it=t(25278),mt=t(21532),Ae=ye.Z.Paragraph,G={formItem:{marginBottom:0,color:"#999",fontSize:"12px"},paragraph:{marginBottom:0,fontSize:"12px",color:"#999"},paragraphTable:{maxWidth:"300px"},paragraphExpanded:{maxWidth:"500px"}},vt=function(R){var r=R.record,x=(0,b.useIntl)(),g=(0,b.useRequest)(function(v){return(0,ce.queryResourceRiskQuantity)({idList:[v]})},{manual:!0,formatResult:function(V){return V.content[0]}}),h=g.data,u=g.run;return(0,E.useEffect)(function(){r!=null&&r.id&&u(Number(r.id))},[r]),(0,e.jsxs)(_e.Z,{size:2,children:[(0,e.jsx)(X.ZP,{type:"link",style:{padding:0},size:"small",target:"_blank",href:"/riskManagement/riskList?platform=".concat(r==null?void 0:r.platform,"&riskLevel=").concat(te.I9[0].value,"&resourceId=").concat(r==null?void 0:r.resourceId),rel:"prefetch",children:(0,e.jsx)(L.Z,{level:"HIGH",text:"".concat(x.formatMessage({id:"common.link.text.high"})," ").concat((h==null?void 0:h.highLevelRiskCount)||0)})}),(0,e.jsx)(X.ZP,{type:"link",style:{padding:0},size:"small",target:"_blank",href:"/riskManagement/riskList?platform=".concat(r==null?void 0:r.platform,"&riskLevel=").concat(te.I9[1].value,"&resourceId=").concat(r==null?void 0:r.resourceId),rel:"prefetch",children:(0,e.jsx)(L.Z,{level:"MEDIUM",text:"".concat(x.formatMessage({id:"common.link.text.middle"})," ").concat((h==null?void 0:h.mediumLevelRiskCount)||0)})}),(0,e.jsx)(X.ZP,{type:"link",style:{padding:0},size:"small",target:"_blank",href:"/riskManagement/riskList?platform=".concat(r==null?void 0:r.platform,"&riskLevel=").concat(te.I9[2].value,"&resourceId=").concat(r==null?void 0:r.resourceId),rel:"prefetch",children:(0,e.jsx)(L.Z,{level:"LOW",text:"".concat(x.formatMessage({id:"common.link.text.low"}),"  ").concat((h==null?void 0:h.lowLevelRiskCount)||0)})})]})},ft=function(){var R,r=l.Z.SHOW_CHILD,x=(0,b.useModel)("rule"),g=x.platformList,h=new URLSearchParams((R=(0,b.useLocation)())===null||R===void 0?void 0:R.search),u=h.get("cloudAccountId"),v=h.get("platform"),V=h.get("resourceGroupType"),N=h.get("resourceType"),se=(0,E.useRef)(),S=(0,E.useRef)(),O=(0,E.useState)(!1),i=m()(O,2),o=i[0],f=i[1],U=F.Z.useForm(),re=m()(U,1),Z=re[0],d=(0,b.useIntl)(),de=(0,E.useState)(!1),$=m()(de,2),he=$[0],be=$[1],ne=(0,E.useRef)({}),Pe=(0,E.useRef)({}),ae=(0,E.useState)([]),pe=m()(ae,2),gt=pe[0],Je=pe[1],ht=(0,E.useState)({customField:{show:!1},cloudAccountId:{show:!1},platform:{show:!1},address:{show:!1},tenantName:{show:!1}}),pt=m()(ht,1),It=pt[0],yt=(0,b.useRequest)(function(C){return(0,$e.queryGroupTypeList)({platformList:C})},{manual:!0,formatResult:function(a){var n=a.content;Je(n||[])}}),ot=yt.run,Et=[{title:(0,e.jsxs)(e.Fragment,{children:[d.formatMessage({id:"common.table.columns.assetId"}),"\xA0\xA0|\xA0\xA0",d.formatMessage({id:"common.table.columns.assetName"})]}),dataIndex:"resourceId",valueType:"text",align:"left",hideInSearch:!0,render:function(a,n){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(X.ZP,{style:{padding:0},size:"small",type:"link",onClick:function(){Pe.current=c()({},n),f(!0)},children:(0,e.jsx)(Ae,{copyable:!0,style:{color:"inherit",marginBottom:0},children:n.resourceId})}),(0,e.jsx)(Oe.Z,{placement:"topLeft",text:n.resourceName,maxWidth:360,style:{color:"#333"}})]})}},{title:d.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",width:200,hideInSearch:!0,render:function(a,n){return(0,e.jsx)(M.Z,{text:n==null?void 0:n.resourceType})}},{title:d.formatMessage({id:"asset.module.risk.number"}),width:200,dataIndex:"rulePassRate",valueType:"text",align:"left",hideInSearch:!0,render:function(a,n){return(0,e.jsx)(vt,{record:n})}},{title:d.formatMessage({id:"common.input.text.custom.fields"}),dataIndex:"customFieldValue",valueType:"text",align:"left",width:500,render:function(a,n){var H,Q,k,_;return(0,e.jsx)("div",{style:{maxHeight:"120px",overflow:"auto"},children:(0,e.jsx)(ge.Z,{children:(0,e.jsx)(P.Z,{span:24,children:(0,s.isEmpty)(n==null||(H=n.resourceDetailConfigMap)===null||H===void 0?void 0:H.BASE_INFO)&&(0,s.isEmpty)(n==null||(Q=n.resourceDetailConfigMap)===null||Q===void 0?void 0:Q.NETWORK)?"-":(0,e.jsxs)(e.Fragment,{children:[n==null||(k=n.resourceDetailConfigMap)===null||k===void 0||(k=k.BASE_INFO)===null||k===void 0?void 0:k.map(function(D,le){return(0,e.jsx)(F.Z.Item,{label:D==null?void 0:D.name,style:G.formItem,children:(0,e.jsx)(Ae,{copyable:{text:D.value},style:c()(c()({},G.paragraph),G.paragraphTable),ellipsis:{tooltip:D.value},children:D.value})},le)}),n==null||(_=n.resourceDetailConfigMap)===null||_===void 0||(_=_.NETWORK)===null||_===void 0?void 0:_.map(function(D,le){return(0,e.jsx)(F.Z.Item,{label:D==null?void 0:D.name,style:G.formItem,children:(0,e.jsx)(Ae,{copyable:{text:D.value},style:c()(c()({},G.paragraph),G.paragraphTable),ellipsis:{tooltip:D.value},children:D.value})},le)})]})})})})}},{title:d.formatMessage({id:"common.table.columns.createAndUpdateTime"}),dataIndex:"gmt_modified",tooltip:d.formatMessage({id:"common.table.columns.sort.update"}),valueType:"text",align:"left",hideInSearch:!0,sorter:!0,width:240,render:function(a,n){return(0,e.jsxs)("div",{children:[(0,e.jsx)("section",{style:{color:"#999"},children:(n==null?void 0:n.gmtCreate)||"-"}),(0,e.jsx)("section",{style:{color:"#999"},children:(n==null?void 0:n.gmtModified)||"-"})]})}},{title:d.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"text",align:"left",hideInSearch:!0,render:function(a,n){return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:n==null?void 0:n.cloudAccountId}),(0,e.jsx)("div",{style:{color:"#999"},children:n==null?void 0:n.alias})]})}},{title:d.formatMessage({id:"common.select.label.cloudPlatform"}),dataIndex:"platform",valueType:"text",align:"center",hideInSearch:!0,render:function(a,n){return(0,ee.fD)(n.platform,g)}},{title:d.formatMessage({id:"asset.module.input.text.ip"}),dataIndex:"address",valueType:"text",align:"left",hideInSearch:!0},{title:d.formatMessage({id:"common.select.label.tenant"}),dataIndex:"tenantName",valueType:"text",align:"left",hideInSearch:!0}],Xe=(0,b.useRequest)(function(C){return(0,Re.cloudAccountBaseInfoList)(c()({},C))},{manual:!0,formatResult:function(a){if(a.msg==="success"){var n;return(a==null||(n=a.content)===null||n===void 0||(n=n.accountAliasList)===null||n===void 0?void 0:n.map(function(H){return{label:H,value:H}}))||[]}}}),Dt=Xe.data,Ye=Xe.run,Mt=Xe.loading,Ct=(0,E.useMemo)(function(){var C=function(n){Ye({platformList:Z.getFieldValue("platformList")||[],cloudAccountSearch:n})};return(0,s.debounce)(C,500)},[Re.cloudAccountBaseInfoList]);return(0,E.useEffect)(function(){var C={};if(v&&(C.platformList=[v]),u&&(C.cloudAccountSearch=u),Ye(C),(!(0,s.isEmpty)(u)||!(0,s.isEmpty)(v)||!(0,s.isEmpty)(V)&&!(0,s.isEmpty)(N))&&(u&&(Z==null||Z.setFieldValue("cloudAccountId",u)),!(0,s.isEmpty)(v)&&(Z==null||Z.setFieldValue("platformList",[v]),Z.setFieldValue("resourceTypeList",null),Je([]),ot([v]),!(0,s.isEmpty)(V)&&!(0,s.isEmpty)(N)))){var a=[],n=[V,N];a.push(n),Z.setFieldValue("resourceTypeList",a)}},[v,u,N]),(0,e.jsxs)(He._z,{title:!1,className:j.Z.assetPageContainer,breadcrumb:void 0,children:[(0,e.jsx)(me.Z,{bodyStyle:{paddingBottom:0},className:j.Z.customFilterCard,children:(0,e.jsx)(F.Z,{form:Z,children:(0,e.jsxs)(ge.Z,{gutter:[24,10],children:[(0,e.jsx)(P.Z,{span:24,children:(0,e.jsx)(F.Z.Item,{name:"platformList",label:d.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,e.jsx)(Qe.Z.Group,{options:(0,ee.T$)(g),onChange:function(a){Z.setFieldValue("resourceTypeList",null),Je([]),ot(a),Ye({platformList:a||[]})}})})}),(0,e.jsx)(P.Z,{span:6,children:(0,e.jsx)(F.Z.Item,{name:"resourceTypeList",label:d.formatMessage({id:"cloudAccount.extend.title.asset.type"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(l.Z,{options:gt,multiple:!0,placeholder:d.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:r,allowClear:!0,showSearch:!0})})}),(0,e.jsx)(P.Z,{span:6,children:(0,e.jsx)(F.Z.Item,{name:"cloudAccountId",label:d.formatMessage({id:"common.select.label.cloudAccount"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(q.Z,{allowClear:!0,showSearch:!0,placeholder:d.formatMessage({id:"common.select.query.text.placeholder"}),notFoundContent:Mt&&(0,e.jsx)(Ge.Z,{size:"small"}),onSearch:Ct,options:Dt||[]})})}),(0,e.jsx)(P.Z,{span:6,children:(0,e.jsx)(F.Z.Item,{name:"searchParam",label:d.formatMessage({id:"common.input.text.assetIdAndName"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(it.Z,{placeholder:d.formatMessage({id:"common.input.text.placeholder"}),allowClear:!0})})}),(0,e.jsx)(P.Z,{span:6,children:(0,e.jsx)(F.Z.Item,{name:"address",label:d.formatMessage({id:"asset.module.input.text.ip"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(it.Z,{placeholder:d.formatMessage({id:"common.input.text.placeholder"}),allowClear:!0})})})]})})}),(0,e.jsx)(fe.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,labelWidth:0},headerTitle:(0,e.jsx)("div",{className:J.Z.customTitle,children:d.formatMessage({id:"asset.module.text.asset.inquiry"})}),actionRef:se,formRef:S,columns:Et,columnsState:{defaultValue:It,persistenceType:"localStorage",persistenceKey:"ASSET_TABLE_LIST_CACHE"},onReset:function(){var a;Z.resetFields(),(a=S.current)===null||a===void 0||a.resetFields()},pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1,pageSizeOptions:[10,20,50]},request:function(){var C=W()(p()().mark(function a(n,H){var Q,k,_,D,le,qe,et,tt,st,nt,at,lt,ut,dt,ct;return p()().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Q=n.customFieldValue,k=n.current,_=n.pageSize,D={customFieldValue:Q,page:k,size:_},le=(0,ee.Hm)(H),(0,s.isEmpty)(le)||(D.sortParam=le==null?void 0:le.key,D.sortType=ze.ym[le.value]),qe=Z.getFieldValue("platformList"),(0,s.isEmpty)(qe)||(D.platformList=qe),et=Z.getFieldValue("resourceTypeList"),(0,s.isEmpty)(et)||(D.resourceTypeList=et),tt=Z.getFieldValue("cloudAccountId"),(0,s.isEmpty)(tt)||(D.cloudAccountId=tt),st=Z.getFieldValue("searchParam"),st&&(D.searchParam=st),nt=Z.getFieldValue("address"),nt&&(D.address=nt),Ie.next=16,(0,ce.queryResourceList)(D);case 16:return at=Ie.sent,lt=at.content,ut=at.code,dt=lt.data,ct=lt.total,Ie.abrupt("return",{data:dt||[],total:ct||0,success:ut===200||!1});case 21:case"end":return Ie.stop()}},a)}));return function(a,n){return C.apply(this,arguments)}}(),tableClassName:j.Z.customAssetTable,expandable:{expandedRowRender:function(a){var n,H,Q,k;return(0,e.jsxs)(ge.Z,{children:[(0,e.jsx)(P.Z,{span:2,className:j.Z.dimBlock,style:{borderLeft:"0.5px solid rgb(239, 239, 239)"},children:d.formatMessage({id:"common.select.label.cloudAccount"})}),(0,e.jsxs)(P.Z,{span:4,className:j.Z.cleanBlock,style:{flexDirection:"column"},children:[(0,e.jsx)("div",{children:a==null?void 0:a.cloudAccountId}),(0,e.jsx)("div",{style:{color:"#999"},children:a==null?void 0:a.alias})]}),(0,e.jsx)(P.Z,{span:2,className:j.Z.dimBlock,children:d.formatMessage({id:"common.select.label.cloudPlatform"})}),(0,e.jsx)(P.Z,{span:4,className:j.Z.cleanBlock,children:(0,ee.fD)(a.platform,g)}),(0,e.jsx)(P.Z,{span:2,className:j.Z.dimBlock,children:d.formatMessage({id:"asset.module.input.text.ip"})}),(0,e.jsx)(P.Z,{span:4,className:j.Z.cleanBlock,children:(a==null?void 0:a.address)||"-"}),(0,e.jsx)(P.Z,{span:2,className:j.Z.dimBlock,children:d.formatMessage({id:"common.select.label.tenant"})}),(0,e.jsx)(P.Z,{span:4,className:j.Z.cleanBlock,children:(a==null?void 0:a.tenantName)||"-"}),(0,e.jsx)(P.Z,{span:2,className:j.Z.dimBlock,style:{borderTop:"none",borderLeft:"0.5px solid rgb(239, 239, 239)"},children:d.formatMessage({id:"common.input.text.custom.fields"})}),(0,e.jsx)(P.Z,{span:22,className:j.Z.customField,style:{borderTop:"none"},children:(0,e.jsxs)(ge.Z,{children:[(0,e.jsx)(P.Z,{span:22,style:{maxHeight:"200px",overflow:"auto"},children:(0,s.isEmpty)(a==null||(n=a.resourceDetailConfigMap)===null||n===void 0?void 0:n.BASE_INFO)&&(0,s.isEmpty)(a==null||(H=a.resourceDetailConfigMap)===null||H===void 0?void 0:H.NETWORK)?(0,e.jsx)(mt.ZP,{theme:{token:{margin:8,marginXL:8,marginXS:8}},children:(0,e.jsx)(xe.Z,{image:xe.Z.PRESENTED_IMAGE_SIMPLE})}):(0,e.jsxs)(e.Fragment,{children:[a==null||(Q=a.resourceDetailConfigMap)===null||Q===void 0||(Q=Q.BASE_INFO)===null||Q===void 0?void 0:Q.map(function(_,D){return(0,e.jsx)(F.Z.Item,{label:_==null?void 0:_.name,style:G.formItem,children:(0,e.jsx)(Ae,{copyable:{text:_.value},style:c()(c()({},G.paragraph),G.paragraphExpanded),ellipsis:{tooltip:_.value},children:_.value})},D)}),a==null||(k=a.resourceDetailConfigMap)===null||k===void 0||(k=k.NETWORK)===null||k===void 0?void 0:k.map(function(_,D){return(0,e.jsx)(F.Z.Item,{label:_==null?void 0:_.name,style:G.formItem,children:(0,e.jsx)(Ae,{copyable:{text:_.value},style:c()(c()({},G.paragraph),G.paragraphExpanded),ellipsis:{tooltip:_.value},children:_.value})},D)})]})}),(0,e.jsx)(P.Z,{span:2,children:(0,e.jsxs)(X.ZP,{size:"small",type:"link",target:"_self",href:"/assetManagement/asseConfig?id=".concat(a==null?void 0:a.id),children:[(0,e.jsx)(Le.Z,{}),d.formatMessage({id:"common.button.text.edit"})]})})]})})]})},columnTitle:(0,e.jsx)("div",{style:{width:30,textAlign:"center"}}),columnWidth:30,rowExpandable:function(){return!0},expandIcon:z.Z}}),(0,e.jsx)(Te,{assetDrawerVisible:he,setAssetDrawerVisible:be,assetDrawerInfo:ne.current,tableActionRef:se}),(0,e.jsx)(Ue,{assetInformVisible:o,setAssetInformVisible:f,assetInfo:Pe.current})]})},xt=ft},92086:function(K,T,t){"use strict";var B=t(5574),p=t.n(B),I=t(87426),W=t(39421),y=t(24163),c=t(71448),A=t(24482),m=t(50322),z=t(22145),L=t(96364),M=t(72028),J=t(29448),Oe=t(45742),ce=t(93410),ee=t(92016),Se=t(25593),me=t(85265),b=t(86250),ye=t(83622),Ee=t(42075),Be=t(66309),Ve=t(83062),We=t(21532),E=t(23323),j=t(62435),De=t(47908),s=t(86074),e=Se.Z.Text,ke=function(ve){var ie,Me,te,fe,oe,X,Ce=ve.riskDrawerVisible,Y=ve.riskDrawerInfo,xe=ve.setRiskDrawerVisible,F=ve.locate,Ze=(0,ee.useModel)("rule"),Fe=Ze.platformList,Ne=(0,ee.useModel)("tenant"),je=Ne.tenantListAll,w=(0,ee.useIntl)(),Ke=(0,j.useState)(!1),Te=p()(Ke,2),we=Te[0],Ue=Te[1],ze=(0,j.useState)(!1),Re=p()(ze,2),$e=Re[0],Le=Re[1],He=function(){xe(!1)},_e=(0,ee.useRequest)(function(q){return(0,M.queryRiskDetailById)({riskId:q})},{manual:!0,formatResult:function(Ge){return Ge.content||{}}}),l=_e.data,ge=_e.run,P=_e.loading,Qe=function(){He()};return(0,j.useEffect)(function(){Ce&&Y!==null&&Y!==void 0&&Y.id&&ge(Y.id)},[Ce,Y]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(me.Z,{title:w.formatMessage({id:"risk.module.text.detail.info"}),width:"50%",open:Ce,onClose:Qe,loading:P,children:[(0,s.jsxs)(ce.Z,{style:{marginBottom:20},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,s.jsx)(b.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,s.jsxs)("span",{children:[(0,s.jsx)(e,{style:{marginRight:12},children:(0,s.jsx)(ye.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(l==null?void 0:l.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(l==null||(ie=l.ruleVO)===null||ie===void 0?void 0:ie.ruleName)||"-"})}),(0,s.jsxs)(Ee.Z,{children:[(0,s.jsx)("span",{children:(0,J.Ff)(L.MW,l==null?void 0:l.status)}),(l==null?void 0:l.ignoreReasonType)&&(0,s.jsxs)("span",{children:[(0,s.jsxs)(e,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[w.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,s.jsx)(Be.Z,{color:"geekblue",children:((Me=L.$G.find(function(q){return q.value===(l==null?void 0:l.ignoreReasonType)}))===null||Me===void 0?void 0:Me.label)||"-"})]}),(l==null?void 0:l.ignoreReason)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[w.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,s.jsx)(y.Z,{rows:1,text:l==null?void 0:l.ignoreReason,maxWidth:64})]})]})]})}),(0,s.jsxs)(b.Z,{vertical:!0,gap:10,children:[(0,s.jsxs)(b.Z,{align:"center",children:[(0,s.jsx)("img",{src:W.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,s.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[w.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,s.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:l==null?void 0:l.gmtModified})]}),(0,s.jsxs)(e,{children:[(0,s.jsx)("img",{src:I.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,s.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[w.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,s.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:l==null?void 0:l.gmtCreate})]})]}),(0,s.jsxs)(b.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,s.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,J.fD)(l==null?void 0:l.platform,Fe)}),(0,s.jsx)(e,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(l==null?void 0:l.resourceType)||"-"}),(0,s.jsxs)(b.Z,{align:"center",children:[(0,s.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(l==null?void 0:l.resourceName)+" / "+(l==null?void 0:l.resourceId)}),F==="risk"&&(0,s.jsx)(Ve.Z,{title:w.formatMessage({id:"asset.extend.text.detail"}),children:(0,s.jsx)("span",{className:De.Z.iconWrap,onClick:function(){return Le(!0)},children:(0,s.jsx)(Oe.Z,{className:De.Z.resourceInstance})})})]}),(0,s.jsx)(e,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(je==null||(te=je.find(function(q){return q.value===(l==null?void 0:l.tenantId)}))===null||te===void 0?void 0:te.label)||"-"})]})]}),(0,s.jsx)(We.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,s.jsxs)(E.Z,{children:[(0,s.jsx)(E.Z.Item,{label:w.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,s.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(l==null||(fe=l.ruleVO)===null||fe===void 0?void 0:fe.advice)||"-"})}),(0,s.jsx)(E.Z.Item,{label:w.formatMessage({id:"risk.module.text.reference.link"}),children:(0,s.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(l==null||(oe=l.ruleVO)===null||oe===void 0?void 0:oe.link)||"-"})}),(0,s.jsx)(E.Z.Item,{label:w.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,s.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(l==null||(X=l.ruleVO)===null||X===void 0?void 0:X.ruleDesc)||"-"})})]})}),(0,s.jsx)(c.Z,{riskDrawerInfo:Y}),(0,s.jsx)(m.Z,{riskDrawerInfo:Y})]}),(0,s.jsx)(A.Z,{evaluateDrawerVisible:we,setEvaluateDrawerVisible:Ue,riskDrawerInfo:Y}),(0,s.jsx)(z.Z,{resourceDrawerVisible:$e,setResourceDrawerVisible:Le,riskDrawerInfo:Y})]})};T.Z=ke},24732:function(K,T){"use strict";T.Z={polymerizeWrap:"polymerizeWrap___DA0Kx",polymerizeCard:"polymerizeCard___cqy_L",polymerizeHead:"polymerizeHead___wg2jK",polymerizeMain:"polymerizeMain___MABwi",riskWrap:"riskWrap___bmqQb",riskWrapLeft:"riskWrapLeft___IXwxM",riskWrapRight:"riskWrapRight___Kdvj4",riskAsset:"riskAsset___QyUxz",assetMain:"assetMain___cdM5B",newTag:"newTag___MqjNr",assetMainItem:"assetMainItem___m8m8F",assetMainItemLabel:"assetMainItemLabel___xE6cJ",assetView:"assetView____rh3f",assetPageContainer:"assetPageContainer___XCTom",customFilterCard:"customFilterCard___vdglF",customText:"customText___B_t7o",iconWrap:"iconWrap___tQQp4",resourceInstance:"resourceInstance___Y06OO",assetConfigPageContainer:"assetConfigPageContainer___tB7j6",customAssetTable:"customAssetTable___J9RJC",cleanBlock:"cleanBlock___xLiWM",dimBlock:"dimBlock___HBpS1",customField:"customField___J1Iyu",tabProCard:"tabProCard___ahTeu"}},64599:function(K,T,t){var B=t(96263);function p(I,W){var y=typeof Symbol!="undefined"&&I[Symbol.iterator]||I["@@iterator"];if(!y){if(Array.isArray(I)||(y=B(I))||W&&I&&typeof I.length=="number"){y&&(I=y);var c=0,A=function(){};return{s:A,n:function(){return c>=I.length?{done:!0}:{done:!1,value:I[c++]}},e:function(J){throw J},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,z=!1,L;return{s:function(){y=y.call(I)},n:function(){var J=y.next();return m=J.done,J},e:function(J){z=!0,L=J},f:function(){try{!m&&y.return!=null&&y.return()}finally{if(z)throw L}}}}K.exports=p,K.exports.__esModule=!0,K.exports.default=K.exports}}]);
