"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3231],{8751:function(ae,O,t){t.d(O,{Z:function(){return h}});var b=t(87462),p=t(62435),B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},k=B,V=t(84089),v=function(S,W){return p.createElement(V.Z,(0,b.Z)({},S,{ref:W,icon:k}))},L=p.forwardRef(v),h=L},18429:function(ae,O,t){t.d(O,{Z:function(){return h}});var b=t(87462),p=t(62435),B={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},k=B,V=t(84089),v=function(S,W){return p.createElement(V.Z,(0,b.Z)({},S,{ref:W,icon:k}))},L=p.forwardRef(v),h=L},56477:function(ae,O,t){t.d(O,{Z:function(){return h}});var b=t(87462),p=t(62435),B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"},k=B,V=t(84089),v=function(S,W){return p.createElement(V.Z,(0,b.Z)({},S,{ref:W,icon:k}))},L=p.forwardRef(v),h=L},61011:function(ae,O,t){t.d(O,{Z:function(){return h}});var b=t(87462),p=t(62435),B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M666.7 505.5l-246-178A8 8 0 00408 334v46.9c0 10.2 4.9 19.9 13.2 25.9L566.6 512 421.2 617.2c-8.3 6-13.2 15.6-13.2 25.9V690c0 6.5 7.4 10.3 12.7 6.5l246-178c4.4-3.2 4.4-9.8 0-13z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"right-circle",theme:"outlined"},k=B,V=t(84089),v=function(S,W){return p.createElement(V.Z,(0,b.Z)({},S,{ref:W,icon:k}))},L=p.forwardRef(v),h=L},28058:function(ae,O,t){t.d(O,{Z:function(){return h}});var b=t(87462),p=t(62435),B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},k=B,V=t(84089),v=function(S,W){return p.createElement(V.Z,(0,b.Z)({},S,{ref:W,icon:k}))},L=p.forwardRef(v),h=L},3859:function(ae,O,t){var b=t(97857),p=t.n(b),B=t(66309),k=t(62435),V=t(53846),v=t(86074);O.Z=function(L){var h,X=L.text,S=L.style,W=L.level;return(0,v.jsx)(B.Z,{className:V.Z[W==="HIGH"?"riskHigh":(h=["MEDIUM","MIDDLE"])!==null&&h!==void 0&&h.includes(W)?"riskMedium":W==="LOW"?"riskLow":""],style:p()({},S),children:X})}},31732:function(ae,O,t){var b=t(97857),p=t.n(b),B=t(66309),k=t(62435),V=t(86074);O.Z=function(v){var L=v.text,h=v.style;return(0,V.jsx)(B.Z,{style:p()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},h),children:L})}},92834:function(ae,O,t){t.r(O),t.d(O,{default:function(){return xt}});var b=t(15009),p=t.n(b),B=t(99289),k=t.n(B),V=t(97857),v=t.n(V),L=t(5574),h=t.n(L),X=t(81569),S=t(3859),W=t(31732),Fe=t(53846),Me=t(24163),ge=t(21171),de=t(29448),Ne=t(45742),ne=t(93410),F=t(92016),Ce=t(25593),le=t(85265),Oe=t(83062),we=t(86250),Ke=t(92398),E=t(62435),A=t(24732),ue=t(29297),I=t(96486),e=t(86074),l=function(C){var r=C.assetInstanceVisible,f=C.assetInfo,x=C.setAssetInstanceVisible,g=(0,E.useState)(""),d=h()(g,2),c=d[0],P=d[1],w=(0,F.useIntl)(),q=function(){x(!1),P("")},T=function(){q()};return(0,E.useEffect)(function(){if(r&&!(0,I.isEmpty)(f)){var _=JSON.stringify(f==null?void 0:f.instance,null,4);(0,I.isEmpty)(_)||P(_)}},[r]),(0,e.jsx)(le.Z,{title:w.formatMessage({id:"asset.extend.text.detail"}),width:"42%",destroyOnClose:!0,open:r,onClose:T,children:!(0,I.isEmpty)(c)&&(0,e.jsx)(ue.q9,{editorKey:"assetInstance",value:c,readOnly:!0,editorStyle:{height:"100%"}})})},ie=l,Ue=t(92086),Ze=t(96364),he=t(72028),Y=t(17910),pe=t(90498),ce=t(66309),G=t(83622),je=function(C){var r=C.assetInfo,f=(0,E.useRef)(),x=(0,E.useRef)(),g=(0,E.useState)(!1),d=h()(g,2),c=d[0],P=d[1],w=(0,E.useRef)({}),q=[{title:"\u8D44\u6E90\u540D\u79F0",dataIndex:"resourceName",valueType:"text",align:"center",render:function(_,i){return(0,e.jsx)(Me.Z,{text:i!=null&&i.resourceExist?i.resourceName:"(\u4E0D\u5B58\u5728) "+i.resourceName,maxWidth:280})}},{title:"\u8D44\u6E90\u7C7B\u578B",dataIndex:"resourceType",valueType:"text",align:"center",render:function(_,i){return(0,e.jsx)(ce.Z,{color:"geekblue",children:i==null?void 0:i.resourceType})}},{title:"\u89C4\u5219\u540D\u79F0",dataIndex:"ruleName",valueType:"text",align:"center",render:function(_,i){var o;return(0,e.jsx)("span",{children:i==null||(o=i.ruleVO)===null||o===void 0?void 0:o.ruleName})}},{title:"\u89C4\u5219\u7EC4",dataIndex:"groupName",valueType:"text",align:"center",render:function(_,i){var o;return(0,e.jsx)("span",{children:i==null||(o=i.ruleVO)===null||o===void 0?void 0:o.groupName})}},{title:"\u98CE\u9669\u7B49\u7EA7",dataIndex:"riskLevel",valueType:"text",align:"center",render:function(_,i){var o=Y.I9===null||Y.I9===void 0?void 0:Y.I9.find(function(m){var U;return m.value===(i==null||(U=i.ruleVO)===null||U===void 0?void 0:U.riskLevel)});return(0,e.jsx)(ce.Z,{color:o==null?void 0:o.color,children:(o==null?void 0:o.text)||"-"})}},{title:"\u98CE\u9669\u72B6\u6001",dataIndex:"status",valueType:"text",align:"center",render:function(_,i){var o=Ze.MW===null||Ze.MW===void 0?void 0:Ze.MW.find(function(m){return m.value===(i==null?void 0:i.status)});return(0,e.jsx)(ce.Z,{color:o==null?void 0:o.color,children:(o==null?void 0:o.label)||"-"})}},{title:"\u6700\u8FD1\u626B\u63CF\u547D\u4E2D",dataIndex:"gmtModified",valueType:"text",align:"center"},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",align:"center",render:function(_,i){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(G.ZP,{type:"link",onClick:function(){w.current=v()({},i),P(!0)},children:"\u8BE6\u60C5"})})}}];return(0,e.jsxs)(ne.Z,{boxShadow:!0,bodyStyle:{padding:"32px 4px 12px 4px"},children:[(0,e.jsx)(pe.Z,{tableStyle:{padding:0},scroll:{x:"max-content"},rowKey:"id",search:!1,options:!1,actionRef:f,formRef:x,columns:q,request:function(){var T=k()(p()().mark(function _(i){var o,m,U,re,R,u,xe,z,ye;return p()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return o=i.pageSize,m=i.current,U=i.cloudAccountId,re=i.resourceId,R=i.platform,u={page:m,size:o,cloudAccountId:U,resourceId:re,platformList:[R]},ee.next=4,(0,he.queryRiskList)(u);case 4:return xe=ee.sent,z=xe.content,ye=xe.code,ee.abrupt("return",{data:(z==null?void 0:z.data)||[],total:(z==null?void 0:z.total)||0,success:ye===200||!1});case 8:case"end":return ee.stop()}},_)}));return function(_){return T.apply(this,arguments)}}(),params:v()({},r),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1,showTotal:function(_){return"\u5171 ".concat(_," \u6761")}}}),(0,e.jsx)(Ue.Z,{locate:"asset",riskDrawerVisible:c,setRiskDrawerVisible:P,riskDrawerInfo:w.current,tableActionRef:f})]})},_e=je,oe=t(32983),M=t(23323),Te=Ce.Z.Text,ze=function(C){var r=(0,F.useAccess)(),f=r.isAdmin,x=C.assetInfo;return(0,e.jsx)("div",{children:f?(0,e.jsx)(G.ZP,{type:"link",size:"small",href:"/assetManagement/asseConfig?id=".concat(x==null?void 0:x.id),target:"_blank",children:"\u914D\u7F6E\u8BE6\u60C5"}):(0,e.jsx)(e.Fragment,{})})},$e=function(C){var r,f,x,g,d=C.assetInfo;return(0,e.jsx)(ne.Z,{boxShadow:!0,extra:(0,e.jsx)(ze,{assetInfo:d}),bodyStyle:{paddingBlockStart:0},children:(0,I.isEmpty)(d==null||(r=d.resourceDetailConfigMap)===null||r===void 0?void 0:r.BASE_INFO)&&(0,I.isEmpty)(d==null||(f=d.resourceDetailConfigMap)===null||f===void 0?void 0:f.NETWORK)?(0,e.jsx)(oe.Z,{image:oe.Z.PRESENTED_IMAGE_SIMPLE}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Te,{style:{marginBottom:6,display:"block",color:"#377df7"},children:"\u57FA\u672C\u4FE1\u606F:"}),d==null||(x=d.resourceDetailConfigMap)===null||x===void 0||(x=x.BASE_INFO)===null||x===void 0?void 0:x.map(function(c,P){return(0,e.jsx)(M.Z.Item,{label:c==null?void 0:c.name,children:c.value},P)}),(0,e.jsx)(Te,{style:{marginBottom:6,display:"block",color:"#377df7"},children:"\u7F51\u7EDC\u4FE1\u606F:"}),d==null||(g=d.resourceDetailConfigMap)===null||g===void 0||(g=g.NETWORK)===null||g===void 0?void 0:g.map(function(c,P){return(0,e.jsx)(M.Z.Item,{label:c==null?void 0:c.name,children:c.value},P)})]})})},He=$e,Ie=Ce.Z.Text,Re=function(C){var r,f=C.assetDrawerVisible,x=C.assetDrawerInfo,g=C.setAssetDrawerVisible,d=(0,F.useModel)("rule"),c=d.platformList,P=(0,F.useModel)("asset"),w=P.assetList,q=(0,E.useState)(!1),T=h()(q,2),_=T[0],i=T[1],o=(0,F.useRequest)(function(te){return(0,ge.queryResourceDetailById)({id:te})},{manual:!0,formatResult:function(Ee){return Ee.content||{}}}),m=o.data,U=o.run,re=o.loading,R=(0,E.useState)("BasicAsset"),u=h()(R,2),xe=u[0],z=u[1],ye=[{key:"BasicAsset",label:"\u8D44\u4EA7\u4FE1\u606F",children:(0,e.jsx)(He,{assetInfo:m})},{key:"AssociateRisk",label:"\u98CE\u9669\u4FE1\u606F",children:(0,e.jsx)(_e,{assetInfo:m})}],We=function(Ee){z(Ee)},ee=function(){g(!1),z("BasicAsset")},ke=function(){ee()};return(0,E.useEffect)(function(){f&&x!==null&&x!==void 0&&x.id&&U(x.id)},[f,x]),(0,e.jsxs)(le.Z,{title:"\u8D44\u4EA7\u8BE6\u60C5",width:"50%",open:f,onClose:ke,loading:re,children:[(0,e.jsxs)(ne.Z,{boxShadow:!0,style:{marginBottom:16},bodyStyle:{paddingBlock:6},children:[(0,e.jsxs)(Ie,{className:A.Z.customText,children:["\u8D44\u6E90\u540D\u79F0: ",(m==null?void 0:m.resourceName)||"-"]}),(0,e.jsxs)(Ie,{className:A.Z.customText,children:["\u8D44\u6E90id: ",(m==null?void 0:m.resourceId)||"-",(0,e.jsx)(Oe.Z,{title:"\u8D44\u6E90\u8BE6\u60C5",children:(0,e.jsx)("span",{className:A.Z.iconWrap,onClick:function(){return i(!0)},children:(0,e.jsx)(Ne.Z,{className:A.Z.resourceInstance})})})]}),(0,e.jsx)(Ie,{className:A.Z.customText,children:(0,e.jsxs)(we.Z,{children:["\u4E91\u670D\u52A1:",(0,e.jsx)("span",{style:{margin:"0 12px 0 6px"},children:(0,de.fD)(m==null?void 0:m.platform,c)}),(0,e.jsx)("span",{children:m==null?void 0:m.platform})]})}),(0,e.jsxs)(Ie,{className:A.Z.customText,children:["\u8D44\u6E90\u7C7B\u578B:",(0,e.jsx)("span",{style:{color:"#0958d9",marginLeft:"4px"},children:(w==null||(r=w.find(function(te){return te.value===(m==null?void 0:m.resourceType)}))===null||r===void 0?void 0:r.label)||"-"})]})]}),(0,e.jsx)(Ke.Z,{activeKey:xe,items:ye,onChange:We,destroyInactiveTabPane:!0}),(0,e.jsx)(ie,{assetInstanceVisible:_,setAssetInstanceVisible:i,assetInfo:m})]})},J=Re,Qe=function(C){var r=C.assetInformVisible,f=C.assetInfo,x=C.setAssetInformVisible,g=(0,E.useState)(""),d=h()(g,2),c=d[0],P=d[1],w=(0,F.useIntl)(),q=function(){x(!1)},T=(0,F.useRequest)(function(o){return(0,ge.queryResourceDetailById)({id:o})},{manual:!0,formatResult:function(m){var U=m.content,re=JSON.stringify(U==null?void 0:U.instance,null,4);(0,I.isEmpty)(re)||P(re)}}),_=T.run,i=T.loading;return(0,E.useEffect)(function(){r&&f!==null&&f!==void 0&&f.id&&_(Number(f.id))},[r,f]),(0,e.jsx)(le.Z,{title:w.formatMessage({id:"asset.extend.text.detail"}),width:"46%",open:r,onClose:q,destroyOnClose:!0,loading:i,children:c&&(0,e.jsx)(ue.q9,{editorKey:"ASSET_CONFIG_INSTANCE",value:c,readOnly:!0,editorStyle:{height:"100%"}})})},Le=Qe,Ge=t(96987),Pe=t(92635),Je=t(79930),Se=t(86548),Xe=t(39380),be=t(42075),Be=t(3303),me=t(71230),Z=t(15746),Ve=t(84567),Ye=t(34041),Ae=t(57381),s=t(25278),qe=t(21532),ve=Ce.Z.Paragraph,K={formItem:{marginBottom:0,color:"#999",fontSize:"12px"},paragraph:{marginBottom:0,fontSize:"12px",color:"#999"},paragraphTable:{maxWidth:"300px"},paragraphExpanded:{maxWidth:"500px"}},Q=function(C){var r=C.record,f=(0,F.useIntl)(),x=(0,F.useRequest)(function(c){return(0,ge.queryResourceRiskQuantity)({idList:[c]})},{manual:!0,formatResult:function(P){return P.content[0]}}),g=x.data,d=x.run;return(0,E.useEffect)(function(){r!=null&&r.id&&d(Number(r.id))},[r]),(0,e.jsxs)(be.Z,{size:2,children:[(0,e.jsx)(G.ZP,{type:"link",style:{padding:0},size:"small",target:"_blank",href:"/riskManagement/riskList?platform=".concat(r==null?void 0:r.platform,"&riskLevel=").concat(Y.I9[0].value,"&resourceId=").concat(r==null?void 0:r.resourceId),rel:"prefetch",children:(0,e.jsx)(S.Z,{level:"HIGH",text:"".concat(f.formatMessage({id:"common.link.text.high"})," ").concat((g==null?void 0:g.highLevelRiskCount)||0)})}),(0,e.jsx)(G.ZP,{type:"link",style:{padding:0},size:"small",target:"_blank",href:"/riskManagement/riskList?platform=".concat(r==null?void 0:r.platform,"&riskLevel=").concat(Y.I9[1].value,"&resourceId=").concat(r==null?void 0:r.resourceId),rel:"prefetch",children:(0,e.jsx)(S.Z,{level:"MEDIUM",text:"".concat(f.formatMessage({id:"common.link.text.middle"})," ").concat((g==null?void 0:g.mediumLevelRiskCount)||0)})}),(0,e.jsx)(G.ZP,{type:"link",style:{padding:0},size:"small",target:"_blank",href:"/riskManagement/riskList?platform=".concat(r==null?void 0:r.platform,"&riskLevel=").concat(Y.I9[2].value,"&resourceId=").concat(r==null?void 0:r.resourceId),rel:"prefetch",children:(0,e.jsx)(S.Z,{level:"LOW",text:"".concat(f.formatMessage({id:"common.link.text.low"}),"  ").concat((g==null?void 0:g.lowLevelRiskCount)||0)})})]})},et=function(){var C,r=Be.Z.SHOW_CHILD,f=(0,F.useModel)("rule"),x=f.platformList,g=new URLSearchParams((C=(0,F.useLocation)())===null||C===void 0?void 0:C.search),d=g.get("cloudAccountId"),c=g.get("platform"),P=g.get("resourceGroupType"),w=g.get("resourceType"),q=(0,E.useRef)(),T=(0,E.useRef)(),_=(0,E.useState)(!1),i=h()(_,2),o=i[0],m=i[1],U=M.Z.useForm(),re=h()(U,1),R=re[0],u=(0,F.useIntl)(),xe=(0,E.useState)(!1),z=h()(xe,2),ye=z[0],We=z[1],ee=(0,E.useRef)({}),ke=(0,E.useRef)({}),te=(0,E.useState)([]),Ee=h()(te,2),gt=Ee[0],tt=Ee[1],ht=(0,E.useState)({customField:{show:!1},cloudAccountId:{show:!1},platform:{show:!1},address:{show:!1},tenantName:{show:!1}}),pt=h()(ht,1),It=pt[0],yt=(0,F.useRequest)(function(D){return(0,Je.queryGroupTypeList)({platformList:D})},{manual:!0,formatResult:function(n){var a=n.content;tt(a||[])}}),ct=yt.run,Et=[{title:(0,e.jsxs)(e.Fragment,{children:[u.formatMessage({id:"common.table.columns.assetId"}),"\xA0\xA0|\xA0\xA0",u.formatMessage({id:"common.table.columns.assetName"})]}),dataIndex:"resourceId",valueType:"text",align:"left",hideInSearch:!0,render:function(n,a){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(G.ZP,{style:{padding:0},size:"small",type:"link",onClick:function(){ke.current=v()({},a),m(!0)},children:(0,e.jsx)(ve,{copyable:!0,style:{color:"inherit",marginBottom:0},children:a.resourceId})}),(0,e.jsx)(Me.Z,{placement:"topLeft",text:a.resourceName,maxWidth:360,style:{color:"#333"}})]})}},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",width:200,hideInSearch:!0,render:function(n,a){return(0,e.jsx)(W.Z,{text:a==null?void 0:a.resourceType})}},{title:u.formatMessage({id:"asset.module.risk.number"}),width:200,dataIndex:"rulePassRate",valueType:"text",align:"left",hideInSearch:!0,render:function(n,a){return(0,e.jsx)(Q,{record:a})}},{title:u.formatMessage({id:"common.input.text.custom.fields"}),dataIndex:"customFieldValue",valueType:"text",align:"left",width:500,render:function(n,a){var $,H,N,j;return(0,e.jsx)("div",{style:{maxHeight:"120px",overflow:"auto"},children:(0,e.jsx)(me.Z,{children:(0,e.jsx)(Z.Z,{span:24,children:(0,I.isEmpty)(a==null||($=a.resourceDetailConfigMap)===null||$===void 0?void 0:$.BASE_INFO)&&(0,I.isEmpty)(a==null||(H=a.resourceDetailConfigMap)===null||H===void 0?void 0:H.NETWORK)?"-":(0,e.jsxs)(e.Fragment,{children:[a==null||(N=a.resourceDetailConfigMap)===null||N===void 0||(N=N.BASE_INFO)===null||N===void 0?void 0:N.map(function(y,se){return(0,e.jsx)(M.Z.Item,{label:y==null?void 0:y.name,style:K.formItem,children:(0,e.jsx)(ve,{copyable:{text:y.value},style:v()(v()({},K.paragraph),K.paragraphTable),ellipsis:{tooltip:y.value},children:y.value})},se)}),a==null||(j=a.resourceDetailConfigMap)===null||j===void 0||(j=j.NETWORK)===null||j===void 0?void 0:j.map(function(y,se){return(0,e.jsx)(M.Z.Item,{label:y==null?void 0:y.name,style:K.formItem,children:(0,e.jsx)(ve,{copyable:{text:y.value},style:v()(v()({},K.paragraph),K.paragraphTable),ellipsis:{tooltip:y.value},children:y.value})},se)})]})})})})}},{title:u.formatMessage({id:"common.table.columns.createAndUpdateTime"}),dataIndex:"gmt_modified",tooltip:u.formatMessage({id:"common.table.columns.sort.update"}),valueType:"text",align:"left",hideInSearch:!0,sorter:!0,width:240,render:function(n,a){return(0,e.jsxs)("div",{children:[(0,e.jsx)("section",{style:{color:"#999"},children:(a==null?void 0:a.gmtCreate)||"-"}),(0,e.jsx)("section",{style:{color:"#999"},children:(a==null?void 0:a.gmtModified)||"-"})]})}},{title:u.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"text",align:"left",hideInSearch:!0,render:function(n,a){return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:a==null?void 0:a.cloudAccountId}),(0,e.jsx)("div",{style:{color:"#999"},children:a==null?void 0:a.alias})]})}},{title:u.formatMessage({id:"common.select.label.cloudPlatform"}),dataIndex:"platform",valueType:"text",align:"center",hideInSearch:!0,render:function(n,a){return(0,de.fD)(a.platform,x)}},{title:u.formatMessage({id:"asset.module.input.text.ip"}),dataIndex:"address",valueType:"text",align:"left",hideInSearch:!0},{title:u.formatMessage({id:"common.select.label.tenant"}),dataIndex:"tenantName",valueType:"text",align:"left",hideInSearch:!0}],st=(0,F.useRequest)(function(D){return(0,Pe.cloudAccountBaseInfoList)(v()({},D))},{manual:!0,formatResult:function(n){if(n.msg==="success"){var a;return(n==null||(a=n.content)===null||a===void 0||(a=a.accountAliasList)===null||a===void 0?void 0:a.map(function($){return{label:$,value:$}}))||[]}}}),Dt=st.data,at=st.run,Mt=st.loading,Ct=(0,E.useMemo)(function(){var D=function(a){at({platformList:R.getFieldValue("platformList")||[],cloudAccountSearch:a})};return(0,I.debounce)(D,500)},[Pe.cloudAccountBaseInfoList]);return(0,E.useEffect)(function(){var D={};if(c&&(D.platformList=[c]),d&&(D.cloudAccountSearch=d),at(D),(!(0,I.isEmpty)(d)||!(0,I.isEmpty)(c)||!(0,I.isEmpty)(P)&&!(0,I.isEmpty)(w))&&(d&&(R==null||R.setFieldValue("cloudAccountId",d)),!(0,I.isEmpty)(c)&&(R==null||R.setFieldValue("platformList",[c]),R.setFieldValue("resourceTypeList",null),tt([]),ct([c]),!(0,I.isEmpty)(P)&&!(0,I.isEmpty)(w)))){var n=[],a=[P,w];n.push(a),R.setFieldValue("resourceTypeList",n)}},[c,d,w]),(0,e.jsxs)(Xe._z,{title:!1,className:A.Z.assetPageContainer,breadcrumb:void 0,children:[(0,e.jsx)(ne.Z,{bodyStyle:{paddingBottom:0},className:A.Z.customFilterCard,children:(0,e.jsx)(M.Z,{form:R,children:(0,e.jsxs)(me.Z,{gutter:[24,10],children:[(0,e.jsx)(Z.Z,{span:24,children:(0,e.jsx)(M.Z.Item,{name:"platformList",label:u.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,e.jsx)(Ve.Z.Group,{options:(0,de.T$)(x),onChange:function(n){R.setFieldValue("resourceTypeList",null),tt([]),ct(n),at({platformList:n||[]})}})})}),(0,e.jsx)(Z.Z,{span:6,children:(0,e.jsx)(M.Z.Item,{name:"resourceTypeList",label:u.formatMessage({id:"cloudAccount.extend.title.asset.type"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(Be.Z,{options:gt,multiple:!0,placeholder:u.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:r,allowClear:!0,showSearch:!0})})}),(0,e.jsx)(Z.Z,{span:6,children:(0,e.jsx)(M.Z.Item,{name:"cloudAccountId",label:u.formatMessage({id:"common.select.label.cloudAccount"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(Ye.Z,{allowClear:!0,showSearch:!0,placeholder:u.formatMessage({id:"common.select.query.text.placeholder"}),notFoundContent:Mt&&(0,e.jsx)(Ae.Z,{size:"small"}),onSearch:Ct,options:Dt||[]})})}),(0,e.jsx)(Z.Z,{span:6,children:(0,e.jsx)(M.Z.Item,{name:"searchParam",label:u.formatMessage({id:"common.input.text.assetIdAndName"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(s.Z,{placeholder:u.formatMessage({id:"common.input.text.placeholder"}),allowClear:!0})})}),(0,e.jsx)(Z.Z,{span:6,children:(0,e.jsx)(M.Z.Item,{name:"address",label:u.formatMessage({id:"asset.module.input.text.ip"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(s.Z,{placeholder:u.formatMessage({id:"common.input.text.placeholder"}),allowClear:!0})})})]})})}),(0,e.jsx)(pe.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,labelWidth:0},headerTitle:(0,e.jsx)("div",{className:Fe.Z.customTitle,children:u.formatMessage({id:"asset.module.text.asset.inquiry"})}),actionRef:q,formRef:T,columns:Et,columnsState:{defaultValue:It,persistenceType:"localStorage",persistenceKey:"ASSET_TABLE_LIST_CACHE"},onReset:function(){var n;R.resetFields(),(n=T.current)===null||n===void 0||n.resetFields()},pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1,pageSizeOptions:[10,20,50]},request:function(){var D=k()(p()().mark(function n(a,$){var H,N,j,y,se,nt,lt,rt,it,ot,dt,ut,mt,vt,ft;return p()().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return H=a.customFieldValue,N=a.current,j=a.pageSize,y={customFieldValue:H,page:N,size:j},se=(0,de.Hm)($),(0,I.isEmpty)(se)||(y.sortParam=se==null?void 0:se.key,y.sortType=Ge.ym[se.value]),nt=R.getFieldValue("platformList"),(0,I.isEmpty)(nt)||(y.platformList=nt),lt=R.getFieldValue("resourceTypeList"),(0,I.isEmpty)(lt)||(y.resourceTypeList=lt),rt=R.getFieldValue("cloudAccountId"),(0,I.isEmpty)(rt)||(y.cloudAccountId=rt),it=R.getFieldValue("searchParam"),it&&(y.searchParam=it),ot=R.getFieldValue("address"),ot&&(y.address=ot),De.next=16,(0,ge.queryResourceList)(y);case 16:return dt=De.sent,ut=dt.content,mt=dt.code,vt=ut.data,ft=ut.total,De.abrupt("return",{data:vt||[],total:ft||0,success:mt===200||!1});case 21:case"end":return De.stop()}},n)}));return function(n,a){return D.apply(this,arguments)}}(),tableClassName:A.Z.customAssetTable,expandable:{expandedRowRender:function(n){var a,$,H,N;return(0,e.jsxs)(me.Z,{children:[(0,e.jsx)(Z.Z,{span:2,className:A.Z.dimBlock,style:{borderLeft:"0.5px solid rgb(239, 239, 239)"},children:u.formatMessage({id:"common.select.label.cloudAccount"})}),(0,e.jsxs)(Z.Z,{span:4,className:A.Z.cleanBlock,style:{flexDirection:"column"},children:[(0,e.jsx)("div",{children:n==null?void 0:n.cloudAccountId}),(0,e.jsx)("div",{style:{color:"#999"},children:n==null?void 0:n.alias})]}),(0,e.jsx)(Z.Z,{span:2,className:A.Z.dimBlock,children:u.formatMessage({id:"common.select.label.cloudPlatform"})}),(0,e.jsx)(Z.Z,{span:4,className:A.Z.cleanBlock,children:(0,de.fD)(n.platform,x)}),(0,e.jsx)(Z.Z,{span:2,className:A.Z.dimBlock,children:u.formatMessage({id:"asset.module.input.text.ip"})}),(0,e.jsx)(Z.Z,{span:4,className:A.Z.cleanBlock,children:(n==null?void 0:n.address)||"-"}),(0,e.jsx)(Z.Z,{span:2,className:A.Z.dimBlock,children:u.formatMessage({id:"common.select.label.tenant"})}),(0,e.jsx)(Z.Z,{span:4,className:A.Z.cleanBlock,children:(n==null?void 0:n.tenantName)||"-"}),(0,e.jsx)(Z.Z,{span:2,className:A.Z.dimBlock,style:{borderTop:"none",borderLeft:"0.5px solid rgb(239, 239, 239)"},children:u.formatMessage({id:"common.input.text.custom.fields"})}),(0,e.jsx)(Z.Z,{span:22,className:A.Z.customField,style:{borderTop:"none"},children:(0,e.jsxs)(me.Z,{children:[(0,e.jsx)(Z.Z,{span:22,style:{maxHeight:"200px",overflow:"auto"},children:(0,I.isEmpty)(n==null||(a=n.resourceDetailConfigMap)===null||a===void 0?void 0:a.BASE_INFO)&&(0,I.isEmpty)(n==null||($=n.resourceDetailConfigMap)===null||$===void 0?void 0:$.NETWORK)?(0,e.jsx)(qe.ZP,{theme:{token:{margin:8,marginXL:8,marginXS:8}},children:(0,e.jsx)(oe.Z,{image:oe.Z.PRESENTED_IMAGE_SIMPLE})}):(0,e.jsxs)(e.Fragment,{children:[n==null||(H=n.resourceDetailConfigMap)===null||H===void 0||(H=H.BASE_INFO)===null||H===void 0?void 0:H.map(function(j,y){return(0,e.jsx)(M.Z.Item,{label:j==null?void 0:j.name,style:K.formItem,children:(0,e.jsx)(ve,{copyable:{text:j.value},style:v()(v()({},K.paragraph),K.paragraphExpanded),ellipsis:{tooltip:j.value},children:j.value})},y)}),n==null||(N=n.resourceDetailConfigMap)===null||N===void 0||(N=N.NETWORK)===null||N===void 0?void 0:N.map(function(j,y){return(0,e.jsx)(M.Z.Item,{label:j==null?void 0:j.name,style:K.formItem,children:(0,e.jsx)(ve,{copyable:{text:j.value},style:v()(v()({},K.paragraph),K.paragraphExpanded),ellipsis:{tooltip:j.value},children:j.value})},y)})]})}),(0,e.jsx)(Z.Z,{span:2,children:(0,e.jsxs)(G.ZP,{size:"small",type:"link",target:"_self",href:"/assetManagement/asseConfig?id=".concat(n==null?void 0:n.id),children:[(0,e.jsx)(Se.Z,{}),u.formatMessage({id:"common.button.text.edit"})]})})]})})]})},columnTitle:(0,e.jsx)("div",{style:{width:30,textAlign:"center"}}),columnWidth:30,rowExpandable:function(){return!0},expandIcon:X.Z}}),(0,e.jsx)(J,{assetDrawerVisible:ye,setAssetDrawerVisible:We,assetDrawerInfo:ee.current,tableActionRef:q}),(0,e.jsx)(Le,{assetInformVisible:o,setAssetInformVisible:m,assetInfo:ke.current})]})},xt=et},92086:function(ae,O,t){var b=t(5574),p=t.n(b),B=t(87426),k=t(39421),V=t(24163),v=t(71448),L=t(24482),h=t(50322),X=t(22145),S=t(96364),W=t(77603),Fe=t(72028),Me=t(29448),ge=t(99611),de=t(45742),Ne=t(93410),ne=t(92016),F=t(25593),Ce=t(85265),le=t(86250),Oe=t(83622),we=t(42075),Ke=t(66309),E=t(83062),A=t(21532),ue=t(23323),I=t(62435),e=t(47908),l=t(86074),ie=F.Z.Text,Ue=function(he){var Y,pe,ce,G,je,_e,oe=he.riskDrawerVisible,M=he.riskDrawerInfo,Te=he.setRiskDrawerVisible,ze=he.locate,$e=(0,ne.useModel)("rule"),He=$e.platformList,Ie=(0,ne.useModel)("tenant"),Re=Ie.tenantListAll,J=(0,ne.useIntl)(),Qe=(0,I.useState)(!1),Le=p()(Qe,2),Ge=Le[0],Pe=Le[1],Je=(0,I.useState)(!1),Se=p()(Je,2),Xe=Se[0],be=Se[1],Be=(0,I.useState)(!1),me=p()(Be,2),Z=me[0],Ve=me[1],Ye=function(){Te(!1)},Ae=(0,ne.useRequest)(function(Q){return(0,Fe.queryRiskDetailById)({riskId:Q})},{manual:!0,formatResult:function(et){return et.content||{}}}),s=Ae.data,qe=Ae.run,ve=Ae.loading,K=function(){Ye()};return(0,I.useEffect)(function(){oe&&M!==null&&M!==void 0&&M.id&&qe(M.id)},[oe,M]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(Ce.Z,{title:J.formatMessage({id:"risk.module.text.detail.info"}),width:"50%",open:oe,onClose:K,loading:ve,children:[(0,l.jsxs)(Ne.Z,{style:{marginBottom:20},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,l.jsx)(le.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,l.jsxs)("span",{children:[(0,l.jsx)(ie,{style:{marginRight:12},children:(0,l.jsx)(Oe.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(s==null?void 0:s.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(s==null||(Y=s.ruleVO)===null||Y===void 0?void 0:Y.ruleName)||"-"})}),(0,l.jsxs)(we.Z,{children:[(0,l.jsx)("span",{children:(0,Me.Ff)(S.MW,s==null?void 0:s.status)}),(s==null?void 0:s.ignoreReasonType)&&(0,l.jsxs)("span",{children:[(0,l.jsxs)(ie,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[J.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,l.jsx)(Ke.Z,{color:"geekblue",children:((pe=S.$G.find(function(Q){return Q.value===(s==null?void 0:s.ignoreReasonType)}))===null||pe===void 0?void 0:pe.label)||"-"})]}),(s==null?void 0:s.ignoreReason)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(ie,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[J.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,l.jsx)(V.Z,{rows:1,text:s==null?void 0:s.ignoreReason,maxWidth:64})]}),(s==null?void 0:s.whitedId)&&(0,l.jsx)(Oe.ZP,{type:"link",size:"small",icon:(0,l.jsx)(ge.Z,{}),onClick:function(){return Ve(!0)},style:{padding:"0 4px",height:"auto",color:"#1890ff"}})]})]})}),(0,l.jsxs)(le.Z,{vertical:!0,gap:10,children:[(0,l.jsxs)(le.Z,{align:"center",children:[(0,l.jsx)("img",{src:k.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,l.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[J.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,l.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:s==null?void 0:s.gmtModified})]}),(0,l.jsxs)(ie,{children:[(0,l.jsx)("img",{src:B.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,l.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[J.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,l.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:s==null?void 0:s.gmtCreate})]})]}),(0,l.jsxs)(le.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,l.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,Me.fD)(s==null?void 0:s.platform,He)}),(0,l.jsx)(ie,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(s==null?void 0:s.resourceType)||"-"}),(0,l.jsxs)(le.Z,{align:"center",children:[(0,l.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(s==null?void 0:s.resourceName)+" / "+(s==null?void 0:s.resourceId)}),ze==="risk"&&(0,l.jsx)(E.Z,{title:J.formatMessage({id:"asset.extend.text.detail"}),children:(0,l.jsx)("span",{className:e.Z.iconWrap,onClick:function(){return be(!0)},children:(0,l.jsx)(de.Z,{className:e.Z.resourceInstance})})})]}),(0,l.jsx)(ie,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(Re==null||(ce=Re.find(function(Q){return Q.value===(s==null?void 0:s.tenantId)}))===null||ce===void 0?void 0:ce.label)||"-"})]})]}),(0,l.jsx)(A.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,l.jsxs)(ue.Z,{children:[(0,l.jsx)(ue.Z.Item,{label:J.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,l.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(s==null||(G=s.ruleVO)===null||G===void 0?void 0:G.advice)||"-"})}),(0,l.jsx)(ue.Z.Item,{label:J.formatMessage({id:"risk.module.text.reference.link"}),children:(0,l.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(s==null||(je=s.ruleVO)===null||je===void 0?void 0:je.link)||"-"})}),(0,l.jsx)(ue.Z.Item,{label:J.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,l.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(s==null||(_e=s.ruleVO)===null||_e===void 0?void 0:_e.ruleDesc)||"-"})})]})}),(0,l.jsx)(v.Z,{riskDrawerInfo:M}),(0,l.jsx)(h.Z,{riskDrawerInfo:M})]}),(0,l.jsx)(L.Z,{evaluateDrawerVisible:Ge,setEvaluateDrawerVisible:Pe,riskDrawerInfo:M}),(0,l.jsx)(X.Z,{resourceDrawerVisible:Xe,setResourceDrawerVisible:be,riskDrawerInfo:M}),(s==null?void 0:s.whitedId)&&(0,l.jsx)(W.Z,{editDrawerVisible:Z,setEditDrawerVisible:Ve,whiteListDrawerInfo:{id:s.whitedId,isEditMode:!1}})]})};O.Z=Ue},24732:function(ae,O){O.Z={polymerizeWrap:"polymerizeWrap___DA0Kx",polymerizeCard:"polymerizeCard___cqy_L",polymerizeHead:"polymerizeHead___wg2jK",polymerizeMain:"polymerizeMain___MABwi",riskWrap:"riskWrap___bmqQb",riskWrapLeft:"riskWrapLeft___IXwxM",riskWrapRight:"riskWrapRight___Kdvj4",riskAsset:"riskAsset___QyUxz",assetMain:"assetMain___cdM5B",newTag:"newTag___MqjNr",assetMainItem:"assetMainItem___m8m8F",assetMainItemLabel:"assetMainItemLabel___xE6cJ",assetView:"assetView____rh3f",assetPageContainer:"assetPageContainer___XCTom",customFilterCard:"customFilterCard___vdglF",customText:"customText___B_t7o",iconWrap:"iconWrap___tQQp4",resourceInstance:"resourceInstance___Y06OO",assetConfigPageContainer:"assetConfigPageContainer___tB7j6",customAssetTable:"customAssetTable___J9RJC",cleanBlock:"cleanBlock___xLiWM",dimBlock:"dimBlock___HBpS1",customField:"customField___J1Iyu",tabProCard:"tabProCard___ahTeu"}}}]);
