"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4470],{15260:function(de,I,t){t.r(I);var L=t(97857),p=t.n(L),U=t(15009),f=t.n(U),y=t(99289),M=t.n(y),A=t(5574),o=t.n(A),P=t(92016),j=t(39380),W=t(78253),c=t(23323),B=t(83062),S=t(38703),h=t(66309),i=t(42075),v=t(34041),b=t(83622),l=t(89094),me=t(8751),fe=t(4340),he=t(92635),z=t(29448),_=t(62435),G=t(31272),Ee=t(27484),H=t.n(Ee),n=t(86074),pe=W.default.RangePicker,ve=function(){var De=(0,P.useModel)("rule"),R=De.platformList,Me=c.Z.useForm(),Pe=o()(Me,1),ge=Pe[0],d=(0,P.useIntl)(),Ce=(0,P.useSearchParams)(),Oe=o()(Ce,1),K=Oe[0],Ae=(0,_.useState)(!1),X=o()(Ae,2),je=X[0],N=X[1],Se=(0,_.useState)([]),J=o()(Se,2),Re=J[0],Q=J[1],Te=(0,_.useState)(0),V=o()(Te,2),Ie=V[0],w=V[1],be=(0,_.useState)([H()().subtract(1,"day"),H()().add(1,"day")]),q=o()(be,2),g=q[0],Le=q[1],Ue=(0,_.useState)(K.get("platform")||""),ee=o()(Ue,2),E=ee[0],ye=ee[1],We=(0,_.useState)(""),te=o()(We,2),C=te[0],x=te[1],Be=(0,_.useState)([]),re=o()(Be,2),Ke=re[0],ne=re[1],xe=(0,_.useState)([]),se=o()(xe,2),Ze=se[0],ae=se[1],Fe=(0,_.useState)(),oe=o()(Fe,2),Z=oe[0],ue=oe[1],Ye=(0,_.useState)(!0),le=o()(Ye,2),$e=le[0],ke=le[1],F=function(){var s=M()(f()().mark(function e(u,m){var D,a,T;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(u){r.next=3;break}return ne([]),r.abrupt("return");case 3:return r.prev=3,r.next=6,(0,he.cloudAccountBaseInfoListV2)({platformList:[u],cloudAccountSearch:m});case 6:D=r.sent,D.msg==="success"&&(T=((a=D.content)===null||a===void 0?void 0:a.map(function(O){return{label:O.alias,value:O.cloudAccountId}}))||[],ne(T)),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(3),console.error("Failed to obtain the list of cloud accounts:",r.t0);case 13:case"end":return r.stop()}},e,null,[[3,10]])}));return function(u,m){return s.apply(this,arguments)}}();(0,_.useEffect)(function(){E&&F(E)},[E]),(0,_.useEffect)(function(){var s=K.get("platform"),e=K.get("cloudAccountId");s&&(F(s),e&&x(e))},[]);var ze=(0,_.useState)(1),_e=o()(ze,2),Y=_e[0],$=_e[1],Ge=(0,_.useState)(10),ce=o()(Ge,2),k=ce[0],He=ce[1],ie=function(){var s=M()(f()().mark(function e(){var u,m;return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(!C&&$e)){a.next=3;break}return ke(!1),a.abrupt("return");case 3:return N(!0),Q([]),w(0),a.prev=6,u={platform:E,cloudAccountId:C,errorCode:Z,startTimeArray:g[0]&&g[1]?[g[0].format("YYYY-MM-DD HH:mm:ss"),g[1].format("YYYY-MM-DD HH:mm:ss")]:void 0,page:Y,size:k},a.next=10,(0,G.Yq)(u);case 10:m=a.sent,m.code===200&&(Q(m.content.data),w(m.content.total)),a.next=17;break;case 14:a.prev=14,a.t0=a.catch(6),console.error("Failed to obtain the collection record list:",a.t0);case 17:return a.prev=17,N(!1),a.finish(17);case 20:case"end":return a.stop()}},e,null,[[6,14,17,20]])}));return function(){return s.apply(this,arguments)}}(),Xe=function(){var s=M()(f()().mark(function e(u,m){var D,a,T;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(u){r.next=3;break}return ae([]),r.abrupt("return");case 3:return r.prev=3,r.next=6,(0,G.XX)({platform:u,cloudAccountId:m});case 6:D=r.sent,D.msg==="success"&&(T=((a=D.content)===null||a===void 0?void 0:a.map(function(O){return{label:"".concat(O.description," (").concat(O.count,")"),value:O.description}}))||[],ae(T)),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(3),console.error("Failed to obtain the list of error codes:",r.t0);case 13:case"end":return r.stop()}},e,null,[[3,10]])}));return function(u,m){return s.apply(this,arguments)}}();(0,_.useEffect)(function(){E&&Xe(E,C)},[E,C]);var Ne=function(){$(1),ie()};(0,_.useEffect)(function(){ie()},[Y,k,E,C,Z,g]);var Je=[{title:d.formatMessage({id:"cloudAccount.extend.title.cloud.platform"}),dataIndex:"platform",key:"platform",render:function(e){return(0,z.c5)(e,R)}},{title:d.formatMessage({id:"cloudAccount.extend.title.account.id"}),dataIndex:"cloudAccountId",key:"cloudAccountId",render:function(e,u){return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:e}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:u.alias})]})}},{title:d.formatMessage({id:"cloudAccount.table.column.collector.name"}),dataIndex:"collectorName",key:"collectorName",ellipsis:!0,render:function(e){return(0,n.jsx)(B.Z,{title:e,children:(0,n.jsx)("span",{children:e})})}},{title:d.formatMessage({id:"cloudAccount.table.column.start.time"}),dataIndex:"startTime",key:"startTime"},{title:d.formatMessage({id:"cloudAccount.table.column.end.time"}),dataIndex:"endTime",key:"endTime"},{title:d.formatMessage({id:"cloudAccount.table.column.status"}),dataIndex:"percent",key:"status",render:function(e,u){return e!==null&&e<100&&u.endTime==null?(0,n.jsx)(S.Z,{percent:e,size:"small",status:e===100?"success":"active",strokeColor:e===100?"#52c41a":"#1890ff"}):(0,n.jsx)(h.Z,{color:"success",icon:(0,n.jsx)(me.Z,{}),children:"Completed"})}},{title:d.formatMessage({id:"cloudAccount.table.column.error.number"}),dataIndex:"errorResourceTypeList",key:"errorResourceTypeList",render:function(e,u){return(0,n.jsx)("a",{onClick:function(){P.history.push("/cloudAccount/collectionRecord/".concat(u.id))},children:(0,n.jsxs)(i.Z,{children:[(e==null?void 0:e.length)||0,(e==null?void 0:e.length)>0&&(0,n.jsx)(fe.Z,{style:{color:"#ff4d4f"}})]})})}}];return(0,n.jsx)(j._z,{title:d.formatMessage({id:"cloudAccount.title.collection.record"}),extra:(0,n.jsxs)(c.Z,{form:ge,layout:"inline",children:[(0,n.jsx)(c.Z.Item,{children:(0,n.jsx)(v.Z,{style:{minWidth:200,maxWidth:"100%"},options:R==null?void 0:R.map(function(s){return p()(p()({},s),{},{label:(0,n.jsxs)(i.Z,{children:[(0,z.c5)(s.value,R),s.label]})})}),value:E,onChange:function(e){ye(e),x(""),$(1)}})}),(0,n.jsx)(c.Z.Item,{children:(0,n.jsx)(v.Z,{placeholder:d.formatMessage({id:"cloudAccount.extend.title.account.id"}),style:{width:200},value:C,onChange:function(e){x(e),ue("")},options:Ke,allowClear:!0,showSearch:!0,filterOption:!1,onSearch:function(e){F(E,e)}})}),(0,n.jsx)(c.Z.Item,{children:(0,n.jsx)(v.Z,{placeholder:d.formatMessage({id:"cloudAccount.table.column.error.number"}),style:{width:200},value:Z,onChange:function(e){return ue(e)},options:Ze,allowClear:!0})}),(0,n.jsx)(c.Z.Item,{children:(0,n.jsx)(pe,{showTime:!0,value:g,onChange:function(e){return Le(e)}})}),(0,n.jsx)(c.Z.Item,{children:(0,n.jsx)(b.ZP,{type:"primary",onClick:Ne,children:d.formatMessage({id:"common.button.text.query"})})})]}),children:(0,n.jsx)(l.Z,{columns:Je,dataSource:Re,rowKey:"id",loading:je,scroll:{x:"max-content"},pagination:{current:Y,pageSize:k,total:Ie,showSizeChanger:!0,showQuickJumper:!0,onChange:function(e,u){$(e),He(u)}}})})};I.default=ve},31272:function(de,I,t){t.d(I,{XX:function(){return B},Yq:function(){return P},xd:function(){return W}});var L=t(15009),p=t.n(L),U=t(97857),f=t.n(U),y=t(99289),M=t.n(y),A=t(40396),o=t(92016);function P(h,i){return j.apply(this,arguments)}function j(){return j=M()(p()().mark(function h(i,v){return p()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,o.request)("".concat(A._,"/api/cloudAccount/collectorRecord/getCollectorRecordList"),f()({method:"POST",headers:{"Content-Type":"application/json"},data:i},v||{})));case 1:case"end":return l.stop()}},h)})),j.apply(this,arguments)}function W(h,i){return c.apply(this,arguments)}function c(){return c=M()(p()().mark(function h(i,v){return p()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,o.request)("".concat(A._,"/api/cloudAccount/collectorRecord/getCollectorRecordDetail"),f()({method:"POST",headers:{"Content-Type":"application/json"},data:i},v||{})));case 1:case"end":return l.stop()}},h)})),c.apply(this,arguments)}function B(h,i){return S.apply(this,arguments)}function S(){return S=M()(p()().mark(function h(i,v){return p()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,o.request)("".concat(A._,"/api/cloudAccount/collectorRecord/getErrorCodeList"),f()({method:"POST",headers:{"Content-Type":"application/json"},data:i},v||{})));case 1:case"end":return l.stop()}},h)})),S.apply(this,arguments)}}}]);
