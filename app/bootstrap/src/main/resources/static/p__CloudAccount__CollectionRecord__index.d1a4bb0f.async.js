"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4470],{15260:function(de,I,t){t.r(I);var L=t(97857),p=t.n(L),U=t(15009),E=t.n(U),y=t(99289),C=t.n(y),R=t(5574),o=t.n(R),M=t(45830),A=t(39380),W=t(78253),c=t(23323),B=t(83062),j=t(38703),f=t(66309),i=t(42075),D=t(34041),b=t(83622),_=t(89094),me=t(8751),Ee=t(4340),fe=t(92635),k=t(29448),l=t(62435),z=t(31272),he=t(27484),G=t.n(he),r=t(86074),pe=W.default.RangePicker,De=function(){var ve=(0,M.useModel)("rule"),S=ve.platformList,Ce=c.Z.useForm(),Me=o()(Ce,1),Pe=Me[0],d=(0,M.useIntl)(),ge=(0,M.useSearchParams)(),Oe=o()(ge,1),K=Oe[0],Re=(0,l.useState)(!1),H=o()(Re,2),Ae=H[0],X=H[1],je=(0,l.useState)([]),N=o()(je,2),Se=N[0],J=N[1],Te=(0,l.useState)(0),Q=o()(Te,2),Ie=Q[0],w=Q[1],be=(0,l.useState)([G()().subtract(1,"day"),G()().add(1,"day")]),q=o()(be,2),P=q[0],Le=q[1],Ue=(0,l.useState)(K.get("platform")||""),ee=o()(Ue,2),h=ee[0],ye=ee[1],We=(0,l.useState)(""),te=o()(We,2),g=te[0],x=te[1],Be=(0,l.useState)([]),ne=o()(Be,2),Ke=ne[0],re=ne[1],xe=(0,l.useState)([]),se=o()(xe,2),Ze=se[0],ae=se[1],Ve=(0,l.useState)(),oe=o()(Ve,2),Z=oe[0],ue=oe[1],Fe=(0,l.useState)(!0),_e=o()(Fe,2),Ye=_e[0],$e=_e[1],V=function(){var s=C()(E()().mark(function e(u,m){var v,a,T;return E()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(u){n.next=3;break}return re([]),n.abrupt("return");case 3:return n.prev=3,n.next=6,(0,fe.cloudAccountBaseInfoListV2)({platformList:[u],cloudAccountSearch:m});case 6:v=n.sent,v.msg==="success"&&(T=((a=v.content)===null||a===void 0?void 0:a.map(function(O){return{label:O.alias,value:O.cloudAccountId}}))||[],re(T)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),console.error("Failed to obtain the list of cloud accounts:",n.t0);case 13:case"end":return n.stop()}},e,null,[[3,10]])}));return function(u,m){return s.apply(this,arguments)}}();(0,l.useEffect)(function(){h&&V(h)},[h]),(0,l.useEffect)(function(){var s=K.get("platform"),e=K.get("cloudAccountId");s&&(V(s),e&&x(e))},[]);var ke=(0,l.useState)(1),le=o()(ke,2),F=le[0],Y=le[1],ze=(0,l.useState)(10),ce=o()(ze,2),$=ce[0],Ge=ce[1],ie=function(){var s=C()(E()().mark(function e(){var u,m;return E()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(!g&&Ye)){a.next=3;break}return $e(!1),a.abrupt("return");case 3:return X(!0),J([]),w(0),a.prev=6,u={platform:h,cloudAccountId:g,errorCode:Z,startTimeArray:P[0]&&P[1]?[P[0].format("YYYY-MM-DD HH:mm:ss"),P[1].format("YYYY-MM-DD HH:mm:ss")]:void 0,page:F,size:$},a.next=10,(0,z.Yq)(u);case 10:m=a.sent,m.code===200&&(J(m.content.data),w(m.content.total)),a.next=17;break;case 14:a.prev=14,a.t0=a.catch(6),console.error("Failed to obtain the collection record list:",a.t0);case 17:return a.prev=17,X(!1),a.finish(17);case 20:case"end":return a.stop()}},e,null,[[6,14,17,20]])}));return function(){return s.apply(this,arguments)}}(),He=function(){var s=C()(E()().mark(function e(u,m){var v,a,T;return E()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(u){n.next=3;break}return ae([]),n.abrupt("return");case 3:return n.prev=3,n.next=6,(0,z.XX)({platform:u,cloudAccountId:m});case 6:v=n.sent,v.msg==="success"&&(T=((a=v.content)===null||a===void 0?void 0:a.map(function(O){return{label:"".concat(O.description," (").concat(O.count,")"),value:O.description}}))||[],ae(T)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),console.error("Failed to obtain the list of error codes:",n.t0);case 13:case"end":return n.stop()}},e,null,[[3,10]])}));return function(u,m){return s.apply(this,arguments)}}();(0,l.useEffect)(function(){h&&He(h,g)},[h,g]);var Xe=function(){Y(1),ie()};(0,l.useEffect)(function(){ie()},[F,$,h,g,Z,P]);var Ne=[{title:d.formatMessage({id:"cloudAccount.extend.title.cloud.platform"}),dataIndex:"platform",key:"platform",render:function(e){return(0,k.c5)(e,S)}},{title:d.formatMessage({id:"cloudAccount.extend.title.account.id"}),dataIndex:"cloudAccountId",key:"cloudAccountId",render:function(e,u){return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:e}),(0,r.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:u.alias})]})}},{title:d.formatMessage({id:"cloudAccount.table.column.collector.name"}),dataIndex:"collectorName",key:"collectorName",ellipsis:!0,render:function(e){return(0,r.jsx)(B.Z,{title:e,children:(0,r.jsx)("span",{children:e})})}},{title:d.formatMessage({id:"cloudAccount.table.column.start.time"}),dataIndex:"startTime",key:"startTime"},{title:d.formatMessage({id:"cloudAccount.table.column.end.time"}),dataIndex:"endTime",key:"endTime"},{title:d.formatMessage({id:"cloudAccount.table.column.status"}),dataIndex:"percent",key:"status",render:function(e,u){return e!==null&&e<100&&u.endTime==null?(0,r.jsx)(j.Z,{percent:e,size:"small",status:e===100?"success":"active",strokeColor:e===100?"#52c41a":"#1890ff"}):(0,r.jsx)(f.Z,{color:"success",icon:(0,r.jsx)(me.Z,{}),children:"Completed"})}},{title:d.formatMessage({id:"cloudAccount.table.column.error.number"}),dataIndex:"errorResourceTypeList",key:"errorResourceTypeList",render:function(e,u){return(0,r.jsx)("a",{onClick:function(){M.history.push("/cloudAccount/collectionRecord/".concat(u.id))},children:(0,r.jsxs)(i.Z,{children:[(e==null?void 0:e.length)||0,(e==null?void 0:e.length)>0&&(0,r.jsx)(Ee.Z,{style:{color:"#ff4d4f"}})]})})}}];return(0,r.jsx)(A._z,{title:d.formatMessage({id:"cloudAccount.title.collection.record"}),extra:(0,r.jsxs)(c.Z,{form:Pe,layout:"inline",children:[(0,r.jsx)(c.Z.Item,{children:(0,r.jsx)(D.Z,{style:{minWidth:200,maxWidth:"100%"},options:S==null?void 0:S.map(function(s){return p()(p()({},s),{},{label:(0,r.jsxs)(i.Z,{children:[(0,k.c5)(s.value,S),s.label]})})}),value:h,onChange:function(e){ye(e),x(""),Y(1)}})}),(0,r.jsx)(c.Z.Item,{children:(0,r.jsx)(D.Z,{placeholder:d.formatMessage({id:"cloudAccount.extend.title.account.id"}),style:{width:200},value:g,onChange:function(e){x(e),ue("")},options:Ke,allowClear:!0,showSearch:!0,filterOption:!1,onSearch:function(e){V(h,e)}})}),(0,r.jsx)(c.Z.Item,{children:(0,r.jsx)(D.Z,{placeholder:d.formatMessage({id:"cloudAccount.table.column.error.number"}),style:{width:200},value:Z,onChange:function(e){return ue(e)},options:Ze,allowClear:!0})}),(0,r.jsx)(c.Z.Item,{children:(0,r.jsx)(pe,{showTime:!0,value:P,onChange:function(e){return Le(e)}})}),(0,r.jsx)(c.Z.Item,{children:(0,r.jsx)(b.ZP,{type:"primary",onClick:Xe,children:d.formatMessage({id:"common.button.text.query"})})})]}),children:(0,r.jsx)(_.Z,{columns:Ne,dataSource:Se,rowKey:"id",loading:Ae,scroll:{x:"max-content"},pagination:{current:F,pageSize:$,total:Ie,showSizeChanger:!0,showQuickJumper:!0,onChange:function(e,u){Y(e),Ge(u)}}})})};I.default=De},31272:function(de,I,t){t.d(I,{XX:function(){return B},Yq:function(){return M},xd:function(){return W}});var L=t(15009),p=t.n(L),U=t(97857),E=t.n(U),y=t(99289),C=t.n(y),R=t(40396),o=t(45830);function M(f,i){return A.apply(this,arguments)}function A(){return A=C()(p()().mark(function f(i,D){return p()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,o.request)("".concat(R._,"/api/cloudAccount/collectorRecord/getCollectorRecordList"),E()({method:"POST",headers:{"Content-Type":"application/json"},data:i},D||{})));case 1:case"end":return _.stop()}},f)})),A.apply(this,arguments)}function W(f,i){return c.apply(this,arguments)}function c(){return c=C()(p()().mark(function f(i,D){return p()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,o.request)("".concat(R._,"/api/cloudAccount/collectorRecord/getCollectorRecordDetail"),E()({method:"POST",headers:{"Content-Type":"application/json"},data:i},D||{})));case 1:case"end":return _.stop()}},f)})),c.apply(this,arguments)}function B(f,i){return j.apply(this,arguments)}function j(){return j=C()(p()().mark(function f(i,D){return p()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,o.request)("".concat(R._,"/api/cloudAccount/collectorRecord/getErrorCodeList"),E()({method:"POST",headers:{"Content-Type":"application/json"},data:i},D||{})));case 1:case"end":return _.stop()}},f)})),j.apply(this,arguments)}}}]);
