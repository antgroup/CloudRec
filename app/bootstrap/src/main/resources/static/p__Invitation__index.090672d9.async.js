"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6090],{55416:function(ye,T,a){a.r(T),a.d(T,{default:function(){return ae}});var K=a(15009),g=a.n(K),U=a(99289),M=a.n(U),G=a(5574),m=a.n(G),H=a(55375),W=a(33651),P=a(98665),b=a(87547),$=a(87462),d=a(62435),V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"},D=V,Y=a(84089),Q=function(C,p){return d.createElement(Y.Z,(0,$.Z)({},C,{ref:p,icon:D}))},X=d.forwardRef(Q),q=X,w=a(94149),f=a(39380),_=a(26),v=a(5966),Z=a(45830),ee=a(68872),te=a(57381),z=a(22181),y=a(83622),h={invitation:"invitation___Fiy6u",invitationContainer:"invitationContainer___s31wH",invitationCard:"invitationCard___F9CsT",title:"title___KvZTK",subtitle:"subtitle___Io6iJ",loadingContainer:"loadingContainer___vfF73",loadingText:"loadingText___apBxr",errorContainer:"errorContainer___OKw9B",errorIcon:"errorIcon___K2Bdj",errorTitle:"errorTitle___YgWtk",errorMessage:"errorMessage___El_tT",autoJoinContainer:"autoJoinContainer___uNHfT",successIcon:"successIcon___VIG7W",autoJoinTitle:"autoJoinTitle___c91xT",autoJoinMessage:"autoJoinMessage___wMdGe",registerForm:"registerForm___v0UKo","ant-form-item":"ant-form-item___NslJY","ant-input":"ant-input___ODsuq","ant-btn":"ant-btn___Tp4Ed","ant-btn-primary":"ant-btn-primary___pNx2n",formTitle:"formTitle___ZTO9w"},t=a(86074),ie=function(){var C=ee.ZP.useMessage(),p=m()(C,2),u=p[0],se=p[1],i=(0,Z.useIntl)(),re=(0,Z.useSearchParams)(),oe=m()(re,1),x=oe[0],le=(0,d.useState)(!0),N=m()(le,2),de=N[0],J=N[1],ue=(0,d.useState)(!1),O=m()(ue,2),ce=O[0],R=O[1],ge=(0,d.useState)(null),A=m()(ge,2),I=A[0],me=A[1],ve=(0,d.useState)("checking"),L=m()(ve,2),B=L[0],c=L[1],fe=function(){var r=localStorage.getItem("JSESSIONID");return!!r},he=function(){var l=M()(g()().mark(function r(){var n,o;return g()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=x.get("code"),n){e.next=5;break}return c("invalid"),J(!1),e.abrupt("return");case 5:return e.prev=5,e.next=8,(0,W.checkInviteCode)({inviteCode:n});case 8:if(o=e.sent,!(o.code===200&&o.content)){e.next=19;break}if(me(o.content),!fe()){e.next=16;break}return e.next=14,pe(n);case 14:e.next=17;break;case 16:c("register");case 17:e.next=20;break;case 19:c("invalid");case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),console.error("Error validating invite code:",e.t0),c("invalid");case 26:return e.prev=26,J(!1),e.finish(26);case 29:case"end":return e.stop()}},r,null,[[5,22,26,29]])}));return function(){return l.apply(this,arguments)}}(),pe=function(){var l=M()(g()().mark(function r(n){var o;return g()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,P.joinTenant)({inviteCode:n});case 3:o=e.sent,o.code===200?(c("auto-join"),u.success(i.formatMessage({id:"invitation.message.join.success"})),setTimeout(function(){window.location.href="/home"},1500)):(u.error(o.msg||i.formatMessage({id:"invitation.message.join.failed"})),c("invalid")),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Auto join tenant error:",e.t0),u.error(i.formatMessage({id:"invitation.message.join.failed"})),c("invalid");case 12:case"end":return e.stop()}},r,null,[[0,7]])}));return function(n){return l.apply(this,arguments)}}(),xe=function(){var l=M()(g()().mark(function r(n){var o,j,e,F,je,k,S;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(o=n.userId,j=n.username,e=n.password,F=n.confirmPassword,je=n.email,k=x.get("code"),e===F){s.next=5;break}return u.error(i.formatMessage({id:"invitation.message.password.mismatch"})),s.abrupt("return");case 5:return R(!0),s.prev=6,s.next=9,(0,P.register)({userId:o,username:j,password:e,code:k});case 9:S=s.sent,S.code===200?(u.success(i.formatMessage({id:"invitation.message.register.success"})),setTimeout(function(){var E=x.get("code"),Me=E?"/login?code=".concat(E):"/login";window.location.href=Me},1500)):u.error(S.msg||i.formatMessage({id:"invitation.message.register.failed"})),s.next=17;break;case 13:s.prev=13,s.t0=s.catch(6),console.error("Registration error:",s.t0),u.error(i.formatMessage({id:"invitation.message.register.failed"}));case 17:return s.prev=17,R(!1),s.finish(17);case 20:case"end":return s.stop()}},r,null,[[6,13,17,20]])}));return function(n){return l.apply(this,arguments)}}();return(0,d.useEffect)(function(){he()},[]),de?(0,t.jsx)(f._z,{ghost:!0,title:!1,breadcrumb:void 0,childrenContentStyle:{padding:0,height:"100%"},className:h.invitation,children:(0,t.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,t.jsx)(te.Z,{size:"large"})})}):B==="invalid"?(0,t.jsx)(f._z,{ghost:!0,title:!1,breadcrumb:void 0,childrenContentStyle:{padding:0,height:"100%"},className:h.invitation,children:(0,t.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,t.jsx)(z.ZP,{status:"error",title:i.formatMessage({id:"invitation.message.invalid"}),subTitle:i.formatMessage({id:"invitation.message.invalid.subtitle"}),extra:[(0,t.jsx)(y.ZP,{type:"primary",onClick:function(){return window.location.href="/home"},children:i.formatMessage({id:"invitation.button.text.return.home"})},"home")]})})}):B==="auto-join"?(0,t.jsx)(f._z,{ghost:!0,title:!1,breadcrumb:void 0,childrenContentStyle:{padding:0,height:"100%"},className:h.invitation,children:(0,t.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,t.jsx)(z.ZP,{status:"success",title:i.formatMessage({id:"invitation.message.join.success"}),subTitle:i.formatMessage({id:"invitation.message.join.success.subtitle"}),extra:[(0,t.jsx)(y.ZP,{type:"primary",onClick:function(){return window.location.href="/home"},children:i.formatMessage({id:"invitation.button.text.return.home"})},"home")]})})}):(0,t.jsxs)(f._z,{ghost:!0,title:!1,breadcrumb:void 0,childrenContentStyle:{padding:0,height:"100%"},className:h.invitation,children:[se,(0,t.jsxs)(_.B,{backgroundImageUrl:"https://gw.alipayobjects.com/zos/rmsportal/FfdJeJRQWjEeGTpqgBKj.png",logo:"/favicon-light.ico",title:H.j2,subTitle:"CloudRec's Protecting More",onFinish:xe,submitter:{render:function(){return(0,t.jsx)(y.ZP,{loading:ce,type:"primary",htmlType:"submit",style:{height:40,width:"100%",borderRadius:6,fontSize:16},children:i.formatMessage({id:"individual.button.text.register"})})}},children:[I&&(0,t.jsxs)("div",{style:{marginBottom:24,padding:16,background:"#f6f8fa",borderRadius:8,border:"1px solid #e1e8ed"},children:[(0,t.jsxs)("div",{style:{fontSize:16,fontWeight:600,color:"#1890ff",marginBottom:12,textAlign:"center"},children:["\u{1F389} ",i.formatMessage({id:"invitation.message.invitation.received"})]}),(0,t.jsx)("div",{style:{fontSize:14,color:"#666",textAlign:"center"},children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{style:{margin:"0 4px"},children:[I.inviter," ",i.formatMessage({id:"invitation.message.invitation.received"})]}),(0,t.jsx)("span",{style:{fontWeight:500},children:I.tenantName})]})})]}),(0,t.jsx)(v.Z,{name:"username",fieldProps:{size:"large",prefix:(0,t.jsx)(b.Z,{className:"prefixIcon"})},placeholder:i.formatMessage({id:"invitation.input.text.username"}),rules:[{required:!0,message:i.formatMessage({id:"invitation.input.text.username"})}]}),(0,t.jsx)(v.Z,{name:"userId",fieldProps:{size:"large",prefix:(0,t.jsx)(b.Z,{className:"prefixIcon"})},placeholder:i.formatMessage({id:"invitation.input.text.user.id"}),rules:[{required:!0,message:i.formatMessage({id:"invitation.input.text.user.id"})}]}),(0,t.jsx)(v.Z,{name:"email",fieldProps:{size:"large",prefix:(0,t.jsx)(q,{className:"prefixIcon"})},placeholder:i.formatMessage({id:"invitation.input.text.email"}),rules:[{required:!0,message:i.formatMessage({id:"invitation.input.text.email"})},{type:"email",message:i.formatMessage({id:"invitation.input.text.email.invalid"})}]}),(0,t.jsx)(v.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,t.jsx)(w.Z,{className:"prefixIcon"})},placeholder:i.formatMessage({id:"invitation.input.text.password"}),rules:[{required:!0,message:i.formatMessage({id:"invitation.input.text.password"})},{min:6,message:i.formatMessage({id:"invitation.input.text.password.length"})}]}),(0,t.jsx)(v.Z.Password,{name:"confirmPassword",fieldProps:{size:"large",prefix:(0,t.jsx)(w.Z,{className:"prefixIcon"})},placeholder:i.formatMessage({id:"invitation.input.text.password.confirm"}),rules:[{required:!0,message:i.formatMessage({id:"invitation.input.text.password.confirm"})}]}),(0,t.jsxs)("div",{style:{textAlign:"center",marginBottom:16,fontSize:14,color:"#666"},children:[i.formatMessage({id:"invitation.message.already.have.account"}),(0,t.jsx)("a",{style:{color:"#1890ff",marginLeft:4,textDecoration:"none"},onClick:function(){var r=x.get("code"),n=r?"/login?code=".concat(r):"/login";window.location.href=n},children:i.formatMessage({id:"invitation.message.already.have.account.login"})})]})]})]})},ae=ie}}]);
