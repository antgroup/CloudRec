"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6090],{55416:function(Ce,T,a){a.r(T),a.d(T,{default:function(){return ne}});var U=a(15009),c=a.n(U),G=a(99289),y=a.n(G),H=a(5574),v=a.n(H),W=a(55375),$=a(33651),P=a(98665),f=a(14748),Z=a(87547),V=a(87462),d=a(62435),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"},Y=D,Q=a(84089),X=function(I,x){return d.createElement(Q.Z,(0,V.Z)({},I,{ref:x,icon:Y}))},q=d.forwardRef(X),_=q,z=a(94149),h=a(39380),ee=a(26),m=a(5966),w=a(45830),ie=a(68872),te=a(57381),R=a(22181),C=a(83622),p={invitation:"invitation___Fiy6u",invitationContainer:"invitationContainer___s31wH",invitationCard:"invitationCard___F9CsT",title:"title___KvZTK",subtitle:"subtitle___Io6iJ",loadingContainer:"loadingContainer___vfF73",loadingText:"loadingText___apBxr",errorContainer:"errorContainer___OKw9B",errorIcon:"errorIcon___K2Bdj",errorTitle:"errorTitle___YgWtk",errorMessage:"errorMessage___El_tT",autoJoinContainer:"autoJoinContainer___uNHfT",successIcon:"successIcon___VIG7W",autoJoinTitle:"autoJoinTitle___c91xT",autoJoinMessage:"autoJoinMessage___wMdGe",registerForm:"registerForm___v0UKo","ant-form-item":"ant-form-item___NslJY","ant-input":"ant-input___ODsuq","ant-btn":"ant-btn___Tp4Ed","ant-btn-primary":"ant-btn-primary___pNx2n",formTitle:"formTitle___ZTO9w"},e=a(86074),ae=function(){var I=ie.ZP.useMessage(),x=v()(I,2),u=x[0],re=x[1],t=(0,w.useIntl)(),oe=(0,w.useSearchParams)(),le=v()(oe,1),j=le[0],de=(0,d.useState)(!0),N=v()(de,2),ue=N[0],J=N[1],ge=(0,d.useState)(!1),O=v()(ge,2),ce=O[0],L=O[1],ve=(0,d.useState)(null),k=v()(ve,2),b=k[0],me=k[1],fe=(0,d.useState)("checking"),A=v()(fe,2),B=A[0],g=A[1],he=function(){var r=localStorage.getItem("JSESSIONID");return!!r},pe=function(){var l=y()(c()().mark(function r(){var n,o;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n=j.get("code"),n){i.next=5;break}return g("invalid"),J(!1),i.abrupt("return");case 5:return i.prev=5,i.next=8,(0,$.checkInviteCode)({inviteCode:n});case 8:if(o=i.sent,!(o.code===200&&o.content)){i.next=19;break}if(me(o.content),!he()){i.next=16;break}return i.next=14,xe(n);case 14:i.next=17;break;case 16:g("register");case 17:i.next=20;break;case 19:g("invalid");case 20:i.next=26;break;case 22:i.prev=22,i.t0=i.catch(5),console.error("Error validating invite code:",i.t0),g("invalid");case 26:return i.prev=26,J(!1),i.finish(26);case 29:case"end":return i.stop()}},r,null,[[5,22,26,29]])}));return function(){return l.apply(this,arguments)}}(),xe=function(){var l=y()(c()().mark(function r(n){var o;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,(0,P.joinTenant)({inviteCode:n});case 3:o=i.sent,o.code===200?(g("auto-join"),u.success(t.formatMessage({id:"invitation.message.join.success"})),setTimeout(function(){window.location.href="/home"},1500)):(u.error(o.msg||t.formatMessage({id:"invitation.message.join.failed"})),g("invalid")),i.next=12;break;case 7:i.prev=7,i.t0=i.catch(0),console.error("Auto join tenant error:",i.t0),u.error(t.formatMessage({id:"invitation.message.join.failed"})),g("invalid");case 12:case"end":return i.stop()}},r,null,[[0,7]])}));return function(n){return l.apply(this,arguments)}}(),je=function(){var l=y()(c()().mark(function r(n){var o,M,i,F,Me,E,S;return c()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(o=n.userId,M=n.username,i=n.password,F=n.confirmPassword,Me=n.email,E=j.get("code"),i===F){s.next=5;break}return u.error(t.formatMessage({id:"invitation.message.password.mismatch"})),s.abrupt("return");case 5:return L(!0),s.prev=6,s.next=9,(0,P.register)({userId:o,username:M,password:i,code:E});case 9:S=s.sent,S.code===200?(u.success(t.formatMessage({id:"invitation.message.register.success"})),setTimeout(function(){var K=j.get("code"),ye=K?"/login?code=".concat(K):"/login";window.location.href=ye},1500)):u.error(S.msg||t.formatMessage({id:"invitation.message.register.failed"})),s.next=17;break;case 13:s.prev=13,s.t0=s.catch(6),console.error("Registration error:",s.t0),u.error(t.formatMessage({id:"invitation.message.register.failed"}));case 17:return s.prev=17,L(!1),s.finish(17);case 20:case"end":return s.stop()}},r,null,[[6,13,17,20]])}));return function(n){return l.apply(this,arguments)}}();return(0,d.useEffect)(function(){pe()},[]),ue?(0,e.jsxs)(h._z,{ghost:!0,title:!1,breadcrumb:void 0,childrenContentStyle:{padding:0,height:"100%"},className:p.invitation,children:[(0,e.jsx)("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e3,background:"rgba(255, 255, 255, 0.9)",borderRadius:"6px",padding:"4px"},children:(0,e.jsx)(f.Z,{})}),(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,e.jsx)(te.Z,{size:"large"})})]}):B==="invalid"?(0,e.jsxs)(h._z,{ghost:!0,title:!1,breadcrumb:void 0,childrenContentStyle:{padding:0,height:"100%"},className:p.invitation,children:[(0,e.jsx)("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e3,background:"rgba(255, 255, 255, 0.9)",borderRadius:"6px",padding:"4px"},children:(0,e.jsx)(f.Z,{})}),(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,e.jsx)(R.ZP,{status:"error",title:t.formatMessage({id:"invitation.message.invalid"}),subTitle:t.formatMessage({id:"invitation.message.invalid.subtitle"}),extra:[(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return window.location.href="/home"},children:t.formatMessage({id:"invitation.button.text.return.home"})},"home")]})})]}):B==="auto-join"?(0,e.jsxs)(h._z,{ghost:!0,title:!1,breadcrumb:void 0,childrenContentStyle:{padding:0,height:"100%"},className:p.invitation,children:[(0,e.jsx)("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e3,background:"rgba(255, 255, 255, 0.9)",borderRadius:"6px",padding:"4px"},children:(0,e.jsx)(f.Z,{})}),(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,e.jsx)(R.ZP,{status:"success",title:t.formatMessage({id:"invitation.message.join.success"}),subTitle:t.formatMessage({id:"invitation.message.join.success.subtitle"}),extra:[(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return window.location.href="/home"},children:t.formatMessage({id:"invitation.button.text.return.home"})},"home")]})})]}):(0,e.jsxs)(h._z,{ghost:!0,title:!1,breadcrumb:void 0,childrenContentStyle:{padding:0,height:"100%"},className:p.invitation,children:[re,(0,e.jsx)("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e3,background:"rgba(255, 255, 255, 0.9)",borderRadius:"6px",padding:"4px"},children:(0,e.jsx)(f.Z,{})}),(0,e.jsxs)(ee.B,{backgroundImageUrl:"https://gw.alipayobjects.com/zos/rmsportal/FfdJeJRQWjEeGTpqgBKj.png",logo:"/favicon-light.ico",title:W.j2,subTitle:"CloudRec's Protecting More",onFinish:je,submitter:{render:function(){return(0,e.jsx)(C.ZP,{loading:ce,type:"primary",htmlType:"submit",style:{height:40,width:"100%",borderRadius:6,fontSize:16},children:t.formatMessage({id:"individual.button.text.register"})})}},children:[b&&(0,e.jsxs)("div",{style:{marginBottom:24,padding:16,background:"#f6f8fa",borderRadius:8,border:"1px solid #e1e8ed"},children:[(0,e.jsxs)("div",{style:{fontSize:16,fontWeight:600,color:"#1890ff",marginBottom:12,textAlign:"center"},children:["\u{1F389} ",t.formatMessage({id:"invitation.message.invitation.received"})]}),(0,e.jsx)("div",{style:{fontSize:14,color:"#666",textAlign:"center"},children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("span",{style:{margin:"0 4px"},children:[b.inviter," ",t.formatMessage({id:"invitation.message.invitation.received"})]}),(0,e.jsx)("span",{style:{fontWeight:500},children:b.tenantName})]})})]}),(0,e.jsx)(m.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(Z.Z,{className:"prefixIcon"})},placeholder:t.formatMessage({id:"invitation.input.text.username"}),rules:[{required:!0,message:t.formatMessage({id:"invitation.input.text.username"})}]}),(0,e.jsx)(m.Z,{name:"userId",fieldProps:{size:"large",prefix:(0,e.jsx)(Z.Z,{className:"prefixIcon"})},placeholder:t.formatMessage({id:"invitation.input.text.user.id"}),rules:[{required:!0,message:t.formatMessage({id:"invitation.input.text.user.id"})}]}),(0,e.jsx)(m.Z,{name:"email",fieldProps:{size:"large",prefix:(0,e.jsx)(_,{className:"prefixIcon"})},placeholder:t.formatMessage({id:"invitation.input.text.email"}),rules:[{required:!0,message:t.formatMessage({id:"invitation.input.text.email"})},{type:"email",message:t.formatMessage({id:"invitation.input.text.email.invalid"})}]}),(0,e.jsx)(m.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(z.Z,{className:"prefixIcon"})},placeholder:t.formatMessage({id:"invitation.input.text.password"}),rules:[{required:!0,message:t.formatMessage({id:"invitation.input.text.password"})},{min:6,message:t.formatMessage({id:"invitation.input.text.password.length"})}]}),(0,e.jsx)(m.Z.Password,{name:"confirmPassword",fieldProps:{size:"large",prefix:(0,e.jsx)(z.Z,{className:"prefixIcon"})},placeholder:t.formatMessage({id:"invitation.input.text.password.confirm"}),rules:[{required:!0,message:t.formatMessage({id:"invitation.input.text.password.confirm"})}]}),(0,e.jsxs)("div",{style:{textAlign:"center",marginBottom:16,fontSize:14,color:"#666"},children:[t.formatMessage({id:"invitation.message.already.have.account"}),(0,e.jsx)("a",{style:{color:"#1890ff",marginLeft:4,textDecoration:"none"},onClick:function(){var r=j.get("code"),n=r?"/login?code=".concat(r):"/login";window.location.href=n},children:t.formatMessage({id:"invitation.message.already.have.account.login"})})]})]})]})},ne=ae}}]);
