(self.webpackChunk=self.webpackChunk||[]).push([[3635],{82826:function(M,j,e){"use strict";e.d(j,{Z:function(){return i}});var o=e(87462),a=e(62435),d={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},c=d,C=e(84089),g=function(y,u){return a.createElement(C.Z,(0,o.Z)({},y,{ref:u,icon:c}))},O=a.forwardRef(g),i=O},24163:function(M,j,e){"use strict";var o=e(97857),a=e.n(o),d=e(25593),c=e(83062),C=e(62435),g=e(86074),O=d.Z.Paragraph;j.Z=function(i){var v=i.text,y=i.width,u=i.maxWidth,m=i.rows,E=m===void 0?2:m,r=i.placement,D=r===void 0?"top":r,s=i.color,p=s===void 0?"rgba(0, 0, 0, 0.88)":s,t=i.link,l=t===void 0?!1:t,R=i.onClickCallBackFunc,h=i.style,x=h===void 0?{}:h,f=i.copyable,I=f===void 0?!1:f;return(0,g.jsx)("div",{style:{maxWidth:u,width:y},children:(0,g.jsx)(c.Z,{title:(0,g.jsx)("div",{children:v}),placement:D,children:(0,g.jsx)(O,{ellipsis:{rows:E},style:a()({marginBottom:0,color:p,cursor:l?"pointer":""},x),onClick:R,copyable:I,children:v})})})}},52078:function(M,j,e){"use strict";var o=e(97857),a=e.n(o),d=e(27997),c=e(62435),C=e(86074),g=function(i){d.Mj.register({id:"json"});var v=i.value,y=v===void 0?"{}":v,u=i.onChange,m=i.editorStyle,E=m===void 0?{}:m,r=i.editorKey,D=r===void 0?"json-editor":r,s=i.readOnly,p=s===void 0?!1:s,t=(0,c.useRef)(),l=(0,c.useRef)(),R=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(x),x}catch(f){return console.warn("Invalid JSON string:",f),"{}"}};return(0,c.useEffect)(function(){if(t.current)return l.current?l.current.setValue(y):(l.current=d.j6.create(t.current,{value:R(y),language:"json",theme:"vs",readOnly:p,folding:!0,automaticLayout:!0}),l.current.onDidChangeModelContent(function(){var h=l.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:h}),u==null||u(h)})),function(){if(l!=null&&l.current){var h;l==null||(h=l.current)===null||h===void 0||h.dispose(),l.current=null}}},[]),(0,c.useEffect)(function(){l.current&&y!==l.current.getValue()&&l.current.setValue(R(y))},[y]),(0,C.jsx)("div",{ref:t,style:a()({height:360,borderRadius:4,overflow:"hidden"},E)},D)};j.Z=g},29297:function(M,j,e){"use strict";e.d(j,{q9:function(){return o.Z},Wy:function(){return i},mi:function(){return m}});var o=e(52078),a=e(97857),d=e.n(a),c=e(55171),C=e.n(c),g=e(86074),O=function(r){var D=r.value,s=r.viewerStyle,p=s===void 0?{}:s,t=r.displayDataTypes,l=t===void 0?!1:t,R=r.name,h=R===void 0?"output json":R;return(0,g.jsx)(C(),{src:D,name:h,collapsed:!1,displayDataTypes:l,style:d()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},p)})},i=O,v=e(27997),y=e(62435),u=function(r){v.Mj.register({id:"rego"});var D=r.value,s=r.onChange,p=r.editorStyle,t=p===void 0?{}:p,l=r.editorKey,R=r.readOnly,h=R===void 0?!1:R,x=(0,y.useRef)(),f=(0,y.useRef)();return(0,y.useEffect)(function(){if(x.current)return f.current||(f.current=v.j6.create(x.current,{value:D,language:"rego",theme:"vs",readOnly:h,automaticLayout:!0}),f.current.onDidChangeModelContent(function(){s==null||s(f.current.getValue())})),function(){if(f.current){var I;(I=f.current)===null||I===void 0||I.dispose(),f.current=null}}},[]),(0,g.jsx)("div",{ref:x,style:d()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},t)},l)},m=u},8210:function(M,j,e){"use strict";e.r(j),e.d(j,{default:function(){return me}});var o=e(5574),a=e.n(o),d=e(87426),c=e(39421),C=e(24163),g=e(22181),O=e(83622),i=e(87462),v=e(62435),y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},u=y,m=e(84089),E=function(P,T){return v.createElement(m.Z,(0,i.Z)({},P,{ref:T,icon:u}))},r=v.forwardRef(E),D=r,s=e(92016),p={noPermissionContainer:"noPermissionContainer___mfh3D","ant-result":"ant-result___HwWPh","ant-result-icon":"ant-result-icon___kCRak",anticon:"anticon___dFq4q","ant-result-title":"ant-result-title___qzgxn","ant-result-subtitle":"ant-result-subtitle___wgaK1","ant-result-extra":"ant-result-extra___YuiiI","ant-btn":"ant-btn___SR44Y",dark:"dark___6IwTX",fadeInUp:"fadeInUp___lq2_S"},t=e(86074),l=function(P){var T=P.title,L=P.subTitle,A=P.showReturnButton,V=A===void 0?!0:A,k=P.onReturn,W=(0,s.useIntl)(),U=function(){k?k():s.history===null||s.history===void 0||s.history.push("/")};return(0,t.jsx)("div",{className:p.noPermissionContainer,children:(0,t.jsx)(g.ZP,{icon:(0,t.jsx)(D,{}),status:"403",title:T||W.formatMessage({id:"common.message.text.no.permission.title"}),subTitle:L||W.formatMessage({id:"common.message.text.no.permission.subtitle"}),extra:V&&(0,t.jsx)(O.ZP,{type:"primary",onClick:U,children:W.formatMessage({id:"common.button.text.return"})})})})},R=l,h=e(71448),x=e(96364),f=e(47908),I=e(72028),$=e(29448),H=e(82826),te=e(45742),J=e(39380),ne=e(93410),re=e(25593),_=e(86250),se=e(4393),oe=e(42075),ie=e(66309),le=e(83062),ae=e(21532),B=e(23323),de=e(24482),ue=e(50322),ce=e(22145),Z=re.Z.Text,ve=function(){var P,T,L,A,V,k,W=(0,s.useLocation)(),U=new URLSearchParams(W.search),G=(0,v.useState)(U.get("id")),fe=a()(G,1),N=fe[0],S=(0,s.useIntl)(),ge=(0,s.useModel)("rule"),xe=ge.platformList,he=(0,s.useModel)("tenant"),K=he.tenantListAll,je=(0,v.useState)(!1),X=a()(je,2),ye=X[0],Ee=X[1],Ce=(0,v.useState)(!1),Y=a()(Ce,2),Oe=Y[0],Q=Y[1],De=(0,v.useState)(!1),q=a()(De,2),Re=q[0],ee=q[1],w=(0,s.useRequest)(function(b){return(0,I.queryRiskDetailById)({riskId:b})},{manual:!0,formatResult:function(F){return F.code===403&&ee(!0),F.content||{}},onError:function(F){ee(!0)}}),n=w.data,pe=w.run,Me=w.loading;return(0,v.useEffect)(function(){N&&pe(N)},[N]),Re?(0,t.jsx)(J._z,{breadcrumbRender:!1,title:(0,t.jsxs)(O.ZP,{type:"link",size:"small",onClick:function(){return s.history===null||s.history===void 0?void 0:s.history.back()},children:[(0,t.jsx)(H.Z,{})," ",S.formatMessage({id:"common.button.text.return"})]}),className:f.Z.riskDetailContainer,children:(0,t.jsx)(R,{})}):(0,t.jsx)(J._z,{loading:Me,breadcrumbRender:!1,title:(0,t.jsx)(_.Z,{justify:"space-between",align:"center",style:{width:"100%"},children:(0,t.jsxs)(O.ZP,{type:"link",size:"small",onClick:function(){return s.history===null||s.history===void 0?void 0:s.history.back()},children:[(0,t.jsx)(H.Z,{})," ",S.formatMessage({id:"common.button.text.return"})]})}),className:f.Z.riskDetailContainer,children:(0,t.jsxs)(se.Z,{className:f.Z.riskDetailAroundCard,children:[(0,t.jsxs)(ne.Z,{style:{marginBottom:18},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,t.jsx)(_.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,t.jsxs)("span",{children:[(0,t.jsx)(Z,{style:{marginRight:12},children:(0,t.jsx)(O.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(n==null?void 0:n.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(n==null||(P=n.ruleVO)===null||P===void 0?void 0:P.ruleName)||"-"})}),(0,t.jsxs)(oe.Z,{children:[(0,t.jsx)("span",{children:(0,$.Ff)(x.MW,n==null?void 0:n.status)}),(n==null?void 0:n.ignoreReasonType)&&(0,t.jsxs)("span",{children:[(0,t.jsxs)(Z,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[S.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,t.jsx)(ie.Z,{color:"geekblue",children:((T=x.$G.find(function(b){return b.value===(n==null?void 0:n.ignoreReasonType)}))===null||T===void 0?void 0:T.label)||"-"})]}),(n==null?void 0:n.ignoreReason)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(Z,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[S.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,t.jsx)(C.Z,{rows:1,text:n==null?void 0:n.ignoreReason,maxWidth:64})]})]})]})}),(0,t.jsxs)(_.Z,{vertical:!0,gap:10,children:[(0,t.jsxs)(_.Z,{align:"center",children:[(0,t.jsx)("img",{src:c.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[S.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:n==null?void 0:n.gmtModified})]}),(0,t.jsxs)(Z,{children:[(0,t.jsx)("img",{src:d.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[S.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:n==null?void 0:n.gmtCreate})]})]}),(0,t.jsxs)(_.Z,{align:"center",style:{margin:"10px 0 6px 0"},children:[(0,t.jsxs)("span",{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[S.formatMessage({id:"common.select.label.cloudAccount"}),"\xA0:\xA0"]}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)",marginRight:16},children:(n==null?void 0:n.cloudAccountId)||"-"}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",marginRight:16},children:(n==null?void 0:n.alias)||"-"})]}),(0,t.jsxs)(_.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,t.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,$.fD)(n==null?void 0:n.platform,xe)}),(0,t.jsx)(Z,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(n==null?void 0:n.resourceType)||"-"}),(0,t.jsxs)(_.Z,{align:"center",children:[(0,t.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(n==null?void 0:n.resourceName)+" / "+(n==null?void 0:n.resourceId)}),(0,t.jsx)(le.Z,{title:S.formatMessage({id:"asset.extend.text.detail"}),children:(0,t.jsx)("span",{className:f.Z.iconWrap,onClick:function(){return Q(!0)},children:(0,t.jsx)(te.Z,{className:f.Z.resourceInstance})})})]}),(0,t.jsx)(Z,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(K==null||(L=K.find(function(b){return b.value===(n==null?void 0:n.tenantId)}))===null||L===void 0?void 0:L.label)||"-"})]})]}),(0,t.jsx)(ae.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,t.jsxs)(B.Z,{children:[(0,t.jsx)(B.Z.Item,{label:S.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(A=n.ruleVO)===null||A===void 0?void 0:A.advice)||"-"})}),(0,t.jsx)(B.Z.Item,{label:S.formatMessage({id:"risk.module.text.reference.link"}),children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(V=n.ruleVO)===null||V===void 0?void 0:V.link)||"-"})}),(0,t.jsx)(B.Z.Item,{label:S.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(k=n.ruleVO)===null||k===void 0?void 0:k.ruleDesc)||"-"})})]})}),(0,t.jsx)(h.Z,{riskDrawerInfo:n}),(0,t.jsx)(ue.Z,{riskDrawerInfo:n}),(0,t.jsx)(de.Z,{evaluateDrawerVisible:ye,setEvaluateDrawerVisible:Ee,riskDrawerInfo:n}),(0,t.jsx)(ce.Z,{resourceDrawerVisible:Oe,setResourceDrawerVisible:Q,riskDrawerInfo:n})]})})},me=ve},53846:function(M,j){"use strict";j.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},69760:function(M,j,e){"use strict";e.d(j,{Z:function(){return y},w:function(){return O}});var o=e(62435),a=e(97937),d=e(64217),c=e(10110),C=e(24457),g=e(38780);function O(u){if(u)return{closable:u.closable,closeIcon:u.closeIcon}}function i(u){const{closable:m,closeIcon:E}=u||{};return o.useMemo(()=>{if(!m&&(m===!1||E===!1||E===null))return!1;if(m===void 0&&E===void 0)return null;let r={closeIcon:typeof E!="boolean"&&E!==null?E:void 0};return m&&typeof m=="object"&&(r=Object.assign(Object.assign({},r),m)),r},[m,E])}const v={};function y(u,m,E=v){const r=i(u),D=i(m),[s]=(0,c.Z)("global",C.Z.global),p=typeof r!="boolean"?!!(r!=null&&r.disabled):!1,t=o.useMemo(()=>Object.assign({closeIcon:o.createElement(a.Z,null)},E),[E]),l=o.useMemo(()=>r===!1?!1:r?(0,g.Z)(t,D,r):D===!1?!1:D?(0,g.Z)(t,D):t.closable?t:!1,[r,D,t]);return o.useMemo(()=>{if(l===!1)return[!1,null,p,{}];const{closeIconRender:R}=t,{closeIcon:h}=l;let x=h;const f=(0,d.Z)(l,!0);return x!=null&&(R&&(x=R(h)),x=o.isValidElement(x)?o.cloneElement(x,Object.assign({"aria-label":s.close},f)):o.createElement("span",Object.assign({"aria-label":s.close},f),x)),[!0,x,p,f]},[l,t])}},16569:function(M,j,e){"use strict";e.d(j,{H:function(){return C}});var o=e(62435),a=e(66680);function d(){}const c=o.createContext({add:d,remove:d});function C(O){const i=o.useContext(c),v=o.useRef(null);return(0,a.Z)(u=>{if(u){const m=O?u.querySelector(O):u;i.add(m),v.current=m}else i.remove(v.current)})}var g=null},85674:function(M,j,e){var o={"./simpleWorker":18352,"./simpleWorker.js":18352};function a(d){return Promise.resolve().then(function(){if(!e.o(o,d)){var c=new Error("Cannot find module '"+d+"'");throw c.code="MODULE_NOT_FOUND",c}var C=o[d];return e(C)})}a.keys=function(){return Object.keys(o)},a.id=85674,M.exports=a},10131:function(M,j,e){var o={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function a(d){if(!e.o(o,d))return Promise.resolve().then(function(){var g=new Error("Cannot find module '"+d+"'");throw g.code="MODULE_NOT_FOUND",g});var c=o[d],C=c[0];return Promise.all(c.slice(1).map(e.e)).then(function(){return e(C)})}a.keys=function(){return Object.keys(o)},a.id=10131,M.exports=a}}]);
