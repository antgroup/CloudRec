(self.webpackChunk=self.webpackChunk||[]).push([[3635],{82826:function(C,x,e){"use strict";e.d(x,{Z:function(){return i}});var u=e(87462),o=e(62435),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},l=a,j=e(84089),_=function(f,E){return o.createElement(j.Z,(0,u.Z)({},f,{ref:E,icon:l}))},p=o.forwardRef(_),i=p},69055:function(C,x,e){"use strict";e.d(x,{Z:function(){return R}});var u=e(22181),o=e(83622),a=e(87462),l=e(62435),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},_=j,p=e(84089),i=function(h,c){return l.createElement(p.Z,(0,a.Z)({},h,{ref:c,icon:_}))},g=l.forwardRef(i),f=g,E=e(45830),M={noPermissionContainer:"noPermissionContainer___mfh3D","ant-result":"ant-result___HwWPh","ant-result-icon":"ant-result-icon___kCRak",anticon:"anticon___dFq4q","ant-result-title":"ant-result-title___qzgxn","ant-result-subtitle":"ant-result-subtitle___wgaK1","ant-result-extra":"ant-result-extra___YuiiI","ant-btn":"ant-btn___SR44Y",dark:"dark___6IwTX",fadeInUp:"fadeInUp___lq2_S"},y=e(86074),d=function(h){var c=h.title,r=h.subTitle,D=h.showReturnButton,v=D===void 0?!0:D,O=h.onReturn,m=(0,E.useIntl)(),I=function(){O?O():E.history===null||E.history===void 0||E.history.push("/")};return(0,y.jsx)("div",{className:M.noPermissionContainer,children:(0,y.jsx)(u.ZP,{icon:(0,y.jsx)(f,{}),status:"403",title:c||m.formatMessage({id:"common.message.text.no.permission.title"}),subTitle:r||m.formatMessage({id:"common.message.text.no.permission.subtitle"}),extra:v&&(0,y.jsx)(o.ZP,{type:"primary",onClick:I,children:m.formatMessage({id:"common.button.text.return"})})})})},R=d},24163:function(C,x,e){"use strict";var u=e(97857),o=e.n(u),a=e(25593),l=e(83062),j=e(62435),_=e(86074),p=a.Z.Paragraph;x.Z=function(i){var g=i.text,f=i.width,E=i.maxWidth,M=i.rows,y=M===void 0?2:M,d=i.placement,R=d===void 0?"top":d,s=i.color,h=s===void 0?"rgba(0, 0, 0, 0.88)":s,c=i.link,r=c===void 0?!1:c,D=i.onClickCallBackFunc,v=i.style,O=v===void 0?{}:v,m=i.copyable,I=m===void 0?!1:m;return(0,_.jsx)("div",{style:{maxWidth:E,width:f},children:(0,_.jsx)(l.Z,{title:(0,_.jsx)("div",{children:g}),placement:R,children:(0,_.jsx)(p,{ellipsis:{rows:y},style:o()({marginBottom:0,color:h,cursor:r?"pointer":""},O),onClick:D,copyable:I,children:g})})})}},52078:function(C,x,e){"use strict";var u=e(97857),o=e.n(u),a=e(27997),l=e(62435),j=e(86074),_=function(i){a.Mj.register({id:"json"});var g=i.value,f=g===void 0?"{}":g,E=i.onChange,M=i.editorStyle,y=M===void 0?{}:M,d=i.editorKey,R=d===void 0?"json-editor":d,s=i.readOnly,h=s===void 0?!1:s,c=(0,l.useRef)(),r=(0,l.useRef)(),D=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(O),O}catch(m){return console.warn("Invalid JSON string:",m),"{}"}};return(0,l.useEffect)(function(){if(c.current)return r.current?r.current.setValue(f):(r.current=a.j6.create(c.current,{value:D(f),language:"json",theme:"vs",readOnly:h,folding:!0,automaticLayout:!0}),r.current.onDidChangeModelContent(function(){var v=r.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:v}),E==null||E(v)})),function(){if(r!=null&&r.current){var v;r==null||(v=r.current)===null||v===void 0||v.dispose(),r.current=null}}},[]),(0,l.useEffect)(function(){r.current&&f!==r.current.getValue()&&r.current.setValue(D(f))},[f]),(0,j.jsx)("div",{ref:c,style:o()({height:360,borderRadius:4,overflow:"hidden"},y)},R)};x.Z=_},29297:function(C,x,e){"use strict";e.d(x,{q9:function(){return u.Z},Wy:function(){return i},mi:function(){return M}});var u=e(52078),o=e(97857),a=e.n(o),l=e(55171),j=e.n(l),_=e(86074),p=function(d){var R=d.value,s=d.viewerStyle,h=s===void 0?{}:s,c=d.displayDataTypes,r=c===void 0?!1:c,D=d.name,v=D===void 0?"output json":D;return(0,_.jsx)(j(),{src:R,name:v,collapsed:!1,displayDataTypes:r,style:a()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},h)})},i=p,g=e(27997),f=e(62435),E=function(d){g.Mj.register({id:"rego"});var R=d.value,s=d.onChange,h=d.editorStyle,c=h===void 0?{}:h,r=d.editorKey,D=d.readOnly,v=D===void 0?!1:D,O=(0,f.useRef)(),m=(0,f.useRef)();return(0,f.useEffect)(function(){if(O.current)return m.current||(m.current=g.j6.create(O.current,{value:R,language:"rego",theme:"vs",readOnly:v,automaticLayout:!0}),m.current.onDidChangeModelContent(function(){s==null||s(m.current.getValue())})),function(){if(m.current){var I;(I=m.current)===null||I===void 0||I.dispose(),m.current=null}}},[]),(0,_.jsx)("div",{ref:O,style:a()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},c)},r)},M=E},35469:function(C,x,e){"use strict";e.r(x);var u=e(5574),o=e.n(u),a=e(87426),l=e(39421),j=e(24163),_=e(69055),p=e(71448),i=e(96364),g=e(47908),f=e(72028),E=e(29448),M=e(82826),y=e(45742),d=e(39380),R=e(93410),s=e(45830),h=e(25593),c=e(83622),r=e(86250),D=e(4393),v=e(42075),O=e(66309),m=e(83062),I=e(21532),A=e(99859),L=e(62435),G=e(24482),Y=e(50322),X=e(22145),n=e(86074),T=h.Z.Text,Q=function(){var W,b,B,U,Z,k,q=(0,s.useLocation)(),ee=new URLSearchParams(q.search),te=(0,L.useState)(ee.get("id")),ne=o()(te,1),K=ne[0],P=(0,s.useIntl)(),re=(0,s.useModel)("rule"),se=re.platformList,ie=(0,s.useModel)("tenant"),V=ie.tenantListAll,oe=(0,L.useState)(!1),F=o()(oe,2),ae=F[0],le=F[1],de=(0,L.useState)(!1),$=o()(de,2),ue=$[0],J=$[1],ce=(0,L.useState)(!1),H=o()(ce,2),_e=H[0],z=H[1],N=(0,s.useRequest)(function(S){return(0,f.queryRiskDetailById)({riskId:S})},{manual:!0,formatResult:function(w){return w.code===403&&z(!0),w.content||{}},onError:function(w){z(!0)}}),t=N.data,ve=N.run,me=N.loading;return(0,L.useEffect)(function(){K&&ve(K)},[K]),_e?(0,n.jsx)(d._z,{breadcrumbRender:!1,title:(0,n.jsxs)(c.ZP,{type:"link",size:"small",onClick:function(){return s.history===null||s.history===void 0?void 0:s.history.back()},children:[(0,n.jsx)(M.Z,{})," ",P.formatMessage({id:"common.button.text.return"})]}),className:g.Z.riskDetailContainer,children:(0,n.jsx)(_.Z,{})}):(0,n.jsx)(d._z,{loading:me,breadcrumbRender:!1,title:(0,n.jsx)(r.Z,{justify:"space-between",align:"center",style:{width:"100%"},children:(0,n.jsxs)(c.ZP,{type:"link",size:"small",onClick:function(){return s.history===null||s.history===void 0?void 0:s.history.back()},children:[(0,n.jsx)(M.Z,{})," ",P.formatMessage({id:"common.button.text.return"})]})}),className:g.Z.riskDetailContainer,children:(0,n.jsxs)(D.Z,{className:g.Z.riskDetailAroundCard,children:[(0,n.jsxs)(R.Z,{style:{marginBottom:18},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,n.jsx)(r.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,n.jsxs)("span",{children:[(0,n.jsx)(T,{style:{marginRight:12},children:(0,n.jsx)(c.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(t==null?void 0:t.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(t==null||(W=t.ruleVO)===null||W===void 0?void 0:W.ruleName)||"-"})}),(0,n.jsxs)(v.Z,{children:[(0,n.jsx)("span",{children:(0,E.Ff)(i.MW,t==null?void 0:t.status)}),(t==null?void 0:t.ignoreReasonType)&&(0,n.jsxs)("span",{children:[(0,n.jsxs)(T,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[P.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,n.jsx)(O.Z,{color:"geekblue",children:((b=i.$G.find(function(S){return S.value===(t==null?void 0:t.ignoreReasonType)}))===null||b===void 0?void 0:b.label)||"-"})]}),(t==null?void 0:t.ignoreReason)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(T,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[P.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,n.jsx)(j.Z,{rows:1,text:t==null?void 0:t.ignoreReason,maxWidth:64})]})]})]})}),(0,n.jsxs)(r.Z,{vertical:!0,gap:10,children:[(0,n.jsxs)(r.Z,{align:"center",children:[(0,n.jsx)("img",{src:l.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,n.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[P.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,n.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:t==null?void 0:t.gmtModified})]}),(0,n.jsxs)(T,{children:[(0,n.jsx)("img",{src:a.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,n.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[P.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,n.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:t==null?void 0:t.gmtCreate})]})]}),(0,n.jsxs)(r.Z,{align:"center",style:{margin:"10px 0 6px 0"},children:[(0,n.jsxs)("span",{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[P.formatMessage({id:"common.select.label.cloudAccount"}),"\xA0:\xA0"]}),(0,n.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)",marginRight:16},children:(t==null?void 0:t.cloudAccountId)||"-"}),(0,n.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",marginRight:16},children:(t==null?void 0:t.alias)||"-"})]}),(0,n.jsxs)(r.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,n.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,E.fD)(t==null?void 0:t.platform,se)}),(0,n.jsx)(T,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(t==null?void 0:t.resourceType)||"-"}),(0,n.jsxs)(r.Z,{align:"center",children:[(0,n.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(t==null?void 0:t.resourceName)+" / "+(t==null?void 0:t.resourceId)}),(0,n.jsx)(m.Z,{title:P.formatMessage({id:"asset.extend.text.detail"}),children:(0,n.jsx)("span",{className:g.Z.iconWrap,onClick:function(){return J(!0)},children:(0,n.jsx)(y.Z,{className:g.Z.resourceInstance})})})]}),(0,n.jsx)(T,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(V==null||(B=V.find(function(S){return S.value===(t==null?void 0:t.tenantId)}))===null||B===void 0?void 0:B.label)||"-"})]})]}),(0,n.jsx)(I.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,n.jsxs)(A.Z,{children:[(0,n.jsx)(A.Z.Item,{label:P.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,n.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(t==null||(U=t.ruleVO)===null||U===void 0?void 0:U.advice)||"-"})}),(0,n.jsx)(A.Z.Item,{label:P.formatMessage({id:"risk.module.text.reference.link"}),children:(0,n.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(t==null||(Z=t.ruleVO)===null||Z===void 0?void 0:Z.link)||"-"})}),(0,n.jsx)(A.Z.Item,{label:P.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,n.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(t==null||(k=t.ruleVO)===null||k===void 0?void 0:k.ruleDesc)||"-"})})]})}),(0,n.jsx)(p.Z,{riskDrawerInfo:t}),(0,n.jsx)(Y.Z,{riskDrawerInfo:t}),(0,n.jsx)(G.Z,{evaluateDrawerVisible:ae,setEvaluateDrawerVisible:le,riskDrawerInfo:t}),(0,n.jsx)(X.Z,{resourceDrawerVisible:ue,setResourceDrawerVisible:J,riskDrawerInfo:t})]})})};x.default=Q},53846:function(C,x){"use strict";x.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},85674:function(C,x,e){var u={"./simpleWorker":18352,"./simpleWorker.js":18352};function o(a){return Promise.resolve().then(function(){if(!e.o(u,a)){var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var j=u[a];return e(j)})}o.keys=function(){return Object.keys(u)},o.id=85674,C.exports=o},10131:function(C,x,e){var u={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function o(a){if(!e.o(u,a))return Promise.resolve().then(function(){var _=new Error("Cannot find module '"+a+"'");throw _.code="MODULE_NOT_FOUND",_});var l=u[a],j=l[0];return Promise.all(l.slice(1).map(e.e)).then(function(){return e(j)})}o.keys=function(){return Object.keys(u)},o.id=10131,C.exports=o}}]);
