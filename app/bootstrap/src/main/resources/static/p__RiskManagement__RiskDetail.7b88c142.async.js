(self.webpackChunk=self.webpackChunk||[]).push([[3635],{82826:function(x,D,e){"use strict";e.d(D,{Z:function(){return s}});var l=e(87462),i=e(62435),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},d=a,h=e(84089),g=function(E,u){return i.createElement(h.Z,(0,l.Z)({},E,{ref:u,icon:d}))},R=i.forwardRef(g),s=R},24163:function(x,D,e){"use strict";var l=e(97857),i=e.n(l),a=e(25593),d=e(83062),h=e(62435),g=e(86074),R=a.Z.Paragraph;D.Z=function(s){var C=s.text,E=s.width,u=s.maxWidth,c=s.rows,O=c===void 0?2:c,o=s.placement,_=o===void 0?"top":o,j=s.color,y=j===void 0?"rgba(0, 0, 0, 0.88)":j,v=s.link,r=v===void 0?!1:v,P=s.onClickCallBackFunc,m=s.style,f=m===void 0?{}:m,M=s.copyable,I=M===void 0?!1:M;return(0,g.jsx)("div",{style:{maxWidth:u,width:E},children:(0,g.jsx)(d.Z,{title:(0,g.jsx)("div",{children:C}),placement:_,children:(0,g.jsx)(R,{ellipsis:{rows:O},style:i()({marginBottom:0,color:y,cursor:r?"pointer":""},f),onClick:P,copyable:I,children:C})})})}},52078:function(x,D,e){"use strict";var l=e(97857),i=e.n(l),a=e(27997),d=e(62435),h=e(86074),g=function(s){a.Mj.register({id:"json"});var C=s.value,E=C===void 0?"{}":C,u=s.onChange,c=s.editorStyle,O=c===void 0?{}:c,o=s.editorKey,_=o===void 0?"json-editor":o,j=s.readOnly,y=j===void 0?!1:j,v=(0,d.useRef)(),r=(0,d.useRef)(),P=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(f),f}catch(M){return console.warn("Invalid JSON string:",M),"{}"}};return(0,d.useEffect)(function(){if(v.current)return r.current?r.current.setValue(E):(r.current=a.j6.create(v.current,{value:P(E),language:"json",theme:"vs",readOnly:y,folding:!0,automaticLayout:!0}),r.current.onDidChangeModelContent(function(){var m=r.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:m}),u==null||u(m)})),function(){if(r!=null&&r.current){var m;r==null||(m=r.current)===null||m===void 0||m.dispose(),r.current=null}}},[]),(0,d.useEffect)(function(){r.current&&E!==r.current.getValue()&&r.current.setValue(P(E))},[E]),(0,h.jsx)("div",{ref:v,style:i()({height:360,borderRadius:4,overflow:"hidden"},O)},_)};D.Z=g},29297:function(x,D,e){"use strict";e.d(D,{q9:function(){return l.Z},Wy:function(){return s},mi:function(){return c}});var l=e(52078),i=e(97857),a=e.n(i),d=e(55171),h=e.n(d),g=e(86074),R=function(o){var _=o.value,j=o.viewerStyle,y=j===void 0?{}:j,v=o.displayDataTypes,r=v===void 0?!1:v,P=o.name,m=P===void 0?"output json":P;return(0,g.jsx)(h(),{src:_,name:m,collapsed:!1,displayDataTypes:r,style:a()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},y)})},s=R,C=e(27997),E=e(62435),u=function(o){C.Mj.register({id:"rego"});var _=o.value,j=o.onChange,y=o.editorStyle,v=y===void 0?{}:y,r=o.editorKey,P=o.readOnly,m=P===void 0?!1:P,f=(0,E.useRef)(),M=(0,E.useRef)();return(0,E.useEffect)(function(){if(f.current)return M.current||(M.current=C.j6.create(f.current,{value:_,language:"rego",theme:"vs",readOnly:m,automaticLayout:!0}),M.current.onDidChangeModelContent(function(){j==null||j(M.current.getValue())})),function(){if(M.current){var I;(I=M.current)===null||I===void 0||I.dispose(),M.current=null}}},[]),(0,g.jsx)("div",{ref:f,style:a()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},v)},r)},c=u},35469:function(x,D,e){"use strict";e.r(D);var l=e(5574),i=e.n(l),a=e(87426),d=e(39421),h=e(24163),g=e(71448),R=e(96364),s=e(47908),C=e(72028),E=e(29448),u=e(82826),c=e(45742),O=e(39380),o=e(93410),_=e(92016),j=e(25593),y=e(83622),v=e(4393),r=e(86250),P=e(42075),m=e(66309),f=e(83062),M=e(21532),I=e(23323),S=e(62435),w=e(24482),$=e(50322),J=e(22145),t=e(86074),T=j.Z.Text,H=function(){var L,A,B,W,U,b,z=(0,_.useLocation)(),G=new URLSearchParams(z.search),X=(0,S.useState)(G.get("id")),Q=i()(X,1),K=Q[0],Y=(0,_.useModel)("rule"),q=Y.platformList,ee=(0,_.useModel)("tenant"),Z=ee.tenantListAll,ne=(0,S.useState)(!1),V=i()(ne,2),te=V[0],re=V[1],se=(0,S.useState)(!1),F=i()(se,2),oe=F[0],N=F[1],k=(0,_.useRequest)(function(p){return(0,C.queryRiskDetailById)({riskId:p})},{manual:!0,formatResult:function(ae){return ae.content||{}}}),n=k.data,le=k.run,ie=k.loading;return(0,S.useEffect)(function(){K&&le(K)},[K]),(0,t.jsx)(O._z,{loading:ie,breadcrumbRender:!1,title:(0,t.jsxs)(y.ZP,{type:"link",size:"small",onClick:function(){return _.history===null||_.history===void 0?void 0:_.history.back()},children:[(0,t.jsx)(u.Z,{})," \u8FD4\u56DE"]}),className:s.Z.riskDetailContainer,children:(0,t.jsxs)(v.Z,{className:s.Z.riskDetailAroundCard,children:[(0,t.jsxs)(o.Z,{style:{marginBottom:18},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,t.jsx)(r.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,t.jsxs)("span",{children:[(0,t.jsx)(T,{style:{marginRight:12},children:(0,t.jsx)(y.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(n==null?void 0:n.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(n==null||(L=n.ruleVO)===null||L===void 0?void 0:L.ruleName)||"-"})}),(0,t.jsxs)(P.Z,{children:[(0,t.jsx)("span",{children:(0,E.Ff)(R.MW,n==null?void 0:n.status)}),(n==null?void 0:n.ignoreReasonType)&&(0,t.jsxs)("span",{children:[(0,t.jsx)(T,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:"\u5FFD\u7565\u7C7B\u578B:"}),(0,t.jsx)(m.Z,{color:"geekblue",children:((A=R.$G.find(function(p){return p.value===(n==null?void 0:n.ignoreReasonType)}))===null||A===void 0?void 0:A.label)||"-"})]}),(n==null?void 0:n.ignoreReason)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:"\u5FFD\u7565\u539F\u56E0:"}),(0,t.jsx)(h.Z,{rows:1,text:n==null?void 0:n.ignoreReason,maxWidth:64})]})]})]})}),(0,t.jsxs)(r.Z,{vertical:!0,gap:10,children:[(0,t.jsxs)(r.Z,{align:"center",children:[(0,t.jsx)("img",{src:d.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:"\u6700\u8FD1\u626B\u63CF\u547D\u4E2D:"}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:n==null?void 0:n.gmtModified})]}),(0,t.jsxs)(T,{children:[(0,t.jsx)("img",{src:a.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:"\u9996\u6B21\u53D1\u73B0\u65F6\u95F4:"}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:n==null?void 0:n.gmtCreate})]})]}),(0,t.jsxs)(r.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,t.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,E.fD)(n==null?void 0:n.platform,q)}),(0,t.jsx)(T,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(n==null?void 0:n.resourceType)||"-"}),(0,t.jsxs)(r.Z,{align:"center",children:[(0,t.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(n==null?void 0:n.resourceName)+" / "+(n==null?void 0:n.resourceId)}),(0,t.jsx)(f.Z,{title:"\u8D44\u4EA7\u8BE6\u60C5",children:(0,t.jsx)("span",{className:s.Z.iconWrap,onClick:function(){return N(!0)},children:(0,t.jsx)(c.Z,{className:s.Z.resourceInstance})})})]}),(0,t.jsx)(T,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(Z==null||(B=Z.find(function(p){return p.value===(n==null?void 0:n.tenantId)}))===null||B===void 0?void 0:B.label)||"-"})]})]}),(0,t.jsx)(M.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,t.jsxs)(I.Z,{children:[(0,t.jsx)(I.Z.Item,{label:"\u4FEE\u590D\u5EFA\u8BAE",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(W=n.ruleVO)===null||W===void 0?void 0:W.advice)||"-"})}),(0,t.jsx)(I.Z.Item,{label:"\u53C2\u8003\u94FE\u63A5",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(U=n.ruleVO)===null||U===void 0?void 0:U.link)||"-"})}),(0,t.jsx)(I.Z.Item,{label:"\u89C4\u5219\u63CF\u8FF0",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(b=n.ruleVO)===null||b===void 0?void 0:b.ruleDesc)||"-"})})]})}),(0,t.jsx)(g.Z,{riskDrawerInfo:n}),(0,t.jsx)($.Z,{riskDrawerInfo:n}),(0,t.jsx)(w.Z,{evaluateDrawerVisible:te,setEvaluateDrawerVisible:re,riskDrawerInfo:n}),(0,t.jsx)(J.Z,{resourceDrawerVisible:oe,setResourceDrawerVisible:N,riskDrawerInfo:n})]})})};D.default=H},53846:function(x,D){"use strict";D.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},69760:function(x,D,e){"use strict";e.d(D,{Z:function(){return E},w:function(){return R}});var l=e(62435),i=e(97937),a=e(64217),d=e(10110),h=e(24457),g=e(38780);function R(u){if(u)return{closable:u.closable,closeIcon:u.closeIcon}}function s(u){const{closable:c,closeIcon:O}=u||{};return l.useMemo(()=>{if(!c&&(c===!1||O===!1||O===null))return!1;if(c===void 0&&O===void 0)return null;let o={closeIcon:typeof O!="boolean"&&O!==null?O:void 0};return c&&typeof c=="object"&&(o=Object.assign(Object.assign({},o),c)),o},[c,O])}const C={};function E(u,c,O=C){const o=s(u),_=s(c),[j]=(0,d.Z)("global",h.Z.global),y=typeof o!="boolean"?!!(o!=null&&o.disabled):!1,v=l.useMemo(()=>Object.assign({closeIcon:l.createElement(i.Z,null)},O),[O]),r=l.useMemo(()=>o===!1?!1:o?(0,g.Z)(v,_,o):_===!1?!1:_?(0,g.Z)(v,_):v.closable?v:!1,[o,_,v]);return l.useMemo(()=>{if(r===!1)return[!1,null,y,{}];const{closeIconRender:P}=v,{closeIcon:m}=r;let f=m;const M=(0,a.Z)(r,!0);return f!=null&&(P&&(f=P(m)),f=l.isValidElement(f)?l.cloneElement(f,Object.assign({"aria-label":j.close},M)):l.createElement("span",Object.assign({"aria-label":j.close},M),f)),[!0,f,y,M]},[r,v])}},16569:function(x,D,e){"use strict";e.d(D,{H:function(){return h}});var l=e(62435),i=e(66680);function a(){}const d=l.createContext({add:a,remove:a});function h(R){const s=l.useContext(d),C=l.useRef(null);return(0,i.Z)(u=>{if(u){const c=R?u.querySelector(R):u;s.add(c),C.current=c}else s.remove(C.current)})}var g=null},85674:function(x,D,e){var l={"./simpleWorker":18352,"./simpleWorker.js":18352};function i(a){return Promise.resolve().then(function(){if(!e.o(l,a)){var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var h=l[a];return e(h)})}i.keys=function(){return Object.keys(l)},i.id=85674,x.exports=i},10131:function(x,D,e){var l={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function i(a){if(!e.o(l,a))return Promise.resolve().then(function(){var g=new Error("Cannot find module '"+a+"'");throw g.code="MODULE_NOT_FOUND",g});var d=l[a],h=d[0];return Promise.all(d.slice(1).map(e.e)).then(function(){return e(h)})}i.keys=function(){return Object.keys(l)},i.id=10131,x.exports=i}}]);
