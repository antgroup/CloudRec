(self.webpackChunk=self.webpackChunk||[]).push([[3635],{82826:function(R,M,e){"use strict";e.d(M,{Z:function(){return u}});var r=e(87462),l=e(62435),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},a=i,E=e(84089),m=function(D,d){return l.createElement(E.Z,(0,r.Z)({},D,{ref:d,icon:a}))},C=l.forwardRef(m),u=C},52078:function(R,M,e){"use strict";var r=e(97857),l=e.n(r),i=e(27997),a=e(62435),E=e(86074),m=function(u){i.Mj.register({id:"json"});var f=u.value,D=u.onChange,d=u.editorStyle,_=d===void 0?{}:d,g=u.editorKey,s=u.readOnly,c=s===void 0?!1:s,O=(0,a.useRef)(),o=(0,a.useRef)();return(0,a.useEffect)(function(){if(O.current)return o.current?o.current.setValue(f):(o.current=i.j6.create(O.current,{value:f,language:"json",theme:"vs",readOnly:c,folding:!0,automaticLayout:!0}),o.current.onDidChangeModelContent(function(){D==null||D(o.current.getValue())})),function(){if(o!=null&&o.current){var v;o==null||(v=o.current)===null||v===void 0||v.dispose(),o.current=null}}},[]),(0,a.useEffect)(function(){o.current&&f!==o.current.getValue()&&o.current.setValue(f)},[f]),(0,E.jsx)("div",{ref:O,style:l()({height:360,borderRadius:4,overflow:"hidden"},_)},g)};M.Z=m},29297:function(R,M,e){"use strict";e.d(M,{q9:function(){return r.Z},Wy:function(){return u},mi:function(){return _}});var r=e(52078),l=e(97857),i=e.n(l),a=e(55171),E=e.n(a),m=e(86074),C=function(s){var c=s.value,O=s.viewerStyle,o=O===void 0?{}:O,v=s.displayDataTypes,j=v===void 0?!1:v,P=s.name,x=P===void 0?"output json":P;return(0,m.jsx)(E(),{src:c,name:x,collapsed:!1,displayDataTypes:j,style:i()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},o)})},u=C,f=e(27997),D=e(62435),d=function(s){f.Mj.register({id:"rego"});var c=s.value,O=s.onChange,o=s.editorStyle,v=o===void 0?{}:o,j=s.editorKey,P=s.readOnly,x=P===void 0?!1:P,h=(0,D.useRef)(),y=(0,D.useRef)();return(0,D.useEffect)(function(){if(h.current)return y.current||(y.current=f.j6.create(h.current,{value:c,language:"rego",theme:"vs",readOnly:x,automaticLayout:!0}),y.current.onDidChangeModelContent(function(){O==null||O(y.current.getValue())})),function(){if(y.current){var I;(I=y.current)===null||I===void 0||I.dispose(),y.current=null}}},[]),(0,m.jsx)("div",{ref:h,style:i()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},v)},j)},_=d},35469:function(R,M,e){"use strict";e.r(M);var r=e(5574),l=e.n(r),i=e(87426),a=e(39421),E=e(24163),m=e(71448),C=e(96364),u=e(47908),f=e(72028),D=e(29448),d=e(82826),_=e(45742),g=e(39380),s=e(93410),c=e(92016),O=e(25593),o=e(83622),v=e(4393),j=e(86250),P=e(42075),x=e(66309),h=e(83062),y=e(21532),I=e(23323),L=e(62435),H=e(24482),$=e(50322),J=e(22145),t=e(86074),T=O.Z.Text,w=function(){var A,p,B,W,U,b,z=(0,c.useLocation)(),G=new URLSearchParams(z.search),X=(0,L.useState)(G.get("id")),Q=l()(X,1),K=Q[0],Y=(0,c.useModel)("rule"),q=Y.platformList,ee=(0,c.useModel)("tenant"),Z=ee.tenantListAll,ne=(0,L.useState)(!1),k=l()(ne,2),te=k[0],re=k[1],se=(0,L.useState)(!1),F=l()(se,2),oe=F[0],N=F[1],V=(0,c.useRequest)(function(S){return(0,f.queryRiskDetailById)({riskId:S})},{manual:!0,formatResult:function(ae){return ae.content||{}}}),n=V.data,le=V.run,ie=V.loading;return(0,L.useEffect)(function(){K&&le(K)},[K]),(0,t.jsx)(g._z,{loading:ie,breadcrumbRender:!1,title:(0,t.jsxs)(o.ZP,{type:"link",size:"small",onClick:function(){return c.history===null||c.history===void 0?void 0:c.history.back()},children:[(0,t.jsx)(d.Z,{})," \u8FD4\u56DE"]}),className:u.Z.riskDetailContainer,children:(0,t.jsxs)(v.Z,{className:u.Z.riskDetailAroundCard,children:[(0,t.jsxs)(s.Z,{style:{marginBottom:18},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,t.jsx)(j.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,t.jsxs)("span",{children:[(0,t.jsx)(T,{style:{marginRight:12},children:(0,t.jsx)(o.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(n==null?void 0:n.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(n==null||(A=n.ruleVO)===null||A===void 0?void 0:A.ruleName)||"-"})}),(0,t.jsxs)(P.Z,{children:[(0,t.jsx)("span",{children:(0,D.Ff)(C.MW,n==null?void 0:n.status)}),(n==null?void 0:n.ignoreReasonType)&&(0,t.jsxs)("span",{children:[(0,t.jsx)(T,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:"\u5FFD\u7565\u7C7B\u578B:"}),(0,t.jsx)(x.Z,{color:"geekblue",children:((p=C.$G.find(function(S){return S.value===(n==null?void 0:n.ignoreReasonType)}))===null||p===void 0?void 0:p.label)||"-"})]}),(n==null?void 0:n.ignoreReason)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:"\u5FFD\u7565\u539F\u56E0:"}),(0,t.jsx)(E.Z,{rows:1,text:n==null?void 0:n.ignoreReason,maxWidth:64})]})]})]})}),(0,t.jsxs)(j.Z,{vertical:!0,gap:10,children:[(0,t.jsxs)(j.Z,{align:"center",children:[(0,t.jsx)("img",{src:a.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:"\u6700\u8FD1\u626B\u63CF\u547D\u4E2D:"}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:n==null?void 0:n.gmtModified})]}),(0,t.jsxs)(T,{children:[(0,t.jsx)("img",{src:i.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:"\u9996\u6B21\u53D1\u73B0\u65F6\u95F4:"}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:n==null?void 0:n.gmtCreate})]})]}),(0,t.jsxs)(j.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,t.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,D.fD)(n==null?void 0:n.platform,q)}),(0,t.jsx)(T,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(n==null?void 0:n.resourceType)||"-"}),(0,t.jsxs)(j.Z,{align:"center",children:[(0,t.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(n==null?void 0:n.resourceName)+" / "+(n==null?void 0:n.resourceId)}),(0,t.jsx)(h.Z,{title:"\u8D44\u4EA7\u8BE6\u60C5",children:(0,t.jsx)("span",{className:u.Z.iconWrap,onClick:function(){return N(!0)},children:(0,t.jsx)(_.Z,{className:u.Z.resourceInstance})})})]}),(0,t.jsx)(T,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(Z==null||(B=Z.find(function(S){return S.value===(n==null?void 0:n.tenantId)}))===null||B===void 0?void 0:B.label)||"-"})]})]}),(0,t.jsx)(y.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,t.jsxs)(I.Z,{children:[(0,t.jsx)(I.Z.Item,{label:"\u4FEE\u590D\u5EFA\u8BAE",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(W=n.ruleVO)===null||W===void 0?void 0:W.advice)||"-"})}),(0,t.jsx)(I.Z.Item,{label:"\u53C2\u8003\u94FE\u63A5",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(U=n.ruleVO)===null||U===void 0?void 0:U.link)||"-"})}),(0,t.jsx)(I.Z.Item,{label:"\u89C4\u5219\u63CF\u8FF0",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(b=n.ruleVO)===null||b===void 0?void 0:b.ruleDesc)||"-"})})]})}),(0,t.jsx)(m.Z,{riskDrawerInfo:n}),(0,t.jsx)($.Z,{riskDrawerInfo:n}),(0,t.jsx)(H.Z,{evaluateDrawerVisible:te,setEvaluateDrawerVisible:re,riskDrawerInfo:n}),(0,t.jsx)(J.Z,{resourceDrawerVisible:oe,setResourceDrawerVisible:N,riskDrawerInfo:n})]})})};M.default=w},69760:function(R,M,e){"use strict";e.d(M,{Z:function(){return D},w:function(){return C}});var r=e(62435),l=e(97937),i=e(64217),a=e(10110),E=e(24457),m=e(38780);function C(d){if(d)return{closable:d.closable,closeIcon:d.closeIcon}}function u(d){const{closable:_,closeIcon:g}=d||{};return r.useMemo(()=>{if(!_&&(_===!1||g===!1||g===null))return!1;if(_===void 0&&g===void 0)return null;let s={closeIcon:typeof g!="boolean"&&g!==null?g:void 0};return _&&typeof _=="object"&&(s=Object.assign(Object.assign({},s),_)),s},[_,g])}const f={};function D(d,_,g=f){const s=u(d),c=u(_),[O]=(0,a.Z)("global",E.Z.global),o=typeof s!="boolean"?!!(s!=null&&s.disabled):!1,v=r.useMemo(()=>Object.assign({closeIcon:r.createElement(l.Z,null)},g),[g]),j=r.useMemo(()=>s===!1?!1:s?(0,m.Z)(v,c,s):c===!1?!1:c?(0,m.Z)(v,c):v.closable?v:!1,[s,c,v]);return r.useMemo(()=>{if(j===!1)return[!1,null,o,{}];const{closeIconRender:P}=v,{closeIcon:x}=j;let h=x;const y=(0,i.Z)(j,!0);return h!=null&&(P&&(h=P(x)),h=r.isValidElement(h)?r.cloneElement(h,Object.assign({"aria-label":O.close},y)):r.createElement("span",Object.assign({"aria-label":O.close},y),h)),[!0,h,o,y]},[j,v])}},16569:function(R,M,e){"use strict";e.d(M,{H:function(){return E}});var r=e(62435),l=e(66680);function i(){}const a=r.createContext({add:i,remove:i});function E(C){const u=r.useContext(a),f=r.useRef(null);return(0,l.Z)(d=>{if(d){const _=C?d.querySelector(C):d;u.add(_),f.current=_}else u.remove(f.current)})}var m=null},85674:function(R,M,e){var r={"./simpleWorker":18352,"./simpleWorker.js":18352};function l(i){return Promise.resolve().then(function(){if(!e.o(r,i)){var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var E=r[i];return e(E)})}l.keys=function(){return Object.keys(r)},l.id=85674,R.exports=l},10131:function(R,M,e){var r={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function l(i){if(!e.o(r,i))return Promise.resolve().then(function(){var m=new Error("Cannot find module '"+i+"'");throw m.code="MODULE_NOT_FOUND",m});var a=r[i],E=a[0];return Promise.all(a.slice(1).map(e.e)).then(function(){return e(E)})}l.keys=function(){return Object.keys(r)},l.id=10131,R.exports=l}}]);
