(self.webpackChunk=self.webpackChunk||[]).push([[3635],{82826:function(x,j,e){"use strict";e.d(j,{Z:function(){return d}});var s=e(87462),l=e(62435),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},u=a,D=e(84089),O=function(f,i){return l.createElement(D.Z,(0,s.Z)({},f,{ref:i,icon:u}))},R=l.forwardRef(O),d=R},52078:function(x,j,e){"use strict";var s=e(97857),l=e.n(s),a=e(27997),u=e(62435),D=e(86074),O=function(d){a.Mj.register({id:"json"});var C=d.value,f=C===void 0?"{}":C,i=d.onChange,c=d.editorStyle,E=c===void 0?{}:c,o=d.editorKey,_=o===void 0?"json-editor":o,h=d.readOnly,P=h===void 0?!1:h,v=(0,u.useRef)(),r=(0,u.useRef)(),y=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(g),g}catch(M){return console.warn("Invalid JSON string:",M),"{}"}};return(0,u.useEffect)(function(){if(v.current)return r.current?r.current.setValue(f):(r.current=a.j6.create(v.current,{value:y(f),language:"json",theme:"vs",readOnly:P,folding:!0,automaticLayout:!0}),r.current.onDidChangeModelContent(function(){var m=r.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:m}),i==null||i(m)})),function(){if(r!=null&&r.current){var m;r==null||(m=r.current)===null||m===void 0||m.dispose(),r.current=null}}},[]),(0,u.useEffect)(function(){r.current&&f!==r.current.getValue()&&r.current.setValue(y(f))},[f]),(0,D.jsx)("div",{ref:v,style:l()({height:360,borderRadius:4,overflow:"hidden"},E)},_)};j.Z=O},29297:function(x,j,e){"use strict";e.d(j,{q9:function(){return s.Z},Wy:function(){return d},mi:function(){return c}});var s=e(52078),l=e(97857),a=e.n(l),u=e(55171),D=e.n(u),O=e(86074),R=function(o){var _=o.value,h=o.viewerStyle,P=h===void 0?{}:h,v=o.displayDataTypes,r=v===void 0?!1:v,y=o.name,m=y===void 0?"output json":y;return(0,O.jsx)(D(),{src:_,name:m,collapsed:!1,displayDataTypes:r,style:a()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},P)})},d=R,C=e(27997),f=e(62435),i=function(o){C.Mj.register({id:"rego"});var _=o.value,h=o.onChange,P=o.editorStyle,v=P===void 0?{}:P,r=o.editorKey,y=o.readOnly,m=y===void 0?!1:y,g=(0,f.useRef)(),M=(0,f.useRef)();return(0,f.useEffect)(function(){if(g.current)return M.current||(M.current=C.j6.create(g.current,{value:_,language:"rego",theme:"vs",readOnly:m,automaticLayout:!0}),M.current.onDidChangeModelContent(function(){h==null||h(M.current.getValue())})),function(){if(M.current){var I;(I=M.current)===null||I===void 0||I.dispose(),M.current=null}}},[]),(0,O.jsx)("div",{ref:g,style:a()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},v)},r)},c=i},35469:function(x,j,e){"use strict";e.r(j);var s=e(5574),l=e.n(s),a=e(87426),u=e(39421),D=e(24163),O=e(71448),R=e(96364),d=e(47908),C=e(72028),f=e(29448),i=e(82826),c=e(45742),E=e(39380),o=e(93410),_=e(92016),h=e(25593),P=e(83622),v=e(4393),r=e(86250),y=e(42075),m=e(66309),g=e(83062),M=e(21532),I=e(23323),L=e(62435),J=e(24482),$=e(50322),H=e(22145),t=e(86074),T=h.Z.Text,w=function(){var p,A,B,W,U,K,z=(0,_.useLocation)(),G=new URLSearchParams(z.search),X=(0,L.useState)(G.get("id")),Q=l()(X,1),b=Q[0],Y=(0,_.useModel)("rule"),q=Y.platformList,ee=(0,_.useModel)("tenant"),Z=ee.tenantListAll,ne=(0,L.useState)(!1),k=l()(ne,2),te=k[0],re=k[1],se=(0,L.useState)(!1),F=l()(se,2),oe=F[0],N=F[1],V=(0,_.useRequest)(function(S){return(0,C.queryRiskDetailById)({riskId:S})},{manual:!0,formatResult:function(ie){return ie.content||{}}}),n=V.data,le=V.run,ae=V.loading;return(0,L.useEffect)(function(){b&&le(b)},[b]),(0,t.jsx)(E._z,{loading:ae,breadcrumbRender:!1,title:(0,t.jsxs)(P.ZP,{type:"link",size:"small",onClick:function(){return _.history===null||_.history===void 0?void 0:_.history.back()},children:[(0,t.jsx)(i.Z,{})," \u8FD4\u56DE"]}),className:d.Z.riskDetailContainer,children:(0,t.jsxs)(v.Z,{className:d.Z.riskDetailAroundCard,children:[(0,t.jsxs)(o.Z,{style:{marginBottom:18},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,t.jsx)(r.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,t.jsxs)("span",{children:[(0,t.jsx)(T,{style:{marginRight:12},children:(0,t.jsx)(P.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(n==null?void 0:n.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(n==null||(p=n.ruleVO)===null||p===void 0?void 0:p.ruleName)||"-"})}),(0,t.jsxs)(y.Z,{children:[(0,t.jsx)("span",{children:(0,f.Ff)(R.MW,n==null?void 0:n.status)}),(n==null?void 0:n.ignoreReasonType)&&(0,t.jsxs)("span",{children:[(0,t.jsx)(T,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:"\u5FFD\u7565\u7C7B\u578B:"}),(0,t.jsx)(m.Z,{color:"geekblue",children:((A=R.$G.find(function(S){return S.value===(n==null?void 0:n.ignoreReasonType)}))===null||A===void 0?void 0:A.label)||"-"})]}),(n==null?void 0:n.ignoreReason)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:"\u5FFD\u7565\u539F\u56E0:"}),(0,t.jsx)(D.Z,{rows:1,text:n==null?void 0:n.ignoreReason,maxWidth:64})]})]})]})}),(0,t.jsxs)(r.Z,{vertical:!0,gap:10,children:[(0,t.jsxs)(r.Z,{align:"center",children:[(0,t.jsx)("img",{src:u.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:"\u6700\u8FD1\u626B\u63CF\u547D\u4E2D:"}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:n==null?void 0:n.gmtModified})]}),(0,t.jsxs)(T,{children:[(0,t.jsx)("img",{src:a.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:"\u9996\u6B21\u53D1\u73B0\u65F6\u95F4:"}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:n==null?void 0:n.gmtCreate})]})]}),(0,t.jsxs)(r.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,t.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,f.fD)(n==null?void 0:n.platform,q)}),(0,t.jsx)(T,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(n==null?void 0:n.resourceType)||"-"}),(0,t.jsxs)(r.Z,{align:"center",children:[(0,t.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(n==null?void 0:n.resourceName)+" / "+(n==null?void 0:n.resourceId)}),(0,t.jsx)(g.Z,{title:"\u8D44\u4EA7\u8BE6\u60C5",children:(0,t.jsx)("span",{className:d.Z.iconWrap,onClick:function(){return N(!0)},children:(0,t.jsx)(c.Z,{className:d.Z.resourceInstance})})})]}),(0,t.jsx)(T,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(Z==null||(B=Z.find(function(S){return S.value===(n==null?void 0:n.tenantId)}))===null||B===void 0?void 0:B.label)||"-"})]})]}),(0,t.jsx)(M.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,t.jsxs)(I.Z,{children:[(0,t.jsx)(I.Z.Item,{label:"\u4FEE\u590D\u5EFA\u8BAE",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(W=n.ruleVO)===null||W===void 0?void 0:W.advice)||"-"})}),(0,t.jsx)(I.Z.Item,{label:"\u53C2\u8003\u94FE\u63A5",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(U=n.ruleVO)===null||U===void 0?void 0:U.link)||"-"})}),(0,t.jsx)(I.Z.Item,{label:"\u89C4\u5219\u63CF\u8FF0",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(K=n.ruleVO)===null||K===void 0?void 0:K.ruleDesc)||"-"})})]})}),(0,t.jsx)(O.Z,{riskDrawerInfo:n}),(0,t.jsx)($.Z,{riskDrawerInfo:n}),(0,t.jsx)(J.Z,{evaluateDrawerVisible:te,setEvaluateDrawerVisible:re,riskDrawerInfo:n}),(0,t.jsx)(H.Z,{resourceDrawerVisible:oe,setResourceDrawerVisible:N,riskDrawerInfo:n})]})})};j.default=w},69760:function(x,j,e){"use strict";e.d(j,{Z:function(){return f},w:function(){return R}});var s=e(62435),l=e(97937),a=e(64217),u=e(10110),D=e(24457),O=e(38780);function R(i){if(i)return{closable:i.closable,closeIcon:i.closeIcon}}function d(i){const{closable:c,closeIcon:E}=i||{};return s.useMemo(()=>{if(!c&&(c===!1||E===!1||E===null))return!1;if(c===void 0&&E===void 0)return null;let o={closeIcon:typeof E!="boolean"&&E!==null?E:void 0};return c&&typeof c=="object"&&(o=Object.assign(Object.assign({},o),c)),o},[c,E])}const C={};function f(i,c,E=C){const o=d(i),_=d(c),[h]=(0,u.Z)("global",D.Z.global),P=typeof o!="boolean"?!!(o!=null&&o.disabled):!1,v=s.useMemo(()=>Object.assign({closeIcon:s.createElement(l.Z,null)},E),[E]),r=s.useMemo(()=>o===!1?!1:o?(0,O.Z)(v,_,o):_===!1?!1:_?(0,O.Z)(v,_):v.closable?v:!1,[o,_,v]);return s.useMemo(()=>{if(r===!1)return[!1,null,P,{}];const{closeIconRender:y}=v,{closeIcon:m}=r;let g=m;const M=(0,a.Z)(r,!0);return g!=null&&(y&&(g=y(m)),g=s.isValidElement(g)?s.cloneElement(g,Object.assign({"aria-label":h.close},M)):s.createElement("span",Object.assign({"aria-label":h.close},M),g)),[!0,g,P,M]},[r,v])}},16569:function(x,j,e){"use strict";e.d(j,{H:function(){return D}});var s=e(62435),l=e(66680);function a(){}const u=s.createContext({add:a,remove:a});function D(R){const d=s.useContext(u),C=s.useRef(null);return(0,l.Z)(i=>{if(i){const c=R?i.querySelector(R):i;d.add(c),C.current=c}else d.remove(C.current)})}var O=null},85674:function(x,j,e){var s={"./simpleWorker":18352,"./simpleWorker.js":18352};function l(a){return Promise.resolve().then(function(){if(!e.o(s,a)){var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var D=s[a];return e(D)})}l.keys=function(){return Object.keys(s)},l.id=85674,x.exports=l},10131:function(x,j,e){var s={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function l(a){if(!e.o(s,a))return Promise.resolve().then(function(){var O=new Error("Cannot find module '"+a+"'");throw O.code="MODULE_NOT_FOUND",O});var u=s[a],D=u[0];return Promise.all(u.slice(1).map(e.e)).then(function(){return e(D)})}l.keys=function(){return Object.keys(s)},l.id=10131,x.exports=l}}]);
