"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7530],{31732:function(Re,P,t){var V=t(97857),f=t.n(V),S=t(66309),A=t(62435),N=t(86074);P.Z=function(g){var w=g.text,o=g.style;return(0,N.jsx)(S.Z,{style:f()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},o),children:w})}},28235:function(Re,P,t){var V=t(97857),f=t.n(V),S=t(25593),A=t(83062),N=t(62435),g=t(86074),w=S.Z.Paragraph;P.Z=function(o){var p=o.text,m=o.width,v=o.maxWidth,k=o.rows,Q=k===void 0?2:k,s=o.placement,W=s===void 0?"top":s,te=o.color,se=te===void 0?"rgba(0, 0, 0, 0.88)":te,b=o.link,Z=b===void 0?!1:b,oe=o.onClickCallBackFunc,re=o.style,ue=re===void 0?{}:re,z=o.copyable,T=z===void 0?!1:z,R=o.tooltipText;return(0,g.jsx)("div",{style:{maxWidth:v,width:m},children:(0,g.jsx)(A.Z,{title:R,placement:W,children:(0,g.jsx)(w,{ellipsis:{rows:Q},style:f()({marginBottom:0,color:se,cursor:Z?"pointer":""},ue),onClick:oe,copyable:T,children:p})})})}},92086:function(Re,P,t){var V=t(5574),f=t.n(V),S=t(87426),A=t(39421),N=t(24163),g=t(71448),w=t(24482),o=t(50322),p=t(22145),m=t(96364),v=t(72028),k=t(29448),Q=t(45742),s=t(93410),W=t(92016),te=t(25593),se=t(85265),b=t(86250),Z=t(83622),oe=t(42075),re=t(66309),ue=t(83062),z=t(21532),T=t(23323),R=t(62435),x=t(47908),a=t(86074),U=te.Z.Text,Se=function(Y){var de,ce,B,I,me,ve,ge=Y.riskDrawerVisible,j=Y.riskDrawerInfo,ke=Y.setRiskDrawerVisible,be=Y.locate,fe=(0,W.useModel)("rule"),we=fe.platformList,Ze=(0,W.useModel)("tenant"),F=Ze.tenantListAll,L=(0,W.useIntl)(),Be=(0,R.useState)(!1),ye=f()(Be,2),Ee=ye[0],Ce=ye[1],Ae=(0,R.useState)(!1),Te=f()(Ae,2),Le=Te[0],je=Te[1],Fe=function(){ke(!1)},H=(0,W.useRequest)(function(C){return(0,v.queryRiskDetailById)({riskId:C})},{manual:!0,formatResult:function(xe){return xe.content||{}}}),r=H.data,O=H.run,K=H.loading,ne=function(){Fe()};return(0,R.useEffect)(function(){ge&&j!==null&&j!==void 0&&j.id&&O(j.id)},[ge,j]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(se.Z,{title:L.formatMessage({id:"risk.module.text.detail.info"}),width:"50%",open:ge,onClose:ne,loading:K,children:[(0,a.jsxs)(s.Z,{style:{marginBottom:20},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,a.jsx)(b.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,a.jsxs)("span",{children:[(0,a.jsx)(U,{style:{marginRight:12},children:(0,a.jsx)(Z.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(r==null?void 0:r.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(r==null||(de=r.ruleVO)===null||de===void 0?void 0:de.ruleName)||"-"})}),(0,a.jsxs)(oe.Z,{children:[(0,a.jsx)("span",{children:(0,k.Ff)(m.MW,r==null?void 0:r.status)}),(r==null?void 0:r.ignoreReasonType)&&(0,a.jsxs)("span",{children:[(0,a.jsxs)(U,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[L.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,a.jsx)(re.Z,{color:"geekblue",children:((ce=m.$G.find(function(C){return C.value===(r==null?void 0:r.ignoreReasonType)}))===null||ce===void 0?void 0:ce.label)||"-"})]}),(r==null?void 0:r.ignoreReason)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(U,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[L.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,a.jsx)(N.Z,{rows:1,text:r==null?void 0:r.ignoreReason,maxWidth:64})]})]})]})}),(0,a.jsxs)(b.Z,{vertical:!0,gap:10,children:[(0,a.jsxs)(b.Z,{align:"center",children:[(0,a.jsx)("img",{src:A.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,a.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[L.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,a.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:r==null?void 0:r.gmtModified})]}),(0,a.jsxs)(U,{children:[(0,a.jsx)("img",{src:S.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,a.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[L.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,a.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:r==null?void 0:r.gmtCreate})]})]}),(0,a.jsxs)(b.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,a.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,k.fD)(r==null?void 0:r.platform,we)}),(0,a.jsx)(U,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(r==null?void 0:r.resourceType)||"-"}),(0,a.jsxs)(b.Z,{align:"center",children:[(0,a.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(r==null?void 0:r.resourceName)+" / "+(r==null?void 0:r.resourceId)}),be==="risk"&&(0,a.jsx)(ue.Z,{title:L.formatMessage({id:"asset.extend.text.detail"}),children:(0,a.jsx)("span",{className:x.Z.iconWrap,onClick:function(){return je(!0)},children:(0,a.jsx)(Q.Z,{className:x.Z.resourceInstance})})})]}),(0,a.jsx)(U,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(F==null||(B=F.find(function(C){return C.value===(r==null?void 0:r.tenantId)}))===null||B===void 0?void 0:B.label)||"-"})]})]}),(0,a.jsx)(z.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,a.jsxs)(T.Z,{children:[(0,a.jsx)(T.Z.Item,{label:L.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,a.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(r==null||(I=r.ruleVO)===null||I===void 0?void 0:I.advice)||"-"})}),(0,a.jsx)(T.Z.Item,{label:L.formatMessage({id:"risk.module.text.reference.link"}),children:(0,a.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(r==null||(me=r.ruleVO)===null||me===void 0?void 0:me.link)||"-"})}),(0,a.jsx)(T.Z.Item,{label:L.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,a.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(r==null||(ve=r.ruleVO)===null||ve===void 0?void 0:ve.ruleDesc)||"-"})})]})}),(0,a.jsx)(g.Z,{riskDrawerInfo:j}),(0,a.jsx)(o.Z,{riskDrawerInfo:j})]}),(0,a.jsx)(w.Z,{evaluateDrawerVisible:Ee,setEvaluateDrawerVisible:Ce,riskDrawerInfo:j}),(0,a.jsx)(p.Z,{resourceDrawerVisible:Le,setResourceDrawerVisible:je,riskDrawerInfo:j})]})};P.Z=Se},40351:function(Re,P,t){t.r(P),t.d(P,{default:function(){return Fe}});var V=t(15009),f=t.n(V),S=t(99289),A=t.n(S),N=t(5574),g=t.n(N),w=t(97857),o=t.n(w),p=t(70501),m=t(96364),v=t(92016),k=t(66309),Q=t(53846),s=t(86074),W=function(H){var r=H.status,O=(0,s.jsx)(k.Z,{children:r||"-"});return[m.Bj[1].value].includes(r)?O=(0,s.jsx)(k.Z,{className:Q.Z.invalidTag,style:{marginLeft:6},children:(0,s.jsx)(v.FormattedMessage,{id:"common.tag.text.noExist"})}):O=(0,s.jsx)(k.Z,{className:Q.Z.validTag,style:{marginLeft:6},children:(0,s.jsx)(v.FormattedMessage,{id:"common.tag.text.exist"})}),O},te=t(31732),se=t(24163),b=t(28235),Z=t(72028),oe=t(37476),re=t(64317),ue=t(90672),z=t(68872),T=t(23323),R=t(96486),x=t(62435),a=function(r){var O=z.ZP.useMessage(),K=g()(O,2),ne=K[0],C=K[1],xe=T.Z.useForm(),Ve=g()(xe,1),he=Ve[0],J=(0,v.useIntl)(),Me=r.ignoreRiskFormVisible,y=r.riskInfo,Ie=r.setIgnoreRiskFormVisible,$=r.tableActionRef,pe=function(){he.resetFields()},ae=function(){Ie(!1),pe()},Ne=function(){var X=A()(f()().mark(function G(Oe){var _,h,De;return f()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return _=o()(o()({},Oe),{},{riskId:y.id}),c.next=3,(0,Z.ignoreRisk)(_);case 3:h=c.sent,h.code===200&&h.msg==="success"&&(ne.success(J.formatMessage({id:"risk.message.api.ignore.risk.success"})),$==null||(De=$.current)===null||De===void 0||De.reload(),ae());case 5:case"end":return c.stop()}},G)}));return function(Oe){return X.apply(this,arguments)}}();return(0,x.useEffect)(function(){Me&&!(0,R.isEmpty)(y)&&he.setFieldsValue({ignoreReasonType:y==null?void 0:y.ignoreReasonType,ignoreReason:y==null?void 0:y.ignoreReason})},[Me,y]),(0,s.jsxs)(s.Fragment,{children:[C,(0,s.jsxs)(oe.Y,{labelCol:{span:J.locale==="en-US"?6:4},title:J.formatMessage({id:"risk.module.text.ignore.risk"}),width:520,form:he,modalProps:{destroyOnClose:!0,onCancel:function(){return ae()},styles:{body:{paddingTop:12}}},open:Me,onFinish:Ne,layout:"horizontal",children:[(0,s.jsx)(re.Z,{label:J.formatMessage({id:"risk.module.text.ignore.type"}),name:"ignoreReasonType",rules:[{required:!0}],options:m.$G}),(0,s.jsx)(ue.Z,{label:J.formatMessage({id:"risk.module.text.ignore.reason"}),name:"ignoreReason",rules:[{required:!0}],fieldProps:{rows:6}})]})]})},U=a,Se=t(92086),qe=t(77603),Y=t(92635),de=t(79930),ce=t(96655),B=t(17910),I=t(29448),me=t(68795),ve=t(39380),ge=t(93410),j=t(90498),ke=t(75302),be=t(3303),fe=t(86250),we=t(34041),Ze=t(57381),F=t(83622),L=t(96074),Be=t(86738),ye=t(71230),Ee=t(15746),Ce=t(84567),Ae=t(47908),Te=ke.ZP.useBreakpoint,Le=be.Z.SHOW_CHILD,je=function(){var r,O=Te(),K=(0,v.useModel)("rule"),ne=K.platformList,C=K.ruleGroupList,xe=K.ruleTypeList,Ve=(0,v.useRequest)(function(){return(0,ce.queryAllTenantSelectRuleList)({})},{formatResult:function(n){var e;return((e=n.content)===null||e===void 0?void 0:e.map(function(i){return o()(o()({},i),{},{key:i==null?void 0:i.id,label:i==null?void 0:i.ruleName,value:i==null?void 0:i.ruleCode})}))||[]}}),he=Ve.data,J=(0,v.useLocation)(),Me=J.search,y=new URLSearchParams(Me),Ie=y.get("riskLevel"),$=y.get("platform"),pe=y.get("ruleCode"),ae=y.get("resourceId"),Ne=z.ZP.useMessage(),X=g()(Ne,2),G=X[0],Oe=X[1],_=(0,x.useRef)(),h=(0,x.useRef)(),De=T.Z.useForm(),et=g()(De,1),c=et[0],u=(0,v.useIntl)(),Ot=(0,x.useState)(!1),tt=g()(Ot,2),_t=tt[0],st=tt[1],rt=(0,x.useRef)({}),Pt=(0,x.useState)(!1),nt=g()(Pt,2),St=nt[0],at=nt[1],it=(0,x.useRef)({}),lt=(0,x.useRef)({}),kt=(0,x.useState)(!1),ot=g()(kt,2),bt=ot[0],ut=ot[1],wt=(0,x.useState)({}),dt=g()(wt,2),We=dt[0],Ue=dt[1],Zt=(0,x.useState)((r=m.MW[0])===null||r===void 0?void 0:r.value),ct=g()(Zt,2),ie=ct[0],Bt=ct[1],Ft=(0,x.useState)(!1),mt=g()(Ft,2),Vt=mt[0],vt=mt[1],Nt=function(){var l=A()(f()().mark(function n(e){var i,d,D;return f()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return i={riskId:e.id},E.next=3,(0,Z.cancelIgnoreRisk)(i);case 3:d=E.sent,d.code===200&&d.msg==="success"&&(G.success(u.formatMessage({id:"risk.message.api.cancel.ignore.risk.success"})),_==null||(D=_.current)===null||D===void 0||D.reload());case 5:case"end":return E.stop()}},n)}));return function(e){return l.apply(this,arguments)}}(),Wt=(0,x.useState)([]),gt=g()(Wt,2),Ut=gt[0],Ke=gt[1],Kt=(0,v.useRequest)(function(l){return(0,de.queryGroupTypeList)({platformList:l})},{manual:!0,formatResult:function(n){var e=n.content;Ke(e||[])}}),ft=Kt.run;(0,x.useEffect)(function(){if((0,R.isEmpty)($)||(c==null||c.setFieldValue("platformList",[$]),c.setFieldValue("resourceType",null),Ke([]),ft([$])),(0,R.isEmpty)(Ie)||c==null||c.setFieldValue("riskLevelList",[Ie]),!(0,R.isEmpty)(pe)){var l;(l=h.current)===null||l===void 0||l.setFieldValue("ruleCodeList",[pe])}if(!(0,R.isEmpty)(ae)){var n;(n=h.current)===null||n===void 0||n.setFieldValue("resourceId",ae)}},[$,Ie,pe,ae]);var $e=(0,v.useRequest)(function(l){return(0,Y.cloudAccountBaseInfoList)(o()({},l))},{formatResult:function(n){if(n.msg==="success"){var e;return(n==null||(e=n.content)===null||e===void 0||(e=e.accountAliasList)===null||e===void 0?void 0:e.map(function(i){return{label:i,value:i}}))||[]}}}),$t=$e.data,xt=$e.run,Gt=$e.loading,Qt=(0,x.useMemo)(function(){var l=function(e){xt({platformList:c.getFieldValue("platformList")||[],cloudAccountSearch:e})};return(0,R.debounce)(l,500)},[Y.cloudAccountBaseInfoList]),ht=(0,v.useRequest)(function(l){return(0,Z.listRuleStatistics)(o()({},l))},{manual:!0,formatResult:function(n){var e,i=[];return i=n==null||(e=n.content)===null||e===void 0?void 0:e.map(function(d){return{label:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)("span",{children:d==null?void 0:d.ruleName}),(0,s.jsx)(fe.Z,{align:"center",children:(0,s.jsx)(k.Z,{color:(0,I.nn)(B.I9,d==null?void 0:d.riskLevel),style:{margin:"0 0 0 8px"},children:(d==null?void 0:d.count)||"-"})})]}),value:d.ruleId}}),i}}),zt=ht.data,Yt=ht.run,Ht=function(){var l=A()(f()().mark(function n(){var e,i;return f()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:i=o()(o()({status:ie},c==null?void 0:c.getFieldsValue()),h==null||(e=h.current)===null||e===void 0?void 0:e.getFieldsValue()),vt(!0),(0,Z.exportRiskList)(o()({},i),{responseType:"blob"}).then(function(M){if(M.type==="application/json"){var E=new FileReader;E.onload=function(){try{var _e=JSON.parse(E.result);G.error(_e.msg||u.formatMessage({id:"common.message.text.export.failed"}))}catch(Ge){G.error(u.formatMessage({id:"common.message.text.export.failed"}))}},E.readAsText(M)}else(0,I.Uc)(M,"CloudRec ".concat(u.formatMessage({id:"risk.module.text.risk.data"}))),G.success(u.formatMessage({id:"common.message.text.export.success"}))}).catch(function(M){G.error(u.formatMessage({id:"common.message.text.export.failed"})),console.error("Export failed:",M)}).finally(function(){return vt(!1)});case 3:case"end":return D.stop()}},n)}));return function(){return l.apply(this,arguments)}}(),Jt=(0,x.useState)(),Mt=g()(Jt,2),Xt=Mt[0],qt=Mt[1],es=function(){var l=A()(f()().mark(function n(e){var i,d;return f()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!e){M.next=4;break}return d=o()(o()({status:ie},c==null?void 0:c.getFieldsValue()),h==null||(i=h.current)===null||i===void 0?void 0:i.getFieldsValue()),M.next=4,Yt(d);case 4:case"end":return M.stop()}},n)}));return function(e){return l.apply(this,arguments)}}(),ts=function(){return{filterDropdown:function(e){var i=e.confirm;return(0,s.jsx)("div",{style:{padding:8},onKeyDown:function(D){return D.stopPropagation()},children:(0,s.jsx)(we.Z,{maxTagCount:"responsive",allowClear:!0,mode:"multiple",placeholder:u.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:zt||[],onChange:(0,R.debounce)(function(d){qt(d),i()},1e3),style:{minWidth:180}})})},filterDropdownProps:{onOpenChange:es},filterIcon:function(e){return(0,s.jsx)(me.Z,{style:{color:e?"#1677ff":void 0}})},destroyOnClose:!0}},ss=function(n){ut(!0),lt.current=n},rs=[o()({title:u.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){var i;return(0,s.jsxs)(fe.Z,{align:"center",children:[(0,s.jsx)("img",{src:(e==null?void 0:e.icon)||p.Z,alt:"RESOURCE_ICON",style:{width:18,height:18}}),(0,s.jsx)(se.Z,{text:(e==null||(i=e.ruleVO)===null||i===void 0?void 0:i.ruleName)||"-",maxWidth:O!=null&&O.xxl?280:240,rows:1,style:{color:"#333",fontSize:14,marginLeft:8},placement:"topLeft"})]})}},ts()),{title:u.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",valueEnum:(0,I.W_)(he),hideInTable:!0,fieldProps:{mode:"multiple"}},{title:u.formatMessage({id:"risk.module.text.firstAndLast.discovered"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,s.jsxs)("div",{children:[(0,s.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,s.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:u.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonTypeList",valueType:"checkbox",valueEnum:(0,I.W_)(m.$G),align:"left",hideInTable:!0,hideInSearch:ie!=="IGNORED"},{title:u.formatMessage({id:"layout.routes.title.ruleGroup"}),dataIndex:"ruleGroupIdList",valueType:"select",valueEnum:(0,I.W_)(C),hideInTable:!0,fieldProps:{mode:"multiple"}},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeList",valueType:"cascader",align:"left",hideInTable:!0,fieldProps:{multiple:!0,showCheckedStrategy:Le,options:Ut,showSearch:!0,allowClear:!0}},{title:u.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),dataIndex:"ruleTypeIdList",valueType:"cascader",hideInTable:!0,fieldProps:{multiple:!0,options:xe,showCheckedStrategy:Le,fieldNames:{label:"typeName",value:"id",children:"childList"}}},{title:u.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"select",fieldProps:{placeholder:u.formatMessage({id:"common.select.query.text.placeholder"}),showSearch:!0,notFoundContent:Gt&&(0,s.jsx)(Ze.Z,{size:"small"}),onSearch:Qt,options:$t||[]},align:"left",render:function(n,e){return(0,s.jsxs)("div",{children:[(0,s.jsx)("section",{style:{color:"rgb(51, 51, 51)"},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,s.jsxs)(fe.Z,{style:{fontSize:"12px",color:"#999"},children:[(0,I.c5)(e.platform,ne),(e==null?void 0:e.alias)||"-"]})]})}},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,s.jsx)(te.Z,{text:e==null?void 0:e.resourceType})}},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceName",valueType:"text",align:"left",width:200,render:function(n,e){return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(b.Z,{placement:"topLeft",maxWidth:400,rows:1,text:(0,s.jsxs)(s.Fragment,{children:[e.resourceName||"-",(0,s.jsx)(W,{status:e==null?void 0:e.resourceStatus})]}),tooltipText:(e==null?void 0:e.resourceStatus)===m.Bj[1].value?"(".concat(u.formatMessage({id:"risk.module.text.not.exist"}),") ")+e.resourceName:e.resourceName||"-"})})}},{title:u.formatMessage({id:"common.table.columns.assetId"}),dataIndex:"resourceId",valueType:"text",align:"left",hideInTable:!0},{title:u.formatMessage({id:"common.table.columns.assetStatus"}),dataIndex:"resourceStatus",valueType:"select",valueEnum:(0,I.W_)(m.Bj),align:"left",hideInTable:!0},{title:u.formatMessage({id:"risk.module.text.first.discovery"}),dataIndex:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0,fieldProps:{presets:B.El},search:{transform:function(n){return{gmtCreateStart:n[0],gmtCreateEnd:n[1]}}}},{title:u.formatMessage({id:"risk.module.text.recently.discovery"}),dataIndex:"modifiedTimeRange",valueType:"dateTimeRange",hideInTable:!0,fieldProps:{presets:B.El},search:{transform:function(n){return{gmtModifiedStart:n[0],gmtModifiedEnd:n[1]}}}},{title:u.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"text",align:"center",hideInSearch:!0,render:function(n,e){var i;return(0,I.Dd)(B.I9,e==null||(i=e.ruleVO)===null||i===void 0?void 0:i.riskLevel)}},{title:u.formatMessage({id:"risk.module.text.risk.status"}),dataIndex:"status",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,I.Ff)(m.MW,e==null?void 0:e.status)}},{title:u.formatMessage({id:"risk.module.text.ignore.reason"}),dataIndex:"ignoreReason",valueType:"text",align:"left",hideInSearch:!0,hideInTable:ie!=="IGNORED",render:function(n,e){return(0,s.jsx)(se.Z,{placement:"topLeft",text:e.ignoreReason||"-",maxWidth:210})}},{title:u.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonType",valueType:"select",valueEnum:(0,I.W_)(m.$G),align:"left",hideInSearch:!0,hideInTable:ie!=="IGNORED"},{title:u.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(n,e){var i;return(0,s.jsxs)(s.Fragment,{children:[!((i=["WHITED"])!==null&&i!==void 0&&i.includes(e.status))&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.ZP,{size:"small",type:"link",onClick:function(){return ss({riskId:e==null?void 0:e.id})},children:u.formatMessage({id:"common.button.text.white"})}),(0,s.jsx)(L.Z,{type:"vertical"})]}),e.status==="IGNORED"?(0,s.jsx)(Be.Z,{title:(0,s.jsx)(s.Fragment,{}),description:u.formatMessage({id:"risk.module.text.cancel.ignore"}),onConfirm:function(){return Nt(e)},onCancel:function(){},okText:u.formatMessage({id:"common.button.text.ok"}),cancelText:u.formatMessage({id:"common.button.text.cancel"}),children:(0,s.jsx)(F.ZP,{size:"small",type:"link",children:u.formatMessage({id:"common.button.text.cancelIgnore"})})}):(0,s.jsx)(F.ZP,{size:"small",type:"link",onClick:function(){it.current=o()({},e),at(!0)},children:u.formatMessage({id:"common.button.text.ignore"})}),(0,s.jsx)(L.Z,{type:"vertical"}),(0,s.jsx)(F.ZP,{size:"small",type:"link",target:"_self",onClick:function(){st(!0),rt.current=o()({},e)},children:u.formatMessage({id:"common.button.text.detail"})})]})}}],ns=function(){var l=A()(f()().mark(function n(e){var i,d,D,M,E,_e,Ge,It,pt,Qe,Dt,Rt,yt,Pe,Et,Ct,At,Tt,Lt,ze,Ye,He,Je,q,Xe,ee,jt;return f()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return D=e.pageSize,M=e.current,E=e.ruleId,_e=e.ruleGroupIdList,Ge=e.cloudAccountId,It=e.resourceName,pt=e.resourceTypeList,Qe=e.status,Dt=Qe===void 0?"UNREPAIRED":Qe,Rt=e.ignoreReasonTypeList,yt=e.ruleTypeIdList,Pe=e.ruleIdList,Et=e.gmtCreateStart,Ct=e.gmtCreateEnd,At=e.gmtModifiedStart,Tt=e.gmtModifiedEnd,Lt=e.resourceStatus,ze=c.getFieldValue("platformList"),Ye=c.getFieldValue("riskLevelList"),He=(i=h.current)===null||i===void 0?void 0:i.getFieldValue("ruleCodeList"),Je=(d=h.current)===null||d===void 0?void 0:d.getFieldValue("resourceId"),q={page:M,size:D,ruleId:E,ruleGroupIdList:_e,cloudAccountId:Ge,resourceName:It,resourceTypeList:pt,status:Dt,ignoreReasonTypeList:Rt,ruleTypeIdList:yt,gmtCreateStart:Et,gmtCreateEnd:Ct,gmtModifiedStart:At,gmtModifiedEnd:Tt,resourceStatus:Lt},ze&&(q.platformList=ze),Ye&&(q.riskLevelList=Ye),He&&(q.ruleCodeList=He),Je&&(q.resourceId=Je),Pe&&!(0,R.isEmpty)(Pe)&&(q.ruleIdList=Pe),le.next=13,(0,Z.queryRiskList)(q);case 13:return Xe=le.sent,ee=Xe.content,jt=Xe.code,le.abrupt("return",{data:(ee==null?void 0:ee.data)||[],total:(ee==null?void 0:ee.total)||0,success:jt===200||!1});case 17:case"end":return le.stop()}},n)}));return function(e){return l.apply(this,arguments)}}();return(0,s.jsxs)(ve._z,{title:!1,className:Ae.Z.riskPageContainer,breadcrumbRender:!1,children:[Oe,(0,s.jsx)(ge.Z,{bodyStyle:{paddingBlock:0},className:Ae.Z.customFilterCard,tabs:{activeKey:ie,items:m.MW.map(function(l){return{label:l.label,key:l.value,children:(0,s.jsx)(T.Z,{form:c,children:(0,s.jsxs)(ye.Z,{gutter:[24,10],children:[(0,s.jsx)(Ee.Z,{span:24,children:(0,s.jsx)(T.Z.Item,{name:"platformList",label:u.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,s.jsx)(Ce.Z.Group,{options:(0,I.T$)(ne),onChange:function(e){c.setFieldValue("resourceTypeList",null),Ke([]),ft(e),xt({platformList:e||[]})}})})}),(0,s.jsx)(Ee.Z,{span:24,children:(0,s.jsx)(T.Z.Item,{name:"riskLevelList",label:u.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,s.jsx)(Ce.Z.Group,{options:(0,I.at)(B.I9)})})})]})})}})||[],onChange:function(n){var e,i,d;Bt(n),(e=h.current)===null||e===void 0||e.setFieldValue("ignoreReasonTypeList",[]);var D=c.getFieldsValue(),M=((i=h.current)===null||i===void 0?void 0:i.getFieldsValue())||{},E=o()(o()(o()(o()({},We),D),M),{},{status:n,ignoreReasonTypeList:[]});Ue(E),(d=_.current)===null||d===void 0||d.reload()}}}),(0,s.jsx)(j.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},headerTitle:(0,s.jsx)("div",{className:Q.Z.customTitle,children:u.formatMessage({id:"risk.module.text.risk.inquiry"})}),toolBarRender:function(){return[(0,s.jsx)(F.ZP,{type:"primary",loading:Vt,onClick:Ht,children:u.formatMessage({id:"common.button.text.export"})},"export")]},actionRef:_,formRef:h,columns:rs,request:ns,onReset:function(){c.resetFields(),Ue({})},onSubmit:function(){var n=c.getFieldsValue();Ue(o()(o()({},We),n))},params:o()(o()({},We),{},{ruleIdList:Xt}),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}}),(0,s.jsx)(Se.Z,{locate:"risk",riskDrawerVisible:_t,setRiskDrawerVisible:st,riskDrawerInfo:rt.current,tableActionRef:_}),(0,s.jsx)(U,{ignoreRiskFormVisible:St,setIgnoreRiskFormVisible:at,riskInfo:it.current,tableActionRef:_}),(0,s.jsx)(qe.Z,{editDrawerVisible:bt,setEditDrawerVisible:ut,whiteListDrawerInfo:lt.current,tableActionRef:_})]})},Fe=je},70501:function(Re,P,t){var V=t(62435),f=Object.defineProperty,S=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,g=(p,m,v)=>m in p?f(p,m,{enumerable:!0,configurable:!0,writable:!0,value:v}):p[m]=v,w=(p,m)=>{for(var v in m||(m={}))A.call(m,v)&&g(p,v,m[v]);if(S)for(var v of S(m))N.call(m,v)&&g(p,v,m[v]);return p};const o=p=>React.createElement("svg",w({className:"DEFAULT_RESOURCE_ICON_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:256,height:256},p),React.createElement("path",{d:"M827.52 782.08a39.84 39.84 0 0 0 56.64 0l104.32-103.36a119.68 119.68 0 0 0 0-170.08L886.4 405.92a40 40 0 0 0-56.8 56.16l90.88 92h-322.4a40 40 0 0 0 0 80h322.24l-92.48 91.52a40 40 0 0 0-.32 56.48z",fill:"#1480ED"}),React.createElement("path",{d:"M864 80h-52V40a40 40 0 0 0-80 0v40H550.08V40a40 40 0 0 0-80 0v40h-180V40a40 40 0 1 0-80 0v40H160A160 160 0 0 0 0 240v624a160 160 0 0 0 160 160h704a160 160 0 0 0 160-160 40 40 0 0 0-80 0 80 80 0 0 1-80 80H160a80 80 0 0 1-80-80V240a80 80 0 0 1 80-80h50.08v40a40 40 0 0 0 80 0v-40h180v40a40 40 0 0 0 80 0v-40H732v40a40 40 0 0 0 80 0v-40h52a80 80 0 0 1 80 80v90.08a40 40 0 0 0 80 0V240A160 160 0 0 0 864 80z",fill:"#2A5699"}));P.Z="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiI+PHBhdGggZD0iTTgyNy41MiA3ODIuMDhhMzkuODQgMzkuODQgMCAwIDAgNTYuNjQgMGwxMDQuMzItMTAzLjM2YTExOS42OCAxMTkuNjggMCAwIDAgMC0xNzAuMDhMODg2LjQgNDA1LjkyYTQwIDQwIDAgMCAwLTU2LjggNTYuMTZsOTAuODggOTJoLTMyMi40YTQwIDQwIDAgMCAwIDAgODBoMzIyLjI0bC05Mi40OCA5MS41MmE0MCA0MCAwIDAgMC0uMzIgNTYuNDh6IiBmaWxsPSIjMTQ4MEVEIi8+PHBhdGggZD0iTTg2NCA4MGgtNTJWNDBhNDAgNDAgMCAwIDAtODAgMHY0MEg1NTAuMDhWNDBhNDAgNDAgMCAwIDAtODAgMHY0MGgtMTgwVjQwYTQwIDQwIDAgMSAwLTgwIDB2NDBIMTYwQTE2MCAxNjAgMCAwIDAgMCAyNDB2NjI0YTE2MCAxNjAgMCAwIDAgMTYwIDE2MGg3MDRhMTYwIDE2MCAwIDAgMCAxNjAtMTYwIDQwIDQwIDAgMCAwLTgwIDAgODAgODAgMCAwIDEtODAgODBIMTYwYTgwIDgwIDAgMCAxLTgwLTgwVjI0MGE4MCA4MCAwIDAgMSA4MC04MGg1MC4wOHY0MGE0MCA0MCAwIDAgMCA4MCAwdi00MGgxODB2NDBhNDAgNDAgMCAwIDAgODAgMHYtNDBINzMydjQwYTQwIDQwIDAgMCAwIDgwIDB2LTQwaDUyYTgwIDgwIDAgMCAxIDgwIDgwdjkwLjA4YTQwIDQwIDAgMCAwIDgwIDBWMjQwQTE2MCAxNjAgMCAwIDAgODY0IDgweiIgZmlsbD0iIzJBNTY5OSIvPjwvc3ZnPg=="}}]);
