(self.webpackChunk=self.webpackChunk||[]).push([[7530],{52078:function(ee,_,t){"use strict";var L=t(97857),h=t.n(L),D=t(27997),x=t(62435),N=t(86074),m=function(i){D.Mj.register({id:"json"});var A=i.value,v=A===void 0?"{}":A,g=i.onChange,C=i.editorStyle,O=C===void 0?{}:C,r=i.editorKey,H=r===void 0?"json-editor":r,Z=i.readOnly,f=Z===void 0?!1:Z,j=(0,x.useRef)(),I=(0,x.useRef)(),w=function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(G),G}catch(M){return console.warn("Invalid JSON string:",M),"{}"}};return(0,x.useEffect)(function(){if(j.current)return I.current?I.current.setValue(v):(I.current=D.j6.create(j.current,{value:w(v),language:"json",theme:"vs",readOnly:f,folding:!0,automaticLayout:!0}),I.current.onDidChangeModelContent(function(){var E=I.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:E}),g==null||g(E)})),function(){if(I!=null&&I.current){var E;I==null||(E=I.current)===null||E===void 0||E.dispose(),I.current=null}}},[]),(0,x.useEffect)(function(){I.current&&v!==I.current.getValue()&&I.current.setValue(w(v))},[v]),(0,N.jsx)("div",{ref:j,style:h()({height:360,borderRadius:4,overflow:"hidden"},O)},H)};_.Z=m},29297:function(ee,_,t){"use strict";t.d(_,{q9:function(){return L.Z},Wy:function(){return i},mi:function(){return C}});var L=t(52078),h=t(97857),D=t.n(h),x=t(55171),N=t.n(x),m=t(86074),Q=function(r){var H=r.value,Z=r.viewerStyle,f=Z===void 0?{}:Z,j=r.displayDataTypes,I=j===void 0?!1:j,w=r.name,E=w===void 0?"output json":w;return(0,m.jsx)(N(),{src:H,name:E,collapsed:!1,displayDataTypes:I,style:D()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},f)})},i=Q,A=t(27997),v=t(62435),g=function(r){A.Mj.register({id:"rego"});var H=r.value,Z=r.onChange,f=r.editorStyle,j=f===void 0?{}:f,I=r.editorKey,w=r.readOnly,E=w===void 0?!1:w,G=(0,v.useRef)(),M=(0,v.useRef)();return(0,v.useEffect)(function(){if(G.current)return M.current||(M.current=A.j6.create(G.current,{value:H,language:"rego",theme:"vs",readOnly:E,automaticLayout:!0}),M.current.onDidChangeModelContent(function(){Z==null||Z(M.current.getValue())})),function(){if(M.current){var U;(U=M.current)===null||U===void 0||U.dispose(),M.current=null}}},[]),(0,m.jsx)("div",{ref:G,style:D()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},j)},I)},C=g},40351:function(ee,_,t){"use strict";t.r(_),t.d(_,{default:function(){return Wt}});var L=t(15009),h=t.n(L),D=t(99289),x=t.n(D),N=t(5574),m=t.n(N),Q=t(97857),i=t.n(Q),A=t(70501),v=t(96364),g=t(45830),C=t(66309),O=t(53846),r=t(86074),H=function(Ze){var K=Ze.status,J=(0,r.jsx)(C.Z,{children:K||"-"});return[v.Bj[1].value].includes(K)?J=(0,r.jsx)(C.Z,{className:O.Z.invalidTag,style:{marginLeft:6},children:(0,r.jsx)(g.FormattedMessage,{id:"common.tag.text.noExist"})}):J=(0,r.jsx)(C.Z,{className:O.Z.validTag,style:{marginLeft:6},children:(0,r.jsx)(g.FormattedMessage,{id:"common.tag.text.exist"})}),J},Z=t(31732),f=t(24163),j=t(72028),I=t(37476),w=t(64317),E=t(90672),G=t(68872),M=t(23323),U=t(96486),R=t(62435),Oe=function(K){var J=G.ZP.useMessage(),fe=m()(J,2),Se=fe[0],Be=fe[1],We=M.Z.useForm(),_e=m()(We,1),De=_e[0],se=(0,g.useIntl)(),Ce=K.ignoreRiskFormVisible,P=K.riskInfo,me=K.setIgnoreRiskFormVisible,X=K.tableActionRef,ge=function(){De.resetFields()},ae=function(){me(!1),ge()},he=function(){var pe=x()(h()().mark(function Me(ne){var je,k,p;return h()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return je=i()(i()({},ne),{},{riskId:P.id}),oe.next=3,(0,j.ignoreRisk)(je);case 3:k=oe.sent,k.code===200&&k.msg==="success"&&(Se.success(se.formatMessage({id:"risk.message.api.ignore.risk.success"})),X==null||(p=X.current)===null||p===void 0||p.reload(),ae());case 5:case"end":return oe.stop()}},Me)}));return function(ne){return pe.apply(this,arguments)}}();return(0,R.useEffect)(function(){Ce&&!(0,U.isEmpty)(P)&&De.setFieldsValue({ignoreReasonType:P==null?void 0:P.ignoreReasonType,ignoreReason:P==null?void 0:P.ignoreReason})},[Ce,P]),(0,r.jsxs)(r.Fragment,{children:[Be,(0,r.jsxs)(I.Y,{labelCol:{span:se.locale==="en-US"?6:4},title:se.formatMessage({id:"risk.module.text.ignore.risk"}),width:520,form:De,modalProps:{destroyOnClose:!0,onCancel:function(){return ae()},styles:{body:{paddingTop:12}}},open:Ce,onFinish:he,layout:"horizontal",children:[(0,r.jsx)(w.Z,{label:se.formatMessage({id:"risk.module.text.ignore.type"}),name:"ignoreReasonType",rules:[{required:!0}],options:v.$G}),(0,r.jsx)(E.Z,{label:se.formatMessage({id:"risk.module.text.ignore.reason"}),name:"ignoreReason",rules:[{required:!0}],fieldProps:{rows:6}})]})]})},Re=Oe,we=t(57207),Fe=t(77603),be=t(64818),Ie=t(92635),Pe=t(79930),Ae=t(96655),le=t(17910),F=t(29448),b=t(68795),Te=t(39380),ke=t(93410),Ve=t(90498),Ne=t(75302),et=t(3303),ve=t(86250),te=t(34041),B=t(25593),re=t(57381),Y=t(83622),T=t(96074),Vt=t(86738),Nt=t(71230),tt=t(15746),rt=t(84567),nt=t(47908),Zt=Ne.ZP.useBreakpoint,lt=et.Z.SHOW_CHILD,Bt=function(){var K,J=Zt(),fe=(0,g.useModel)("rule"),Se=fe.platformList,Be=fe.ruleGroupList,We=fe.ruleTypeList,_e=(0,g.useRequest)(function(){return(0,Ae.queryAllTenantSelectRuleList)({})},{formatResult:function(n){var e;return((e=n.content)===null||e===void 0?void 0:e.map(function(l){return i()(i()({},l),{},{key:l==null?void 0:l.id,label:l==null?void 0:l.ruleName,value:l==null?void 0:l.ruleCode})}))||[]}}),De=_e.data,se=(0,g.useLocation)(),Ce=se.search,P=new URLSearchParams(Ce),me=P.get("riskLevel"),X=P.get("platform"),ge=P.get("ruleCode"),ae=P.get("resourceId"),he=P.get("cloudAccountId"),pe=G.ZP.useMessage(),Me=m()(pe,2),ne=Me[0],je=Me[1],k=(0,R.useRef)(),p=(0,R.useRef)(),st=M.Z.useForm(),oe=m()(st,1),y=oe[0],u=(0,g.useIntl)(),_t=(0,R.useState)(!1),at=m()(_t,2),Ut=at[0],ot=at[1],it=(0,R.useRef)({}),zt=(0,R.useState)(!1),ut=m()(zt,2),$t=ut[0],dt=ut[1],ct=(0,R.useRef)({}),vt=(0,R.useRef)({}),Gt=(0,R.useState)(!1),ft=m()(Gt,2),Kt=ft[0],mt=ft[1],Qt=(0,R.useState)(!1),gt=m()(Qt,2),Ht=gt[0],ht=gt[1],Yt=(0,R.useState)({}),pt=m()(Yt,2),yt=pt[0],Jt=pt[1],Xt=(0,R.useState)({}),xt=m()(Xt,2),Ee=xt[0],ie=xt[1],qt=(0,R.useState)((K=v.MW[0])===null||K===void 0?void 0:K.value),It=m()(qt,2),ue=It[0],er=It[1],tr=(0,R.useState)(!1),Dt=m()(tr,2),rr=Dt[0],Ct=Dt[1],nr=function(){var a=x()(h()().mark(function n(e){var l,s,o;return h()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return l={riskId:e.id},c.next=3,(0,j.cancelIgnoreRisk)(l);case 3:s=c.sent,s.code===200&&s.msg==="success"&&(ne.success(u.formatMessage({id:"risk.message.api.cancel.ignore.risk.success"})),k==null||(o=k.current)===null||o===void 0||o.reload());case 5:case"end":return c.stop()}},n)}));return function(e){return a.apply(this,arguments)}}(),lr=(0,R.useState)([]),Mt=m()(lr,2),sr=Mt[0],Ue=Mt[1],ar=(0,g.useRequest)(function(a){return(0,Pe.queryGroupTypeList)({platformList:a})},{manual:!0,formatResult:function(n){var e=n.content;Ue(e||[])}}),Rt=ar.run;(0,R.useEffect)(function(){var a={};if((0,U.isEmpty)(X)||(y==null||y.setFieldValue("platformList",[X]),y.setFieldValue("resourceType",null),Ue([]),Rt([X]),a.platformList=[X]),(0,U.isEmpty)(me)||(y==null||y.setFieldValue("riskLevelList",[me]),a.riskLevelList=[me]),!(0,U.isEmpty)(ge)){var n;(n=p.current)===null||n===void 0||n.setFieldValue("ruleCodeList",[ge]),a.ruleCodeList=[ge]}if(!(0,U.isEmpty)(ae)){var e;(e=p.current)===null||e===void 0||e.setFieldValue("resourceId",ae),a.resourceId=ae}if(!(0,U.isEmpty)(he)){var l;(l=p.current)===null||l===void 0||l.setFieldValue("cloudAccountId",he),a.cloudAccountId=he}Object.keys(a).length>0&&ie(a)},[X,me,ge,ae,he]);var ze=(0,g.useRequest)(function(a){return(0,Ie.cloudAccountBaseInfoList)(i()({},a))},{formatResult:function(n){if(n.msg==="success"){var e;return(n==null||(e=n.content)===null||e===void 0||(e=e.accountAliasList)===null||e===void 0?void 0:e.map(function(l){return{label:l,value:l}}))||[]}}}),or=ze.data,At=ze.run,ir=ze.loading,ur=(0,R.useMemo)(function(){var a=function(e){At({platformList:y.getFieldValue("platformList")||[],cloudAccountSearch:e})};return(0,U.debounce)(a,500)},[Ie.cloudAccountBaseInfoList]),Tt=(0,g.useRequest)(function(a){return(0,j.listRuleStatistics)(i()({},a))},{manual:!0,formatResult:function(n){var e=(n==null?void 0:n.content)||[];gr(e);var l=[];return l=e.map(function(s){return{label:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:s==null?void 0:s.ruleName}),(0,r.jsx)(ve.Z,{align:"center",children:(0,r.jsx)(C.Z,{color:(0,F.nn)(le.I9,s==null?void 0:s.riskLevel),style:{margin:"0 0 0 8px"},children:(s==null?void 0:s.count)||"-"})})]}),value:s.ruleCode}}),l}}),dr=Tt.data,cr=Tt.run,vr=(0,R.useState)([]),St=m()(vr,2),$e=St[0],fr=St[1],mr=(0,R.useState)([]),jt=m()(mr,2),Ge=jt[0],gr=jt[1],Et=(0,g.useRequest)(function(a){return(0,j.listCloudAccountStatistics)(i()({},a))},{manual:!0,formatResult:function(n){var e=(n==null?void 0:n.content)||[];fr(e);var l=[];return l=e.map(function(s){return{label:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:(s==null?void 0:s.alias)||(s==null?void 0:s.cloudAccountId)}),(0,r.jsx)(ve.Z,{align:"center",children:(0,r.jsx)(C.Z,{style:{margin:"0 0 0 8px"},children:(s==null?void 0:s.count)||"-"})})]}),value:s.cloudAccountId}}),l}}),hr=Et.data,pr=Et.run,yr=function(){var a=x()(h()().mark(function n(){var e,l;return h()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:l=i()(i()({status:ue},y==null?void 0:y.getFieldsValue()),p==null||(e=p.current)===null||e===void 0?void 0:e.getFieldsValue()),Ct(!0),(0,j.exportRiskList)(i()({},l),{responseType:"blob"}).then(function(d){if(d.type==="application/json"){var c=new FileReader;c.onload=function(){try{var S=JSON.parse(c.result);ne.error(S.msg||u.formatMessage({id:"common.message.text.export.failed"}))}catch(z){ne.error(u.formatMessage({id:"common.message.text.export.failed"}))}},c.readAsText(d)}else(0,F.Uc)(d,"CloudRec ".concat(u.formatMessage({id:"risk.module.text.risk.data"}))),ne.success(u.formatMessage({id:"common.message.text.export.success"}))}).catch(function(d){ne.error(u.formatMessage({id:"common.message.text.export.failed"})),console.error("Export failed:",d)}).finally(function(){return Ct(!1)});case 3:case"end":return o.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),xr=function(){var a=x()(h()().mark(function n(e){var l,s;return h()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!e){d.next=4;break}return s=i()(i()({status:ue},y==null?void 0:y.getFieldsValue()),p==null||(l=p.current)===null||l===void 0?void 0:l.getFieldsValue()),d.next=4,cr(s);case 4:case"end":return d.stop()}},n)}));return function(e){return a.apply(this,arguments)}}(),Ir=function(){var a=x()(h()().mark(function n(e){var l,s,o;return h()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!e){c.next=6;break}return o=i()(i()({status:ue},y==null?void 0:y.getFieldsValue()),p==null||(l=p.current)===null||l===void 0?void 0:l.getFieldsValue()),!o.ruleCodeList&&(s=p.current)!==null&&s!==void 0&&s.getFieldValue("ruleCodeList")&&(o.ruleCodeList=p.current.getFieldValue("ruleCodeList")),o.ruleIdList&&delete o.ruleIdList,c.next=6,pr(o);case 6:case"end":return c.stop()}},n)}));return function(e){return a.apply(this,arguments)}}(),Dr=function(){return{filterDropdown:function(e){var l=e.confirm;return(0,r.jsx)("div",{style:{padding:8},onKeyDown:function(o){return o.stopPropagation()},children:(0,r.jsx)(te.Z,{maxTagCount:"responsive",allowClear:!0,mode:"multiple",showSearch:!0,placeholder:u.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:dr||[],filterOption:function(o,d){var c,S=o.toLowerCase(),z=(d==null||(c=d.value)===null||c===void 0?void 0:c.toString().toLowerCase())||"",W=Ge==null?void 0:Ge.find(function(Le){return Le.ruleCode===(d==null?void 0:d.value)});if(W){var V,$,de=((V=W.ruleName)===null||V===void 0?void 0:V.toLowerCase())||"",ye=(($=W.ruleCode)===null||$===void 0?void 0:$.toLowerCase())||"";return de.includes(S)||ye.includes(S)||z.includes(S)}return z.includes(S)},onChange:function(o){var d,c;(d=p.current)===null||d===void 0||d.setFieldValue("ruleCodeList",o),ie(function(S){return i()(i()({},S),{},{ruleCodeList:o})}),(c=k.current)===null||c===void 0||c.reload(),l()},onBlur:function(){l()},style:{minWidth:320}})})},filterDropdownProps:{onOpenChange:xr},filterIcon:function(e){return(0,r.jsx)(b.Z,{style:{color:e?"#1677ff":"#1890ff",fontSize:"18px",fontWeight:"bold"}})},destroyOnClose:!0}},Cr=function(n){mt(!0),vt.current=n},Mr=[i()({title:u.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",width:400,valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){var l,s,o,d,c,S,z=function(){var V;if(e!=null&&(V=e.ruleVO)!==null&&V!==void 0&&V.id){var $;Jt({ruleId:e.ruleVO.id,ruleCode:($=e.ruleId)===null||$===void 0?void 0:$.toString()}),ht(!0)}};return(0,r.jsxs)(ve.Z,{align:"center",children:[(0,r.jsx)("img",{src:(e==null?void 0:e.icon)||A.Z,alt:"RESOURCE_ICON",style:{width:20,height:20}}),(0,r.jsx)(B.Z.Text,{copyable:e!=null&&(l=e.ruleVO)!==null&&l!==void 0&&l.ruleName?{text:e.ruleVO.ruleName}:!1,style:{color:e!=null&&(s=e.ruleVO)!==null&&s!==void 0&&s.id?"#1890ff":"#333",fontSize:14,marginLeft:8,maxWidth:J!=null&&J.xxl?450:400,cursor:e!=null&&(o=e.ruleVO)!==null&&o!==void 0&&o.id?"pointer":"default"},ellipsis:{tooltip:(e==null||(d=e.ruleVO)===null||d===void 0?void 0:d.ruleName)||"-"},onClick:e!=null&&(c=e.ruleVO)!==null&&c!==void 0&&c.id?z:void 0,children:(e==null||(S=e.ruleVO)===null||S===void 0?void 0:S.ruleName)||"-"})]})}},Dr()),{title:u.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",valueEnum:(0,F.W_)(De),hideInTable:!0,colSize:2,fieldProps:{mode:"multiple"}},{title:u.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"select",colSize:1,fieldProps:{placeholder:u.formatMessage({id:"common.select.query.text.placeholder"}),showSearch:!0,notFoundContent:ir&&(0,r.jsx)(re.Z,{size:"small"}),onSearch:ur,options:or||[],onChange:function(n){ie(function(e){return i()(i()({},e),{},{cloudAccountId:n})})}},align:"left",filterDropdown:function(n){var e=n.confirm;return(0,r.jsx)("div",{style:{padding:8},onKeyDown:function(s){return s.stopPropagation()},children:(0,r.jsx)(te.Z,{allowClear:!0,showSearch:!0,placeholder:u.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:hr||[],filterOption:function(s,o){var d,c=s.toLowerCase(),S=(o==null||(d=o.value)===null||d===void 0?void 0:d.toString().toLowerCase())||"",z=$e==null?void 0:$e.find(function(ye){return ye.cloudAccountId===(o==null?void 0:o.value)});if(z){var W,V,$=((W=z.alias)===null||W===void 0?void 0:W.toLowerCase())||"",de=((V=z.cloudAccountId)===null||V===void 0?void 0:V.toLowerCase())||"";return $.includes(c)||de.includes(c)||S.includes(c)}return S.includes(c)},onChange:function(s){var o,d;(o=p.current)===null||o===void 0||o.setFieldValue("cloudAccountId",s),ie(function(c){return i()(i()({},c),{},{cloudAccountId:s})}),(d=k.current)===null||d===void 0||d.reload(),e()},onBlur:function(){e()},style:{minWidth:320}})})},filterDropdownProps:{onOpenChange:Ir},filterIcon:function(n){return(0,r.jsx)(b.Z,{style:{color:n?"#1677ff":"#1890ff",fontSize:"18px",fontWeight:"bold"}})},render:function(n,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)(B.Z.Text,{copyable:e!=null&&e.cloudAccountId?{text:e.cloudAccountId}:!1,style:{color:"rgb(51, 51, 51)"},ellipsis:{tooltip:(e==null?void 0:e.cloudAccountId)||"-"},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,r.jsxs)(ve.Z,{style:{fontSize:"12px",color:"#999"},children:[(0,F.c5)(e.platform,Se),(e==null?void 0:e.alias)||"-"]})]})}},{title:u.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),dataIndex:"ruleTypeIdList",valueType:"cascader",hideInTable:!0,colSize:1,fieldProps:{multiple:!0,options:We,showCheckedStrategy:lt,fieldNames:{label:"typeName",value:"id",children:"childList"}}},{title:u.formatMessage({id:"layout.routes.title.ruleGroup"}),dataIndex:"ruleGroupIdList",valueType:"select",valueEnum:(0,F.W_)(Be),hideInTable:!0,colSize:1,fieldProps:{mode:"multiple"}},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeList",valueType:"cascader",align:"left",hideInTable:!0,colSize:1,fieldProps:{multiple:!0,showCheckedStrategy:lt,options:sr,showSearch:!0,allowClear:!0}},{title:u.formatMessage({id:"common.table.columns.assetId"}),dataIndex:"resourceId",valueType:"text",align:"left",hideInTable:!0,colSize:1},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceName",valueType:"text",align:"left",hideInTable:!0,colSize:1},{title:u.formatMessage({id:"risk.module.text.firstAndLast.discovered"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,r.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:u.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonTypeList",valueType:"checkbox",valueEnum:(0,F.W_)(v.$G),align:"left",hideInTable:!0,hideInSearch:ue!=="IGNORED",colSize:6},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,r.jsx)(Z.Z,{text:e==null?void 0:e.resourceType})}},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceNameDisplay",valueType:"text",align:"left",width:300,hideInSearch:!0,render:function(n,e){var l=(e==null?void 0:e.resourceStatus)===v.Bj[1].value?"(".concat(u.formatMessage({id:"risk.module.text.not.exist"}),") ")+e.resourceName:e.resourceName||"-";return(0,r.jsxs)(ve.Z,{align:"center",children:[(0,r.jsx)(B.Z.Text,{copyable:e!=null&&e.resourceName?{text:e.resourceName}:!1,style:{maxWidth:450},ellipsis:{tooltip:l},children:e.resourceName||"-"}),(0,r.jsx)(H,{status:e==null?void 0:e.resourceStatus})]})}},{title:u.formatMessage({id:"risk.module.text.first.discovery"}),dataIndex:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0,colSize:1,fieldProps:{presets:le.El},search:{transform:function(n){return{gmtCreateStart:n[0],gmtCreateEnd:n[1]}}}},{title:u.formatMessage({id:"risk.module.text.recently.discovery"}),dataIndex:"modifiedTimeRange",valueType:"dateTimeRange",hideInTable:!0,colSize:1,fieldProps:{presets:le.El},search:{transform:function(n){return{gmtModifiedStart:n[0],gmtModifiedEnd:n[1]}}}},{title:u.formatMessage({id:"common.table.columns.assetStatus"}),dataIndex:"resourceStatus",valueType:"select",valueEnum:(0,F.W_)(v.Bj),align:"left",hideInTable:!0,colSize:1},{title:u.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"text",align:"center",hideInSearch:!0,render:function(n,e){var l;return(0,F.Dd)(le.I9,e==null||(l=e.ruleVO)===null||l===void 0?void 0:l.riskLevel)}},{title:u.formatMessage({id:"risk.module.text.risk.status"}),dataIndex:"status",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,F.Ff)(v.MW,e==null?void 0:e.status)}},{title:u.formatMessage({id:"risk.module.text.ignore.reason"}),dataIndex:"ignoreReason",valueType:"text",align:"left",hideInSearch:!0,hideInTable:ue!=="IGNORED",render:function(n,e){return(0,r.jsx)(f.Z,{placement:"topLeft",text:e.ignoreReason||"-",maxWidth:210})}},{title:u.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonType",valueType:"select",valueEnum:(0,F.W_)(v.$G),align:"left",hideInSearch:!0,hideInTable:ue!=="IGNORED"},{title:u.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(n,e){var l;return(0,r.jsxs)(r.Fragment,{children:[!((l=["WHITED"])!==null&&l!==void 0&&l.includes(e.status))&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Y.ZP,{size:"small",type:"link",onClick:function(){return Cr({riskId:e==null?void 0:e.id})},children:u.formatMessage({id:"common.button.text.white"})}),(0,r.jsx)(T.Z,{type:"vertical"})]}),e.status==="IGNORED"?(0,r.jsx)(Vt.Z,{title:(0,r.jsx)(r.Fragment,{}),description:u.formatMessage({id:"risk.module.text.cancel.ignore"}),onConfirm:function(){return nr(e)},onCancel:function(){},okText:u.formatMessage({id:"common.button.text.ok"}),cancelText:u.formatMessage({id:"common.button.text.cancel"}),children:(0,r.jsx)(Y.ZP,{size:"small",type:"link",children:u.formatMessage({id:"common.button.text.cancelIgnore"})})}):(0,r.jsx)(Y.ZP,{size:"small",type:"link",onClick:function(){ct.current=i()({},e),dt(!0)},children:u.formatMessage({id:"common.button.text.ignore"})}),(0,r.jsx)(T.Z,{type:"vertical"}),(0,r.jsx)(Y.ZP,{size:"small",type:"link",target:"_self",onClick:function(){ot(!0),it.current=i()({},e)},children:u.formatMessage({id:"common.button.text.detail"})})]})}}],Rr=function(){var a=x()(h()().mark(function n(e){var l,s,o,d,c,S,z,W,V,$,de,ye,Le,Lt,Ot,wt,Ft,bt,Pt,Ke,Qe,He,Ye,q,Je,Xe,qe,ce,kt;return h()().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return d=e.pageSize,c=e.current,S=e.ruleId,z=e.ruleGroupIdList,W=e.cloudAccountId,V=e.resourceName,$=e.resourceTypeList,de=e.status,ye=de===void 0?"UNREPAIRED":de,Le=e.ignoreReasonTypeList,Lt=e.ruleTypeIdList,Ot=e.gmtCreateStart,wt=e.gmtCreateEnd,Ft=e.gmtModifiedStart,bt=e.gmtModifiedEnd,Pt=e.resourceStatus,Ke=y.getFieldValue("platformList"),Qe=y.getFieldValue("riskLevelList"),He=(l=p.current)===null||l===void 0?void 0:l.getFieldValue("ruleCodeList"),Ye=(s=p.current)===null||s===void 0?void 0:s.getFieldValue("resourceId"),q={page:c,size:d,ruleId:S,ruleGroupIdList:z,cloudAccountId:W,resourceName:V,resourceTypeList:$,status:ye,ignoreReasonTypeList:Le,ruleTypeIdList:Lt,gmtCreateStart:Ot,gmtCreateEnd:wt,gmtModifiedStart:Ft,gmtModifiedEnd:bt,resourceStatus:Pt},Ke&&(q.platformList=Ke),Qe&&(q.riskLevelList=Qe),He&&(q.ruleCodeList=He),Ye&&(q.resourceId=Ye),Je=(o=p.current)===null||o===void 0?void 0:o.getFieldValue("cloudAccountId"),Xe=Ee.cloudAccountId,W?q.cloudAccountId=W:Je?q.cloudAccountId=Je:Xe&&(q.cloudAccountId=Xe),xe.next=15,(0,j.queryRiskList)(q);case 15:return qe=xe.sent,ce=qe.content,kt=qe.code,xe.abrupt("return",{data:(ce==null?void 0:ce.data)||[],total:(ce==null?void 0:ce.total)||0,success:kt===200||!1});case 19:case"end":return xe.stop()}},n)}));return function(e){return a.apply(this,arguments)}}();return(0,r.jsxs)(Te._z,{title:!1,className:nt.Z.riskPageContainer,breadcrumbRender:!1,children:[je,(0,r.jsx)(ke.Z,{bodyStyle:{paddingBlock:0},className:nt.Z.customFilterCard,tabs:{activeKey:ue,items:v.MW.map(function(a){return{label:a.label,key:a.value,children:(0,r.jsx)(M.Z,{form:y,children:(0,r.jsxs)(Nt.Z,{gutter:[24,10],children:[(0,r.jsx)(tt.Z,{span:24,children:(0,r.jsx)(M.Z.Item,{name:"platformList",label:u.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,r.jsx)(rt.Z.Group,{options:(0,F.T$)(Se),onChange:function(e){y.setFieldValue("resourceTypeList",null),Ue([]),Rt(e),At({platformList:e||[]})}})})}),(0,r.jsx)(tt.Z,{span:24,children:(0,r.jsx)(M.Z.Item,{name:"riskLevelList",label:u.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,r.jsx)(rt.Z.Group,{options:(0,F.at)(le.I9)})})})]})})}})||[],onChange:function(n){var e,l,s;er(n),(e=p.current)===null||e===void 0||e.setFieldValue("ignoreReasonTypeList",[]);var o=y.getFieldsValue(),d=((l=p.current)===null||l===void 0?void 0:l.getFieldsValue())||{},c=i()(i()(i()(i()({},Ee),o),d),{},{status:n,ignoreReasonTypeList:[]});ie(c),(s=k.current)===null||s===void 0||s.reload()}}}),(0,r.jsx)(Ve.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,labelWidth:0,defaultColsNumber:6},headerTitle:(0,r.jsx)("div",{className:O.Z.customTitle,children:u.formatMessage({id:"risk.module.text.risk.inquiry"})}),toolBarRender:function(){return[(0,r.jsx)(Y.ZP,{type:"primary",loading:rr,onClick:yr,children:u.formatMessage({id:"common.button.text.export"})},"export")]},actionRef:k,formRef:p,columns:Mr,request:Rr,onReset:function(){y.resetFields(),ie({})},onSubmit:function(){var n,e=y.getFieldsValue(),l=((n=p.current)===null||n===void 0?void 0:n.getFieldsValue())||{};ie(i()(i()(i()({},Ee),e),l))},params:i()({},Ee),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}}),(0,r.jsx)(we.Z,{locate:"risk",riskDrawerVisible:Ut,setRiskDrawerVisible:ot,riskDrawerInfo:it.current,tableActionRef:k}),(0,r.jsx)(Re,{ignoreRiskFormVisible:$t,setIgnoreRiskFormVisible:dt,riskInfo:ct.current,tableActionRef:k}),(0,r.jsx)(Fe.Z,{editDrawerVisible:Kt,setEditDrawerVisible:mt,whiteListDrawerInfo:vt.current,tableActionRef:k}),(0,r.jsx)(be.Z,{visible:Ht,onClose:function(){return ht(!1)},ruleId:yt.ruleId,ruleCode:yt.ruleCode})]})},Wt=Bt},64818:function(ee,_,t){"use strict";var L=t(15009),h=t.n(L),D=t(99289),x=t.n(D),N=t(5574),m=t.n(N),Q=t(62435),i=t(68872),A=t(66309),v=t(85265),g=t(57381),C=t(26412),O=t(25593),r=t(45830),H=t(96655),Z=t(29448),f=t(86074),j=function(w){var E=w.visible,G=w.onClose,M=w.ruleId,U=w.ruleCode,R=(0,r.useIntl)(),Oe=i.ZP.useMessage(),Re=m()(Oe,2),we=Re[0],Fe=Re[1],be=(0,Q.useState)(!1),Ie=m()(be,2),Pe=Ie[0],Ae=Ie[1],le=(0,Q.useState)(null),F=m()(le,2),b=F[0],Te=F[1];(0,Q.useEffect)(function(){E&&M&&ke()},[E,M]);var ke=function(){var te=x()(h()().mark(function B(){var re;return h()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(Ae(!0),T.prev=1,!M){T.next=6;break}return T.next=5,(0,H.queryRuleDetail)({id:M});case 5:re=T.sent;case 6:re&&re.content&&Te(re.content),T.next=12;break;case 9:T.prev=9,T.t0=T.catch(1),we.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return T.prev=12,Ae(!1),T.finish(12);case 15:case"end":return T.stop()}},B,null,[[1,9,12,15]])}));return function(){return te.apply(this,arguments)}}(),Ve=function(){Te(null),G()},Ne=function(B){switch(B.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},et=function(B){if(!B)return null;var re=B.split(",");return re.map(function(Y,T){return(0,f.jsx)(A.Z,{color:Ne(Y.trim()),children:Y.trim()},T)})},ve=function(B){return(0,Z.c5)(B)};return(0,f.jsxs)(f.Fragment,{children:[Fe,(0,f.jsx)(v.Z,{title:"\u89C4\u5219\u8BE6\u60C5",placement:"right",onClose:Ve,open:E,width:1e3,destroyOnClose:!0,children:(0,f.jsx)(g.Z,{spinning:Pe,children:b&&(0,f.jsxs)(C.Z,{column:1,bordered:!0,children:[(0,f.jsx)(C.Z.Item,{label:"\u89C4\u5219\u540D\u79F0",children:(0,f.jsx)(O.Z.Text,{copyable:!0,children:b.ruleName})}),(0,f.jsx)(C.Z.Item,{label:"\u89C4\u5219code",children:(0,f.jsx)(O.Z.Text,{copyable:!0,children:b.ruleCode})}),(0,f.jsx)(C.Z.Item,{label:"\u4FEE\u590D\u5EFA\u8BAE",children:(0,f.jsx)(O.Z.Text,{copyable:!0,children:b.advice})}),(0,f.jsx)(C.Z.Item,{label:"\u4FEE\u590D\u6587\u6863",children:(0,f.jsx)(O.Z.Text,{copyable:!0,children:b.link})}),(0,f.jsx)(C.Z.Item,{label:"\u4E0A\u4E0B\u6587\u6A21\u677F",children:(0,f.jsx)(O.Z.Text,{copyable:!0,children:b.context})}),b.ruleRego&&(0,f.jsx)(C.Z.Item,{label:"\u7B56\u7565",children:(0,f.jsx)(O.Z.Paragraph,{copyable:!0,children:(0,f.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"1000px",overflow:"auto"},children:b.ruleRego})})}),b.createTime&&(0,f.jsx)(C.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:(0,f.jsx)(O.Z.Text,{copyable:!0,children:b.createTime})}),b.updateTime&&(0,f.jsx)(C.Z.Item,{label:"\u66F4\u65B0\u65F6\u95F4",children:(0,f.jsx)(O.Z.Text,{copyable:!0,children:b.updateTime})})]})})})]})};_.Z=j},70501:function(ee,_,t){"use strict";var L=t(62435),h=Object.defineProperty,D=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,m=(A,v,g)=>v in A?h(A,v,{enumerable:!0,configurable:!0,writable:!0,value:g}):A[v]=g,Q=(A,v)=>{for(var g in v||(v={}))x.call(v,g)&&m(A,g,v[g]);if(D)for(var g of D(v))N.call(v,g)&&m(A,g,v[g]);return A};const i=A=>React.createElement("svg",Q({className:"DEFAULT_RESOURCE_ICON_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:256,height:256},A),React.createElement("path",{d:"M827.52 782.08a39.84 39.84 0 0 0 56.64 0l104.32-103.36a119.68 119.68 0 0 0 0-170.08L886.4 405.92a40 40 0 0 0-56.8 56.16l90.88 92h-322.4a40 40 0 0 0 0 80h322.24l-92.48 91.52a40 40 0 0 0-.32 56.48z",fill:"#1480ED"}),React.createElement("path",{d:"M864 80h-52V40a40 40 0 0 0-80 0v40H550.08V40a40 40 0 0 0-80 0v40h-180V40a40 40 0 1 0-80 0v40H160A160 160 0 0 0 0 240v624a160 160 0 0 0 160 160h704a160 160 0 0 0 160-160 40 40 0 0 0-80 0 80 80 0 0 1-80 80H160a80 80 0 0 1-80-80V240a80 80 0 0 1 80-80h50.08v40a40 40 0 0 0 80 0v-40h180v40a40 40 0 0 0 80 0v-40H732v40a40 40 0 0 0 80 0v-40h52a80 80 0 0 1 80 80v90.08a40 40 0 0 0 80 0V240A160 160 0 0 0 864 80z",fill:"#2A5699"}));_.Z="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiI+PHBhdGggZD0iTTgyNy41MiA3ODIuMDhhMzkuODQgMzkuODQgMCAwIDAgNTYuNjQgMGwxMDQuMzItMTAzLjM2YTExOS42OCAxMTkuNjggMCAwIDAgMC0xNzAuMDhMODg2LjQgNDA1LjkyYTQwIDQwIDAgMCAwLTU2LjggNTYuMTZsOTAuODggOTJoLTMyMi40YTQwIDQwIDAgMCAwIDAgODBoMzIyLjI0bC05Mi40OCA5MS41MmE0MCA0MCAwIDAgMC0uMzIgNTYuNDh6IiBmaWxsPSIjMTQ4MEVEIi8+PHBhdGggZD0iTTg2NCA4MGgtNTJWNDBhNDAgNDAgMCAwIDAtODAgMHY0MEg1NTAuMDhWNDBhNDAgNDAgMCAwIDAtODAgMHY0MGgtMTgwVjQwYTQwIDQwIDAgMSAwLTgwIDB2NDBIMTYwQTE2MCAxNjAgMCAwIDAgMCAyNDB2NjI0YTE2MCAxNjAgMCAwIDAgMTYwIDE2MGg3MDRhMTYwIDE2MCAwIDAgMCAxNjAtMTYwIDQwIDQwIDAgMCAwLTgwIDAgODAgODAgMCAwIDEtODAgODBIMTYwYTgwIDgwIDAgMCAxLTgwLTgwVjI0MGE4MCA4MCAwIDAgMSA4MC04MGg1MC4wOHY0MGE0MCA0MCAwIDAgMCA4MCAwdi00MGgxODB2NDBhNDAgNDAgMCAwIDAgODAgMHYtNDBINzMydjQwYTQwIDQwIDAgMCAwIDgwIDB2LTQwaDUyYTgwIDgwIDAgMCAxIDgwIDgwdjkwLjA4YTQwIDQwIDAgMCAwIDgwIDBWMjQwQTE2MCAxNjAgMCAwIDAgODY0IDgweiIgZmlsbD0iIzJBNTY5OSIvPjwvc3ZnPg=="},85674:function(ee,_,t){var L={"./simpleWorker":18352,"./simpleWorker.js":18352};function h(D){return Promise.resolve().then(function(){if(!t.o(L,D)){var x=new Error("Cannot find module '"+D+"'");throw x.code="MODULE_NOT_FOUND",x}var N=L[D];return t(N)})}h.keys=function(){return Object.keys(L)},h.id=85674,ee.exports=h},10131:function(ee,_,t){var L={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function h(D){if(!t.o(L,D))return Promise.resolve().then(function(){var m=new Error("Cannot find module '"+D+"'");throw m.code="MODULE_NOT_FOUND",m});var x=L[D],N=x[0];return Promise.all(x.slice(1).map(t.e)).then(function(){return t(N)})}h.keys=function(){return Object.keys(L)},h.id=10131,ee.exports=h}}]);
