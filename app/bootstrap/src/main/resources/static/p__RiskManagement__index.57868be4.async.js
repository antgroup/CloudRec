(self.webpackChunk=self.webpackChunk||[]).push([[7530],{31732:function(z,A,e){"use strict";var y=e(97857),v=e.n(y),M=e(66309),x=e(62435),_=e(86074);A.Z=function(m){var Z=m.text,o=m.style;return(0,_.jsx)(M.Z,{style:v()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},o),children:Z})}},28235:function(z,A,e){"use strict";var y=e(97857),v=e.n(y),M=e(25593),x=e(83062),_=e(62435),m=e(86074),Z=M.Z.Paragraph;A.Z=function(o){var D=o.text,d=o.width,g=o.maxWidth,w=o.rows,N=w===void 0?2:w,r=o.placement,$=r===void 0?"top":r,O=o.color,L=O===void 0?"rgba(0, 0, 0, 0.88)":O,P=o.link,f=P===void 0?!1:P,R=o.onClickCallBackFunc,E=o.style,W=E===void 0?{}:E,j=o.copyable,V=j===void 0?!1:j,F=o.tooltipText;return(0,m.jsx)("div",{style:{maxWidth:g,width:d},children:(0,m.jsx)(x.Z,{title:F,placement:$,children:(0,m.jsx)(Z,{ellipsis:{rows:N},style:v()({marginBottom:0,color:L,cursor:f?"pointer":""},W),onClick:R,copyable:V,children:D})})})}},52078:function(z,A,e){"use strict";var y=e(97857),v=e.n(y),M=e(27997),x=e(62435),_=e(86074),m=function(o){M.Mj.register({id:"json"});var D=o.value,d=D===void 0?"{}":D,g=o.onChange,w=o.editorStyle,N=w===void 0?{}:w,r=o.editorKey,$=r===void 0?"json-editor":r,O=o.readOnly,L=O===void 0?!1:O,P=(0,x.useRef)(),f=(0,x.useRef)(),R=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(W),W}catch(j){return console.warn("Invalid JSON string:",j),"{}"}};return(0,x.useEffect)(function(){if(P.current)return f.current?f.current.setValue(d):(f.current=M.j6.create(P.current,{value:R(d),language:"json",theme:"vs",readOnly:L,folding:!0,automaticLayout:!0}),f.current.onDidChangeModelContent(function(){var E=f.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:E}),g==null||g(E)})),function(){if(f!=null&&f.current){var E;f==null||(E=f.current)===null||E===void 0||E.dispose(),f.current=null}}},[]),(0,x.useEffect)(function(){f.current&&d!==f.current.getValue()&&f.current.setValue(R(d))},[d]),(0,_.jsx)("div",{ref:P,style:v()({height:360,borderRadius:4,overflow:"hidden"},N)},$)};A.Z=m},29297:function(z,A,e){"use strict";e.d(A,{q9:function(){return y.Z},Wy:function(){return o},mi:function(){return w}});var y=e(52078),v=e(97857),M=e.n(v),x=e(55171),_=e.n(x),m=e(86074),Z=function(r){var $=r.value,O=r.viewerStyle,L=O===void 0?{}:O,P=r.displayDataTypes,f=P===void 0?!1:P,R=r.name,E=R===void 0?"output json":R;return(0,m.jsx)(_(),{src:$,name:E,collapsed:!1,displayDataTypes:f,style:M()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},L)})},o=Z,D=e(27997),d=e(62435),g=function(r){D.Mj.register({id:"rego"});var $=r.value,O=r.onChange,L=r.editorStyle,P=L===void 0?{}:L,f=r.editorKey,R=r.readOnly,E=R===void 0?!1:R,W=(0,d.useRef)(),j=(0,d.useRef)();return(0,d.useEffect)(function(){if(W.current)return j.current||(j.current=D.j6.create(W.current,{value:$,language:"rego",theme:"vs",readOnly:E,automaticLayout:!0}),j.current.onDidChangeModelContent(function(){O==null||O(j.current.getValue())})),function(){if(j.current){var V;(V=j.current)===null||V===void 0||V.dispose(),j.current=null}}},[]),(0,m.jsx)("div",{ref:W,style:M()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},P)},f)},w=g},92086:function(z,A,e){"use strict";var y=e(5574),v=e.n(y),M=e(87426),x=e(39421),_=e(24163),m=e(71448),Z=e(24482),o=e(50322),D=e(22145),d=e(96364),g=e(77603),w=e(72028),N=e(29448),r=e(99611),$=e(45742),O=e(93410),L=e(92016),P=e(25593),f=e(85265),R=e(86250),E=e(83622),W=e(42075),j=e(66309),V=e(83062),F=e(21532),p=e(23323),de=e(62435),_e=e(47908),i=e(86074),J=P.Z.Text,Oe=function(ce){var H,S,xe,Me,De,pe,Ie=ce.riskDrawerVisible,G=ce.riskDrawerInfo,ye=ce.setRiskDrawerVisible,Be=ce.locate,Ze=(0,L.useModel)("rule"),te=Ze.platformList,Le=(0,L.useModel)("tenant"),Ee=Le.tenantListAll,Q=(0,L.useIntl)(),Se=(0,de.useState)(!1),Re=v()(Se,2),Pe=Re[0],Ne=Re[1],ke=(0,de.useState)(!1),we=v()(ke,2),We=we[0],ve=we[1],B=(0,de.useState)(!1),U=v()(B,2),X=U[0],re=U[1],Ce=function(){ye(!1)},se=(0,L.useRequest)(function(h){return(0,w.queryRiskDetailById)({riskId:h})},{manual:!0,formatResult:function(ae){return ae.content||{}}}),s=se.data,ne=se.run,Y=se.loading,ie=function(){Ce()};return(0,de.useEffect)(function(){Ie&&G!==null&&G!==void 0&&G.id&&ne(G.id)},[Ie,G]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(f.Z,{title:Q.formatMessage({id:"risk.module.text.detail.info"}),width:"50%",open:Ie,onClose:ie,loading:Y,children:[(0,i.jsxs)(O.Z,{style:{marginBottom:20},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,i.jsx)(R.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,i.jsxs)("span",{children:[(0,i.jsx)(J,{style:{marginRight:12},children:(0,i.jsx)(E.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(s==null?void 0:s.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(s==null||(H=s.ruleVO)===null||H===void 0?void 0:H.ruleName)||"-"})}),(0,i.jsxs)(W.Z,{children:[(0,i.jsx)("span",{children:(0,N.Ff)(d.MW,s==null?void 0:s.status)}),(s==null?void 0:s.ignoreReasonType)&&(0,i.jsxs)("span",{children:[(0,i.jsxs)(J,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[Q.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,i.jsx)(j.Z,{color:"geekblue",children:((S=d.$G.find(function(h){return h.value===(s==null?void 0:s.ignoreReasonType)}))===null||S===void 0?void 0:S.label)||"-"})]}),(s==null?void 0:s.ignoreReason)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(J,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[Q.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,i.jsx)(_.Z,{rows:1,text:s==null?void 0:s.ignoreReason,maxWidth:64})]}),(s==null?void 0:s.whitedId)&&(0,i.jsx)(E.ZP,{type:"link",size:"small",icon:(0,i.jsx)(r.Z,{}),onClick:function(){return re(!0)},style:{padding:"0 4px",height:"auto",color:"#1890ff"}})]})]})}),(0,i.jsxs)(R.Z,{vertical:!0,gap:10,children:[(0,i.jsxs)(R.Z,{align:"center",children:[(0,i.jsx)("img",{src:x.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,i.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[Q.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,i.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:s==null?void 0:s.gmtModified})]}),(0,i.jsxs)(J,{children:[(0,i.jsx)("img",{src:M.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,i.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[Q.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,i.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:s==null?void 0:s.gmtCreate})]})]}),(0,i.jsxs)(R.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,i.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,N.fD)(s==null?void 0:s.platform,te)}),(0,i.jsx)(J,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(s==null?void 0:s.resourceType)||"-"}),(0,i.jsxs)(R.Z,{align:"center",children:[(0,i.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(s==null?void 0:s.resourceName)+" / "+(s==null?void 0:s.resourceId)}),Be==="risk"&&(0,i.jsx)(V.Z,{title:Q.formatMessage({id:"asset.extend.text.detail"}),children:(0,i.jsx)("span",{className:_e.Z.iconWrap,onClick:function(){return ve(!0)},children:(0,i.jsx)($.Z,{className:_e.Z.resourceInstance})})})]}),(0,i.jsx)(J,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(Ee==null||(xe=Ee.find(function(h){return h.value===(s==null?void 0:s.tenantId)}))===null||xe===void 0?void 0:xe.label)||"-"})]})]}),(0,i.jsx)(F.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,i.jsxs)(p.Z,{children:[(0,i.jsx)(p.Z.Item,{label:Q.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,i.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(s==null||(Me=s.ruleVO)===null||Me===void 0?void 0:Me.advice)||"-"})}),(0,i.jsx)(p.Z.Item,{label:Q.formatMessage({id:"risk.module.text.reference.link"}),children:(0,i.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(s==null||(De=s.ruleVO)===null||De===void 0?void 0:De.link)||"-"})}),(0,i.jsx)(p.Z.Item,{label:Q.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,i.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(s==null||(pe=s.ruleVO)===null||pe===void 0?void 0:pe.ruleDesc)||"-"})})]})}),(0,i.jsx)(m.Z,{riskDrawerInfo:G}),(0,i.jsx)(o.Z,{riskDrawerInfo:G})]}),(0,i.jsx)(Z.Z,{evaluateDrawerVisible:Pe,setEvaluateDrawerVisible:Ne,riskDrawerInfo:G}),(0,i.jsx)(D.Z,{resourceDrawerVisible:We,setResourceDrawerVisible:ve,riskDrawerInfo:G}),(s==null?void 0:s.whitedId)&&(0,i.jsx)(g.Z,{editDrawerVisible:X,setEditDrawerVisible:re,whiteListDrawerInfo:{id:s.whitedId,isEditMode:!1}})]})};A.Z=Oe},40351:function(z,A,e){"use strict";e.r(A),e.d(A,{default:function(){return We}});var y=e(15009),v=e.n(y),M=e(99289),x=e.n(M),_=e(5574),m=e.n(_),Z=e(97857),o=e.n(Z),D=e(70501),d=e(96364),g=e(92016),w=e(66309),N=e(53846),r=e(86074),$=function(ve){var B=ve.status,U=(0,r.jsx)(w.Z,{children:B||"-"});return[d.Bj[1].value].includes(B)?U=(0,r.jsx)(w.Z,{className:N.Z.invalidTag,style:{marginLeft:6},children:(0,r.jsx)(g.FormattedMessage,{id:"common.tag.text.noExist"})}):U=(0,r.jsx)(w.Z,{className:N.Z.validTag,style:{marginLeft:6},children:(0,r.jsx)(g.FormattedMessage,{id:"common.tag.text.exist"})}),U},O=e(31732),L=e(24163),P=e(28235),f=e(72028),R=e(37476),E=e(64317),W=e(90672),j=e(68872),V=e(23323),F=e(96486),p=e(62435),de=function(B){var U=j.ZP.useMessage(),X=m()(U,2),re=X[0],Ce=X[1],se=V.Z.useForm(),s=m()(se,1),ne=s[0],Y=(0,g.useIntl)(),ie=B.ignoreRiskFormVisible,h=B.riskInfo,ae=B.setIgnoreRiskFormVisible,q=B.tableActionRef,je=function(){ne.resetFields()},me=function(){ae(!1),je()},Te=function(){var ge=x()(v()().mark(function Ae(ee){var be,K,C;return v()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return be=o()(o()({},ee),{},{riskId:h.id}),oe.next=3,(0,f.ignoreRisk)(be);case 3:K=oe.sent,K.code===200&&K.msg==="success"&&(re.success(Y.formatMessage({id:"risk.message.api.ignore.risk.success"})),q==null||(C=q.current)===null||C===void 0||C.reload(),me());case 5:case"end":return oe.stop()}},Ae)}));return function(ee){return ge.apply(this,arguments)}}();return(0,p.useEffect)(function(){ie&&!(0,F.isEmpty)(h)&&ne.setFieldsValue({ignoreReasonType:h==null?void 0:h.ignoreReasonType,ignoreReason:h==null?void 0:h.ignoreReason})},[ie,h]),(0,r.jsxs)(r.Fragment,{children:[Ce,(0,r.jsxs)(R.Y,{labelCol:{span:Y.locale==="en-US"?6:4},title:Y.formatMessage({id:"risk.module.text.ignore.risk"}),width:520,form:ne,modalProps:{destroyOnClose:!0,onCancel:function(){return me()},styles:{body:{paddingTop:12}}},open:ie,onFinish:Te,layout:"horizontal",children:[(0,r.jsx)(E.Z,{label:Y.formatMessage({id:"risk.module.text.ignore.type"}),name:"ignoreReasonType",rules:[{required:!0}],options:d.$G}),(0,r.jsx)(W.Z,{label:Y.formatMessage({id:"risk.module.text.ignore.reason"}),name:"ignoreReason",rules:[{required:!0}],fieldProps:{rows:6}})]})]})},_e=de,i=e(92086),J=e(77603),Oe=e(92635),et=e(79930),ce=e(96655),H=e(17910),S=e(29448),xe=e(68795),Me=e(39380),De=e(93410),pe=e(90498),Ie=e(75302),G=e(3303),ye=e(86250),Be=e(34041),Ze=e(57381),te=e(83622),Le=e(96074),Ee=e(86738),Q=e(71230),Se=e(15746),Re=e(84567),Pe=e(47908),Ne=Ie.ZP.useBreakpoint,ke=G.Z.SHOW_CHILD,we=function(){var B,U=Ne(),X=(0,g.useModel)("rule"),re=X.platformList,Ce=X.ruleGroupList,se=X.ruleTypeList,s=(0,g.useRequest)(function(){return(0,ce.queryAllTenantSelectRuleList)({})},{formatResult:function(n){var t;return((t=n.content)===null||t===void 0?void 0:t.map(function(a){return o()(o()({},a),{},{key:a==null?void 0:a.id,label:a==null?void 0:a.ruleName,value:a==null?void 0:a.ruleCode})}))||[]}}),ne=s.data,Y=(0,g.useLocation)(),ie=Y.search,h=new URLSearchParams(ie),ae=h.get("riskLevel"),q=h.get("platform"),je=h.get("ruleCode"),me=h.get("resourceId"),Te=h.get("cloudAccountId"),ge=j.ZP.useMessage(),Ae=m()(ge,2),ee=Ae[0],be=Ae[1],K=(0,p.useRef)(),C=(0,p.useRef)(),tt=V.Z.useForm(),oe=m()(tt,1),I=oe[0],u=(0,g.useIntl)(),Lt=(0,p.useState)(!1),rt=m()(Lt,2),St=rt[0],st=rt[1],nt=(0,p.useRef)({}),Pt=(0,p.useState)(!1),it=m()(Pt,2),kt=it[0],at=it[1],ot=(0,p.useRef)({}),lt=(0,p.useRef)({}),wt=(0,p.useState)(!1),ut=m()(wt,2),bt=ut[0],dt=ut[1],Vt=(0,p.useState)({}),ct=m()(Vt,2),Ue=ct[0],Ke=ct[1],Ft=(0,p.useState)((B=d.MW[0])===null||B===void 0?void 0:B.value),vt=m()(Ft,2),fe=vt[0],Bt=vt[1],Zt=(0,p.useState)(!1),mt=m()(Zt,2),Nt=mt[0],gt=mt[1],Wt=function(){var l=x()(v()().mark(function n(t){var a,c,k;return v()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return a={riskId:t.id},b.next=3,(0,f.cancelIgnoreRisk)(a);case 3:c=b.sent,c.code===200&&c.msg==="success"&&(ee.success(u.formatMessage({id:"risk.message.api.cancel.ignore.risk.success"})),K==null||(k=K.current)===null||k===void 0||k.reload());case 5:case"end":return b.stop()}},n)}));return function(t){return l.apply(this,arguments)}}(),Ut=(0,p.useState)([]),ft=m()(Ut,2),Kt=ft[0],$e=ft[1],$t=(0,g.useRequest)(function(l){return(0,et.queryGroupTypeList)({platformList:l})},{manual:!0,formatResult:function(n){var t=n.content;$e(t||[])}}),ht=$t.run;(0,p.useEffect)(function(){if((0,F.isEmpty)(q)||(I==null||I.setFieldValue("platformList",[q]),I.setFieldValue("resourceType",null),$e([]),ht([q])),(0,F.isEmpty)(ae)||I==null||I.setFieldValue("riskLevelList",[ae]),!(0,F.isEmpty)(je)){var l;(l=C.current)===null||l===void 0||l.setFieldValue("ruleCodeList",[je])}if(!(0,F.isEmpty)(me)){var n;(n=C.current)===null||n===void 0||n.setFieldValue("resourceId",me)}if(!(0,F.isEmpty)(Te)){var t;(t=C.current)===null||t===void 0||t.setFieldValue("cloudAccountId",Te)}},[q,ae,je,me,Te]);var Ge=(0,g.useRequest)(function(l){return(0,Oe.cloudAccountBaseInfoList)(o()({},l))},{formatResult:function(n){if(n.msg==="success"){var t;return(n==null||(t=n.content)===null||t===void 0||(t=t.accountAliasList)===null||t===void 0?void 0:t.map(function(a){return{label:a,value:a}}))||[]}}}),Gt=Ge.data,xt=Ge.run,Qt=Ge.loading,zt=(0,p.useMemo)(function(){var l=function(t){xt({platformList:I.getFieldValue("platformList")||[],cloudAccountSearch:t})};return(0,F.debounce)(l,500)},[Oe.cloudAccountBaseInfoList]),Mt=(0,g.useRequest)(function(l){return(0,f.listRuleStatistics)(o()({},l))},{manual:!0,formatResult:function(n){var t,a=[];return a=n==null||(t=n.content)===null||t===void 0?void 0:t.map(function(c){return{label:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:c==null?void 0:c.ruleName}),(0,r.jsx)(ye.Z,{align:"center",children:(0,r.jsx)(w.Z,{color:(0,S.nn)(H.I9,c==null?void 0:c.riskLevel),style:{margin:"0 0 0 8px"},children:(c==null?void 0:c.count)||"-"})})]}),value:c.ruleId}}),a}}),Ht=Mt.data,Yt=Mt.run,Jt=function(){var l=x()(v()().mark(function n(){var t,a;return v()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:a=o()(o()({status:fe},I==null?void 0:I.getFieldsValue()),C==null||(t=C.current)===null||t===void 0?void 0:t.getFieldsValue()),gt(!0),(0,f.exportRiskList)(o()({},a),{responseType:"blob"}).then(function(T){if(T.type==="application/json"){var b=new FileReader;b.onload=function(){try{var Ve=JSON.parse(b.result);ee.error(Ve.msg||u.formatMessage({id:"common.message.text.export.failed"}))}catch(Qe){ee.error(u.formatMessage({id:"common.message.text.export.failed"}))}},b.readAsText(T)}else(0,S.Uc)(T,"CloudRec ".concat(u.formatMessage({id:"risk.module.text.risk.data"}))),ee.success(u.formatMessage({id:"common.message.text.export.success"}))}).catch(function(T){ee.error(u.formatMessage({id:"common.message.text.export.failed"})),console.error("Export failed:",T)}).finally(function(){return gt(!1)});case 3:case"end":return k.stop()}},n)}));return function(){return l.apply(this,arguments)}}(),Xt=(0,p.useState)(),Dt=m()(Xt,2),qt=Dt[0],er=Dt[1],tr=function(){var l=x()(v()().mark(function n(t){var a,c;return v()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!t){T.next=4;break}return c=o()(o()({status:fe},I==null?void 0:I.getFieldsValue()),C==null||(a=C.current)===null||a===void 0?void 0:a.getFieldsValue()),T.next=4,Yt(c);case 4:case"end":return T.stop()}},n)}));return function(t){return l.apply(this,arguments)}}(),rr=function(){return{filterDropdown:function(t){var a=t.confirm;return(0,r.jsx)("div",{style:{padding:8},onKeyDown:function(k){return k.stopPropagation()},children:(0,r.jsx)(Be.Z,{maxTagCount:"responsive",allowClear:!0,mode:"multiple",placeholder:u.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:Ht||[],onChange:(0,F.debounce)(function(c){er(c),a()},1e3),style:{minWidth:180}})})},filterDropdownProps:{onOpenChange:tr},filterIcon:function(t){return(0,r.jsx)(xe.Z,{style:{color:t?"#1677ff":void 0}})},destroyOnClose:!0}},sr=function(n){dt(!0),lt.current=n},nr=[o()({title:u.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(n,t){var a;return(0,r.jsxs)(ye.Z,{align:"center",children:[(0,r.jsx)("img",{src:(t==null?void 0:t.icon)||D.Z,alt:"RESOURCE_ICON",style:{width:18,height:18}}),(0,r.jsx)(L.Z,{text:(t==null||(a=t.ruleVO)===null||a===void 0?void 0:a.ruleName)||"-",maxWidth:U!=null&&U.xxl?280:240,rows:1,style:{color:"#333",fontSize:14,marginLeft:8},placement:"topLeft"})]})}},rr()),{title:u.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",valueEnum:(0,S.W_)(ne),hideInTable:!0,fieldProps:{mode:"multiple"}},{title:u.formatMessage({id:"risk.module.text.firstAndLast.discovered"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(n,t){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{style:{color:"#999"},children:(t==null?void 0:t.gmtCreate)||"-"}),(0,r.jsx)("section",{style:{color:"#999"},children:(t==null?void 0:t.gmtModified)||"-"})]})}},{title:u.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonTypeList",valueType:"checkbox",valueEnum:(0,S.W_)(d.$G),align:"left",hideInTable:!0,hideInSearch:fe!=="IGNORED"},{title:u.formatMessage({id:"layout.routes.title.ruleGroup"}),dataIndex:"ruleGroupIdList",valueType:"select",valueEnum:(0,S.W_)(Ce),hideInTable:!0,fieldProps:{mode:"multiple"}},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeList",valueType:"cascader",align:"left",hideInTable:!0,fieldProps:{multiple:!0,showCheckedStrategy:ke,options:Kt,showSearch:!0,allowClear:!0}},{title:u.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),dataIndex:"ruleTypeIdList",valueType:"cascader",hideInTable:!0,fieldProps:{multiple:!0,options:se,showCheckedStrategy:ke,fieldNames:{label:"typeName",value:"id",children:"childList"}}},{title:u.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"select",fieldProps:{placeholder:u.formatMessage({id:"common.select.query.text.placeholder"}),showSearch:!0,notFoundContent:Qt&&(0,r.jsx)(Ze.Z,{size:"small"}),onSearch:zt,options:Gt||[]},align:"left",render:function(n,t){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{style:{color:"rgb(51, 51, 51)"},children:(t==null?void 0:t.cloudAccountId)||"-"}),(0,r.jsxs)(ye.Z,{style:{fontSize:"12px",color:"#999"},children:[(0,S.c5)(t.platform,re),(t==null?void 0:t.alias)||"-"]})]})}},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",hideInSearch:!0,render:function(n,t){return(0,r.jsx)(O.Z,{text:t==null?void 0:t.resourceType})}},{title:u.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceName",valueType:"text",align:"left",width:200,render:function(n,t){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(P.Z,{placement:"topLeft",maxWidth:400,rows:1,text:(0,r.jsxs)(r.Fragment,{children:[t.resourceName||"-",(0,r.jsx)($,{status:t==null?void 0:t.resourceStatus})]}),tooltipText:(t==null?void 0:t.resourceStatus)===d.Bj[1].value?"(".concat(u.formatMessage({id:"risk.module.text.not.exist"}),") ")+t.resourceName:t.resourceName||"-"})})}},{title:u.formatMessage({id:"common.table.columns.assetId"}),dataIndex:"resourceId",valueType:"text",align:"left",hideInTable:!0},{title:u.formatMessage({id:"common.table.columns.assetStatus"}),dataIndex:"resourceStatus",valueType:"select",valueEnum:(0,S.W_)(d.Bj),align:"left",hideInTable:!0},{title:u.formatMessage({id:"risk.module.text.first.discovery"}),dataIndex:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0,fieldProps:{presets:H.El},search:{transform:function(n){return{gmtCreateStart:n[0],gmtCreateEnd:n[1]}}}},{title:u.formatMessage({id:"risk.module.text.recently.discovery"}),dataIndex:"modifiedTimeRange",valueType:"dateTimeRange",hideInTable:!0,fieldProps:{presets:H.El},search:{transform:function(n){return{gmtModifiedStart:n[0],gmtModifiedEnd:n[1]}}}},{title:u.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"text",align:"center",hideInSearch:!0,render:function(n,t){var a;return(0,S.Dd)(H.I9,t==null||(a=t.ruleVO)===null||a===void 0?void 0:a.riskLevel)}},{title:u.formatMessage({id:"risk.module.text.risk.status"}),dataIndex:"status",valueType:"text",align:"left",hideInSearch:!0,render:function(n,t){return(0,S.Ff)(d.MW,t==null?void 0:t.status)}},{title:u.formatMessage({id:"risk.module.text.ignore.reason"}),dataIndex:"ignoreReason",valueType:"text",align:"left",hideInSearch:!0,hideInTable:fe!=="IGNORED",render:function(n,t){return(0,r.jsx)(L.Z,{placement:"topLeft",text:t.ignoreReason||"-",maxWidth:210})}},{title:u.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonType",valueType:"select",valueEnum:(0,S.W_)(d.$G),align:"left",hideInSearch:!0,hideInTable:fe!=="IGNORED"},{title:u.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(n,t){var a;return(0,r.jsxs)(r.Fragment,{children:[!((a=["WHITED"])!==null&&a!==void 0&&a.includes(t.status))&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(te.ZP,{size:"small",type:"link",onClick:function(){return sr({riskId:t==null?void 0:t.id})},children:u.formatMessage({id:"common.button.text.white"})}),(0,r.jsx)(Le.Z,{type:"vertical"})]}),t.status==="IGNORED"?(0,r.jsx)(Ee.Z,{title:(0,r.jsx)(r.Fragment,{}),description:u.formatMessage({id:"risk.module.text.cancel.ignore"}),onConfirm:function(){return Wt(t)},onCancel:function(){},okText:u.formatMessage({id:"common.button.text.ok"}),cancelText:u.formatMessage({id:"common.button.text.cancel"}),children:(0,r.jsx)(te.ZP,{size:"small",type:"link",children:u.formatMessage({id:"common.button.text.cancelIgnore"})})}):(0,r.jsx)(te.ZP,{size:"small",type:"link",onClick:function(){ot.current=o()({},t),at(!0)},children:u.formatMessage({id:"common.button.text.ignore"})}),(0,r.jsx)(Le.Z,{type:"vertical"}),(0,r.jsx)(te.ZP,{size:"small",type:"link",target:"_self",onClick:function(){st(!0),nt.current=o()({},t)},children:u.formatMessage({id:"common.button.text.detail"})})]})}}],ir=function(){var l=x()(v()().mark(function n(t){var a,c,k,T,b,Ve,Qe,pt,It,ze,yt,Et,Rt,Fe,Ct,jt,Tt,At,_t,He,Ye,Je,Xe,le,qe,ue,Ot;return v()().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return k=t.pageSize,T=t.current,b=t.ruleId,Ve=t.ruleGroupIdList,Qe=t.cloudAccountId,pt=t.resourceName,It=t.resourceTypeList,ze=t.status,yt=ze===void 0?"UNREPAIRED":ze,Et=t.ignoreReasonTypeList,Rt=t.ruleTypeIdList,Fe=t.ruleIdList,Ct=t.gmtCreateStart,jt=t.gmtCreateEnd,Tt=t.gmtModifiedStart,At=t.gmtModifiedEnd,_t=t.resourceStatus,He=I.getFieldValue("platformList"),Ye=I.getFieldValue("riskLevelList"),Je=(a=C.current)===null||a===void 0?void 0:a.getFieldValue("ruleCodeList"),Xe=(c=C.current)===null||c===void 0?void 0:c.getFieldValue("resourceId"),le={page:T,size:k,ruleId:b,ruleGroupIdList:Ve,cloudAccountId:Qe,resourceName:pt,resourceTypeList:It,status:yt,ignoreReasonTypeList:Et,ruleTypeIdList:Rt,gmtCreateStart:Ct,gmtCreateEnd:jt,gmtModifiedStart:Tt,gmtModifiedEnd:At,resourceStatus:_t},He&&(le.platformList=He),Ye&&(le.riskLevelList=Ye),Je&&(le.ruleCodeList=Je),Xe&&(le.resourceId=Xe),Fe&&!(0,F.isEmpty)(Fe)&&(le.ruleIdList=Fe),he.next=13,(0,f.queryRiskList)(le);case 13:return qe=he.sent,ue=qe.content,Ot=qe.code,he.abrupt("return",{data:(ue==null?void 0:ue.data)||[],total:(ue==null?void 0:ue.total)||0,success:Ot===200||!1});case 17:case"end":return he.stop()}},n)}));return function(t){return l.apply(this,arguments)}}();return(0,r.jsxs)(Me._z,{title:!1,className:Pe.Z.riskPageContainer,breadcrumbRender:!1,children:[be,(0,r.jsx)(De.Z,{bodyStyle:{paddingBlock:0},className:Pe.Z.customFilterCard,tabs:{activeKey:fe,items:d.MW.map(function(l){return{label:l.label,key:l.value,children:(0,r.jsx)(V.Z,{form:I,children:(0,r.jsxs)(Q.Z,{gutter:[24,10],children:[(0,r.jsx)(Se.Z,{span:24,children:(0,r.jsx)(V.Z.Item,{name:"platformList",label:u.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,r.jsx)(Re.Z.Group,{options:(0,S.T$)(re),onChange:function(t){I.setFieldValue("resourceTypeList",null),$e([]),ht(t),xt({platformList:t||[]})}})})}),(0,r.jsx)(Se.Z,{span:24,children:(0,r.jsx)(V.Z.Item,{name:"riskLevelList",label:u.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,r.jsx)(Re.Z.Group,{options:(0,S.at)(H.I9)})})})]})})}})||[],onChange:function(n){var t,a,c;Bt(n),(t=C.current)===null||t===void 0||t.setFieldValue("ignoreReasonTypeList",[]);var k=I.getFieldsValue(),T=((a=C.current)===null||a===void 0?void 0:a.getFieldsValue())||{},b=o()(o()(o()(o()({},Ue),k),T),{},{status:n,ignoreReasonTypeList:[]});Ke(b),(c=K.current)===null||c===void 0||c.reload()}}}),(0,r.jsx)(pe.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},headerTitle:(0,r.jsx)("div",{className:N.Z.customTitle,children:u.formatMessage({id:"risk.module.text.risk.inquiry"})}),toolBarRender:function(){return[(0,r.jsx)(te.ZP,{type:"primary",loading:Nt,onClick:Jt,children:u.formatMessage({id:"common.button.text.export"})},"export")]},actionRef:K,formRef:C,columns:nr,request:ir,onReset:function(){I.resetFields(),Ke({})},onSubmit:function(){var n=I.getFieldsValue();Ke(o()(o()({},Ue),n))},params:o()(o()({},Ue),{},{ruleIdList:qt}),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}}),(0,r.jsx)(i.Z,{locate:"risk",riskDrawerVisible:St,setRiskDrawerVisible:st,riskDrawerInfo:nt.current,tableActionRef:K}),(0,r.jsx)(_e,{ignoreRiskFormVisible:kt,setIgnoreRiskFormVisible:at,riskInfo:ot.current,tableActionRef:K}),(0,r.jsx)(J.Z,{editDrawerVisible:bt,setEditDrawerVisible:dt,whiteListDrawerInfo:lt.current,tableActionRef:K})]})},We=we},70501:function(z,A,e){"use strict";var y=e(62435),v=Object.defineProperty,M=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,m=(D,d,g)=>d in D?v(D,d,{enumerable:!0,configurable:!0,writable:!0,value:g}):D[d]=g,Z=(D,d)=>{for(var g in d||(d={}))x.call(d,g)&&m(D,g,d[g]);if(M)for(var g of M(d))_.call(d,g)&&m(D,g,d[g]);return D};const o=D=>React.createElement("svg",Z({className:"DEFAULT_RESOURCE_ICON_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:256,height:256},D),React.createElement("path",{d:"M827.52 782.08a39.84 39.84 0 0 0 56.64 0l104.32-103.36a119.68 119.68 0 0 0 0-170.08L886.4 405.92a40 40 0 0 0-56.8 56.16l90.88 92h-322.4a40 40 0 0 0 0 80h322.24l-92.48 91.52a40 40 0 0 0-.32 56.48z",fill:"#1480ED"}),React.createElement("path",{d:"M864 80h-52V40a40 40 0 0 0-80 0v40H550.08V40a40 40 0 0 0-80 0v40h-180V40a40 40 0 1 0-80 0v40H160A160 160 0 0 0 0 240v624a160 160 0 0 0 160 160h704a160 160 0 0 0 160-160 40 40 0 0 0-80 0 80 80 0 0 1-80 80H160a80 80 0 0 1-80-80V240a80 80 0 0 1 80-80h50.08v40a40 40 0 0 0 80 0v-40h180v40a40 40 0 0 0 80 0v-40H732v40a40 40 0 0 0 80 0v-40h52a80 80 0 0 1 80 80v90.08a40 40 0 0 0 80 0V240A160 160 0 0 0 864 80z",fill:"#2A5699"}));A.Z="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiI+PHBhdGggZD0iTTgyNy41MiA3ODIuMDhhMzkuODQgMzkuODQgMCAwIDAgNTYuNjQgMGwxMDQuMzItMTAzLjM2YTExOS42OCAxMTkuNjggMCAwIDAgMC0xNzAuMDhMODg2LjQgNDA1LjkyYTQwIDQwIDAgMCAwLTU2LjggNTYuMTZsOTAuODggOTJoLTMyMi40YTQwIDQwIDAgMCAwIDAgODBoMzIyLjI0bC05Mi40OCA5MS41MmE0MCA0MCAwIDAgMC0uMzIgNTYuNDh6IiBmaWxsPSIjMTQ4MEVEIi8+PHBhdGggZD0iTTg2NCA4MGgtNTJWNDBhNDAgNDAgMCAwIDAtODAgMHY0MEg1NTAuMDhWNDBhNDAgNDAgMCAwIDAtODAgMHY0MGgtMTgwVjQwYTQwIDQwIDAgMSAwLTgwIDB2NDBIMTYwQTE2MCAxNjAgMCAwIDAgMCAyNDB2NjI0YTE2MCAxNjAgMCAwIDAgMTYwIDE2MGg3MDRhMTYwIDE2MCAwIDAgMCAxNjAtMTYwIDQwIDQwIDAgMCAwLTgwIDAgODAgODAgMCAwIDEtODAgODBIMTYwYTgwIDgwIDAgMCAxLTgwLTgwVjI0MGE4MCA4MCAwIDAgMSA4MC04MGg1MC4wOHY0MGE0MCA0MCAwIDAgMCA4MCAwdi00MGgxODB2NDBhNDAgNDAgMCAwIDAgODAgMHYtNDBINzMydjQwYTQwIDQwIDAgMCAwIDgwIDB2LTQwaDUyYTgwIDgwIDAgMCAxIDgwIDgwdjkwLjA4YTQwIDQwIDAgMCAwIDgwIDBWMjQwQTE2MCAxNjAgMCAwIDAgODY0IDgweiIgZmlsbD0iIzJBNTY5OSIvPjwvc3ZnPg=="},85674:function(z,A,e){var y={"./simpleWorker":18352,"./simpleWorker.js":18352};function v(M){return Promise.resolve().then(function(){if(!e.o(y,M)){var x=new Error("Cannot find module '"+M+"'");throw x.code="MODULE_NOT_FOUND",x}var _=y[M];return e(_)})}v.keys=function(){return Object.keys(y)},v.id=85674,z.exports=v},10131:function(z,A,e){var y={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function v(M){if(!e.o(y,M))return Promise.resolve().then(function(){var m=new Error("Cannot find module '"+M+"'");throw m.code="MODULE_NOT_FOUND",m});var x=y[M],_=x[0];return Promise.all(x.slice(1).map(e.e)).then(function(){return e(_)})}v.keys=function(){return Object.keys(y)},v.id=10131,z.exports=v}}]);
