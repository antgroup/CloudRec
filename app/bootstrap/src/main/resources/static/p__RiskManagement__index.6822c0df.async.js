(self.webpackChunk=self.webpackChunk||[]).push([[7530],{52078:function(Q,Z,t){"use strict";var A=t(97857),m=t.n(A),y=t(27997),g=t(62435),N=t(86074),c=function(o){y.Mj.register({id:"json"});var x=o.value,u=x===void 0?"{}":x,v=o.onChange,M=o.editorStyle,S=M===void 0?{}:M,r=o.editorKey,G=r===void 0?"json-editor":r,w=o.readOnly,d=w===void 0?!1:w,L=(0,g.useRef)(),f=(0,g.useRef)(),O=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(W),W}catch(I){return console.warn("Invalid JSON string:",I),"{}"}};return(0,g.useEffect)(function(){if(L.current)return f.current?f.current.setValue(u):(f.current=y.j6.create(L.current,{value:O(u),language:"json",theme:"vs",readOnly:d,folding:!0,automaticLayout:!0}),f.current.onDidChangeModelContent(function(){var E=f.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:E}),v==null||v(E)})),function(){if(f!=null&&f.current){var E;f==null||(E=f.current)===null||E===void 0||E.dispose(),f.current=null}}},[]),(0,g.useEffect)(function(){f.current&&u!==f.current.getValue()&&f.current.setValue(O(u))},[u]),(0,N.jsx)("div",{ref:L,style:m()({height:360,borderRadius:4,overflow:"hidden"},S)},G)};Z.Z=c},29297:function(Q,Z,t){"use strict";t.d(Z,{q9:function(){return A.Z},Wy:function(){return o},mi:function(){return M}});var A=t(52078),m=t(97857),y=t.n(m),g=t(55171),N=t.n(g),c=t(86074),U=function(r){var G=r.value,w=r.viewerStyle,d=w===void 0?{}:w,L=r.displayDataTypes,f=L===void 0?!1:L,O=r.name,E=O===void 0?"output json":O;return(0,c.jsx)(N(),{src:G,name:E,collapsed:!1,displayDataTypes:f,style:y()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},d)})},o=U,x=t(27997),u=t(62435),v=function(r){x.Mj.register({id:"rego"});var G=r.value,w=r.onChange,d=r.editorStyle,L=d===void 0?{}:d,f=r.editorKey,O=r.readOnly,E=O===void 0?!1:O,W=(0,u.useRef)(),I=(0,u.useRef)();return(0,u.useEffect)(function(){if(W.current)return I.current||(I.current=x.j6.create(W.current,{value:G,language:"rego",theme:"vs",readOnly:E,automaticLayout:!0}),I.current.onDidChangeModelContent(function(){w==null||w(I.current.getValue())})),function(){if(I.current){var F;(F=I.current)===null||F===void 0||F.dispose(),I.current=null}}},[]),(0,c.jsx)("div",{ref:W,style:y()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},L)},f)},M=v},40351:function(Q,Z,t){"use strict";t.r(Z),t.d(Z,{default:function(){return kt}});var A=t(15009),m=t.n(A),y=t(99289),g=t.n(y),N=t(5574),c=t.n(N),U=t(97857),o=t.n(U),x=t(70501),u=t(96364),v=t(92016),M=t(66309),S=t(53846),r=t(86074),G=function(Fe){var _=Fe.status,K=(0,r.jsx)(M.Z,{children:_||"-"});return[u.Bj[1].value].includes(_)?K=(0,r.jsx)(M.Z,{className:S.Z.invalidTag,style:{marginLeft:6},children:(0,r.jsx)(v.FormattedMessage,{id:"common.tag.text.noExist"})}):K=(0,r.jsx)(M.Z,{className:S.Z.validTag,style:{marginLeft:6},children:(0,r.jsx)(v.FormattedMessage,{id:"common.tag.text.exist"})}),K},w=t(31732),d=t(24163),L=t(72028),f=t(37476),O=t(64317),E=t(90672),W=t(68872),I=t(23323),F=t(96486),D=t(62435),je=function(_){var K=W.ZP.useMessage(),ae=c()(K,2),Ce=ae[0],ke=ae[1],Ne=I.Z.useForm(),we=c()(Ne,1),me=we[0],ee=(0,v.useIntl)(),ge=_.ignoreRiskFormVisible,b=_.riskInfo,fe=_.setIgnoreRiskFormVisible,H=_.tableActionRef,he=function(){me.resetFields()},le=function(){fe(!1),he()},pe=function(){var ie=g()(m()().mark(function ye(Y){var Re,B,T;return m()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return Re=o()(o()({},Y),{},{riskId:b.id}),te.next=3,(0,L.ignoreRisk)(Re);case 3:B=te.sent,B.code===200&&B.msg==="success"&&(Ce.success(ee.formatMessage({id:"risk.message.api.ignore.risk.success"})),H==null||(T=H.current)===null||T===void 0||T.reload(),le());case 5:case"end":return te.stop()}},ye)}));return function(Y){return ie.apply(this,arguments)}}();return(0,D.useEffect)(function(){ge&&!(0,F.isEmpty)(b)&&me.setFieldsValue({ignoreReasonType:b==null?void 0:b.ignoreReasonType,ignoreReason:b==null?void 0:b.ignoreReason})},[ge,b]),(0,r.jsxs)(r.Fragment,{children:[ke,(0,r.jsxs)(f.Y,{labelCol:{span:ee.locale==="en-US"?6:4},title:ee.formatMessage({id:"risk.module.text.ignore.risk"}),width:520,form:me,modalProps:{destroyOnClose:!0,onCancel:function(){return le()},styles:{body:{paddingTop:12}}},open:ge,onFinish:pe,layout:"horizontal",children:[(0,r.jsx)(O.Z,{label:ee.formatMessage({id:"risk.module.text.ignore.type"}),name:"ignoreReasonType",rules:[{required:!0}],options:u.$G}),(0,r.jsx)(E.Z,{label:ee.formatMessage({id:"risk.module.text.ignore.reason"}),name:"ignoreReason",rules:[{required:!0}],fieldProps:{rows:6}})]})]})},xe=je,Ee=t(57207),Ae=t(77603),Se=t(64818),ce=t(92635),Le=t(79930),Me=t(96655),X=t(17910),P=t(29448),k=t(68795),De=t(39380),Oe=t(93410),Pe=t(90498),be=t(75302),ze=t(3303),ve=t(86250),q=t(34041),V=t(25593),z=t(57381),$=t(83622),R=t(96074),Ot=t(86738),Pt=t(71230),He=t(15746),Ye=t(84567),Je=t(47908),bt=be.ZP.useBreakpoint,Xe=ze.Z.SHOW_CHILD,Ft=function(){var _,K=bt(),ae=(0,v.useModel)("rule"),Ce=ae.platformList,ke=ae.ruleGroupList,Ne=ae.ruleTypeList,we=(0,v.useRequest)(function(){return(0,Me.queryAllTenantSelectRuleList)({})},{formatResult:function(n){var e;return((e=n.content)===null||e===void 0?void 0:e.map(function(s){return o()(o()({},s),{},{key:s==null?void 0:s.id,label:s==null?void 0:s.ruleName,value:s==null?void 0:s.ruleCode})}))||[]}}),me=we.data,ee=(0,v.useLocation)(),ge=ee.search,b=new URLSearchParams(ge),fe=b.get("riskLevel"),H=b.get("platform"),he=b.get("ruleCode"),le=b.get("resourceId"),pe=b.get("cloudAccountId"),ie=W.ZP.useMessage(),ye=c()(ie,2),Y=ye[0],Re=ye[1],B=(0,D.useRef)(),T=(0,D.useRef)(),qe=I.Z.useForm(),te=c()(qe,1),h=te[0],l=(0,v.useIntl)(),Nt=(0,D.useState)(!1),et=c()(Nt,2),wt=et[0],tt=et[1],rt=(0,D.useRef)({}),Vt=(0,D.useState)(!1),nt=c()(Vt,2),Zt=nt[0],st=nt[1],at=(0,D.useRef)({}),lt=(0,D.useRef)({}),Bt=(0,D.useState)(!1),it=c()(Bt,2),Wt=it[0],ot=it[1],_t=(0,D.useState)(!1),ut=c()(_t,2),Ut=ut[0],dt=ut[1],Gt=(0,D.useState)({}),ct=c()(Gt,2),vt=ct[0],$t=ct[1],Kt=(0,D.useState)({}),mt=c()(Kt,2),Ve=mt[0],Ze=mt[1],Qt=(0,D.useState)((_=u.MW[0])===null||_===void 0?void 0:_.value),gt=c()(Qt,2),oe=gt[0],zt=gt[1],Ht=(0,D.useState)(!1),ft=c()(Ht,2),Yt=ft[0],ht=ft[1],Jt=function(){var a=g()(m()().mark(function n(e){var s,i,C;return m()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return s={riskId:e.id},j.next=3,(0,L.cancelIgnoreRisk)(s);case 3:i=j.sent,i.code===200&&i.msg==="success"&&(Y.success(l.formatMessage({id:"risk.message.api.cancel.ignore.risk.success"})),B==null||(C=B.current)===null||C===void 0||C.reload());case 5:case"end":return j.stop()}},n)}));return function(e){return a.apply(this,arguments)}}(),Xt=(0,D.useState)([]),pt=c()(Xt,2),qt=pt[0],Be=pt[1],er=(0,v.useRequest)(function(a){return(0,Le.queryGroupTypeList)({platformList:a})},{manual:!0,formatResult:function(n){var e=n.content;Be(e||[])}}),yt=er.run;(0,D.useEffect)(function(){if((0,F.isEmpty)(H)||(h==null||h.setFieldValue("platformList",[H]),h.setFieldValue("resourceType",null),Be([]),yt([H])),(0,F.isEmpty)(fe)||h==null||h.setFieldValue("riskLevelList",[fe]),!(0,F.isEmpty)(he)){var a;(a=T.current)===null||a===void 0||a.setFieldValue("ruleCodeList",[he])}if(!(0,F.isEmpty)(le)){var n;(n=T.current)===null||n===void 0||n.setFieldValue("resourceId",le)}if(!(0,F.isEmpty)(pe)){var e;(e=T.current)===null||e===void 0||e.setFieldValue("cloudAccountId",pe)}},[H,fe,he,le,pe]);var We=(0,v.useRequest)(function(a){return(0,ce.cloudAccountBaseInfoList)(o()({},a))},{formatResult:function(n){if(n.msg==="success"){var e;return(n==null||(e=n.content)===null||e===void 0||(e=e.accountAliasList)===null||e===void 0?void 0:e.map(function(s){return{label:s,value:s}}))||[]}}}),tr=We.data,It=We.run,rr=We.loading,nr=(0,D.useMemo)(function(){var a=function(e){It({platformList:h.getFieldValue("platformList")||[],cloudAccountSearch:e})};return(0,F.debounce)(a,500)},[ce.cloudAccountBaseInfoList]),xt=(0,v.useRequest)(function(a){return(0,L.listRuleStatistics)(o()({},a))},{manual:!0,formatResult:function(n){var e,s=[];return s=n==null||(e=n.content)===null||e===void 0?void 0:e.map(function(i){return{label:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:i==null?void 0:i.ruleName}),(0,r.jsx)(ve.Z,{align:"center",children:(0,r.jsx)(M.Z,{color:(0,P.nn)(X.I9,i==null?void 0:i.riskLevel),style:{margin:"0 0 0 8px"},children:(i==null?void 0:i.count)||"-"})})]}),value:i.ruleId}}),s}}),sr=xt.data,ar=xt.run,lr=function(){var a=g()(m()().mark(function n(){var e,s;return m()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:s=o()(o()({status:oe},h==null?void 0:h.getFieldsValue()),T==null||(e=T.current)===null||e===void 0?void 0:e.getFieldsValue()),ht(!0),(0,L.exportRiskList)(o()({},s),{responseType:"blob"}).then(function(p){if(p.type==="application/json"){var j=new FileReader;j.onload=function(){try{var J=JSON.parse(j.result);Y.error(J.msg||l.formatMessage({id:"common.message.text.export.failed"}))}catch(Ie){Y.error(l.formatMessage({id:"common.message.text.export.failed"}))}},j.readAsText(p)}else(0,P.Uc)(p,"CloudRec ".concat(l.formatMessage({id:"risk.module.text.risk.data"}))),Y.success(l.formatMessage({id:"common.message.text.export.success"}))}).catch(function(p){Y.error(l.formatMessage({id:"common.message.text.export.failed"})),console.error("Export failed:",p)}).finally(function(){return ht(!1)});case 3:case"end":return C.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),ir=(0,D.useState)(),Mt=c()(ir,2),or=Mt[0],ur=Mt[1],dr=function(){var a=g()(m()().mark(function n(e){var s,i;return m()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!e){p.next=4;break}return i=o()(o()({status:oe},h==null?void 0:h.getFieldsValue()),T==null||(s=T.current)===null||s===void 0?void 0:s.getFieldsValue()),p.next=4,ar(i);case 4:case"end":return p.stop()}},n)}));return function(e){return a.apply(this,arguments)}}(),cr=function(){return{filterDropdown:function(e){var s=e.confirm;return(0,r.jsx)("div",{style:{padding:8},onKeyDown:function(C){return C.stopPropagation()},children:(0,r.jsx)(q.Z,{maxTagCount:"responsive",allowClear:!0,mode:"multiple",placeholder:l.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:sr||[],onChange:(0,F.debounce)(function(i){ur(i),s()},1e3),style:{minWidth:180}})})},filterDropdownProps:{onOpenChange:dr},filterIcon:function(e){return(0,r.jsx)(k.Z,{style:{color:e?"#1677ff":void 0}})},destroyOnClose:!0}},vr=function(n){ot(!0),lt.current=n},mr=[o()({title:l.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){var s,i,C,p,j,J,Ie=function(){var ue;if(e!=null&&(ue=e.ruleVO)!==null&&ue!==void 0&&ue.id){var re;$t({ruleId:e.ruleVO.id,ruleCode:(re=e.ruleId)===null||re===void 0?void 0:re.toString()}),dt(!0)}};return(0,r.jsxs)(ve.Z,{align:"center",children:[(0,r.jsx)("img",{src:(e==null?void 0:e.icon)||x.Z,alt:"RESOURCE_ICON",style:{width:18,height:18}}),(0,r.jsx)(V.Z.Text,{copyable:e!=null&&(s=e.ruleVO)!==null&&s!==void 0&&s.ruleName?{text:e.ruleVO.ruleName}:!1,style:{color:e!=null&&(i=e.ruleVO)!==null&&i!==void 0&&i.id?"#1890ff":"#333",fontSize:14,marginLeft:8,maxWidth:K!=null&&K.xxl?280:240,cursor:e!=null&&(C=e.ruleVO)!==null&&C!==void 0&&C.id?"pointer":"default"},ellipsis:{tooltip:(e==null||(p=e.ruleVO)===null||p===void 0?void 0:p.ruleName)||"-"},onClick:e!=null&&(j=e.ruleVO)!==null&&j!==void 0&&j.id?Ie:void 0,children:(e==null||(J=e.ruleVO)===null||J===void 0?void 0:J.ruleName)||"-"})]})}},cr()),{title:l.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",valueEnum:(0,P.W_)(me),hideInTable:!0,fieldProps:{mode:"multiple"}},{title:l.formatMessage({id:"risk.module.text.firstAndLast.discovered"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,r.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:l.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonTypeList",valueType:"checkbox",valueEnum:(0,P.W_)(u.$G),align:"left",hideInTable:!0,hideInSearch:oe!=="IGNORED"},{title:l.formatMessage({id:"layout.routes.title.ruleGroup"}),dataIndex:"ruleGroupIdList",valueType:"select",valueEnum:(0,P.W_)(ke),hideInTable:!0,fieldProps:{mode:"multiple"}},{title:l.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeList",valueType:"cascader",align:"left",hideInTable:!0,fieldProps:{multiple:!0,showCheckedStrategy:Xe,options:qt,showSearch:!0,allowClear:!0}},{title:l.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),dataIndex:"ruleTypeIdList",valueType:"cascader",hideInTable:!0,fieldProps:{multiple:!0,options:Ne,showCheckedStrategy:Xe,fieldNames:{label:"typeName",value:"id",children:"childList"}}},{title:l.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"select",fieldProps:{placeholder:l.formatMessage({id:"common.select.query.text.placeholder"}),showSearch:!0,notFoundContent:rr&&(0,r.jsx)(z.Z,{size:"small"}),onSearch:nr,options:tr||[]},align:"left",render:function(n,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)(V.Z.Text,{copyable:e!=null&&e.cloudAccountId?{text:e.cloudAccountId}:!1,style:{color:"rgb(51, 51, 51)"},ellipsis:{tooltip:(e==null?void 0:e.cloudAccountId)||"-"},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,r.jsxs)(ve.Z,{style:{fontSize:"12px",color:"#999"},children:[(0,P.c5)(e.platform,Ce),(e==null?void 0:e.alias)||"-"]})]})}},{title:l.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,r.jsx)(w.Z,{text:e==null?void 0:e.resourceType})}},{title:l.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceName",valueType:"text",align:"left",width:200,render:function(n,e){var s=(e==null?void 0:e.resourceStatus)===u.Bj[1].value?"(".concat(l.formatMessage({id:"risk.module.text.not.exist"}),") ")+e.resourceName:e.resourceName||"-";return(0,r.jsxs)(ve.Z,{align:"center",children:[(0,r.jsx)(V.Z.Text,{copyable:e!=null&&e.resourceName?{text:e.resourceName}:!1,style:{maxWidth:350},ellipsis:{tooltip:s},children:e.resourceName||"-"}),(0,r.jsx)(G,{status:e==null?void 0:e.resourceStatus})]})}},{title:l.formatMessage({id:"common.table.columns.assetId"}),dataIndex:"resourceId",valueType:"text",align:"left",hideInTable:!0},{title:l.formatMessage({id:"common.table.columns.assetStatus"}),dataIndex:"resourceStatus",valueType:"select",valueEnum:(0,P.W_)(u.Bj),align:"left",hideInTable:!0},{title:l.formatMessage({id:"risk.module.text.first.discovery"}),dataIndex:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0,fieldProps:{presets:X.El},search:{transform:function(n){return{gmtCreateStart:n[0],gmtCreateEnd:n[1]}}}},{title:l.formatMessage({id:"risk.module.text.recently.discovery"}),dataIndex:"modifiedTimeRange",valueType:"dateTimeRange",hideInTable:!0,fieldProps:{presets:X.El},search:{transform:function(n){return{gmtModifiedStart:n[0],gmtModifiedEnd:n[1]}}}},{title:l.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"text",align:"center",hideInSearch:!0,render:function(n,e){var s;return(0,P.Dd)(X.I9,e==null||(s=e.ruleVO)===null||s===void 0?void 0:s.riskLevel)}},{title:l.formatMessage({id:"risk.module.text.risk.status"}),dataIndex:"status",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,P.Ff)(u.MW,e==null?void 0:e.status)}},{title:l.formatMessage({id:"risk.module.text.ignore.reason"}),dataIndex:"ignoreReason",valueType:"text",align:"left",hideInSearch:!0,hideInTable:oe!=="IGNORED",render:function(n,e){return(0,r.jsx)(d.Z,{placement:"topLeft",text:e.ignoreReason||"-",maxWidth:210})}},{title:l.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonType",valueType:"select",valueEnum:(0,P.W_)(u.$G),align:"left",hideInSearch:!0,hideInTable:oe!=="IGNORED"},{title:l.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(n,e){var s;return(0,r.jsxs)(r.Fragment,{children:[!((s=["WHITED"])!==null&&s!==void 0&&s.includes(e.status))&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)($.ZP,{size:"small",type:"link",onClick:function(){return vr({riskId:e==null?void 0:e.id})},children:l.formatMessage({id:"common.button.text.white"})}),(0,r.jsx)(R.Z,{type:"vertical"})]}),e.status==="IGNORED"?(0,r.jsx)(Ot.Z,{title:(0,r.jsx)(r.Fragment,{}),description:l.formatMessage({id:"risk.module.text.cancel.ignore"}),onConfirm:function(){return Jt(e)},onCancel:function(){},okText:l.formatMessage({id:"common.button.text.ok"}),cancelText:l.formatMessage({id:"common.button.text.cancel"}),children:(0,r.jsx)($.ZP,{size:"small",type:"link",children:l.formatMessage({id:"common.button.text.cancelIgnore"})})}):(0,r.jsx)($.ZP,{size:"small",type:"link",onClick:function(){at.current=o()({},e),st(!0)},children:l.formatMessage({id:"common.button.text.ignore"})}),(0,r.jsx)(R.Z,{type:"vertical"}),(0,r.jsx)($.ZP,{size:"small",type:"link",target:"_self",onClick:function(){tt(!0),rt.current=o()({},e)},children:l.formatMessage({id:"common.button.text.detail"})})]})}}],gr=function(){var a=g()(m()().mark(function n(e){var s,i,C,p,j,J,Ie,_e,ue,re,Dt,Ct,Rt,Te,Tt,jt,Et,At,St,Ue,Ge,$e,Ke,ne,Qe,se,Lt;return m()().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return C=e.pageSize,p=e.current,j=e.ruleId,J=e.ruleGroupIdList,Ie=e.cloudAccountId,_e=e.resourceName,ue=e.resourceTypeList,re=e.status,Dt=re===void 0?"UNREPAIRED":re,Ct=e.ignoreReasonTypeList,Rt=e.ruleTypeIdList,Te=e.ruleIdList,Tt=e.gmtCreateStart,jt=e.gmtCreateEnd,Et=e.gmtModifiedStart,At=e.gmtModifiedEnd,St=e.resourceStatus,Ue=h.getFieldValue("platformList"),Ge=h.getFieldValue("riskLevelList"),$e=(s=T.current)===null||s===void 0?void 0:s.getFieldValue("ruleCodeList"),Ke=(i=T.current)===null||i===void 0?void 0:i.getFieldValue("resourceId"),ne={page:p,size:C,ruleId:j,ruleGroupIdList:J,cloudAccountId:Ie,resourceName:_e,resourceTypeList:ue,status:Dt,ignoreReasonTypeList:Ct,ruleTypeIdList:Rt,gmtCreateStart:Tt,gmtCreateEnd:jt,gmtModifiedStart:Et,gmtModifiedEnd:At,resourceStatus:St},Ue&&(ne.platformList=Ue),Ge&&(ne.riskLevelList=Ge),$e&&(ne.ruleCodeList=$e),Ke&&(ne.resourceId=Ke),Te&&!(0,F.isEmpty)(Te)&&(ne.ruleIdList=Te),de.next=13,(0,L.queryRiskList)(ne);case 13:return Qe=de.sent,se=Qe.content,Lt=Qe.code,de.abrupt("return",{data:(se==null?void 0:se.data)||[],total:(se==null?void 0:se.total)||0,success:Lt===200||!1});case 17:case"end":return de.stop()}},n)}));return function(e){return a.apply(this,arguments)}}();return(0,r.jsxs)(De._z,{title:!1,className:Je.Z.riskPageContainer,breadcrumbRender:!1,children:[Re,(0,r.jsx)(Oe.Z,{bodyStyle:{paddingBlock:0},className:Je.Z.customFilterCard,tabs:{activeKey:oe,items:u.MW.map(function(a){return{label:a.label,key:a.value,children:(0,r.jsx)(I.Z,{form:h,children:(0,r.jsxs)(Pt.Z,{gutter:[24,10],children:[(0,r.jsx)(He.Z,{span:24,children:(0,r.jsx)(I.Z.Item,{name:"platformList",label:l.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,r.jsx)(Ye.Z.Group,{options:(0,P.T$)(Ce),onChange:function(e){h.setFieldValue("resourceTypeList",null),Be([]),yt(e),It({platformList:e||[]})}})})}),(0,r.jsx)(He.Z,{span:24,children:(0,r.jsx)(I.Z.Item,{name:"riskLevelList",label:l.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,r.jsx)(Ye.Z.Group,{options:(0,P.at)(X.I9)})})})]})})}})||[],onChange:function(n){var e,s,i;zt(n),(e=T.current)===null||e===void 0||e.setFieldValue("ignoreReasonTypeList",[]);var C=h.getFieldsValue(),p=((s=T.current)===null||s===void 0?void 0:s.getFieldsValue())||{},j=o()(o()(o()(o()({},Ve),C),p),{},{status:n,ignoreReasonTypeList:[]});Ze(j),(i=B.current)===null||i===void 0||i.reload()}}}),(0,r.jsx)(Pe.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},headerTitle:(0,r.jsx)("div",{className:S.Z.customTitle,children:l.formatMessage({id:"risk.module.text.risk.inquiry"})}),toolBarRender:function(){return[(0,r.jsx)($.ZP,{type:"primary",loading:Yt,onClick:lr,children:l.formatMessage({id:"common.button.text.export"})},"export")]},actionRef:B,formRef:T,columns:mr,request:gr,onReset:function(){h.resetFields(),Ze({})},onSubmit:function(){var n=h.getFieldsValue();Ze(o()(o()({},Ve),n))},params:o()(o()({},Ve),{},{ruleIdList:or}),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}}),(0,r.jsx)(Ee.Z,{locate:"risk",riskDrawerVisible:wt,setRiskDrawerVisible:tt,riskDrawerInfo:rt.current,tableActionRef:B}),(0,r.jsx)(xe,{ignoreRiskFormVisible:Zt,setIgnoreRiskFormVisible:st,riskInfo:at.current,tableActionRef:B}),(0,r.jsx)(Ae.Z,{editDrawerVisible:Wt,setEditDrawerVisible:ot,whiteListDrawerInfo:lt.current,tableActionRef:B}),(0,r.jsx)(Se.Z,{visible:Ut,onClose:function(){return dt(!1)},ruleId:vt.ruleId,ruleCode:vt.ruleCode})]})},kt=Ft},64818:function(Q,Z,t){"use strict";var A=t(15009),m=t.n(A),y=t(99289),g=t.n(y),N=t(5574),c=t.n(N),U=t(62435),o=t(68872),x=t(66309),u=t(85265),v=t(57381),M=t(26412),S=t(25593),r=t(92016),G=t(96655),w=t(29448),d=t(86074),L=function(O){var E=O.visible,W=O.onClose,I=O.ruleId,F=O.ruleCode,D=(0,r.useIntl)(),je=o.ZP.useMessage(),xe=c()(je,2),Ee=xe[0],Ae=xe[1],Se=(0,U.useState)(!1),ce=c()(Se,2),Le=ce[0],Me=ce[1],X=(0,U.useState)(null),P=c()(X,2),k=P[0],De=P[1];(0,U.useEffect)(function(){E&&I&&Oe()},[E,I]);var Oe=function(){var q=g()(m()().mark(function V(){var z;return m()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(Me(!0),R.prev=1,!I){R.next=6;break}return R.next=5,(0,G.queryRuleDetail)({id:I});case 5:z=R.sent;case 6:z&&z.content&&De(z.content),R.next=12;break;case 9:R.prev=9,R.t0=R.catch(1),Ee.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return R.prev=12,Me(!1),R.finish(12);case 15:case"end":return R.stop()}},V,null,[[1,9,12,15]])}));return function(){return q.apply(this,arguments)}}(),Pe=function(){De(null),W()},be=function(V){switch(V.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},ze=function(V){if(!V)return null;var z=V.split(",");return z.map(function($,R){return(0,d.jsx)(x.Z,{color:be($.trim()),children:$.trim()},R)})},ve=function(V){return(0,w.c5)(V)};return(0,d.jsxs)(d.Fragment,{children:[Ae,(0,d.jsx)(u.Z,{title:"\u89C4\u5219\u8BE6\u60C5",placement:"right",onClose:Pe,open:E,width:1e3,destroyOnClose:!0,children:(0,d.jsx)(v.Z,{spinning:Le,children:k&&(0,d.jsxs)(M.Z,{column:1,bordered:!0,children:[(0,d.jsx)(M.Z.Item,{label:"\u89C4\u5219\u540D\u79F0",children:(0,d.jsx)(S.Z.Text,{copyable:!0,children:k.ruleName})}),(0,d.jsx)(M.Z.Item,{label:"\u89C4\u5219code",children:(0,d.jsx)(S.Z.Text,{copyable:!0,children:k.ruleCode})}),(0,d.jsx)(M.Z.Item,{label:"\u4FEE\u590D\u5EFA\u8BAE",children:(0,d.jsx)(S.Z.Text,{copyable:!0,children:k.advice})}),(0,d.jsx)(M.Z.Item,{label:"\u4FEE\u590D\u6587\u6863",children:(0,d.jsx)(S.Z.Text,{copyable:!0,children:k.link})}),(0,d.jsx)(M.Z.Item,{label:"\u4E0A\u4E0B\u6587\u6A21\u677F",children:(0,d.jsx)(S.Z.Text,{copyable:!0,children:k.context})}),k.ruleRego&&(0,d.jsx)(M.Z.Item,{label:"\u7B56\u7565",children:(0,d.jsx)(S.Z.Paragraph,{copyable:!0,children:(0,d.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"1000px",overflow:"auto"},children:k.ruleRego})})}),k.createTime&&(0,d.jsx)(M.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:(0,d.jsx)(S.Z.Text,{copyable:!0,children:k.createTime})}),k.updateTime&&(0,d.jsx)(M.Z.Item,{label:"\u66F4\u65B0\u65F6\u95F4",children:(0,d.jsx)(S.Z.Text,{copyable:!0,children:k.updateTime})})]})})})]})};Z.Z=L},70501:function(Q,Z,t){"use strict";var A=t(62435),m=Object.defineProperty,y=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,c=(x,u,v)=>u in x?m(x,u,{enumerable:!0,configurable:!0,writable:!0,value:v}):x[u]=v,U=(x,u)=>{for(var v in u||(u={}))g.call(u,v)&&c(x,v,u[v]);if(y)for(var v of y(u))N.call(u,v)&&c(x,v,u[v]);return x};const o=x=>React.createElement("svg",U({className:"DEFAULT_RESOURCE_ICON_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:256,height:256},x),React.createElement("path",{d:"M827.52 782.08a39.84 39.84 0 0 0 56.64 0l104.32-103.36a119.68 119.68 0 0 0 0-170.08L886.4 405.92a40 40 0 0 0-56.8 56.16l90.88 92h-322.4a40 40 0 0 0 0 80h322.24l-92.48 91.52a40 40 0 0 0-.32 56.48z",fill:"#1480ED"}),React.createElement("path",{d:"M864 80h-52V40a40 40 0 0 0-80 0v40H550.08V40a40 40 0 0 0-80 0v40h-180V40a40 40 0 1 0-80 0v40H160A160 160 0 0 0 0 240v624a160 160 0 0 0 160 160h704a160 160 0 0 0 160-160 40 40 0 0 0-80 0 80 80 0 0 1-80 80H160a80 80 0 0 1-80-80V240a80 80 0 0 1 80-80h50.08v40a40 40 0 0 0 80 0v-40h180v40a40 40 0 0 0 80 0v-40H732v40a40 40 0 0 0 80 0v-40h52a80 80 0 0 1 80 80v90.08a40 40 0 0 0 80 0V240A160 160 0 0 0 864 80z",fill:"#2A5699"}));Z.Z="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiI+PHBhdGggZD0iTTgyNy41MiA3ODIuMDhhMzkuODQgMzkuODQgMCAwIDAgNTYuNjQgMGwxMDQuMzItMTAzLjM2YTExOS42OCAxMTkuNjggMCAwIDAgMC0xNzAuMDhMODg2LjQgNDA1LjkyYTQwIDQwIDAgMCAwLTU2LjggNTYuMTZsOTAuODggOTJoLTMyMi40YTQwIDQwIDAgMCAwIDAgODBoMzIyLjI0bC05Mi40OCA5MS41MmE0MCA0MCAwIDAgMC0uMzIgNTYuNDh6IiBmaWxsPSIjMTQ4MEVEIi8+PHBhdGggZD0iTTg2NCA4MGgtNTJWNDBhNDAgNDAgMCAwIDAtODAgMHY0MEg1NTAuMDhWNDBhNDAgNDAgMCAwIDAtODAgMHY0MGgtMTgwVjQwYTQwIDQwIDAgMSAwLTgwIDB2NDBIMTYwQTE2MCAxNjAgMCAwIDAgMCAyNDB2NjI0YTE2MCAxNjAgMCAwIDAgMTYwIDE2MGg3MDRhMTYwIDE2MCAwIDAgMCAxNjAtMTYwIDQwIDQwIDAgMCAwLTgwIDAgODAgODAgMCAwIDEtODAgODBIMTYwYTgwIDgwIDAgMCAxLTgwLTgwVjI0MGE4MCA4MCAwIDAgMSA4MC04MGg1MC4wOHY0MGE0MCA0MCAwIDAgMCA4MCAwdi00MGgxODB2NDBhNDAgNDAgMCAwIDAgODAgMHYtNDBINzMydjQwYTQwIDQwIDAgMCAwIDgwIDB2LTQwaDUyYTgwIDgwIDAgMCAxIDgwIDgwdjkwLjA4YTQwIDQwIDAgMCAwIDgwIDBWMjQwQTE2MCAxNjAgMCAwIDAgODY0IDgweiIgZmlsbD0iIzJBNTY5OSIvPjwvc3ZnPg=="},85674:function(Q,Z,t){var A={"./simpleWorker":18352,"./simpleWorker.js":18352};function m(y){return Promise.resolve().then(function(){if(!t.o(A,y)){var g=new Error("Cannot find module '"+y+"'");throw g.code="MODULE_NOT_FOUND",g}var N=A[y];return t(N)})}m.keys=function(){return Object.keys(A)},m.id=85674,Q.exports=m},10131:function(Q,Z,t){var A={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function m(y){if(!t.o(A,y))return Promise.resolve().then(function(){var c=new Error("Cannot find module '"+y+"'");throw c.code="MODULE_NOT_FOUND",c});var g=A[y],N=g[0];return Promise.all(g.slice(1).map(t.e)).then(function(){return t(N)})}m.keys=function(){return Object.keys(A)},m.id=10131,Q.exports=m}}]);
