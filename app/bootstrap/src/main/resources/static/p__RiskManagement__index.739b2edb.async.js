(self.webpackChunk=self.webpackChunk||[]).push([[7530],{52078:function(Y,Z,t){"use strict";var E=t(97857),g=t.n(E),D=t(27997),I=t(62435),k=t(86074),h=function(a){D.Mj.register({id:"json"});var R=a.value,d=R===void 0?"{}":R,v=a.onChange,M=a.editorStyle,L=M===void 0?{}:M,r=a.editorKey,z=r===void 0?"json-editor":r,V=a.readOnly,c=V===void 0?!1:V,j=(0,I.useRef)(),x=(0,I.useRef)(),O=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(W),W}catch(C){return console.warn("Invalid JSON string:",C),"{}"}};return(0,I.useEffect)(function(){if(j.current)return x.current?x.current.setValue(d):(x.current=D.j6.create(j.current,{value:O(d),language:"json",theme:"vs",readOnly:c,folding:!0,automaticLayout:!0}),x.current.onDidChangeModelContent(function(){var S=x.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:S}),v==null||v(S)})),function(){if(x!=null&&x.current){var S;x==null||(S=x.current)===null||S===void 0||S.dispose(),x.current=null}}},[]),(0,I.useEffect)(function(){x.current&&d!==x.current.getValue()&&x.current.setValue(O(d))},[d]),(0,k.jsx)("div",{ref:j,style:g()({height:360,borderRadius:4,overflow:"hidden"},L)},z)};Z.Z=h},29297:function(Y,Z,t){"use strict";t.d(Z,{q9:function(){return E.Z},Wy:function(){return a},mi:function(){return M}});var E=t(52078),g=t(97857),D=t.n(g),I=t(55171),k=t.n(I),h=t(86074),U=function(r){var z=r.value,V=r.viewerStyle,c=V===void 0?{}:V,j=r.displayDataTypes,x=j===void 0?!1:j,O=r.name,S=O===void 0?"output json":O;return(0,h.jsx)(k(),{src:z,name:S,collapsed:!1,displayDataTypes:x,style:D()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},c)})},a=U,R=t(27997),d=t(62435),v=function(r){R.Mj.register({id:"rego"});var z=r.value,V=r.onChange,c=r.editorStyle,j=c===void 0?{}:c,x=r.editorKey,O=r.readOnly,S=O===void 0?!1:O,W=(0,d.useRef)(),C=(0,d.useRef)();return(0,d.useEffect)(function(){if(W.current)return C.current||(C.current=R.j6.create(W.current,{value:z,language:"rego",theme:"vs",readOnly:S,automaticLayout:!0}),C.current.onDidChangeModelContent(function(){V==null||V(C.current.getValue())})),function(){if(C.current){var B;(B=C.current)===null||B===void 0||B.dispose(),C.current=null}}},[]),(0,h.jsx)("div",{ref:W,style:D()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},j)},x)},M=v},40351:function(Y,Z,t){"use strict";t.r(Z),t.d(Z,{default:function(){return Vt}});var E=t(15009),g=t.n(E),D=t(99289),I=t.n(D),k=t(5574),h=t.n(k),U=t(97857),a=t.n(U),R=t(70501),d=t(96364),v=t(92016),M=t(66309),L=t(53846),r=t(86074),z=function(ke){var _=ke.status,K=(0,r.jsx)(M.Z,{children:_||"-"});return[d.Bj[1].value].includes(_)?K=(0,r.jsx)(M.Z,{className:L.Z.invalidTag,style:{marginLeft:6},children:(0,r.jsx)(v.FormattedMessage,{id:"common.tag.text.noExist"})}):K=(0,r.jsx)(M.Z,{className:L.Z.validTag,style:{marginLeft:6},children:(0,r.jsx)(v.FormattedMessage,{id:"common.tag.text.exist"})}),K},V=t(31732),c=t(24163),j=t(72028),x=t(37476),O=t(64317),S=t(90672),W=t(68872),C=t(23323),B=t(96486),A=t(62435),Se=function(_){var K=W.ZP.useMessage(),ie=h()(K,2),Ae=ie[0],Ve=ie[1],Ne=C.Z.useForm(),Ze=h()(Ne,1),pe=Ze[0],te=(0,v.useIntl)(),ye=_.ignoreRiskFormVisible,w=_.riskInfo,ue=_.setIgnoreRiskFormVisible,Q=_.tableActionRef,de=function(){pe.resetFields()},re=function(){ue(!1),de()},ce=function(){var ve=I()(g()().mark(function Ie(q){var Te,P,p;return g()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return Te=a()(a()({},q),{},{riskId:w.id}),ne.next=3,(0,j.ignoreRisk)(Te);case 3:P=ne.sent,P.code===200&&P.msg==="success"&&(Ae.success(te.formatMessage({id:"risk.message.api.ignore.risk.success"})),Q==null||(p=Q.current)===null||p===void 0||p.reload(),re());case 5:case"end":return ne.stop()}},Ie)}));return function(q){return ve.apply(this,arguments)}}();return(0,A.useEffect)(function(){ye&&!(0,B.isEmpty)(w)&&pe.setFieldsValue({ignoreReasonType:w==null?void 0:w.ignoreReasonType,ignoreReason:w==null?void 0:w.ignoreReason})},[ye,w]),(0,r.jsxs)(r.Fragment,{children:[Ve,(0,r.jsxs)(x.Y,{labelCol:{span:te.locale==="en-US"?6:4},title:te.formatMessage({id:"risk.module.text.ignore.risk"}),width:520,form:pe,modalProps:{destroyOnClose:!0,onCancel:function(){return re()},styles:{body:{paddingTop:12}}},open:ye,onFinish:ce,layout:"horizontal",children:[(0,r.jsx)(O.Z,{label:te.formatMessage({id:"risk.module.text.ignore.type"}),name:"ignoreReasonType",rules:[{required:!0}],options:d.$G}),(0,r.jsx)(S.Z,{label:te.formatMessage({id:"risk.module.text.ignore.reason"}),name:"ignoreReason",rules:[{required:!0}],fieldProps:{rows:6}})]})]})},Me=Se,Ee=t(57207),Le=t(77603),Oe=t(64818),he=t(92635),Fe=t(79930),Ce=t(96655),ee=t(17910),F=t(29448),b=t(68795),Re=t(39380),be=t(93410),we=t(90498),Pe=t(75302),Ye=t(3303),ae=t(86250),J=t(34041),N=t(25593),X=t(57381),G=t(83622),T=t(96074),bt=t(86738),wt=t(71230),Je=t(15746),Xe=t(84567),qe=t(47908),Pt=Pe.ZP.useBreakpoint,et=Ye.Z.SHOW_CHILD,kt=function(){var _,K=Pt(),ie=(0,v.useModel)("rule"),Ae=ie.platformList,Ve=ie.ruleGroupList,Ne=ie.ruleTypeList,Ze=(0,v.useRequest)(function(){return(0,Ce.queryAllTenantSelectRuleList)({})},{formatResult:function(n){var e;return((e=n.content)===null||e===void 0?void 0:e.map(function(l){return a()(a()({},l),{},{key:l==null?void 0:l.id,label:l==null?void 0:l.ruleName,value:l==null?void 0:l.ruleCode})}))||[]}}),pe=Ze.data,te=(0,v.useLocation)(),ye=te.search,w=new URLSearchParams(ye),ue=w.get("riskLevel"),Q=w.get("platform"),de=w.get("ruleCode"),re=w.get("resourceId"),ce=w.get("cloudAccountId"),ve=W.ZP.useMessage(),Ie=h()(ve,2),q=Ie[0],Te=Ie[1],P=(0,A.useRef)(),p=(0,A.useRef)(),tt=C.Z.useForm(),ne=h()(tt,1),y=ne[0],i=(0,v.useIntl)(),Nt=(0,A.useState)(!1),rt=h()(Nt,2),Zt=rt[0],nt=rt[1],lt=(0,A.useRef)({}),Bt=(0,A.useState)(!1),st=h()(Bt,2),Wt=st[0],ot=st[1],at=(0,A.useRef)({}),it=(0,A.useRef)({}),_t=(0,A.useState)(!1),ut=h()(_t,2),Ut=ut[0],dt=ut[1],$t=(0,A.useState)(!1),ct=h()($t,2),zt=ct[0],vt=ct[1],Gt=(0,A.useState)({}),ft=h()(Gt,2),mt=ft[0],Kt=ft[1],Qt=(0,A.useState)({}),gt=h()(Qt,2),je=gt[0],le=gt[1],Ht=(0,A.useState)((_=d.MW[0])===null||_===void 0?void 0:_.value),ht=h()(Ht,2),se=ht[0],Yt=ht[1],Jt=(0,A.useState)(!1),pt=h()(Jt,2),Xt=pt[0],yt=pt[1],qt=function(){var o=I()(g()().mark(function n(e){var l,s,u;return g()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return l={riskId:e.id},m.next=3,(0,j.cancelIgnoreRisk)(l);case 3:s=m.sent,s.code===200&&s.msg==="success"&&(q.success(i.formatMessage({id:"risk.message.api.cancel.ignore.risk.success"})),P==null||(u=P.current)===null||u===void 0||u.reload());case 5:case"end":return m.stop()}},n)}));return function(e){return o.apply(this,arguments)}}(),er=(0,A.useState)([]),It=h()(er,2),tr=It[0],Be=It[1],rr=(0,v.useRequest)(function(o){return(0,Fe.queryGroupTypeList)({platformList:o})},{manual:!0,formatResult:function(n){var e=n.content;Be(e||[])}}),xt=rr.run;(0,A.useEffect)(function(){var o={};if((0,B.isEmpty)(Q)||(y==null||y.setFieldValue("platformList",[Q]),y.setFieldValue("resourceType",null),Be([]),xt([Q]),o.platformList=[Q]),(0,B.isEmpty)(ue)||(y==null||y.setFieldValue("riskLevelList",[ue]),o.riskLevelList=[ue]),!(0,B.isEmpty)(de)){var n;(n=p.current)===null||n===void 0||n.setFieldValue("ruleCodeList",[de]),o.ruleCodeList=[de]}if(!(0,B.isEmpty)(re)){var e;(e=p.current)===null||e===void 0||e.setFieldValue("resourceId",re),o.resourceId=re}if(!(0,B.isEmpty)(ce)){var l;(l=p.current)===null||l===void 0||l.setFieldValue("cloudAccountId",ce),o.cloudAccountId=ce}Object.keys(o).length>0&&le(o)},[Q,ue,de,re,ce]);var We=(0,v.useRequest)(function(o){return(0,he.cloudAccountBaseInfoList)(a()({},o))},{formatResult:function(n){if(n.msg==="success"){var e;return(n==null||(e=n.content)===null||e===void 0||(e=e.accountAliasList)===null||e===void 0?void 0:e.map(function(l){return{label:l,value:l}}))||[]}}}),nr=We.data,Dt=We.run,lr=We.loading,sr=(0,A.useMemo)(function(){var o=function(e){Dt({platformList:y.getFieldValue("platformList")||[],cloudAccountSearch:e})};return(0,B.debounce)(o,500)},[he.cloudAccountBaseInfoList]),Mt=(0,v.useRequest)(function(o){return(0,j.listRuleStatistics)(a()({},o))},{manual:!0,formatResult:function(n){var e,l=[];return l=n==null||(e=n.content)===null||e===void 0?void 0:e.map(function(s){return{label:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:s==null?void 0:s.ruleName}),(0,r.jsx)(ae.Z,{align:"center",children:(0,r.jsx)(M.Z,{color:(0,F.nn)(ee.I9,s==null?void 0:s.riskLevel),style:{margin:"0 0 0 8px"},children:(s==null?void 0:s.count)||"-"})})]}),value:s.ruleCode}}),l}}),or=Mt.data,ar=Mt.run,Ct=(0,v.useRequest)(function(o){return(0,j.listCloudAccountStatistics)(a()({},o))},{manual:!0,formatResult:function(n){var e,l=[];return l=n==null||(e=n.content)===null||e===void 0?void 0:e.map(function(s){return{label:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:(s==null?void 0:s.alias)||(s==null?void 0:s.cloudAccountId)}),(0,r.jsx)(ae.Z,{align:"center",children:(0,r.jsx)(M.Z,{style:{margin:"0 0 0 8px"},children:(s==null?void 0:s.count)||"-"})})]}),value:s.cloudAccountId}}),l}}),ir=Ct.data,ur=Ct.run,dr=function(){var o=I()(g()().mark(function n(){var e,l;return g()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:l=a()(a()({status:se},y==null?void 0:y.getFieldsValue()),p==null||(e=p.current)===null||e===void 0?void 0:e.getFieldsValue()),yt(!0),(0,j.exportRiskList)(a()({},l),{responseType:"blob"}).then(function(f){if(f.type==="application/json"){var m=new FileReader;m.onload=function(){try{var $=JSON.parse(m.result);q.error($.msg||i.formatMessage({id:"common.message.text.export.failed"}))}catch(xe){q.error(i.formatMessage({id:"common.message.text.export.failed"}))}},m.readAsText(f)}else(0,F.Uc)(f,"CloudRec ".concat(i.formatMessage({id:"risk.module.text.risk.data"}))),q.success(i.formatMessage({id:"common.message.text.export.success"}))}).catch(function(f){q.error(i.formatMessage({id:"common.message.text.export.failed"})),console.error("Export failed:",f)}).finally(function(){return yt(!1)});case 3:case"end":return u.stop()}},n)}));return function(){return o.apply(this,arguments)}}(),cr=function(){var o=I()(g()().mark(function n(e){var l,s;return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!e){f.next=4;break}return s=a()(a()({status:se},y==null?void 0:y.getFieldsValue()),p==null||(l=p.current)===null||l===void 0?void 0:l.getFieldsValue()),f.next=4,ar(s);case 4:case"end":return f.stop()}},n)}));return function(e){return o.apply(this,arguments)}}(),vr=function(){var o=I()(g()().mark(function n(e){var l,s,u;return g()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!e){m.next=6;break}return u=a()(a()({status:se},y==null?void 0:y.getFieldsValue()),p==null||(l=p.current)===null||l===void 0?void 0:l.getFieldsValue()),!u.ruleCodeList&&(s=p.current)!==null&&s!==void 0&&s.getFieldValue("ruleCodeList")&&(u.ruleCodeList=p.current.getFieldValue("ruleCodeList")),u.ruleIdList&&delete u.ruleIdList,m.next=6,ur(u);case 6:case"end":return m.stop()}},n)}));return function(e){return o.apply(this,arguments)}}(),fr=function(){return{filterDropdown:function(e){var l=e.confirm;return(0,r.jsx)("div",{style:{padding:8},onKeyDown:function(u){return u.stopPropagation()},children:(0,r.jsx)(J.Z,{maxTagCount:"responsive",allowClear:!0,mode:"multiple",placeholder:i.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:or||[],onChange:function(u){var f,m;(f=p.current)===null||f===void 0||f.setFieldValue("ruleCodeList",u),le(function($){return a()(a()({},$),{},{ruleCodeList:u})}),(m=P.current)===null||m===void 0||m.reload(),l()},onBlur:function(){l()},style:{minWidth:320}})})},filterDropdownProps:{onOpenChange:cr},filterIcon:function(e){return(0,r.jsx)(b.Z,{style:{color:e?"#1677ff":"#1890ff",fontSize:"18px",fontWeight:"bold"}})},destroyOnClose:!0}},mr=function(n){dt(!0),it.current=n},gr=[a()({title:i.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",width:400,valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){var l,s,u,f,m,$,xe=function(){var fe;if(e!=null&&(fe=e.ruleVO)!==null&&fe!==void 0&&fe.id){var me;Kt({ruleId:e.ruleVO.id,ruleCode:(me=e.ruleId)===null||me===void 0?void 0:me.toString()}),vt(!0)}};return(0,r.jsxs)(ae.Z,{align:"center",children:[(0,r.jsx)("img",{src:(e==null?void 0:e.icon)||R.Z,alt:"RESOURCE_ICON",style:{width:20,height:20}}),(0,r.jsx)(N.Z.Text,{copyable:e!=null&&(l=e.ruleVO)!==null&&l!==void 0&&l.ruleName?{text:e.ruleVO.ruleName}:!1,style:{color:e!=null&&(s=e.ruleVO)!==null&&s!==void 0&&s.id?"#1890ff":"#333",fontSize:14,marginLeft:8,maxWidth:K!=null&&K.xxl?450:400,cursor:e!=null&&(u=e.ruleVO)!==null&&u!==void 0&&u.id?"pointer":"default"},ellipsis:{tooltip:(e==null||(f=e.ruleVO)===null||f===void 0?void 0:f.ruleName)||"-"},onClick:e!=null&&(m=e.ruleVO)!==null&&m!==void 0&&m.id?xe:void 0,children:(e==null||($=e.ruleVO)===null||$===void 0?void 0:$.ruleName)||"-"})]})}},fr()),{title:i.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",valueEnum:(0,F.W_)(pe),hideInTable:!0,colSize:2,fieldProps:{mode:"multiple"}},{title:i.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"select",colSize:1,fieldProps:{placeholder:i.formatMessage({id:"common.select.query.text.placeholder"}),showSearch:!0,notFoundContent:lr&&(0,r.jsx)(X.Z,{size:"small"}),onSearch:sr,options:nr||[],onChange:function(n){le(function(e){return a()(a()({},e),{},{cloudAccountId:n})})}},align:"left",filterDropdown:function(n){var e=n.confirm;return(0,r.jsx)("div",{style:{padding:8},onKeyDown:function(s){return s.stopPropagation()},children:(0,r.jsx)(J.Z,{allowClear:!0,placeholder:i.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:ir||[],onChange:function(s){var u,f;(u=p.current)===null||u===void 0||u.setFieldValue("cloudAccountId",s),le(function(m){return a()(a()({},m),{},{cloudAccountId:s})}),(f=P.current)===null||f===void 0||f.reload(),e()},onBlur:function(){e()},style:{minWidth:320}})})},filterDropdownProps:{onOpenChange:vr},filterIcon:function(n){return(0,r.jsx)(b.Z,{style:{color:n?"#1677ff":"#1890ff",fontSize:"18px",fontWeight:"bold"}})},render:function(n,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)(N.Z.Text,{copyable:e!=null&&e.cloudAccountId?{text:e.cloudAccountId}:!1,style:{color:"rgb(51, 51, 51)"},ellipsis:{tooltip:(e==null?void 0:e.cloudAccountId)||"-"},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,r.jsxs)(ae.Z,{style:{fontSize:"12px",color:"#999"},children:[(0,F.c5)(e.platform,Ae),(e==null?void 0:e.alias)||"-"]})]})}},{title:i.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),dataIndex:"ruleTypeIdList",valueType:"cascader",hideInTable:!0,colSize:1,fieldProps:{multiple:!0,options:Ne,showCheckedStrategy:et,fieldNames:{label:"typeName",value:"id",children:"childList"}}},{title:i.formatMessage({id:"layout.routes.title.ruleGroup"}),dataIndex:"ruleGroupIdList",valueType:"select",valueEnum:(0,F.W_)(Ve),hideInTable:!0,colSize:1,fieldProps:{mode:"multiple"}},{title:i.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeList",valueType:"cascader",align:"left",hideInTable:!0,colSize:1,fieldProps:{multiple:!0,showCheckedStrategy:et,options:tr,showSearch:!0,allowClear:!0}},{title:i.formatMessage({id:"common.table.columns.assetId"}),dataIndex:"resourceId",valueType:"text",align:"left",hideInTable:!0,colSize:1},{title:i.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceName",valueType:"text",align:"left",hideInTable:!0,colSize:1},{title:i.formatMessage({id:"risk.module.text.firstAndLast.discovered"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,r.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:i.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonTypeList",valueType:"checkbox",valueEnum:(0,F.W_)(d.$G),align:"left",hideInTable:!0,hideInSearch:se!=="IGNORED",colSize:6},{title:i.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,r.jsx)(V.Z,{text:e==null?void 0:e.resourceType})}},{title:i.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceNameDisplay",valueType:"text",align:"left",width:300,hideInSearch:!0,render:function(n,e){var l=(e==null?void 0:e.resourceStatus)===d.Bj[1].value?"(".concat(i.formatMessage({id:"risk.module.text.not.exist"}),") ")+e.resourceName:e.resourceName||"-";return(0,r.jsxs)(ae.Z,{align:"center",children:[(0,r.jsx)(N.Z.Text,{copyable:e!=null&&e.resourceName?{text:e.resourceName}:!1,style:{maxWidth:450},ellipsis:{tooltip:l},children:e.resourceName||"-"}),(0,r.jsx)(z,{status:e==null?void 0:e.resourceStatus})]})}},{title:i.formatMessage({id:"risk.module.text.first.discovery"}),dataIndex:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0,colSize:1,fieldProps:{presets:ee.El},search:{transform:function(n){return{gmtCreateStart:n[0],gmtCreateEnd:n[1]}}}},{title:i.formatMessage({id:"risk.module.text.recently.discovery"}),dataIndex:"modifiedTimeRange",valueType:"dateTimeRange",hideInTable:!0,colSize:1,fieldProps:{presets:ee.El},search:{transform:function(n){return{gmtModifiedStart:n[0],gmtModifiedEnd:n[1]}}}},{title:i.formatMessage({id:"common.table.columns.assetStatus"}),dataIndex:"resourceStatus",valueType:"select",valueEnum:(0,F.W_)(d.Bj),align:"left",hideInTable:!0,colSize:1},{title:i.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"text",align:"center",hideInSearch:!0,render:function(n,e){var l;return(0,F.Dd)(ee.I9,e==null||(l=e.ruleVO)===null||l===void 0?void 0:l.riskLevel)}},{title:i.formatMessage({id:"risk.module.text.risk.status"}),dataIndex:"status",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,F.Ff)(d.MW,e==null?void 0:e.status)}},{title:i.formatMessage({id:"risk.module.text.ignore.reason"}),dataIndex:"ignoreReason",valueType:"text",align:"left",hideInSearch:!0,hideInTable:se!=="IGNORED",render:function(n,e){return(0,r.jsx)(c.Z,{placement:"topLeft",text:e.ignoreReason||"-",maxWidth:210})}},{title:i.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonType",valueType:"select",valueEnum:(0,F.W_)(d.$G),align:"left",hideInSearch:!0,hideInTable:se!=="IGNORED"},{title:i.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(n,e){var l;return(0,r.jsxs)(r.Fragment,{children:[!((l=["WHITED"])!==null&&l!==void 0&&l.includes(e.status))&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(G.ZP,{size:"small",type:"link",onClick:function(){return mr({riskId:e==null?void 0:e.id})},children:i.formatMessage({id:"common.button.text.white"})}),(0,r.jsx)(T.Z,{type:"vertical"})]}),e.status==="IGNORED"?(0,r.jsx)(bt.Z,{title:(0,r.jsx)(r.Fragment,{}),description:i.formatMessage({id:"risk.module.text.cancel.ignore"}),onConfirm:function(){return qt(e)},onCancel:function(){},okText:i.formatMessage({id:"common.button.text.ok"}),cancelText:i.formatMessage({id:"common.button.text.cancel"}),children:(0,r.jsx)(G.ZP,{size:"small",type:"link",children:i.formatMessage({id:"common.button.text.cancelIgnore"})})}):(0,r.jsx)(G.ZP,{size:"small",type:"link",onClick:function(){at.current=a()({},e),ot(!0)},children:i.formatMessage({id:"common.button.text.ignore"})}),(0,r.jsx)(T.Z,{type:"vertical"}),(0,r.jsx)(G.ZP,{size:"small",type:"link",target:"_self",onClick:function(){nt(!0),lt.current=a()({},e)},children:i.formatMessage({id:"common.button.text.detail"})})]})}}],hr=function(){var o=I()(g()().mark(function n(e){var l,s,u,f,m,$,xe,De,fe,me,_e,Rt,At,Tt,jt,St,Et,Lt,Ot,Ue,$e,ze,Ge,H,Ke,Qe,He,oe,Ft;return g()().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return f=e.pageSize,m=e.current,$=e.ruleId,xe=e.ruleGroupIdList,De=e.cloudAccountId,fe=e.resourceName,me=e.resourceTypeList,_e=e.status,Rt=_e===void 0?"UNREPAIRED":_e,At=e.ignoreReasonTypeList,Tt=e.ruleTypeIdList,jt=e.gmtCreateStart,St=e.gmtCreateEnd,Et=e.gmtModifiedStart,Lt=e.gmtModifiedEnd,Ot=e.resourceStatus,Ue=y.getFieldValue("platformList"),$e=y.getFieldValue("riskLevelList"),ze=(l=p.current)===null||l===void 0?void 0:l.getFieldValue("ruleCodeList"),Ge=(s=p.current)===null||s===void 0?void 0:s.getFieldValue("resourceId"),H={page:m,size:f,ruleId:$,ruleGroupIdList:xe,cloudAccountId:De,resourceName:fe,resourceTypeList:me,status:Rt,ignoreReasonTypeList:At,ruleTypeIdList:Tt,gmtCreateStart:jt,gmtCreateEnd:St,gmtModifiedStart:Et,gmtModifiedEnd:Lt,resourceStatus:Ot},Ue&&(H.platformList=Ue),$e&&(H.riskLevelList=$e),ze&&(H.ruleCodeList=ze),Ge&&(H.resourceId=Ge),Ke=(u=p.current)===null||u===void 0?void 0:u.getFieldValue("cloudAccountId"),Qe=je.cloudAccountId,De?H.cloudAccountId=De:Ke?H.cloudAccountId=Ke:Qe&&(H.cloudAccountId=Qe),ge.next=15,(0,j.queryRiskList)(H);case 15:return He=ge.sent,oe=He.content,Ft=He.code,ge.abrupt("return",{data:(oe==null?void 0:oe.data)||[],total:(oe==null?void 0:oe.total)||0,success:Ft===200||!1});case 19:case"end":return ge.stop()}},n)}));return function(e){return o.apply(this,arguments)}}();return(0,r.jsxs)(Re._z,{title:!1,className:qe.Z.riskPageContainer,breadcrumbRender:!1,children:[Te,(0,r.jsx)(be.Z,{bodyStyle:{paddingBlock:0},className:qe.Z.customFilterCard,tabs:{activeKey:se,items:d.MW.map(function(o){return{label:o.label,key:o.value,children:(0,r.jsx)(C.Z,{form:y,children:(0,r.jsxs)(wt.Z,{gutter:[24,10],children:[(0,r.jsx)(Je.Z,{span:24,children:(0,r.jsx)(C.Z.Item,{name:"platformList",label:i.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,r.jsx)(Xe.Z.Group,{options:(0,F.T$)(Ae),onChange:function(e){y.setFieldValue("resourceTypeList",null),Be([]),xt(e),Dt({platformList:e||[]})}})})}),(0,r.jsx)(Je.Z,{span:24,children:(0,r.jsx)(C.Z.Item,{name:"riskLevelList",label:i.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,r.jsx)(Xe.Z.Group,{options:(0,F.at)(ee.I9)})})})]})})}})||[],onChange:function(n){var e,l,s;Yt(n),(e=p.current)===null||e===void 0||e.setFieldValue("ignoreReasonTypeList",[]);var u=y.getFieldsValue(),f=((l=p.current)===null||l===void 0?void 0:l.getFieldsValue())||{},m=a()(a()(a()(a()({},je),u),f),{},{status:n,ignoreReasonTypeList:[]});le(m),(s=P.current)===null||s===void 0||s.reload()}}}),(0,r.jsx)(we.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,labelWidth:0,defaultColsNumber:6},headerTitle:(0,r.jsx)("div",{className:L.Z.customTitle,children:i.formatMessage({id:"risk.module.text.risk.inquiry"})}),toolBarRender:function(){return[(0,r.jsx)(G.ZP,{type:"primary",loading:Xt,onClick:dr,children:i.formatMessage({id:"common.button.text.export"})},"export")]},actionRef:P,formRef:p,columns:gr,request:hr,onReset:function(){y.resetFields(),le({})},onSubmit:function(){var n,e=y.getFieldsValue(),l=((n=p.current)===null||n===void 0?void 0:n.getFieldsValue())||{};le(a()(a()(a()({},je),e),l))},params:a()({},je),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}}),(0,r.jsx)(Ee.Z,{locate:"risk",riskDrawerVisible:Zt,setRiskDrawerVisible:nt,riskDrawerInfo:lt.current,tableActionRef:P}),(0,r.jsx)(Me,{ignoreRiskFormVisible:Wt,setIgnoreRiskFormVisible:ot,riskInfo:at.current,tableActionRef:P}),(0,r.jsx)(Le.Z,{editDrawerVisible:Ut,setEditDrawerVisible:dt,whiteListDrawerInfo:it.current,tableActionRef:P}),(0,r.jsx)(Oe.Z,{visible:zt,onClose:function(){return vt(!1)},ruleId:mt.ruleId,ruleCode:mt.ruleCode})]})},Vt=kt},64818:function(Y,Z,t){"use strict";var E=t(15009),g=t.n(E),D=t(99289),I=t.n(D),k=t(5574),h=t.n(k),U=t(62435),a=t(68872),R=t(66309),d=t(85265),v=t(57381),M=t(26412),L=t(25593),r=t(92016),z=t(96655),V=t(29448),c=t(86074),j=function(O){var S=O.visible,W=O.onClose,C=O.ruleId,B=O.ruleCode,A=(0,r.useIntl)(),Se=a.ZP.useMessage(),Me=h()(Se,2),Ee=Me[0],Le=Me[1],Oe=(0,U.useState)(!1),he=h()(Oe,2),Fe=he[0],Ce=he[1],ee=(0,U.useState)(null),F=h()(ee,2),b=F[0],Re=F[1];(0,U.useEffect)(function(){S&&C&&be()},[S,C]);var be=function(){var J=I()(g()().mark(function N(){var X;return g()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(Ce(!0),T.prev=1,!C){T.next=6;break}return T.next=5,(0,z.queryRuleDetail)({id:C});case 5:X=T.sent;case 6:X&&X.content&&Re(X.content),T.next=12;break;case 9:T.prev=9,T.t0=T.catch(1),Ee.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return T.prev=12,Ce(!1),T.finish(12);case 15:case"end":return T.stop()}},N,null,[[1,9,12,15]])}));return function(){return J.apply(this,arguments)}}(),we=function(){Re(null),W()},Pe=function(N){switch(N.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},Ye=function(N){if(!N)return null;var X=N.split(",");return X.map(function(G,T){return(0,c.jsx)(R.Z,{color:Pe(G.trim()),children:G.trim()},T)})},ae=function(N){return(0,V.c5)(N)};return(0,c.jsxs)(c.Fragment,{children:[Le,(0,c.jsx)(d.Z,{title:"\u89C4\u5219\u8BE6\u60C5",placement:"right",onClose:we,open:S,width:1e3,destroyOnClose:!0,children:(0,c.jsx)(v.Z,{spinning:Fe,children:b&&(0,c.jsxs)(M.Z,{column:1,bordered:!0,children:[(0,c.jsx)(M.Z.Item,{label:"\u89C4\u5219\u540D\u79F0",children:(0,c.jsx)(L.Z.Text,{copyable:!0,children:b.ruleName})}),(0,c.jsx)(M.Z.Item,{label:"\u89C4\u5219code",children:(0,c.jsx)(L.Z.Text,{copyable:!0,children:b.ruleCode})}),(0,c.jsx)(M.Z.Item,{label:"\u4FEE\u590D\u5EFA\u8BAE",children:(0,c.jsx)(L.Z.Text,{copyable:!0,children:b.advice})}),(0,c.jsx)(M.Z.Item,{label:"\u4FEE\u590D\u6587\u6863",children:(0,c.jsx)(L.Z.Text,{copyable:!0,children:b.link})}),(0,c.jsx)(M.Z.Item,{label:"\u4E0A\u4E0B\u6587\u6A21\u677F",children:(0,c.jsx)(L.Z.Text,{copyable:!0,children:b.context})}),b.ruleRego&&(0,c.jsx)(M.Z.Item,{label:"\u7B56\u7565",children:(0,c.jsx)(L.Z.Paragraph,{copyable:!0,children:(0,c.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"1000px",overflow:"auto"},children:b.ruleRego})})}),b.createTime&&(0,c.jsx)(M.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:(0,c.jsx)(L.Z.Text,{copyable:!0,children:b.createTime})}),b.updateTime&&(0,c.jsx)(M.Z.Item,{label:"\u66F4\u65B0\u65F6\u95F4",children:(0,c.jsx)(L.Z.Text,{copyable:!0,children:b.updateTime})})]})})})]})};Z.Z=j},70501:function(Y,Z,t){"use strict";var E=t(62435),g=Object.defineProperty,D=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable,h=(R,d,v)=>d in R?g(R,d,{enumerable:!0,configurable:!0,writable:!0,value:v}):R[d]=v,U=(R,d)=>{for(var v in d||(d={}))I.call(d,v)&&h(R,v,d[v]);if(D)for(var v of D(d))k.call(d,v)&&h(R,v,d[v]);return R};const a=R=>React.createElement("svg",U({className:"DEFAULT_RESOURCE_ICON_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:256,height:256},R),React.createElement("path",{d:"M827.52 782.08a39.84 39.84 0 0 0 56.64 0l104.32-103.36a119.68 119.68 0 0 0 0-170.08L886.4 405.92a40 40 0 0 0-56.8 56.16l90.88 92h-322.4a40 40 0 0 0 0 80h322.24l-92.48 91.52a40 40 0 0 0-.32 56.48z",fill:"#1480ED"}),React.createElement("path",{d:"M864 80h-52V40a40 40 0 0 0-80 0v40H550.08V40a40 40 0 0 0-80 0v40h-180V40a40 40 0 1 0-80 0v40H160A160 160 0 0 0 0 240v624a160 160 0 0 0 160 160h704a160 160 0 0 0 160-160 40 40 0 0 0-80 0 80 80 0 0 1-80 80H160a80 80 0 0 1-80-80V240a80 80 0 0 1 80-80h50.08v40a40 40 0 0 0 80 0v-40h180v40a40 40 0 0 0 80 0v-40H732v40a40 40 0 0 0 80 0v-40h52a80 80 0 0 1 80 80v90.08a40 40 0 0 0 80 0V240A160 160 0 0 0 864 80z",fill:"#2A5699"}));Z.Z="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiI+PHBhdGggZD0iTTgyNy41MiA3ODIuMDhhMzkuODQgMzkuODQgMCAwIDAgNTYuNjQgMGwxMDQuMzItMTAzLjM2YTExOS42OCAxMTkuNjggMCAwIDAgMC0xNzAuMDhMODg2LjQgNDA1LjkyYTQwIDQwIDAgMCAwLTU2LjggNTYuMTZsOTAuODggOTJoLTMyMi40YTQwIDQwIDAgMCAwIDAgODBoMzIyLjI0bC05Mi40OCA5MS41MmE0MCA0MCAwIDAgMC0uMzIgNTYuNDh6IiBmaWxsPSIjMTQ4MEVEIi8+PHBhdGggZD0iTTg2NCA4MGgtNTJWNDBhNDAgNDAgMCAwIDAtODAgMHY0MEg1NTAuMDhWNDBhNDAgNDAgMCAwIDAtODAgMHY0MGgtMTgwVjQwYTQwIDQwIDAgMSAwLTgwIDB2NDBIMTYwQTE2MCAxNjAgMCAwIDAgMCAyNDB2NjI0YTE2MCAxNjAgMCAwIDAgMTYwIDE2MGg3MDRhMTYwIDE2MCAwIDAgMCAxNjAtMTYwIDQwIDQwIDAgMCAwLTgwIDAgODAgODAgMCAwIDEtODAgODBIMTYwYTgwIDgwIDAgMCAxLTgwLTgwVjI0MGE4MCA4MCAwIDAgMSA4MC04MGg1MC4wOHY0MGE0MCA0MCAwIDAgMCA4MCAwdi00MGgxODB2NDBhNDAgNDAgMCAwIDAgODAgMHYtNDBINzMydjQwYTQwIDQwIDAgMCAwIDgwIDB2LTQwaDUyYTgwIDgwIDAgMCAxIDgwIDgwdjkwLjA4YTQwIDQwIDAgMCAwIDgwIDBWMjQwQTE2MCAxNjAgMCAwIDAgODY0IDgweiIgZmlsbD0iIzJBNTY5OSIvPjwvc3ZnPg=="},85674:function(Y,Z,t){var E={"./simpleWorker":18352,"./simpleWorker.js":18352};function g(D){return Promise.resolve().then(function(){if(!t.o(E,D)){var I=new Error("Cannot find module '"+D+"'");throw I.code="MODULE_NOT_FOUND",I}var k=E[D];return t(k)})}g.keys=function(){return Object.keys(E)},g.id=85674,Y.exports=g},10131:function(Y,Z,t){var E={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function g(D){if(!t.o(E,D))return Promise.resolve().then(function(){var h=new Error("Cannot find module '"+D+"'");throw h.code="MODULE_NOT_FOUND",h});var I=E[D],k=I[0];return Promise.all(I.slice(1).map(t.e)).then(function(){return t(k)})}g.keys=function(){return Object.keys(E)},g.id=10131,Y.exports=g}}]);
