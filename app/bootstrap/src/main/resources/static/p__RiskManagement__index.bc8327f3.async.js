"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7530],{31732:function(Ce,P,t){var V=t(97857),m=t.n(V),k=t(66309),x=t(62435),W=t(86074);P.Z=function(h){var Z=h.text,d=h.style;return(0,W.jsx)(k.Z,{style:m()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},d),children:Z})}},28235:function(Ce,P,t){var V=t(97857),m=t.n(V),k=t(25593),x=t(83062),W=t(62435),h=t(86074),Z=k.Z.Paragraph;P.Z=function(d){var p=d.text,c=d.width,g=d.maxWidth,S=d.rows,G=S===void 0?2:S,s=d.placement,U=s===void 0?"top":s,ee=d.color,te=ee===void 0?"rgba(0, 0, 0, 0.88)":ee,b=d.link,B=b===void 0?!1:b,oe=d.onClickCallBackFunc,se=d.style,ue=se===void 0?{}:se,Q=d.copyable,T=Q===void 0?!1:Q,R=d.tooltipText;return(0,h.jsx)("div",{style:{maxWidth:g,width:c},children:(0,h.jsx)(x.Z,{title:R,placement:U,children:(0,h.jsx)(Z,{ellipsis:{rows:G},style:m()({marginBottom:0,color:te,cursor:B?"pointer":""},ue),onClick:oe,copyable:T,children:p})})})}},92086:function(Ce,P,t){var V=t(5574),m=t.n(V),k=t(87426),x=t(39421),W=t(24163),h=t(71448),Z=t(24482),d=t(50322),p=t(22145),c=t(96364),g=t(72028),S=t(29448),G=t(45742),s=t(93410),U=t(92016),ee=t(25593),te=t(85265),b=t(86250),B=t(83622),oe=t(42075),se=t(66309),ue=t(83062),Q=t(21532),T=t(23323),R=t(62435),f=t(47908),a=t(86074),K=ee.Z.Text,Se=function(z){var de,F,M,ce,me,ge,ve=z.riskDrawerVisible,j=z.riskDrawerInfo,be=z.setRiskDrawerVisible,fe=z.locate,we=(0,U.useModel)("rule"),Ze=we.platformList,Y=(0,U.useModel)("tenant"),re=Y.tenantListAll,O=(0,U.useIntl)(),Be=(0,R.useState)(!1),xe=m()(Be,2),Ae=xe[0],Te=xe[1],Fe=(0,R.useState)(!1),he=m()(Fe,2),Ne=he[0],Le=he[1],Me=function(){be(!1)},D=(0,U.useRequest)(function(E){return(0,g.queryRiskDetailById)({riskId:E})},{manual:!0,formatResult:function(pe){return pe.content||{}}}),r=D.data,N=D.run,ne=D.loading,Ie=function(){Me()};return(0,R.useEffect)(function(){ve&&j!==null&&j!==void 0&&j.id&&N(j.id)},[ve,j]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(te.Z,{title:O.formatMessage({id:"risk.module.text.detail.info"}),width:"50%",open:ve,onClose:Ie,loading:ne,children:[(0,a.jsxs)(s.Z,{style:{marginBottom:20},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,a.jsx)(b.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,a.jsxs)("span",{children:[(0,a.jsx)(K,{style:{marginRight:12},children:(0,a.jsx)(B.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(r==null?void 0:r.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(r==null||(de=r.ruleVO)===null||de===void 0?void 0:de.ruleName)||"-"})}),(0,a.jsxs)(oe.Z,{children:[(0,a.jsx)("span",{children:(0,S.Ff)(c.MW,r==null?void 0:r.status)}),(r==null?void 0:r.ignoreReasonType)&&(0,a.jsxs)("span",{children:[(0,a.jsxs)(K,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[O.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,a.jsx)(se.Z,{color:"geekblue",children:((F=c.$G.find(function(E){return E.value===(r==null?void 0:r.ignoreReasonType)}))===null||F===void 0?void 0:F.label)||"-"})]}),(r==null?void 0:r.ignoreReason)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(K,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[O.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,a.jsx)(W.Z,{rows:1,text:r==null?void 0:r.ignoreReason,maxWidth:64})]})]})]})}),(0,a.jsxs)(b.Z,{vertical:!0,gap:10,children:[(0,a.jsxs)(b.Z,{align:"center",children:[(0,a.jsx)("img",{src:x.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,a.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[O.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,a.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:r==null?void 0:r.gmtModified})]}),(0,a.jsxs)(K,{children:[(0,a.jsx)("img",{src:k.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,a.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[O.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,a.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:r==null?void 0:r.gmtCreate})]})]}),(0,a.jsxs)(b.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,a.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,S.fD)(r==null?void 0:r.platform,Ze)}),(0,a.jsx)(K,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(r==null?void 0:r.resourceType)||"-"}),(0,a.jsxs)(b.Z,{align:"center",children:[(0,a.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(r==null?void 0:r.resourceName)+" / "+(r==null?void 0:r.resourceId)}),fe==="risk"&&(0,a.jsx)(ue.Z,{title:O.formatMessage({id:"asset.extend.text.detail"}),children:(0,a.jsx)("span",{className:f.Z.iconWrap,onClick:function(){return Le(!0)},children:(0,a.jsx)(G.Z,{className:f.Z.resourceInstance})})})]}),(0,a.jsx)(K,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(re==null||(M=re.find(function(E){return E.value===(r==null?void 0:r.tenantId)}))===null||M===void 0?void 0:M.label)||"-"})]})]}),(0,a.jsx)(Q.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,a.jsxs)(T.Z,{children:[(0,a.jsx)(T.Z.Item,{label:O.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,a.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(r==null||(ce=r.ruleVO)===null||ce===void 0?void 0:ce.advice)||"-"})}),(0,a.jsx)(T.Z.Item,{label:O.formatMessage({id:"risk.module.text.reference.link"}),children:(0,a.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(r==null||(me=r.ruleVO)===null||me===void 0?void 0:me.link)||"-"})}),(0,a.jsx)(T.Z.Item,{label:O.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,a.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(r==null||(ge=r.ruleVO)===null||ge===void 0?void 0:ge.ruleDesc)||"-"})})]})}),(0,a.jsx)(h.Z,{riskDrawerInfo:j}),(0,a.jsx)(d.Z,{riskDrawerInfo:j})]}),(0,a.jsx)(Z.Z,{evaluateDrawerVisible:Ae,setEvaluateDrawerVisible:Te,riskDrawerInfo:j}),(0,a.jsx)(p.Z,{resourceDrawerVisible:Ne,setResourceDrawerVisible:Le,riskDrawerInfo:j})]})};P.Z=Se},40351:function(Ce,P,t){t.r(P),t.d(P,{default:function(){return Le}});var V=t(97857),m=t.n(V),k=t(15009),x=t.n(k),W=t(99289),h=t.n(W),Z=t(5574),d=t.n(Z),p=t(70501),c=t(96364),g=t(92016),S=t(66309),G=t(53846),s=t(86074),U=function(Me){var D=Me.status,r=(0,s.jsx)(S.Z,{children:D||"-"});return[c.Bj[1].value].includes(D)?r=(0,s.jsx)(S.Z,{className:G.Z.invalidTag,style:{marginLeft:6},children:(0,s.jsx)(g.FormattedMessage,{id:"common.tag.text.noExist"})}):r=(0,s.jsx)(S.Z,{className:G.Z.validTag,style:{marginLeft:6},children:(0,s.jsx)(g.FormattedMessage,{id:"common.tag.text.exist"})}),r},ee=t(31732),te=t(24163),b=t(28235),B=t(72028),oe=t(37476),se=t(64317),ue=t(90672),Q=t(68872),T=t(23323),R=t(96486),f=t(62435),a=function(D){var r=Q.ZP.useMessage(),N=d()(r,2),ne=N[0],Ie=N[1],E=T.Z.useForm(),pe=d()(E,1),De=pe[0],H=(0,g.useIntl)(),$=D.ignoreRiskFormVisible,C=D.riskInfo,ae=D.setIgnoreRiskFormVisible,J=D.tableActionRef,ye=function(){De.resetFields()},je=function(){ae(!1),ye()},Oe=function(){var w=h()(x()().mark(function _e(_){var I,Re,Ee;return x()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return I=m()(m()({},_),{},{riskId:C.id}),i.next=3,(0,B.ignoreRisk)(I);case 3:Re=i.sent,Re.code===200&&Re.msg==="success"&&(ne.success(H.formatMessage({id:"risk.message.api.ignore.risk.success"})),J==null||(Ee=J.current)===null||Ee===void 0||Ee.reload(),je());case 5:case"end":return i.stop()}},_e)}));return function(_){return w.apply(this,arguments)}}();return(0,f.useEffect)(function(){$&&!(0,R.isEmpty)(C)&&De.setFieldsValue({ignoreReasonType:C==null?void 0:C.ignoreReasonType,ignoreReason:C==null?void 0:C.ignoreReason})},[$,C]),(0,s.jsxs)(s.Fragment,{children:[Ie,(0,s.jsxs)(oe.Y,{labelCol:{span:H.locale==="en-US"?6:4},title:H.formatMessage({id:"risk.module.text.ignore.risk"}),width:520,form:De,modalProps:{destroyOnClose:!0,onCancel:function(){return je()},styles:{body:{paddingTop:12}}},open:$,onFinish:Oe,layout:"horizontal",children:[(0,s.jsx)(se.Z,{label:H.formatMessage({id:"risk.module.text.ignore.type"}),name:"ignoreReasonType",rules:[{required:!0}],options:c.$G}),(0,s.jsx)(ue.Z,{label:H.formatMessage({id:"risk.module.text.ignore.reason"}),name:"ignoreReason",rules:[{required:!0}],fieldProps:{rows:6}})]})]})},K=a,Se=t(92086),Je=t(77603),z=t(92635),de=t(79930),F=t(17910),M=t(29448),ce=t(68795),me=t(39380),ge=t(93410),ve=t(70989),j=t(75302),be=t(3303),fe=t(86250),we=t(34041),Ze=t(57381),Y=t(83622),re=t(96074),O=t(86738),Be=t(71230),xe=t(15746),Ae=t(84567),Te=t(47908),Fe=j.ZP.useBreakpoint,he=be.Z.SHOW_CHILD,Ne=function(){var D,r=Fe(),N=(0,g.useModel)("rule"),ne=N.platformList,Ie=N.ruleGroupList,E=N.ruleTypeList,pe=N.allRuleList,De=(0,g.useLocation)(),H=De.search,$=new URLSearchParams(H),C=$.get("riskLevel"),ae=$.get("platform"),J=$.get("ruleCode"),ye=$.get("resourceId"),je=Q.ZP.useMessage(),Oe=d()(je,2),w=Oe[0],_e=Oe[1],_=(0,f.useRef)(),I=(0,f.useRef)(),Re=T.Z.useForm(),Ee=d()(Re,1),v=Ee[0],i=(0,g.useIntl)(),Lt=(0,f.useState)(!1),Xe=d()(Lt,2),jt=Xe[0],qe=Xe[1],et=(0,f.useRef)({}),Ot=(0,f.useState)(!1),tt=d()(Ot,2),_t=tt[0],st=tt[1],rt=(0,f.useRef)({}),nt=(0,f.useRef)({}),Pt=(0,f.useState)(!1),at=d()(Pt,2),kt=at[0],it=at[1],St=(0,f.useState)({}),lt=d()(St,2),ot=lt[0],Ve=lt[1],bt=(0,f.useState)((D=c.MW[0])===null||D===void 0?void 0:D.value),ut=d()(bt,2),ie=ut[0],wt=ut[1],Zt=(0,f.useState)(!1),dt=d()(Zt,2),Bt=dt[0],ct=dt[1],Ft=function(){var l=h()(x()().mark(function n(e){var o,u,A;return x()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return o={riskId:e.id},L.next=3,(0,B.cancelIgnoreRisk)(o);case 3:u=L.sent,u.code===200&&u.msg==="success"&&(w.success(i.formatMessage({id:"risk.message.api.cancel.ignore.risk.success"})),_==null||(A=_.current)===null||A===void 0||A.reload());case 5:case"end":return L.stop()}},n)}));return function(e){return l.apply(this,arguments)}}(),Nt=(0,f.useState)([]),mt=d()(Nt,2),Vt=mt[0],We=mt[1],Wt=(0,g.useRequest)(function(l){return(0,de.queryGroupTypeList)({platformList:l})},{manual:!0,formatResult:function(n){var e=n.content;We(e||[])}}),gt=Wt.run;(0,f.useEffect)(function(){if((0,R.isEmpty)(ae)||(v==null||v.setFieldValue("platformList",[ae]),v.setFieldValue("resourceType",null),We([]),gt([ae])),(0,R.isEmpty)(C)||v==null||v.setFieldValue("riskLevelList",[C]),!(0,R.isEmpty)(J)){var l;(l=I.current)===null||l===void 0||l.setFieldValue("ruleCodeList",[J])}if(!(0,R.isEmpty)(ye)){var n;(n=I.current)===null||n===void 0||n.setFieldValue("resourceId",ye)}},[ae,C,J,ye]);var Ue=(0,g.useRequest)(function(l){return(0,z.cloudAccountBaseInfoList)(m()({},l))},{formatResult:function(n){if(n.msg==="success"){var e;return(n==null||(e=n.content)===null||e===void 0||(e=e.accountAliasList)===null||e===void 0?void 0:e.map(function(o){return{label:o,value:o}}))||[]}}}),Ut=Ue.data,vt=Ue.run,Kt=Ue.loading,$t=(0,f.useMemo)(function(){var l=function(e){vt({platformList:v.getFieldValue("platformList")||[],cloudAccountSearch:e})};return(0,R.debounce)(l,500)},[z.cloudAccountBaseInfoList]),ft=(0,g.useRequest)(function(l){return(0,B.listRuleStatistics)(m()({},l))},{manual:!0,formatResult:function(n){var e,o=[];return o=n==null||(e=n.content)===null||e===void 0?void 0:e.map(function(u){return{label:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)("span",{children:u==null?void 0:u.ruleName}),(0,s.jsx)(fe.Z,{align:"center",children:(0,s.jsx)(S.Z,{color:(0,M.nn)(F.I9,u==null?void 0:u.riskLevel),style:{margin:"0 0 0 8px"},children:(u==null?void 0:u.count)||"-"})})]}),value:u.ruleId}}),o}}),Gt=ft.data,Qt=ft.run,zt=function(){var l=h()(x()().mark(function n(){var e,o;return x()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:o=m()(m()({status:ie},v==null?void 0:v.getFieldsValue()),I==null||(e=I.current)===null||e===void 0?void 0:e.getFieldsValue()),ct(!0),(0,B.exportRiskList)(m()({},o),{responseType:"blob"}).then(function(y){if(y.type==="application/json"){var L=new FileReader;L.onload=function(){try{var Pe=JSON.parse(L.result);w.error(Pe.msg||i.formatMessage({id:"common.message.text.export.failed"}))}catch(Ke){w.error(i.formatMessage({id:"common.message.text.export.failed"}))}},L.readAsText(y)}else(0,M.Uc)(y,"CloudRec ".concat(i.formatMessage({id:"risk.module.text.risk.data"}))),w.success(i.formatMessage({id:"common.message.text.export.success"}))}).catch(function(y){w.error(i.formatMessage({id:"common.message.text.export.failed"})),console.error("Export failed:",y)}).finally(function(){return ct(!1)});case 3:case"end":return A.stop()}},n)}));return function(){return l.apply(this,arguments)}}(),Yt=(0,f.useState)(),xt=d()(Yt,2),Ht=xt[0],Jt=xt[1],Xt=function(){var l=h()(x()().mark(function n(e){var o,u;return x()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!e){y.next=4;break}return u=m()(m()({status:ie},v==null?void 0:v.getFieldsValue()),I==null||(o=I.current)===null||o===void 0?void 0:o.getFieldsValue()),y.next=4,Qt(u);case 4:case"end":return y.stop()}},n)}));return function(e){return l.apply(this,arguments)}}(),qt=function(){return{filterDropdown:function(e){var o=e.confirm;return(0,s.jsx)("div",{style:{padding:8},onKeyDown:function(A){return A.stopPropagation()},children:(0,s.jsx)(we.Z,{maxTagCount:"responsive",allowClear:!0,mode:"multiple",placeholder:i.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:Gt||[],onChange:(0,R.debounce)(function(u){Jt(u),o()},1e3),style:{minWidth:180}})})},filterDropdownProps:{onOpenChange:Xt},filterIcon:function(e){return(0,s.jsx)(ce.Z,{style:{color:e?"#1677ff":void 0}})},destroyOnClose:!0}},es=function(n){it(!0),nt.current=n},ts=[m()({title:i.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){var o;return(0,s.jsxs)(fe.Z,{align:"center",children:[(0,s.jsx)("img",{src:(e==null?void 0:e.icon)||p.Z,alt:"RESOURCE_ICON",style:{width:18,height:18}}),(0,s.jsx)(te.Z,{text:(e==null||(o=e.ruleVO)===null||o===void 0?void 0:o.ruleName)||"-",maxWidth:r!=null&&r.xxl?280:240,rows:1,style:{color:"#333",fontSize:14,marginLeft:8},placement:"topLeft"})]})}},qt()),{title:i.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",valueEnum:(0,M.W_)(pe),hideInTable:!0,fieldProps:{mode:"multiple"}},{title:i.formatMessage({id:"risk.module.text.firstAndLast.discovered"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,s.jsxs)("div",{children:[(0,s.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,s.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:i.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonTypeList",valueType:"checkbox",valueEnum:(0,M.W_)(c.$G),align:"left",hideInTable:!0,hideInSearch:ie!=="IGNORED"},{title:i.formatMessage({id:"layout.routes.title.ruleGroup"}),dataIndex:"ruleGroupIdList",valueType:"select",valueEnum:(0,M.W_)(Ie),hideInTable:!0,fieldProps:{mode:"multiple"}},{title:i.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeList",valueType:"cascader",align:"left",hideInTable:!0,fieldProps:{multiple:!0,showCheckedStrategy:he,options:Vt,showSearch:!0,allowClear:!0}},{title:i.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),dataIndex:"ruleTypeIdList",valueType:"cascader",hideInTable:!0,fieldProps:{multiple:!0,options:E,showCheckedStrategy:he,fieldNames:{label:"typeName",value:"id",children:"childList"}}},{title:i.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"select",fieldProps:{placeholder:i.formatMessage({id:"common.select.query.text.placeholder"}),showSearch:!0,notFoundContent:Kt&&(0,s.jsx)(Ze.Z,{size:"small"}),onSearch:$t,options:Ut||[]},align:"left",render:function(n,e){return(0,s.jsxs)("div",{children:[(0,s.jsx)("section",{style:{color:"rgb(51, 51, 51)"},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,s.jsxs)(fe.Z,{style:{fontSize:"12px",color:"#999"},children:[(0,M.c5)(e.platform,ne),(e==null?void 0:e.alias)||"-"]})]})}},{title:i.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,s.jsx)(ee.Z,{text:e==null?void 0:e.resourceType})}},{title:i.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceName",valueType:"text",align:"left",width:200,render:function(n,e){return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(b.Z,{placement:"topLeft",maxWidth:400,rows:1,text:(0,s.jsxs)(s.Fragment,{children:[e.resourceName||"-",(0,s.jsx)(U,{status:e==null?void 0:e.resourceStatus})]}),tooltipText:(e==null?void 0:e.resourceStatus)===c.Bj[1].value?"(".concat(i.formatMessage({id:"risk.module.text.not.exist"}),") ")+e.resourceName:e.resourceName||"-"})})}},{title:i.formatMessage({id:"common.table.columns.assetId"}),dataIndex:"resourceId",valueType:"text",align:"left",hideInTable:!0},{title:i.formatMessage({id:"common.table.columns.assetStatus"}),dataIndex:"resourceStatus",valueType:"select",valueEnum:(0,M.W_)(c.Bj),align:"left",hideInTable:!0},{title:i.formatMessage({id:"risk.module.text.first.discovery"}),dataIndex:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0,fieldProps:{presets:F.El},search:{transform:function(n){return{gmtCreateStart:n[0],gmtCreateEnd:n[1]}}}},{title:i.formatMessage({id:"risk.module.text.recently.discovery"}),dataIndex:"modifiedTimeRange",valueType:"dateTimeRange",hideInTable:!0,fieldProps:{presets:F.El},search:{transform:function(n){return{gmtModifiedStart:n[0],gmtModifiedEnd:n[1]}}}},{title:i.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"text",align:"center",hideInSearch:!0,render:function(n,e){var o;return(0,M.Dd)(F.I9,e==null||(o=e.ruleVO)===null||o===void 0?void 0:o.riskLevel)}},{title:i.formatMessage({id:"risk.module.text.risk.status"}),dataIndex:"status",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,M.Ff)(c.MW,e==null?void 0:e.status)}},{title:i.formatMessage({id:"risk.module.text.ignore.reason"}),dataIndex:"ignoreReason",valueType:"text",align:"left",hideInSearch:!0,hideInTable:ie!=="IGNORED",render:function(n,e){return(0,s.jsx)(te.Z,{placement:"topLeft",text:e.ignoreReason||"-",maxWidth:210})}},{title:i.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonType",valueType:"select",valueEnum:(0,M.W_)(c.$G),align:"left",hideInSearch:!0,hideInTable:ie!=="IGNORED"},{title:i.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(n,e){var o;return(0,s.jsxs)(s.Fragment,{children:[!((o=["WHITED"])!==null&&o!==void 0&&o.includes(e.status))&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Y.ZP,{size:"small",type:"link",onClick:function(){return es({riskId:e==null?void 0:e.id})},children:i.formatMessage({id:"common.button.text.white"})}),(0,s.jsx)(re.Z,{type:"vertical"})]}),e.status==="IGNORED"?(0,s.jsx)(O.Z,{title:(0,s.jsx)(s.Fragment,{}),description:i.formatMessage({id:"risk.module.text.cancel.ignore"}),onConfirm:function(){return Ft(e)},onCancel:function(){},okText:i.formatMessage({id:"common.button.text.ok"}),cancelText:i.formatMessage({id:"common.button.text.cancel"}),children:(0,s.jsx)(Y.ZP,{size:"small",type:"link",children:i.formatMessage({id:"common.button.text.cancelIgnore"})})}):(0,s.jsx)(Y.ZP,{size:"small",type:"link",onClick:function(){rt.current=m()({},e),st(!0)},children:i.formatMessage({id:"common.button.text.ignore"})}),(0,s.jsx)(re.Z,{type:"vertical"}),(0,s.jsx)(Y.ZP,{size:"small",type:"link",target:"_self",onClick:function(){qe(!0),et.current=m()({},e)},children:i.formatMessage({id:"common.button.text.detail"})})]})}}],ss=function(){var l=h()(x()().mark(function n(e){var o,u,A,y,L,Pe,Ke,ht,Mt,$e,It,pt,Dt,ke,yt,Rt,Et,Ct,At,Ge,Qe,ze,Ye,X,He,q,Tt;return x()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return A=e.pageSize,y=e.current,L=e.ruleId,Pe=e.ruleGroupIdList,Ke=e.cloudAccountId,ht=e.resourceName,Mt=e.resourceTypeList,$e=e.status,It=$e===void 0?"UNREPAIRED":$e,pt=e.ignoreReasonTypeList,Dt=e.ruleTypeIdList,ke=e.ruleIdList,yt=e.gmtCreateStart,Rt=e.gmtCreateEnd,Et=e.gmtModifiedStart,Ct=e.gmtModifiedEnd,At=e.resourceStatus,Ge=v.getFieldValue("platformList"),Qe=v.getFieldValue("riskLevelList"),ze=(o=I.current)===null||o===void 0?void 0:o.getFieldValue("ruleCodeList"),Ye=(u=I.current)===null||u===void 0?void 0:u.getFieldValue("resourceId"),X={page:y,size:A,ruleId:L,ruleGroupIdList:Pe,cloudAccountId:Ke,resourceName:ht,resourceTypeList:Mt,status:It,ignoreReasonTypeList:pt,ruleTypeIdList:Dt,gmtCreateStart:yt,gmtCreateEnd:Rt,gmtModifiedStart:Et,gmtModifiedEnd:Ct,resourceStatus:At},Ge&&(X.platformList=Ge),Qe&&(X.riskLevelList=Qe),ze&&(X.ruleCodeList=ze),Ye&&(X.resourceId=Ye),ke&&!(0,R.isEmpty)(ke)&&(X.ruleIdList=ke),le.next=13,(0,B.queryRiskList)(X);case 13:return He=le.sent,q=He.content,Tt=He.code,le.abrupt("return",{data:(q==null?void 0:q.data)||[],total:(q==null?void 0:q.total)||0,success:Tt===200||!1});case 17:case"end":return le.stop()}},n)}));return function(e){return l.apply(this,arguments)}}();return(0,s.jsxs)(me._z,{title:!1,className:Te.Z.riskPageContainer,breadcrumbRender:!1,children:[_e,(0,s.jsx)(ge.Z,{bodyStyle:{paddingBlock:0},className:Te.Z.customFilterCard,tabs:{activeKey:ie,items:c.MW.map(function(l){return{label:l.label,key:l.value,children:(0,s.jsx)(T.Z,{form:v,children:(0,s.jsxs)(Be.Z,{gutter:[24,10],children:[(0,s.jsx)(xe.Z,{span:24,children:(0,s.jsx)(T.Z.Item,{name:"platformList",label:i.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,s.jsx)(Ae.Z.Group,{options:(0,M.T$)(ne),onChange:function(e){v.setFieldValue("resourceTypeList",null),We([]),gt(e),vt({platformList:e||[]})}})})}),(0,s.jsx)(xe.Z,{span:24,children:(0,s.jsx)(T.Z.Item,{name:"riskLevelList",label:i.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,s.jsx)(Ae.Z.Group,{options:(0,M.at)(F.I9)})})})]})})}})||[],onChange:function(n){var e,o,u;wt(n),(e=I.current)===null||e===void 0||e.setFieldValue("ignoreReasonTypeList",[]),(o=I.current)===null||o===void 0||o.resetFields(),v.setFieldValue("platformList",[]),v.setFieldValue("riskLevelList",null),(u=_.current)===null||u===void 0||u.reset(),Ve({status:n})}}}),(0,s.jsx)(ve.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},headerTitle:(0,s.jsx)("div",{className:G.Z.customTitle,children:i.formatMessage({id:"risk.module.text.risk.inquiry"})}),toolBarRender:function(){return[(0,s.jsx)(Y.ZP,{type:"primary",loading:Bt,onClick:zt,children:i.formatMessage({id:"common.button.text.export"})},"export")]},actionRef:_,formRef:I,columns:ts,request:ss,onReset:function(){v.resetFields(),Ve({})},onSubmit:function(){var n=v.getFieldsValue();Ve(m()(m()({},ot),n))},params:m()(m()({},ot),{},{ruleIdList:Ht}),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}}),(0,s.jsx)(Se.Z,{locate:"risk",riskDrawerVisible:jt,setRiskDrawerVisible:qe,riskDrawerInfo:et.current,tableActionRef:_}),(0,s.jsx)(K,{ignoreRiskFormVisible:_t,setIgnoreRiskFormVisible:st,riskInfo:rt.current,tableActionRef:_}),(0,s.jsx)(Je.Z,{editDrawerVisible:kt,setEditDrawerVisible:it,whiteListDrawerInfo:nt.current,tableActionRef:_})]})},Le=Ne},70501:function(Ce,P,t){var V=t(62435),m=Object.defineProperty,k=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,h=(p,c,g)=>c in p?m(p,c,{enumerable:!0,configurable:!0,writable:!0,value:g}):p[c]=g,Z=(p,c)=>{for(var g in c||(c={}))x.call(c,g)&&h(p,g,c[g]);if(k)for(var g of k(c))W.call(c,g)&&h(p,g,c[g]);return p};const d=p=>React.createElement("svg",Z({className:"DEFAULT_RESOURCE_ICON_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:256,height:256},p),React.createElement("path",{d:"M827.52 782.08a39.84 39.84 0 0 0 56.64 0l104.32-103.36a119.68 119.68 0 0 0 0-170.08L886.4 405.92a40 40 0 0 0-56.8 56.16l90.88 92h-322.4a40 40 0 0 0 0 80h322.24l-92.48 91.52a40 40 0 0 0-.32 56.48z",fill:"#1480ED"}),React.createElement("path",{d:"M864 80h-52V40a40 40 0 0 0-80 0v40H550.08V40a40 40 0 0 0-80 0v40h-180V40a40 40 0 1 0-80 0v40H160A160 160 0 0 0 0 240v624a160 160 0 0 0 160 160h704a160 160 0 0 0 160-160 40 40 0 0 0-80 0 80 80 0 0 1-80 80H160a80 80 0 0 1-80-80V240a80 80 0 0 1 80-80h50.08v40a40 40 0 0 0 80 0v-40h180v40a40 40 0 0 0 80 0v-40H732v40a40 40 0 0 0 80 0v-40h52a80 80 0 0 1 80 80v90.08a40 40 0 0 0 80 0V240A160 160 0 0 0 864 80z",fill:"#2A5699"}));P.Z="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiI+PHBhdGggZD0iTTgyNy41MiA3ODIuMDhhMzkuODQgMzkuODQgMCAwIDAgNTYuNjQgMGwxMDQuMzItMTAzLjM2YTExOS42OCAxMTkuNjggMCAwIDAgMC0xNzAuMDhMODg2LjQgNDA1LjkyYTQwIDQwIDAgMCAwLTU2LjggNTYuMTZsOTAuODggOTJoLTMyMi40YTQwIDQwIDAgMCAwIDAgODBoMzIyLjI0bC05Mi40OCA5MS41MmE0MCA0MCAwIDAgMC0uMzIgNTYuNDh6IiBmaWxsPSIjMTQ4MEVEIi8+PHBhdGggZD0iTTg2NCA4MGgtNTJWNDBhNDAgNDAgMCAwIDAtODAgMHY0MEg1NTAuMDhWNDBhNDAgNDAgMCAwIDAtODAgMHY0MGgtMTgwVjQwYTQwIDQwIDAgMSAwLTgwIDB2NDBIMTYwQTE2MCAxNjAgMCAwIDAgMCAyNDB2NjI0YTE2MCAxNjAgMCAwIDAgMTYwIDE2MGg3MDRhMTYwIDE2MCAwIDAgMCAxNjAtMTYwIDQwIDQwIDAgMCAwLTgwIDAgODAgODAgMCAwIDEtODAgODBIMTYwYTgwIDgwIDAgMCAxLTgwLTgwVjI0MGE4MCA4MCAwIDAgMSA4MC04MGg1MC4wOHY0MGE0MCA0MCAwIDAgMCA4MCAwdi00MGgxODB2NDBhNDAgNDAgMCAwIDAgODAgMHYtNDBINzMydjQwYTQwIDQwIDAgMCAwIDgwIDB2LTQwaDUyYTgwIDgwIDAgMCAxIDgwIDgwdjkwLjA4YTQwIDQwIDAgMCAwIDgwIDBWMjQwQTE2MCAxNjAgMCAwIDAgODY0IDgweiIgZmlsbD0iIzJBNTY5OSIvPjwvc3ZnPg=="}}]);
