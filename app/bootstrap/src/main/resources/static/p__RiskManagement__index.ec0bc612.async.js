(self.webpackChunk=self.webpackChunk||[]).push([[7530],{52078:function(Q,Z,t){"use strict";var E=t(97857),m=t.n(E),x=t(27997),h=t(62435),F=t(86074),c=function(i){x.Mj.register({id:"json"});var R=i.value,u=R===void 0?"{}":R,v=i.onChange,D=i.editorStyle,L=D===void 0?{}:D,r=i.editorKey,z=r===void 0?"json-editor":r,N=i.readOnly,d=N===void 0?!1:N,S=(0,h.useRef)(),p=(0,h.useRef)(),O=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(W),W}catch(M){return console.warn("Invalid JSON string:",M),"{}"}};return(0,h.useEffect)(function(){if(S.current)return p.current?p.current.setValue(u):(p.current=x.j6.create(S.current,{value:O(u),language:"json",theme:"vs",readOnly:d,folding:!0,automaticLayout:!0}),p.current.onDidChangeModelContent(function(){var A=p.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:A}),v==null||v(A)})),function(){if(p!=null&&p.current){var A;p==null||(A=p.current)===null||A===void 0||A.dispose(),p.current=null}}},[]),(0,h.useEffect)(function(){p.current&&u!==p.current.getValue()&&p.current.setValue(O(u))},[u]),(0,F.jsx)("div",{ref:S,style:m()({height:360,borderRadius:4,overflow:"hidden"},L)},z)};Z.Z=c},29297:function(Q,Z,t){"use strict";t.d(Z,{q9:function(){return E.Z},Wy:function(){return i},mi:function(){return D}});var E=t(52078),m=t(97857),x=t.n(m),h=t(55171),F=t.n(h),c=t(86074),U=function(r){var z=r.value,N=r.viewerStyle,d=N===void 0?{}:N,S=r.displayDataTypes,p=S===void 0?!1:S,O=r.name,A=O===void 0?"output json":O;return(0,c.jsx)(F(),{src:z,name:A,collapsed:!1,displayDataTypes:p,style:x()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},d)})},i=U,R=t(27997),u=t(62435),v=function(r){R.Mj.register({id:"rego"});var z=r.value,N=r.onChange,d=r.editorStyle,S=d===void 0?{}:d,p=r.editorKey,O=r.readOnly,A=O===void 0?!1:O,W=(0,u.useRef)(),M=(0,u.useRef)();return(0,u.useEffect)(function(){if(W.current)return M.current||(M.current=R.j6.create(W.current,{value:z,language:"rego",theme:"vs",readOnly:A,automaticLayout:!0}),M.current.onDidChangeModelContent(function(){N==null||N(M.current.getValue())})),function(){if(M.current){var b;(b=M.current)===null||b===void 0||b.dispose(),M.current=null}}},[]),(0,c.jsx)("div",{ref:W,style:x()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},S)},p)},D=v},40351:function(Q,Z,t){"use strict";t.r(Z),t.d(Z,{default:function(){return Nt}});var E=t(15009),m=t.n(E),x=t(99289),h=t.n(x),F=t(5574),c=t.n(F),U=t(97857),i=t.n(U),R=t(70501),u=t(96364),v=t(92016),D=t(66309),L=t(53846),r=t(86074),z=function(ke){var _=ke.status,$=(0,r.jsx)(D.Z,{children:_||"-"});return[u.Bj[1].value].includes(_)?$=(0,r.jsx)(D.Z,{className:L.Z.invalidTag,style:{marginLeft:6},children:(0,r.jsx)(v.FormattedMessage,{id:"common.tag.text.noExist"})}):$=(0,r.jsx)(D.Z,{className:L.Z.validTag,style:{marginLeft:6},children:(0,r.jsx)(v.FormattedMessage,{id:"common.tag.text.exist"})}),$},N=t(31732),d=t(24163),S=t(72028),p=t(37476),O=t(64317),A=t(90672),W=t(68872),M=t(23323),b=t(96486),C=t(62435),Se=function(_){var $=W.ZP.useMessage(),ie=c()($,2),Ce=ie[0],Fe=ie[1],Ne=M.Z.useForm(),Ve=c()(Ne,1),he=Ve[0],ee=(0,v.useIntl)(),pe=_.ignoreRiskFormVisible,k=_.riskInfo,ue=_.setIgnoreRiskFormVisible,K=_.tableActionRef,de=function(){he.resetFields()},te=function(){ue(!1),de()},ce=function(){var ve=h()(m()().mark(function ye(J){var Re,B,I;return m()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return Re=i()(i()({},J),{},{riskId:k.id}),re.next=3,(0,S.ignoreRisk)(Re);case 3:B=re.sent,B.code===200&&B.msg==="success"&&(Ce.success(ee.formatMessage({id:"risk.message.api.ignore.risk.success"})),K==null||(I=K.current)===null||I===void 0||I.reload(),te());case 5:case"end":return re.stop()}},ye)}));return function(J){return ve.apply(this,arguments)}}();return(0,C.useEffect)(function(){pe&&!(0,b.isEmpty)(k)&&he.setFieldsValue({ignoreReasonType:k==null?void 0:k.ignoreReasonType,ignoreReason:k==null?void 0:k.ignoreReason})},[pe,k]),(0,r.jsxs)(r.Fragment,{children:[Fe,(0,r.jsxs)(p.Y,{labelCol:{span:ee.locale==="en-US"?6:4},title:ee.formatMessage({id:"risk.module.text.ignore.risk"}),width:520,form:he,modalProps:{destroyOnClose:!0,onCancel:function(){return te()},styles:{body:{paddingTop:12}}},open:pe,onFinish:ce,layout:"horizontal",children:[(0,r.jsx)(O.Z,{label:ee.formatMessage({id:"risk.module.text.ignore.type"}),name:"ignoreReasonType",rules:[{required:!0}],options:u.$G}),(0,r.jsx)(A.Z,{label:ee.formatMessage({id:"risk.module.text.ignore.reason"}),name:"ignoreReason",rules:[{required:!0}],fieldProps:{rows:6}})]})]})},xe=Se,Ae=t(57207),Ee=t(77603),Le=t(64818),ge=t(92635),Oe=t(79930),De=t(96655),q=t(17910),w=t(29448),P=t(68795),Me=t(39380),be=t(93410),we=t(90498),Pe=t(75302),Qe=t(3303),oe=t(86250),H=t(34041),V=t(25593),Y=t(57381),G=t(83622),T=t(96074),wt=t(86738),Pt=t(71230),He=t(15746),Ye=t(84567),Je=t(47908),kt=Pe.ZP.useBreakpoint,Xe=Qe.Z.SHOW_CHILD,Ft=function(){var _,$=kt(),ie=(0,v.useModel)("rule"),Ce=ie.platformList,Fe=ie.ruleGroupList,Ne=ie.ruleTypeList,Ve=(0,v.useRequest)(function(){return(0,De.queryAllTenantSelectRuleList)({})},{formatResult:function(n){var e;return((e=n.content)===null||e===void 0?void 0:e.map(function(s){return i()(i()({},s),{},{key:s==null?void 0:s.id,label:s==null?void 0:s.ruleName,value:s==null?void 0:s.ruleCode})}))||[]}}),he=Ve.data,ee=(0,v.useLocation)(),pe=ee.search,k=new URLSearchParams(pe),ue=k.get("riskLevel"),K=k.get("platform"),de=k.get("ruleCode"),te=k.get("resourceId"),ce=k.get("cloudAccountId"),ve=W.ZP.useMessage(),ye=c()(ve,2),J=ye[0],Re=ye[1],B=(0,C.useRef)(),I=(0,C.useRef)(),qe=M.Z.useForm(),re=c()(qe,1),g=re[0],o=(0,v.useIntl)(),Vt=(0,C.useState)(!1),et=c()(Vt,2),Zt=et[0],tt=et[1],rt=(0,C.useRef)({}),Bt=(0,C.useState)(!1),nt=c()(Bt,2),Wt=nt[0],st=nt[1],lt=(0,C.useRef)({}),at=(0,C.useRef)({}),_t=(0,C.useState)(!1),ot=c()(_t,2),Ut=ot[0],it=ot[1],zt=(0,C.useState)(!1),ut=c()(zt,2),Gt=ut[0],dt=ut[1],$t=(0,C.useState)({}),ct=c()($t,2),vt=ct[0],Kt=ct[1],Qt=(0,C.useState)({}),mt=c()(Qt,2),Ze=mt[0],Te=mt[1],Ht=(0,C.useState)((_=u.MW[0])===null||_===void 0?void 0:_.value),ft=c()(Ht,2),ne=ft[0],Yt=ft[1],Jt=(0,C.useState)(!1),gt=c()(Jt,2),Xt=gt[0],ht=gt[1],qt=function(){var a=h()(m()().mark(function n(e){var s,l,y;return m()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return s={riskId:e.id},j.next=3,(0,S.cancelIgnoreRisk)(s);case 3:l=j.sent,l.code===200&&l.msg==="success"&&(J.success(o.formatMessage({id:"risk.message.api.cancel.ignore.risk.success"})),B==null||(y=B.current)===null||y===void 0||y.reload());case 5:case"end":return j.stop()}},n)}));return function(e){return a.apply(this,arguments)}}(),er=(0,C.useState)([]),pt=c()(er,2),tr=pt[0],Be=pt[1],rr=(0,v.useRequest)(function(a){return(0,Oe.queryGroupTypeList)({platformList:a})},{manual:!0,formatResult:function(n){var e=n.content;Be(e||[])}}),yt=rr.run;(0,C.useEffect)(function(){var a={};if((0,b.isEmpty)(K)||(g==null||g.setFieldValue("platformList",[K]),g.setFieldValue("resourceType",null),Be([]),yt([K]),a.platformList=[K]),(0,b.isEmpty)(ue)||(g==null||g.setFieldValue("riskLevelList",[ue]),a.riskLevelList=[ue]),!(0,b.isEmpty)(de)){var n;(n=I.current)===null||n===void 0||n.setFieldValue("ruleCodeList",[de]),a.ruleCodeList=[de]}if(!(0,b.isEmpty)(te)){var e;(e=I.current)===null||e===void 0||e.setFieldValue("resourceId",te),a.resourceId=te}if(!(0,b.isEmpty)(ce)){var s;(s=I.current)===null||s===void 0||s.setFieldValue("cloudAccountId",ce),a.cloudAccountId=ce}Object.keys(a).length>0&&Te(a)},[K,ue,de,te,ce]);var We=(0,v.useRequest)(function(a){return(0,ge.cloudAccountBaseInfoList)(i()({},a))},{formatResult:function(n){if(n.msg==="success"){var e;return(n==null||(e=n.content)===null||e===void 0||(e=e.accountAliasList)===null||e===void 0?void 0:e.map(function(s){return{label:s,value:s}}))||[]}}}),nr=We.data,It=We.run,sr=We.loading,lr=(0,C.useMemo)(function(){var a=function(e){It({platformList:g.getFieldValue("platformList")||[],cloudAccountSearch:e})};return(0,b.debounce)(a,500)},[ge.cloudAccountBaseInfoList]),xt=(0,v.useRequest)(function(a){return(0,S.listRuleStatistics)(i()({},a))},{manual:!0,formatResult:function(n){var e,s=[];return s=n==null||(e=n.content)===null||e===void 0?void 0:e.map(function(l){return{label:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:l==null?void 0:l.ruleName}),(0,r.jsx)(oe.Z,{align:"center",children:(0,r.jsx)(D.Z,{color:(0,w.nn)(q.I9,l==null?void 0:l.riskLevel),style:{margin:"0 0 0 8px"},children:(l==null?void 0:l.count)||"-"})})]}),value:l.ruleId}}),s}}),ar=xt.data,or=xt.run,Dt=(0,v.useRequest)(function(a){return(0,S.listCloudAccountStatistics)(i()({},a))},{manual:!0,formatResult:function(n){var e,s=[];return s=n==null||(e=n.content)===null||e===void 0?void 0:e.map(function(l){return{label:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:(l==null?void 0:l.alias)||(l==null?void 0:l.cloudAccountId)}),(0,r.jsx)(oe.Z,{align:"center",children:(0,r.jsx)(D.Z,{color:"blue",style:{margin:"0 0 0 8px"},children:(l==null?void 0:l.count)||"-"})})]}),value:l.cloudAccountId}}),s}}),ir=Dt.data,ur=Dt.run,dr=function(){var a=h()(m()().mark(function n(){var e,s;return m()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:s=i()(i()({status:ne},g==null?void 0:g.getFieldsValue()),I==null||(e=I.current)===null||e===void 0?void 0:e.getFieldsValue()),ht(!0),(0,S.exportRiskList)(i()({},s),{responseType:"blob"}).then(function(f){if(f.type==="application/json"){var j=new FileReader;j.onload=function(){try{var X=JSON.parse(j.result);J.error(X.msg||o.formatMessage({id:"common.message.text.export.failed"}))}catch(Ie){J.error(o.formatMessage({id:"common.message.text.export.failed"}))}},j.readAsText(f)}else(0,w.Uc)(f,"CloudRec ".concat(o.formatMessage({id:"risk.module.text.risk.data"}))),J.success(o.formatMessage({id:"common.message.text.export.success"}))}).catch(function(f){J.error(o.formatMessage({id:"common.message.text.export.failed"})),console.error("Export failed:",f)}).finally(function(){return ht(!1)});case 3:case"end":return y.stop()}},n)}));return function(){return a.apply(this,arguments)}}(),cr=(0,C.useState)(),Mt=c()(cr,2),vr=Mt[0],mr=Mt[1],fr=(0,C.useState)(),Ct=c()(fr,2),Cr=Ct[0],gr=Ct[1],hr=function(){var a=h()(m()().mark(function n(e){var s,l;return m()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!e){f.next=4;break}return l=i()(i()({status:ne},g==null?void 0:g.getFieldsValue()),I==null||(s=I.current)===null||s===void 0?void 0:s.getFieldsValue()),f.next=4,or(l);case 4:case"end":return f.stop()}},n)}));return function(e){return a.apply(this,arguments)}}(),pr=function(){var a=h()(m()().mark(function n(e){var s,l;return m()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!e){f.next=4;break}return l=i()(i()({status:ne},g==null?void 0:g.getFieldsValue()),I==null||(s=I.current)===null||s===void 0?void 0:s.getFieldsValue()),f.next=4,ur(l);case 4:case"end":return f.stop()}},n)}));return function(e){return a.apply(this,arguments)}}(),yr=function(){return{filterDropdown:function(e){var s=e.confirm;return(0,r.jsx)("div",{style:{padding:8},onKeyDown:function(y){return y.stopPropagation()},children:(0,r.jsx)(H.Z,{maxTagCount:"responsive",allowClear:!0,mode:"multiple",placeholder:o.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:ar||[],onChange:(0,b.debounce)(function(l){mr(l),s()},1e3),style:{minWidth:320}})})},filterDropdownProps:{onOpenChange:hr},filterIcon:function(e){return(0,r.jsx)(P.Z,{style:{color:e?"#1677ff":"#1890ff",fontSize:"18px",fontWeight:"bold"}})},destroyOnClose:!0}},Ir=function(){return{filterDropdown:function(e){var s=e.confirm;return(0,r.jsx)("div",{style:{padding:8},onKeyDown:function(y){return y.stopPropagation()},children:(0,r.jsx)(H.Z,{maxTagCount:"responsive",allowClear:!0,mode:"multiple",placeholder:o.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:ir||[],onChange:(0,b.debounce)(function(l){gr(l),s()},1e3),style:{minWidth:320}})})},filterDropdownProps:{onOpenChange:pr},filterIcon:function(e){return(0,r.jsx)(P.Z,{style:{color:e?"#1677ff":"#1890ff",fontSize:"18px",fontWeight:"bold"}})},destroyOnClose:!0}},xr=function(n){it(!0),at.current=n},Dr=[i()({title:o.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",width:400,valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){var s,l,y,f,j,X,Ie=function(){var me;if(e!=null&&(me=e.ruleVO)!==null&&me!==void 0&&me.id){var se;Kt({ruleId:e.ruleVO.id,ruleCode:(se=e.ruleId)===null||se===void 0?void 0:se.toString()}),dt(!0)}};return(0,r.jsxs)(oe.Z,{align:"center",children:[(0,r.jsx)("img",{src:(e==null?void 0:e.icon)||R.Z,alt:"RESOURCE_ICON",style:{width:20,height:20}}),(0,r.jsx)(V.Z.Text,{copyable:e!=null&&(s=e.ruleVO)!==null&&s!==void 0&&s.ruleName?{text:e.ruleVO.ruleName}:!1,style:{color:e!=null&&(l=e.ruleVO)!==null&&l!==void 0&&l.id?"#1890ff":"#333",fontSize:14,marginLeft:8,maxWidth:$!=null&&$.xxl?450:400,cursor:e!=null&&(y=e.ruleVO)!==null&&y!==void 0&&y.id?"pointer":"default"},ellipsis:{tooltip:(e==null||(f=e.ruleVO)===null||f===void 0?void 0:f.ruleName)||"-"},onClick:e!=null&&(j=e.ruleVO)!==null&&j!==void 0&&j.id?Ie:void 0,children:(e==null||(X=e.ruleVO)===null||X===void 0?void 0:X.ruleName)||"-"})]})}},yr()),{title:o.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",valueEnum:(0,w.W_)(he),hideInTable:!0,colSize:2,fieldProps:{mode:"multiple"}},i()({title:o.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"select",colSize:1,fieldProps:{placeholder:o.formatMessage({id:"common.select.query.text.placeholder"}),showSearch:!0,notFoundContent:sr&&(0,r.jsx)(Y.Z,{size:"small"}),onSearch:lr,options:nr||[]},align:"left",render:function(n,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)(V.Z.Text,{copyable:e!=null&&e.cloudAccountId?{text:e.cloudAccountId}:!1,style:{color:"rgb(51, 51, 51)"},ellipsis:{tooltip:(e==null?void 0:e.cloudAccountId)||"-"},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,r.jsxs)(oe.Z,{style:{fontSize:"12px",color:"#999"},children:[(0,w.c5)(e.platform,Ce),(e==null?void 0:e.alias)||"-"]})]})}},Ir()),{title:o.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),dataIndex:"ruleTypeIdList",valueType:"cascader",hideInTable:!0,colSize:1,fieldProps:{multiple:!0,options:Ne,showCheckedStrategy:Xe,fieldNames:{label:"typeName",value:"id",children:"childList"}}},{title:o.formatMessage({id:"layout.routes.title.ruleGroup"}),dataIndex:"ruleGroupIdList",valueType:"select",valueEnum:(0,w.W_)(Fe),hideInTable:!0,colSize:1,fieldProps:{mode:"multiple"}},{title:o.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeList",valueType:"cascader",align:"left",hideInTable:!0,colSize:1,fieldProps:{multiple:!0,showCheckedStrategy:Xe,options:tr,showSearch:!0,allowClear:!0}},{title:o.formatMessage({id:"common.table.columns.assetId"}),dataIndex:"resourceId",valueType:"text",align:"left",hideInTable:!0,colSize:1},{title:o.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceName",valueType:"text",align:"left",hideInTable:!0,colSize:1},{title:o.formatMessage({id:"risk.module.text.firstAndLast.discovered"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,r.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:o.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonTypeList",valueType:"checkbox",valueEnum:(0,w.W_)(u.$G),align:"left",hideInTable:!0,hideInSearch:ne!=="IGNORED",colSize:6},{title:o.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,r.jsx)(N.Z,{text:e==null?void 0:e.resourceType})}},{title:o.formatMessage({id:"common.table.columns.assetStatus"}),dataIndex:"resourceStatus",valueType:"select",valueEnum:(0,w.W_)(u.Bj),align:"left",hideInTable:!0,colSize:1},{title:o.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceNameDisplay",valueType:"text",align:"left",width:300,hideInSearch:!0,render:function(n,e){var s=(e==null?void 0:e.resourceStatus)===u.Bj[1].value?"(".concat(o.formatMessage({id:"risk.module.text.not.exist"}),") ")+e.resourceName:e.resourceName||"-";return(0,r.jsxs)(oe.Z,{align:"center",children:[(0,r.jsx)(V.Z.Text,{copyable:e!=null&&e.resourceName?{text:e.resourceName}:!1,style:{maxWidth:450},ellipsis:{tooltip:s},children:e.resourceName||"-"}),(0,r.jsx)(z,{status:e==null?void 0:e.resourceStatus})]})}},{title:o.formatMessage({id:"risk.module.text.first.discovery"}),dataIndex:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0,colSize:1,fieldProps:{presets:q.El},search:{transform:function(n){return{gmtCreateStart:n[0],gmtCreateEnd:n[1]}}}},{title:o.formatMessage({id:"risk.module.text.recently.discovery"}),dataIndex:"modifiedTimeRange",valueType:"dateTimeRange",hideInTable:!0,colSize:1,fieldProps:{presets:q.El},search:{transform:function(n){return{gmtModifiedStart:n[0],gmtModifiedEnd:n[1]}}}},{title:o.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"text",align:"center",hideInSearch:!0,render:function(n,e){var s;return(0,w.Dd)(q.I9,e==null||(s=e.ruleVO)===null||s===void 0?void 0:s.riskLevel)}},{title:o.formatMessage({id:"risk.module.text.risk.status"}),dataIndex:"status",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,w.Ff)(u.MW,e==null?void 0:e.status)}},{title:o.formatMessage({id:"risk.module.text.ignore.reason"}),dataIndex:"ignoreReason",valueType:"text",align:"left",hideInSearch:!0,hideInTable:ne!=="IGNORED",render:function(n,e){return(0,r.jsx)(d.Z,{placement:"topLeft",text:e.ignoreReason||"-",maxWidth:210})}},{title:o.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonType",valueType:"select",valueEnum:(0,w.W_)(u.$G),align:"left",hideInSearch:!0,hideInTable:ne!=="IGNORED"},{title:o.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(n,e){var s;return(0,r.jsxs)(r.Fragment,{children:[!((s=["WHITED"])!==null&&s!==void 0&&s.includes(e.status))&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(G.ZP,{size:"small",type:"link",onClick:function(){return xr({riskId:e==null?void 0:e.id})},children:o.formatMessage({id:"common.button.text.white"})}),(0,r.jsx)(T.Z,{type:"vertical"})]}),e.status==="IGNORED"?(0,r.jsx)(wt.Z,{title:(0,r.jsx)(r.Fragment,{}),description:o.formatMessage({id:"risk.module.text.cancel.ignore"}),onConfirm:function(){return qt(e)},onCancel:function(){},okText:o.formatMessage({id:"common.button.text.ok"}),cancelText:o.formatMessage({id:"common.button.text.cancel"}),children:(0,r.jsx)(G.ZP,{size:"small",type:"link",children:o.formatMessage({id:"common.button.text.cancelIgnore"})})}):(0,r.jsx)(G.ZP,{size:"small",type:"link",onClick:function(){lt.current=i()({},e),st(!0)},children:o.formatMessage({id:"common.button.text.ignore"})}),(0,r.jsx)(T.Z,{type:"vertical"}),(0,r.jsx)(G.ZP,{size:"small",type:"link",target:"_self",onClick:function(){tt(!0),rt.current=i()({},e)},children:o.formatMessage({id:"common.button.text.detail"})})]})}}],Mr=function(){var a=h()(m()().mark(function n(e){var s,l,y,f,j,X,Ie,_e,me,se,Rt,Tt,jt,je,St,At,Et,Lt,Ot,Ue,ze,Ge,$e,le,Ke,ae,bt;return m()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return y=e.pageSize,f=e.current,j=e.ruleId,X=e.ruleGroupIdList,Ie=e.cloudAccountId,_e=e.resourceName,me=e.resourceTypeList,se=e.status,Rt=se===void 0?"UNREPAIRED":se,Tt=e.ignoreReasonTypeList,jt=e.ruleTypeIdList,je=e.ruleIdList,St=e.gmtCreateStart,At=e.gmtCreateEnd,Et=e.gmtModifiedStart,Lt=e.gmtModifiedEnd,Ot=e.resourceStatus,Ue=g.getFieldValue("platformList"),ze=g.getFieldValue("riskLevelList"),Ge=(s=I.current)===null||s===void 0?void 0:s.getFieldValue("ruleCodeList"),$e=(l=I.current)===null||l===void 0?void 0:l.getFieldValue("resourceId"),le={page:f,size:y,ruleId:j,ruleGroupIdList:X,cloudAccountId:Ie,resourceName:_e,resourceTypeList:me,status:Rt,ignoreReasonTypeList:Tt,ruleTypeIdList:jt,gmtCreateStart:St,gmtCreateEnd:At,gmtModifiedStart:Et,gmtModifiedEnd:Lt,resourceStatus:Ot},Ue&&(le.platformList=Ue),ze&&(le.riskLevelList=ze),Ge&&(le.ruleCodeList=Ge),$e&&(le.resourceId=$e),je&&!(0,b.isEmpty)(je)&&(le.ruleIdList=je),fe.next=13,(0,S.queryRiskList)(le);case 13:return Ke=fe.sent,ae=Ke.content,bt=Ke.code,fe.abrupt("return",{data:(ae==null?void 0:ae.data)||[],total:(ae==null?void 0:ae.total)||0,success:bt===200||!1});case 17:case"end":return fe.stop()}},n)}));return function(e){return a.apply(this,arguments)}}();return(0,r.jsxs)(Me._z,{title:!1,className:Je.Z.riskPageContainer,breadcrumbRender:!1,children:[Re,(0,r.jsx)(be.Z,{bodyStyle:{paddingBlock:0},className:Je.Z.customFilterCard,tabs:{activeKey:ne,items:u.MW.map(function(a){return{label:a.label,key:a.value,children:(0,r.jsx)(M.Z,{form:g,children:(0,r.jsxs)(Pt.Z,{gutter:[24,10],children:[(0,r.jsx)(He.Z,{span:24,children:(0,r.jsx)(M.Z.Item,{name:"platformList",label:o.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,r.jsx)(Ye.Z.Group,{options:(0,w.T$)(Ce),onChange:function(e){g.setFieldValue("resourceTypeList",null),Be([]),yt(e),It({platformList:e||[]})}})})}),(0,r.jsx)(He.Z,{span:24,children:(0,r.jsx)(M.Z.Item,{name:"riskLevelList",label:o.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,r.jsx)(Ye.Z.Group,{options:(0,w.at)(q.I9)})})})]})})}})||[],onChange:function(n){var e,s,l;Yt(n),(e=I.current)===null||e===void 0||e.setFieldValue("ignoreReasonTypeList",[]);var y=g.getFieldsValue(),f=((s=I.current)===null||s===void 0?void 0:s.getFieldsValue())||{},j=i()(i()(i()(i()({},Ze),y),f),{},{status:n,ignoreReasonTypeList:[]});Te(j),(l=B.current)===null||l===void 0||l.reload()}}}),(0,r.jsx)(we.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,labelWidth:0,defaultColsNumber:6},headerTitle:(0,r.jsx)("div",{className:L.Z.customTitle,children:o.formatMessage({id:"risk.module.text.risk.inquiry"})}),toolBarRender:function(){return[(0,r.jsx)(G.ZP,{type:"primary",loading:Xt,onClick:dr,children:o.formatMessage({id:"common.button.text.export"})},"export")]},actionRef:B,formRef:I,columns:Dr,request:Mr,onReset:function(){g.resetFields(),Te({})},onSubmit:function(){var n=g.getFieldsValue();Te(i()(i()({},Ze),n))},params:i()(i()({},Ze),{},{ruleIdList:vr}),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}}),(0,r.jsx)(Ae.Z,{locate:"risk",riskDrawerVisible:Zt,setRiskDrawerVisible:tt,riskDrawerInfo:rt.current,tableActionRef:B}),(0,r.jsx)(xe,{ignoreRiskFormVisible:Wt,setIgnoreRiskFormVisible:st,riskInfo:lt.current,tableActionRef:B}),(0,r.jsx)(Ee.Z,{editDrawerVisible:Ut,setEditDrawerVisible:it,whiteListDrawerInfo:at.current,tableActionRef:B}),(0,r.jsx)(Le.Z,{visible:Gt,onClose:function(){return dt(!1)},ruleId:vt.ruleId,ruleCode:vt.ruleCode})]})},Nt=Ft},64818:function(Q,Z,t){"use strict";var E=t(15009),m=t.n(E),x=t(99289),h=t.n(x),F=t(5574),c=t.n(F),U=t(62435),i=t(68872),R=t(66309),u=t(85265),v=t(57381),D=t(26412),L=t(25593),r=t(92016),z=t(96655),N=t(29448),d=t(86074),S=function(O){var A=O.visible,W=O.onClose,M=O.ruleId,b=O.ruleCode,C=(0,r.useIntl)(),Se=i.ZP.useMessage(),xe=c()(Se,2),Ae=xe[0],Ee=xe[1],Le=(0,U.useState)(!1),ge=c()(Le,2),Oe=ge[0],De=ge[1],q=(0,U.useState)(null),w=c()(q,2),P=w[0],Me=w[1];(0,U.useEffect)(function(){A&&M&&be()},[A,M]);var be=function(){var H=h()(m()().mark(function V(){var Y;return m()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(De(!0),T.prev=1,!M){T.next=6;break}return T.next=5,(0,z.queryRuleDetail)({id:M});case 5:Y=T.sent;case 6:Y&&Y.content&&Me(Y.content),T.next=12;break;case 9:T.prev=9,T.t0=T.catch(1),Ae.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return T.prev=12,De(!1),T.finish(12);case 15:case"end":return T.stop()}},V,null,[[1,9,12,15]])}));return function(){return H.apply(this,arguments)}}(),we=function(){Me(null),W()},Pe=function(V){switch(V.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},Qe=function(V){if(!V)return null;var Y=V.split(",");return Y.map(function(G,T){return(0,d.jsx)(R.Z,{color:Pe(G.trim()),children:G.trim()},T)})},oe=function(V){return(0,N.c5)(V)};return(0,d.jsxs)(d.Fragment,{children:[Ee,(0,d.jsx)(u.Z,{title:"\u89C4\u5219\u8BE6\u60C5",placement:"right",onClose:we,open:A,width:1e3,destroyOnClose:!0,children:(0,d.jsx)(v.Z,{spinning:Oe,children:P&&(0,d.jsxs)(D.Z,{column:1,bordered:!0,children:[(0,d.jsx)(D.Z.Item,{label:"\u89C4\u5219\u540D\u79F0",children:(0,d.jsx)(L.Z.Text,{copyable:!0,children:P.ruleName})}),(0,d.jsx)(D.Z.Item,{label:"\u89C4\u5219code",children:(0,d.jsx)(L.Z.Text,{copyable:!0,children:P.ruleCode})}),(0,d.jsx)(D.Z.Item,{label:"\u4FEE\u590D\u5EFA\u8BAE",children:(0,d.jsx)(L.Z.Text,{copyable:!0,children:P.advice})}),(0,d.jsx)(D.Z.Item,{label:"\u4FEE\u590D\u6587\u6863",children:(0,d.jsx)(L.Z.Text,{copyable:!0,children:P.link})}),(0,d.jsx)(D.Z.Item,{label:"\u4E0A\u4E0B\u6587\u6A21\u677F",children:(0,d.jsx)(L.Z.Text,{copyable:!0,children:P.context})}),P.ruleRego&&(0,d.jsx)(D.Z.Item,{label:"\u7B56\u7565",children:(0,d.jsx)(L.Z.Paragraph,{copyable:!0,children:(0,d.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"1000px",overflow:"auto"},children:P.ruleRego})})}),P.createTime&&(0,d.jsx)(D.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:(0,d.jsx)(L.Z.Text,{copyable:!0,children:P.createTime})}),P.updateTime&&(0,d.jsx)(D.Z.Item,{label:"\u66F4\u65B0\u65F6\u95F4",children:(0,d.jsx)(L.Z.Text,{copyable:!0,children:P.updateTime})})]})})})]})};Z.Z=S},70501:function(Q,Z,t){"use strict";var E=t(62435),m=Object.defineProperty,x=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable,c=(R,u,v)=>u in R?m(R,u,{enumerable:!0,configurable:!0,writable:!0,value:v}):R[u]=v,U=(R,u)=>{for(var v in u||(u={}))h.call(u,v)&&c(R,v,u[v]);if(x)for(var v of x(u))F.call(u,v)&&c(R,v,u[v]);return R};const i=R=>React.createElement("svg",U({className:"DEFAULT_RESOURCE_ICON_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:256,height:256},R),React.createElement("path",{d:"M827.52 782.08a39.84 39.84 0 0 0 56.64 0l104.32-103.36a119.68 119.68 0 0 0 0-170.08L886.4 405.92a40 40 0 0 0-56.8 56.16l90.88 92h-322.4a40 40 0 0 0 0 80h322.24l-92.48 91.52a40 40 0 0 0-.32 56.48z",fill:"#1480ED"}),React.createElement("path",{d:"M864 80h-52V40a40 40 0 0 0-80 0v40H550.08V40a40 40 0 0 0-80 0v40h-180V40a40 40 0 1 0-80 0v40H160A160 160 0 0 0 0 240v624a160 160 0 0 0 160 160h704a160 160 0 0 0 160-160 40 40 0 0 0-80 0 80 80 0 0 1-80 80H160a80 80 0 0 1-80-80V240a80 80 0 0 1 80-80h50.08v40a40 40 0 0 0 80 0v-40h180v40a40 40 0 0 0 80 0v-40H732v40a40 40 0 0 0 80 0v-40h52a80 80 0 0 1 80 80v90.08a40 40 0 0 0 80 0V240A160 160 0 0 0 864 80z",fill:"#2A5699"}));Z.Z="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiI+PHBhdGggZD0iTTgyNy41MiA3ODIuMDhhMzkuODQgMzkuODQgMCAwIDAgNTYuNjQgMGwxMDQuMzItMTAzLjM2YTExOS42OCAxMTkuNjggMCAwIDAgMC0xNzAuMDhMODg2LjQgNDA1LjkyYTQwIDQwIDAgMCAwLTU2LjggNTYuMTZsOTAuODggOTJoLTMyMi40YTQwIDQwIDAgMCAwIDAgODBoMzIyLjI0bC05Mi40OCA5MS41MmE0MCA0MCAwIDAgMC0uMzIgNTYuNDh6IiBmaWxsPSIjMTQ4MEVEIi8+PHBhdGggZD0iTTg2NCA4MGgtNTJWNDBhNDAgNDAgMCAwIDAtODAgMHY0MEg1NTAuMDhWNDBhNDAgNDAgMCAwIDAtODAgMHY0MGgtMTgwVjQwYTQwIDQwIDAgMSAwLTgwIDB2NDBIMTYwQTE2MCAxNjAgMCAwIDAgMCAyNDB2NjI0YTE2MCAxNjAgMCAwIDAgMTYwIDE2MGg3MDRhMTYwIDE2MCAwIDAgMCAxNjAtMTYwIDQwIDQwIDAgMCAwLTgwIDAgODAgODAgMCAwIDEtODAgODBIMTYwYTgwIDgwIDAgMCAxLTgwLTgwVjI0MGE4MCA4MCAwIDAgMSA4MC04MGg1MC4wOHY0MGE0MCA0MCAwIDAgMCA4MCAwdi00MGgxODB2NDBhNDAgNDAgMCAwIDAgODAgMHYtNDBINzMydjQwYTQwIDQwIDAgMCAwIDgwIDB2LTQwaDUyYTgwIDgwIDAgMCAxIDgwIDgwdjkwLjA4YTQwIDQwIDAgMCAwIDgwIDBWMjQwQTE2MCAxNjAgMCAwIDAgODY0IDgweiIgZmlsbD0iIzJBNTY5OSIvPjwvc3ZnPg=="},85674:function(Q,Z,t){var E={"./simpleWorker":18352,"./simpleWorker.js":18352};function m(x){return Promise.resolve().then(function(){if(!t.o(E,x)){var h=new Error("Cannot find module '"+x+"'");throw h.code="MODULE_NOT_FOUND",h}var F=E[x];return t(F)})}m.keys=function(){return Object.keys(E)},m.id=85674,Q.exports=m},10131:function(Q,Z,t){var E={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function m(x){if(!t.o(E,x))return Promise.resolve().then(function(){var c=new Error("Cannot find module '"+x+"'");throw c.code="MODULE_NOT_FOUND",c});var h=E[x],F=h[0];return Promise.all(h.slice(1).map(t.e)).then(function(){return t(F)})}m.keys=function(){return Object.keys(E)},m.id=10131,Q.exports=m}}]);
