(self.webpackChunk=self.webpackChunk||[]).push([[7530],{52078:function(re,_,t){"use strict";var O=t(97857),h=t.n(O),A=t(27997),C=t(62435),B=t(86074),f=function(d){A.Mj.register({id:"json"});var S=d.value,v=S===void 0?"{}":S,m=d.onChange,j=d.editorStyle,k=j===void 0?{}:j,r=d.editorKey,J=r===void 0?"json-editor":r,W=d.readOnly,g=W===void 0?!1:W,L=(0,C.useRef)(),D=(0,C.useRef)(),P=function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(G),G}catch(T){return console.warn("Invalid JSON string:",T),"{}"}};return(0,C.useEffect)(function(){if(L.current)return D.current?D.current.setValue(v):(D.current=A.j6.create(L.current,{value:P(v),language:"json",theme:"vs",readOnly:g,folding:!0,automaticLayout:!0}),D.current.onDidChangeModelContent(function(){var E=D.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:E}),m==null||m(E)})),function(){if(D!=null&&D.current){var E;D==null||(E=D.current)===null||E===void 0||E.dispose(),D.current=null}}},[]),(0,C.useEffect)(function(){D.current&&v!==D.current.getValue()&&D.current.setValue(P(v))},[v]),(0,B.jsx)("div",{ref:L,style:h()({height:360,borderRadius:4,overflow:"hidden"},k)},J)};_.Z=f},29297:function(re,_,t){"use strict";t.d(_,{q9:function(){return O.Z},Wy:function(){return d},mi:function(){return j}});var O=t(52078),h=t(97857),A=t.n(h),C=t(55171),B=t.n(C),f=t(86074),Q=function(r){var J=r.value,W=r.viewerStyle,g=W===void 0?{}:W,L=r.displayDataTypes,D=L===void 0?!1:L,P=r.name,E=P===void 0?"output json":P;return(0,f.jsx)(B(),{src:J,name:E,collapsed:!1,displayDataTypes:D,style:A()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},g)})},d=Q,S=t(27997),v=t(62435),m=function(r){S.Mj.register({id:"rego"});var J=r.value,W=r.onChange,g=r.editorStyle,L=g===void 0?{}:g,D=r.editorKey,P=r.readOnly,E=P===void 0?!1:P,G=(0,v.useRef)(),T=(0,v.useRef)();return(0,v.useEffect)(function(){if(G.current)return T.current||(T.current=S.j6.create(G.current,{value:J,language:"rego",theme:"vs",readOnly:E,automaticLayout:!0}),T.current.onDidChangeModelContent(function(){W==null||W(T.current.getValue())})),function(){if(T.current){var U;(U=T.current)===null||U===void 0||U.dispose(),T.current=null}}},[]),(0,f.jsx)("div",{ref:G,style:A()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},L)},D)},j=m},40351:function(re,_,t){"use strict";t.r(_),t.d(_,{default:function(){return _t}});var O=t(15009),h=t.n(O),A=t(99289),C=t.n(A),B=t(5574),f=t.n(B),Q=t(97857),d=t.n(Q),S=t(70501),v=t(96364),m=t(45830),j=t(66309),k=t(53846),r=t(86074),J=function(Ze){var K=Ze.status,X=(0,r.jsx)(j.Z,{children:K||"-"});return[v.Bj[1].value].includes(K)?X=(0,r.jsx)(j.Z,{className:k.Z.invalidTag,style:{marginLeft:6},children:(0,r.jsx)(m.FormattedMessage,{id:"common.tag.text.noExist"})}):X=(0,r.jsx)(j.Z,{className:k.Z.validTag,style:{marginLeft:6},children:(0,r.jsx)(m.FormattedMessage,{id:"common.tag.text.exist"})}),X},W=t(31732),g=t(24163),L=t(72028),D=t(37476),P=t(64317),E=t(90672),G=t(68872),T=t(99859),U=t(96486),x=t(62435),Ee=function(K){var X=G.ZP.useMessage(),ce=f()(X,2),Ce=ce[0],Be=ce[1],We=T.Z.useForm(),_e=f()(We,1),ne=_e[0],oe=(0,m.useIntl)(),De=K.ignoreRiskFormVisible,F=K.riskInfo,ve=K.setIgnoreRiskFormVisible,q=K.tableActionRef,fe=function(){ne.resetFields()},se=function(){ve(!1),fe()},me=function(){var ge=C()(h()().mark(function Me(le){var Te,w,y;return h()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return Te=d()(d()({},le),{},{riskId:F.id}),ae.next=3,(0,L.ignoreRisk)(Te);case 3:w=ae.sent,w.code===200&&w.msg==="success"&&(Ce.success(oe.formatMessage({id:"risk.message.api.ignore.risk.success"})),q==null||(y=q.current)===null||y===void 0||y.reload(),se());case 5:case"end":return ae.stop()}},Me)}));return function(le){return ge.apply(this,arguments)}}();return(0,x.useEffect)(function(){De&&!(0,U.isEmpty)(F)&&ne.setFieldsValue({ignoreReasonType:F==null?void 0:F.ignoreReasonType,ignoreReason:F==null?void 0:F.ignoreReason})},[De,F]),(0,r.jsxs)(r.Fragment,{children:[Be,(0,r.jsxs)(D.Y,{labelCol:{span:oe.locale==="en-US"?6:4},title:oe.formatMessage({id:"risk.module.text.ignore.risk"}),width:520,form:ne,modalProps:{destroyOnClose:!0,onCancel:function(){return se()},styles:{body:{paddingTop:12}}},open:De,onFinish:me,layout:"horizontal",children:[(0,r.jsx)(P.Z,{label:oe.formatMessage({id:"risk.module.text.ignore.type"}),name:"ignoreReasonType",rules:[{required:!0}],options:v.$G}),(0,r.jsx)(E.Z,{label:oe.formatMessage({id:"risk.module.text.ignore.reason"}),name:"ignoreReason",rules:[{required:!0}],fieldProps:{rows:6}})]})]})},Re=Ee,Oe=t(57207),we=t(77603),be=t(64818),ye=t(92635),ke=t(79930),Ae=t(96655),Pe=t(59999),H=t(17910),I=t(29448),xe=t(68795),Fe=t(39380),Ve=t(93410),Ne=t(90498),tt=t(75302),rt=t(3303),$=t(86250),z=t(34041),Y=t(25593),Ie=t(57381),R=t(83622),nt=t(96074),Nt=t(86738),Zt=t(71230),lt=t(15746),ot=t(84567),st=t(47908),Bt=tt.ZP.useBreakpoint,at=rt.Z.SHOW_CHILD,Wt=function(){var K,X=Bt(),ce=(0,m.useModel)("rule"),Ce=ce.platformList,Be=ce.ruleGroupList,We=ce.ruleTypeList,_e=(0,m.useRequest)(function(){return(0,Ae.queryAllTenantSelectRuleList)({})},{formatResult:function(l){var e;return((e=l.content)===null||e===void 0?void 0:e.map(function(n){return d()(d()({},n),{},{key:n==null?void 0:n.id,label:n==null?void 0:n.ruleName,value:n==null?void 0:n.ruleCode})}))||[]}}),ne=_e.data,oe=(0,m.useLocation)(),De=oe.search,F=new URLSearchParams(De),ve=F.get("riskLevel"),q=F.get("platform"),fe=F.get("ruleCode"),se=F.get("resourceId"),me=F.get("cloudAccountId"),ge=G.ZP.useMessage(),Me=f()(ge,2),le=Me[0],Te=Me[1],w=(0,x.useRef)(),y=(0,x.useRef)(),it=T.Z.useForm(),ae=f()(it,1),p=ae[0],c=(0,m.useIntl)(),Ut=(0,x.useState)(!1),ut=f()(Ut,2),zt=ut[0],dt=ut[1],ct=(0,x.useRef)({}),Gt=(0,x.useState)(!1),vt=f()(Gt,2),$t=vt[0],ft=vt[1],mt=(0,x.useRef)({}),gt=(0,x.useRef)({}),Kt=(0,x.useState)(!1),ht=f()(Kt,2),Qt=ht[0],pt=ht[1],Ht=(0,x.useState)(!1),yt=f()(Ht,2),Yt=yt[0],xt=yt[1],Jt=(0,x.useState)({}),It=f()(Jt,2),Ct=It[0],Xt=It[1],qt=(0,x.useState)({}),Dt=f()(qt,2),Se=Dt[0],ie=Dt[1],er=(0,x.useState)((K=v.MW[0])===null||K===void 0?void 0:K.value),Mt=f()(er,2),ue=Mt[0],tr=Mt[1],rr=(0,x.useState)(!1),Rt=f()(rr,2),nr=Rt[0],At=Rt[1],lr=function(){var s=C()(h()().mark(function l(e){var n,o,a;return h()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n={riskId:e.id},u.next=3,(0,L.cancelIgnoreRisk)(n);case 3:o=u.sent,o.code===200&&o.msg==="success"&&(le.success(c.formatMessage({id:"risk.message.api.cancel.ignore.risk.success"})),w==null||(a=w.current)===null||a===void 0||a.reload());case 5:case"end":return u.stop()}},l)}));return function(e){return s.apply(this,arguments)}}(),or=(0,x.useState)([]),Tt=f()(or,2),sr=Tt[0],je=Tt[1],ar=(0,m.useRequest)(function(s){return(0,ke.queryGroupTypeList)({platformList:s})},{manual:!0,formatResult:function(l){var e=l.content;je(e||[])}}),Ue=ar.run;(0,x.useEffect)(function(){var s={};if((0,U.isEmpty)(q)||(p==null||p.setFieldValue("platformList",[q]),p.setFieldValue("resourceType",null),je([]),Ue([q]),s.platformList=[q]),(0,U.isEmpty)(ve)||(p==null||p.setFieldValue("riskLevelList",[ve]),s.riskLevelList=[ve]),!(0,U.isEmpty)(fe)){var l;(l=y.current)===null||l===void 0||l.setFieldValue("ruleCodeList",[fe]),s.ruleCodeList=[fe]}if(!(0,U.isEmpty)(se)){var e;(e=y.current)===null||e===void 0||e.setFieldValue("resourceId",se),s.resourceId=se}if(!(0,U.isEmpty)(me)){var n;(n=y.current)===null||n===void 0||n.setFieldValue("cloudAccountId",me),s.cloudAccountId=me}Object.keys(s).length>0&&ie(s)},[q,ve,fe,se,me]);var ze=(0,m.useRequest)(function(s){return(0,ye.cloudAccountBaseInfoList)(d()({},s))},{formatResult:function(l){if(l.msg==="success"){var e;return(l==null||(e=l.content)===null||e===void 0||(e=e.accountAliasList)===null||e===void 0?void 0:e.map(function(n){return{label:n,value:n}}))||[]}}}),ir=ze.data,Ge=ze.run,ur=ze.loading;(0,Pe.j)({platformList:Ce,form:p,requestResourceTypeList:function(l){je([]),Ue(l)},requestCloudAccountBaseInfoList:Ge,platformFieldName:"platformList",resourceTypeFieldName:"resourceTypeList"}),(0,x.useEffect)(function(){H.I9.length>0&&!p.getFieldValue("riskLevelList")&&p.setFieldValue("riskLevelList",[H.I9[0].value])},[p]);var dr=(0,x.useMemo)(function(){var s=function(e){Ge({platformList:p.getFieldValue("platformList")||[],cloudAccountSearch:e})};return(0,U.debounce)(s,500)},[ye.cloudAccountBaseInfoList]),St=(0,m.useRequest)(function(s){return(0,L.listRuleStatistics)(d()({},s))},{manual:!0,formatResult:function(l){var e=(l==null?void 0:l.content)||[];hr(e);var n=[];return n=e.map(function(o){return{label:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:o==null?void 0:o.ruleName}),(0,r.jsx)($.Z,{align:"center",children:(0,r.jsx)(j.Z,{color:(0,I.nn)(H.I9,o==null?void 0:o.riskLevel),style:{margin:"0 0 0 8px"},children:(o==null?void 0:o.count)||"-"})})]}),value:o.ruleCode}}),n}}),cr=St.data,vr=St.run,fr=(0,x.useState)([]),jt=f()(fr,2),$e=jt[0],mr=jt[1],gr=(0,x.useState)([]),Lt=f()(gr,2),Ke=Lt[0],hr=Lt[1],Et=(0,m.useRequest)(function(s){return(0,L.listCloudAccountStatistics)(d()({},s))},{manual:!0,formatResult:function(l){var e=(l==null?void 0:l.content)||[];mr(e);var n=[];return n=e.map(function(o){return{label:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("span",{children:(o==null?void 0:o.alias)||(o==null?void 0:o.cloudAccountId)}),(0,r.jsx)($.Z,{align:"center",children:(0,r.jsx)(j.Z,{style:{margin:"0 0 0 8px"},children:(o==null?void 0:o.count)||"-"})})]}),value:o.cloudAccountId}}),n}}),pr=Et.data,yr=Et.run,xr=function(){var s=C()(h()().mark(function l(){var e,n;return h()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:n=d()(d()({status:ue},p==null?void 0:p.getFieldsValue()),y==null||(e=y.current)===null||e===void 0?void 0:e.getFieldsValue()),At(!0),(0,L.exportRiskList)(d()({},n),{responseType:"blob"}).then(function(i){if(i.type==="application/json"){var u=new FileReader;u.onload=function(){try{var M=JSON.parse(u.result);le.error(M.msg||c.formatMessage({id:"common.message.text.export.failed"}))}catch(N){le.error(c.formatMessage({id:"common.message.text.export.failed"}))}},u.readAsText(i)}else(0,I.Uc)(i,"CloudRec ".concat(c.formatMessage({id:"risk.module.text.risk.data"}))),le.success(c.formatMessage({id:"common.message.text.export.success"}))}).catch(function(i){le.error(c.formatMessage({id:"common.message.text.export.failed"})),console.error("Export failed:",i)}).finally(function(){return At(!1)});case 3:case"end":return a.stop()}},l)}));return function(){return s.apply(this,arguments)}}(),Ir=function(){var s=C()(h()().mark(function l(e){var n,o;return h()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!e){i.next=4;break}return o=d()(d()({status:ue},p==null?void 0:p.getFieldsValue()),y==null||(n=y.current)===null||n===void 0?void 0:n.getFieldsValue()),i.next=4,vr(o);case 4:case"end":return i.stop()}},l)}));return function(e){return s.apply(this,arguments)}}(),Cr=function(){var s=C()(h()().mark(function l(e){var n,o,a;return h()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!e){u.next=6;break}return a=d()(d()({status:ue},p==null?void 0:p.getFieldsValue()),y==null||(n=y.current)===null||n===void 0?void 0:n.getFieldsValue()),!a.ruleCodeList&&(o=y.current)!==null&&o!==void 0&&o.getFieldValue("ruleCodeList")&&(a.ruleCodeList=y.current.getFieldValue("ruleCodeList")),a.ruleIdList&&delete a.ruleIdList,u.next=6,yr(a);case 6:case"end":return u.stop()}},l)}));return function(e){return s.apply(this,arguments)}}(),Dr=function(){return{filterDropdown:function(e){var n=e.confirm;return(0,r.jsx)("div",{style:{padding:8},onKeyDown:function(a){return a.stopPropagation()},children:(0,r.jsx)(z.Z,{maxTagCount:"responsive",allowClear:!0,mode:"multiple",showSearch:!0,placeholder:c.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:cr||[],filterOption:function(a,i){var u,M=a.toLowerCase(),N=(i==null||(u=i.value)===null||u===void 0?void 0:u.toString().toLowerCase())||"",V=Ke==null?void 0:Ke.find(function(Le){return Le.ruleCode===(i==null?void 0:i.value)});if(V){var b,Z,ee=((b=V.ruleName)===null||b===void 0?void 0:b.toLowerCase())||"",he=((Z=V.ruleCode)===null||Z===void 0?void 0:Z.toLowerCase())||"";return ee.includes(M)||he.includes(M)||N.includes(M)}return N.includes(M)},onChange:function(a){var i,u;(i=y.current)===null||i===void 0||i.setFieldValue("ruleCodeList",a),ie(function(M){return d()(d()({},M),{},{ruleCodeList:a})}),(u=w.current)===null||u===void 0||u.reload(),n()},onBlur:function(){n()},style:{minWidth:320}})})},filterDropdownProps:{onOpenChange:Ir},filterIcon:function(e){return(0,r.jsx)(xe.Z,{style:{color:e?"#1677ff":"#1890ff",fontSize:"18px",fontWeight:"bold"}})},destroyOnClose:!0}},Mr=function(l){pt(!0),gt.current=l},Rr=[d()({title:c.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",width:400,valueType:"text",align:"left",hideInSearch:!0,render:function(l,e){var n,o,a,i,u,M,N=function(){var b;if(e!=null&&(b=e.ruleVO)!==null&&b!==void 0&&b.id){var Z;Xt({ruleId:e.ruleVO.id,ruleCode:(Z=e.ruleId)===null||Z===void 0?void 0:Z.toString()}),xt(!0)}};return(0,r.jsxs)($.Z,{align:"center",children:[(0,r.jsx)("img",{src:(e==null?void 0:e.icon)||S.Z,alt:"RESOURCE_ICON",style:{width:20,height:20}}),(0,r.jsx)(Y.Z.Text,{copyable:e!=null&&(n=e.ruleVO)!==null&&n!==void 0&&n.ruleName?{text:e.ruleVO.ruleName}:!1,style:{color:e!=null&&(o=e.ruleVO)!==null&&o!==void 0&&o.id?"#1890ff":"#333",fontSize:14,marginLeft:8,maxWidth:X!=null&&X.xxl?450:400,cursor:e!=null&&(a=e.ruleVO)!==null&&a!==void 0&&a.id?"pointer":"default"},ellipsis:{tooltip:(e==null||(i=e.ruleVO)===null||i===void 0?void 0:i.ruleName)||"-"},onClick:e!=null&&(u=e.ruleVO)!==null&&u!==void 0&&u.id?N:void 0,children:(e==null||(M=e.ruleVO)===null||M===void 0?void 0:M.ruleName)||"-"})]})}},Dr()),{title:c.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",valueEnum:(0,I.W_)(ne),hideInTable:!0,colSize:2,fieldProps:{mode:"multiple",showSearch:!0,filterOption:function(l,e){var n,o=l.toLowerCase(),a=(e==null||(n=e.value)===null||n===void 0?void 0:n.toString().toLowerCase())||"",i=ne==null?void 0:ne.find(function(ee){return ee.ruleCode===(e==null?void 0:e.value)});if(i){var u,M,N=((u=i.ruleName)===null||u===void 0?void 0:u.toLowerCase())||"",V=((M=i.ruleCode)===null||M===void 0?void 0:M.toLowerCase())||"",b=N.includes(o)||V.includes(o)||a.includes(o);return b}var Z=a.includes(o);return Z}}},{title:c.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"select",colSize:1,fieldProps:{placeholder:c.formatMessage({id:"common.select.query.text.placeholder"}),showSearch:!0,notFoundContent:ur&&(0,r.jsx)(Ie.Z,{size:"small"}),onSearch:dr,options:ir||[],onChange:function(l){ie(function(e){return d()(d()({},e),{},{cloudAccountId:l})})}},align:"left",filterDropdown:function(l){var e=l.confirm;return(0,r.jsx)("div",{style:{padding:8},onKeyDown:function(o){return o.stopPropagation()},children:(0,r.jsx)(z.Z,{allowClear:!0,showSearch:!0,placeholder:c.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:pr||[],filterOption:function(o,a){var i,u=o.toLowerCase(),M=(a==null||(i=a.value)===null||i===void 0?void 0:i.toString().toLowerCase())||"",N=$e==null?void 0:$e.find(function(he){return he.cloudAccountId===(a==null?void 0:a.value)});if(N){var V,b,Z=((V=N.alias)===null||V===void 0?void 0:V.toLowerCase())||"",ee=((b=N.cloudAccountId)===null||b===void 0?void 0:b.toLowerCase())||"";return Z.includes(u)||ee.includes(u)||M.includes(u)}return M.includes(u)},onChange:function(o){var a,i;(a=y.current)===null||a===void 0||a.setFieldValue("cloudAccountId",o),ie(function(u){return d()(d()({},u),{},{cloudAccountId:o})}),(i=w.current)===null||i===void 0||i.reload(),e()},onBlur:function(){e()},style:{minWidth:320}})})},filterDropdownProps:{onOpenChange:Cr},filterIcon:function(l){return(0,r.jsx)(xe.Z,{style:{color:l?"#1677ff":"#1890ff",fontSize:"18px",fontWeight:"bold"}})},render:function(l,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)(Y.Z.Text,{copyable:e!=null&&e.cloudAccountId?{text:e.cloudAccountId}:!1,style:{color:"rgb(51, 51, 51)"},ellipsis:{tooltip:(e==null?void 0:e.cloudAccountId)||"-"},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,r.jsxs)($.Z,{style:{fontSize:"12px",color:"#999"},children:[(0,I.c5)(e.platform,Ce),(e==null?void 0:e.alias)||"-"]})]})}},{title:c.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),dataIndex:"ruleTypeIdList",valueType:"cascader",hideInTable:!0,colSize:1,fieldProps:{multiple:!0,options:We,showCheckedStrategy:at,fieldNames:{label:"typeName",value:"id",children:"childList"}}},{title:c.formatMessage({id:"layout.routes.title.ruleGroup"}),dataIndex:"ruleGroupIdList",valueType:"select",valueEnum:(0,I.W_)(Be),hideInTable:!0,colSize:1,fieldProps:{mode:"multiple"}},{title:c.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeList",valueType:"cascader",align:"left",hideInTable:!0,colSize:1,fieldProps:{multiple:!0,showCheckedStrategy:at,options:sr,showSearch:!0,allowClear:!0}},{title:c.formatMessage({id:"common.table.columns.assetId"}),dataIndex:"resourceId",valueType:"text",align:"left",hideInTable:!0,colSize:1},{title:c.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceName",valueType:"text",align:"left",hideInTable:!0,colSize:1},{title:c.formatMessage({id:"risk.module.text.firstAndLast.discovered"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(l,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,r.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:c.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonTypeList",valueType:"checkbox",valueEnum:(0,I.W_)(v.$G),align:"left",hideInTable:!0,hideInSearch:ue!=="IGNORED",colSize:6},{title:c.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",hideInSearch:!0,render:function(l,e){return(0,r.jsx)(W.Z,{text:e==null?void 0:e.resourceType})}},{title:c.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceNameDisplay",valueType:"text",align:"left",width:300,hideInSearch:!0,render:function(l,e){var n=(e==null?void 0:e.resourceStatus)===v.Bj[1].value?"(".concat(c.formatMessage({id:"risk.module.text.not.exist"}),") ")+e.resourceName:e.resourceName||"-";return(0,r.jsxs)($.Z,{align:"center",children:[(0,r.jsx)(Y.Z.Text,{copyable:e!=null&&e.resourceName?{text:e.resourceName}:!1,style:{maxWidth:450},ellipsis:{tooltip:n},children:e.resourceName||"-"}),(0,r.jsx)(J,{status:e==null?void 0:e.resourceStatus})]})}},{title:c.formatMessage({id:"risk.module.text.first.discovery"}),dataIndex:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0,colSize:1,fieldProps:{presets:H.El},search:{transform:function(l){return{gmtCreateStart:l[0],gmtCreateEnd:l[1]}}}},{title:c.formatMessage({id:"risk.module.text.recently.discovery"}),dataIndex:"modifiedTimeRange",valueType:"dateTimeRange",hideInTable:!0,colSize:1,fieldProps:{presets:H.El},search:{transform:function(l){return{gmtModifiedStart:l[0],gmtModifiedEnd:l[1]}}}},{title:c.formatMessage({id:"common.table.columns.assetStatus"}),dataIndex:"resourceStatus",valueType:"select",valueEnum:(0,I.W_)(v.Bj),align:"left",hideInTable:!0,colSize:1},{title:c.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"text",align:"center",hideInSearch:!0,render:function(l,e){var n;return(0,I.Dd)(H.I9,e==null||(n=e.ruleVO)===null||n===void 0?void 0:n.riskLevel)}},{title:c.formatMessage({id:"risk.module.text.risk.status"}),dataIndex:"status",valueType:"text",align:"left",hideInSearch:!0,render:function(l,e){return(0,I.Ff)(v.MW,e==null?void 0:e.status)}},{title:c.formatMessage({id:"risk.module.text.ignore.reason"}),dataIndex:"ignoreReason",valueType:"text",align:"left",hideInSearch:!0,hideInTable:ue!=="IGNORED",render:function(l,e){return(0,r.jsx)(g.Z,{placement:"topLeft",text:e.ignoreReason||"-",maxWidth:210})}},{title:c.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonType",valueType:"select",valueEnum:(0,I.W_)(v.$G),align:"left",hideInSearch:!0,hideInTable:ue!=="IGNORED"},{title:c.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(l,e){var n;return(0,r.jsxs)(r.Fragment,{children:[!((n=["WHITED"])!==null&&n!==void 0&&n.includes(e.status))&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.ZP,{size:"small",type:"link",onClick:function(){return Mr({riskId:e==null?void 0:e.id})},children:c.formatMessage({id:"common.button.text.white"})}),(0,r.jsx)(nt.Z,{type:"vertical"})]}),e.status==="IGNORED"?(0,r.jsx)(Nt.Z,{title:(0,r.jsx)(r.Fragment,{}),description:c.formatMessage({id:"risk.module.text.cancel.ignore"}),onConfirm:function(){return lr(e)},onCancel:function(){},okText:c.formatMessage({id:"common.button.text.ok"}),cancelText:c.formatMessage({id:"common.button.text.cancel"}),children:(0,r.jsx)(R.ZP,{size:"small",type:"link",children:c.formatMessage({id:"common.button.text.cancelIgnore"})})}):(0,r.jsx)(R.ZP,{size:"small",type:"link",onClick:function(){mt.current=d()({},e),ft(!0)},children:c.formatMessage({id:"common.button.text.ignore"})}),(0,r.jsx)(nt.Z,{type:"vertical"}),(0,r.jsx)(R.ZP,{size:"small",type:"link",target:"_self",onClick:function(){dt(!0),ct.current=d()({},e)},children:c.formatMessage({id:"common.button.text.detail"})})]})}}],Ar=function(){var s=C()(h()().mark(function l(e){var n,o,a,i,u,M,N,V,b,Z,ee,he,Le,Ot,wt,bt,kt,Pt,Ft,Qe,He,Ye,Je,te,Xe,qe,et,de,Vt;return h()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return i=e.pageSize,u=e.current,M=e.ruleId,N=e.ruleGroupIdList,V=e.cloudAccountId,b=e.resourceName,Z=e.resourceTypeList,ee=e.status,he=ee===void 0?"UNREPAIRED":ee,Le=e.ignoreReasonTypeList,Ot=e.ruleTypeIdList,wt=e.gmtCreateStart,bt=e.gmtCreateEnd,kt=e.gmtModifiedStart,Pt=e.gmtModifiedEnd,Ft=e.resourceStatus,Qe=p.getFieldValue("platformList"),He=p.getFieldValue("riskLevelList"),Ye=(n=y.current)===null||n===void 0?void 0:n.getFieldValue("ruleCodeList"),Je=(o=y.current)===null||o===void 0?void 0:o.getFieldValue("resourceId"),te={page:u,size:i,ruleId:M,ruleGroupIdList:N,cloudAccountId:V,resourceName:b,resourceTypeList:Z,status:he,ignoreReasonTypeList:Le,ruleTypeIdList:Ot,gmtCreateStart:wt,gmtCreateEnd:bt,gmtModifiedStart:kt,gmtModifiedEnd:Pt,resourceStatus:Ft},Qe&&(te.platformList=Qe),He&&(te.riskLevelList=He),Ye&&(te.ruleCodeList=Ye),Je&&(te.resourceId=Je),Xe=(a=y.current)===null||a===void 0?void 0:a.getFieldValue("cloudAccountId"),qe=Se.cloudAccountId,V?te.cloudAccountId=V:Xe?te.cloudAccountId=Xe:qe&&(te.cloudAccountId=qe),pe.next=15,(0,L.queryRiskList)(te);case 15:return et=pe.sent,de=et.content,Vt=et.code,pe.abrupt("return",{data:(de==null?void 0:de.data)||[],total:(de==null?void 0:de.total)||0,success:Vt===200||!1});case 19:case"end":return pe.stop()}},l)}));return function(e){return s.apply(this,arguments)}}();return(0,r.jsxs)(Fe._z,{title:!1,className:st.Z.riskPageContainer,breadcrumbRender:!1,children:[Te,(0,r.jsx)(Ve.Z,{bodyStyle:{paddingBlock:0},className:st.Z.customFilterCard,tabs:{activeKey:ue,items:v.MW.map(function(s){return{label:s.label,key:s.value,children:(0,r.jsx)(T.Z,{form:p,children:(0,r.jsxs)(Zt.Z,{gutter:[24,10],children:[(0,r.jsx)(lt.Z,{span:24,children:(0,r.jsx)(T.Z.Item,{name:"platformList",label:c.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,r.jsx)(ot.Z.Group,{options:(0,I.T$)(Ce),onChange:function(e){var n,o=e||[];p.setFieldValue("resourceTypeList",null),je([]),Ue(o),Ge({platformList:o}),(n=w.current)===null||n===void 0||n.reload()}})})}),(0,r.jsx)(lt.Z,{span:24,children:(0,r.jsx)(T.Z.Item,{name:"riskLevelList",label:c.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,r.jsx)(ot.Z.Group,{options:(0,I.at)(H.I9),onChange:function(e){var n;(n=w.current)===null||n===void 0||n.reload()}})})})]})})}})||[],onChange:function(l){var e,n,o;tr(l),(e=y.current)===null||e===void 0||e.setFieldValue("ignoreReasonTypeList",[]);var a=p.getFieldsValue(),i=((n=y.current)===null||n===void 0?void 0:n.getFieldsValue())||{},u=d()(d()(d()(d()({},Se),a),i),{},{status:l,ignoreReasonTypeList:[]});ie(u),(o=w.current)===null||o===void 0||o.reload()}}}),(0,r.jsx)(Ne.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,labelWidth:0,defaultColsNumber:6},headerTitle:(0,r.jsx)("div",{className:k.Z.customTitle,children:c.formatMessage({id:"risk.module.text.risk.inquiry"})}),toolBarRender:function(){return[(0,r.jsx)(R.ZP,{type:"primary",loading:nr,onClick:xr,children:c.formatMessage({id:"common.button.text.export"})},"export")]},actionRef:w,formRef:y,columns:Rr,request:Ar,onReset:function(){p.resetFields(),ie({})},onSubmit:function(){var l,e=p.getFieldsValue(),n=((l=y.current)===null||l===void 0?void 0:l.getFieldsValue())||{};ie(d()(d()(d()({},Se),e),n))},params:d()({},Se),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}}),(0,r.jsx)(Oe.Z,{locate:"risk",riskDrawerVisible:zt,setRiskDrawerVisible:dt,riskDrawerInfo:ct.current,tableActionRef:w}),(0,r.jsx)(Re,{ignoreRiskFormVisible:$t,setIgnoreRiskFormVisible:ft,riskInfo:mt.current,tableActionRef:w}),(0,r.jsx)(we.Z,{editDrawerVisible:Qt,setEditDrawerVisible:pt,whiteListDrawerInfo:gt.current,tableActionRef:w}),(0,r.jsx)(be.Z,{visible:Yt,onClose:function(){return xt(!1)},ruleId:Ct.ruleId,ruleCode:Ct.ruleCode})]})},_t=Wt},64818:function(re,_,t){"use strict";var O=t(15009),h=t.n(O),A=t(99289),C=t.n(A),B=t(5574),f=t.n(B),Q=t(62435),d=t(68872),S=t(66309),v=t(85265),m=t(57381),j=t(26412),k=t(25593),r=t(45830),J=t(96655),W=t(29448),g=t(86074),L=function(P){var E=P.visible,G=P.onClose,T=P.ruleId,U=P.ruleCode,x=(0,r.useIntl)(),Ee=d.ZP.useMessage(),Re=f()(Ee,2),Oe=Re[0],we=Re[1],be=(0,Q.useState)(!1),ye=f()(be,2),ke=ye[0],Ae=ye[1],Pe=(0,Q.useState)(null),H=f()(Pe,2),I=H[0],xe=H[1];(0,Q.useEffect)(function(){E&&T&&Fe()},[E,T]);var Fe=function(){var $=C()(h()().mark(function z(){var Y;return h()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(Ae(!0),R.prev=1,!T){R.next=6;break}return R.next=5,(0,J.queryRuleDetail)({id:T});case 5:Y=R.sent;case 6:Y&&Y.content&&xe(Y.content),R.next=12;break;case 9:R.prev=9,R.t0=R.catch(1),Oe.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return R.prev=12,Ae(!1),R.finish(12);case 15:case"end":return R.stop()}},z,null,[[1,9,12,15]])}));return function(){return $.apply(this,arguments)}}(),Ve=function(){xe(null),G()},Ne=function(z){switch(z.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},tt=function(z){if(!z)return null;var Y=z.split(",");return Y.map(function(Ie,R){return(0,g.jsx)(S.Z,{color:Ne(Ie.trim()),children:Ie.trim()},R)})},rt=function(z){return(0,W.c5)(z)};return(0,g.jsxs)(g.Fragment,{children:[we,(0,g.jsx)(v.Z,{placement:"right",onClose:Ve,open:E,width:1e3,destroyOnClose:!0,children:(0,g.jsx)(m.Z,{spinning:ke,children:I&&(0,g.jsxs)(j.Z,{column:1,bordered:!0,children:[(0,g.jsx)(j.Z.Item,{label:x.formatMessage({id:"home.module.inform.columns.ruleName"},{}),children:(0,g.jsx)(k.Z.Text,{copyable:!0,children:I.ruleName})}),(0,g.jsx)(j.Z.Item,{label:"Code",children:(0,g.jsx)(k.Z.Text,{copyable:!0,children:I.ruleCode})}),(0,g.jsx)(j.Z.Item,{label:x.formatMessage({id:"rule.module.text.repair.suggestions"},{}),children:(0,g.jsx)(k.Z.Text,{copyable:!0,children:I.advice})}),(0,g.jsx)(j.Z.Item,{label:x.formatMessage({id:"rule.module.text.reference.link"},{}),children:(0,g.jsx)(k.Z.Text,{copyable:!0,children:I.link})}),(0,g.jsx)(j.Z.Item,{label:x.formatMessage({id:"rule.module.text.risk.context.template"},{}),children:(0,g.jsx)(k.Z.Text,{copyable:!0,children:I.context})}),I.ruleRego&&(0,g.jsx)(j.Z.Item,{label:"Rego Policy",children:(0,g.jsx)(k.Z.Text,{copyable:{text:I.ruleRego},children:(0,g.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"2048px",overflow:"auto"},children:I.ruleRego})})}),I.gmtModified&&(0,g.jsx)(j.Z.Item,{label:x.formatMessage({id:"common.text.update.time"},{}),children:(0,g.jsx)(k.Z.Text,{copyable:!0,children:I.gmtModified})})]})})})]})};_.Z=L},70501:function(re,_,t){"use strict";var O=t(62435),h=Object.defineProperty,A=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,f=(S,v,m)=>v in S?h(S,v,{enumerable:!0,configurable:!0,writable:!0,value:m}):S[v]=m,Q=(S,v)=>{for(var m in v||(v={}))C.call(v,m)&&f(S,m,v[m]);if(A)for(var m of A(v))B.call(v,m)&&f(S,m,v[m]);return S};const d=S=>React.createElement("svg",Q({className:"DEFAULT_RESOURCE_ICON_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:256,height:256},S),React.createElement("path",{d:"M827.52 782.08a39.84 39.84 0 0 0 56.64 0l104.32-103.36a119.68 119.68 0 0 0 0-170.08L886.4 405.92a40 40 0 0 0-56.8 56.16l90.88 92h-322.4a40 40 0 0 0 0 80h322.24l-92.48 91.52a40 40 0 0 0-.32 56.48z",fill:"#1480ED"}),React.createElement("path",{d:"M864 80h-52V40a40 40 0 0 0-80 0v40H550.08V40a40 40 0 0 0-80 0v40h-180V40a40 40 0 1 0-80 0v40H160A160 160 0 0 0 0 240v624a160 160 0 0 0 160 160h704a160 160 0 0 0 160-160 40 40 0 0 0-80 0 80 80 0 0 1-80 80H160a80 80 0 0 1-80-80V240a80 80 0 0 1 80-80h50.08v40a40 40 0 0 0 80 0v-40h180v40a40 40 0 0 0 80 0v-40H732v40a40 40 0 0 0 80 0v-40h52a80 80 0 0 1 80 80v90.08a40 40 0 0 0 80 0V240A160 160 0 0 0 864 80z",fill:"#2A5699"}));_.Z="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiI+PHBhdGggZD0iTTgyNy41MiA3ODIuMDhhMzkuODQgMzkuODQgMCAwIDAgNTYuNjQgMGwxMDQuMzItMTAzLjM2YTExOS42OCAxMTkuNjggMCAwIDAgMC0xNzAuMDhMODg2LjQgNDA1LjkyYTQwIDQwIDAgMCAwLTU2LjggNTYuMTZsOTAuODggOTJoLTMyMi40YTQwIDQwIDAgMCAwIDAgODBoMzIyLjI0bC05Mi40OCA5MS41MmE0MCA0MCAwIDAgMC0uMzIgNTYuNDh6IiBmaWxsPSIjMTQ4MEVEIi8+PHBhdGggZD0iTTg2NCA4MGgtNTJWNDBhNDAgNDAgMCAwIDAtODAgMHY0MEg1NTAuMDhWNDBhNDAgNDAgMCAwIDAtODAgMHY0MGgtMTgwVjQwYTQwIDQwIDAgMSAwLTgwIDB2NDBIMTYwQTE2MCAxNjAgMCAwIDAgMCAyNDB2NjI0YTE2MCAxNjAgMCAwIDAgMTYwIDE2MGg3MDRhMTYwIDE2MCAwIDAgMCAxNjAtMTYwIDQwIDQwIDAgMCAwLTgwIDAgODAgODAgMCAwIDEtODAgODBIMTYwYTgwIDgwIDAgMCAxLTgwLTgwVjI0MGE4MCA4MCAwIDAgMSA4MC04MGg1MC4wOHY0MGE0MCA0MCAwIDAgMCA4MCAwdi00MGgxODB2NDBhNDAgNDAgMCAwIDAgODAgMHYtNDBINzMydjQwYTQwIDQwIDAgMCAwIDgwIDB2LTQwaDUyYTgwIDgwIDAgMCAxIDgwIDgwdjkwLjA4YTQwIDQwIDAgMCAwIDgwIDBWMjQwQTE2MCAxNjAgMCAwIDAgODY0IDgweiIgZmlsbD0iIzJBNTY5OSIvPjwvc3ZnPg=="},85674:function(re,_,t){var O={"./simpleWorker":18352,"./simpleWorker.js":18352};function h(A){return Promise.resolve().then(function(){if(!t.o(O,A)){var C=new Error("Cannot find module '"+A+"'");throw C.code="MODULE_NOT_FOUND",C}var B=O[A];return t(B)})}h.keys=function(){return Object.keys(O)},h.id=85674,re.exports=h},10131:function(re,_,t){var O={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function h(A){if(!t.o(O,A))return Promise.resolve().then(function(){var f=new Error("Cannot find module '"+A+"'");throw f.code="MODULE_NOT_FOUND",f});var C=O[A],B=C[0];return Promise.all(C.slice(1).map(t.e)).then(function(){return t(B)})}h.keys=function(){return Object.keys(O)},h.id=10131,re.exports=h}}]);
