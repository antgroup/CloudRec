"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4992],{7401:function(se,O,e){e.r(O);var Z=e(15009),D=e.n(Z),G=e(99289),P=e.n(G),N=e(5574),m=e.n(N),I=e(29297),H=e(57695),k=e(94032),p=e(10736),w=e(39380),b=e(45830),$=e(25593),z=e(68872),L=e(71230),F=e(86250),j=e(42075),T=e(83622),A=e(15746),E=e(85137),v=e(62435),J=e(61194),t=e(86074),B=$.Z.Title,V=function(){var Q=(0,b.useLocation)(),X=new URLSearchParams(Q.search),x=(0,v.useState)(X.get("id")),Y=m()(x,1),g=Y[0],M=z.ZP.useMessage(),K=m()(M,2),h=K[0],q=K[1],ee=(0,v.useState)(!1),W=m()(ee,2),te=W[0],d=W[1],a=(0,v.useState)(""),u=m()(a,2),c=u[0],C=u[1],U=(0,v.useState)(""),n=m()(U,2),ne=n[0],R=n[1],ie=(0,v.useState)({}),re=m()(ie,2),de=re[0],_e=re[1],ce=(0,v.useState)(1),ae=m()(ce,2),me=ae[0],Ee=ae[1],ve=(0,v.useState)(!1),le=m()(ve,2),De=le[0],oe=le[1],ue=(0,v.useRef)({}),fe=function(l){C(l)},ge=function(l){R(l)},S=function(){var o=P()(D()().mark(function l(r){var i,s,_;return D()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return d(!0),y.next=3,(0,p.queryLatestById)({ruleId:r});case 3:i=y.sent,d(!1),(i.code===200||i.msg==="success")&&(s=i.content,C((s==null?void 0:s.ruleRego)||""),Ee(s==null?void 0:s.isDraft),_=s!=null&&s.input?JSON.parse(s==null?void 0:s.input):{},R(JSON.stringify(_,null,4)||""));case 6:case"end":return y.stop()}},l)}));return function(r){return o.apply(this,arguments)}}();(0,v.useEffect)(function(){g&&S(Number(g))},[g]);var Me=function(){var o=P()(D()().mark(function l(){var r;return D()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,p.evaluateRego)({ruleRego:c,input:ne});case 2:r=s.sent,r.code===200||r.msg==="success"?(h.success("\u6267\u884C\u6210\u529F"),_e((r==null?void 0:r.content)||{})):r.code!==200&&r.msg!=="success"&&_e(r||{});case 4:case"end":return s.stop()}},l)}));return function(){return o.apply(this,arguments)}}(),Ce=function(){var o=P()(D()().mark(function l(){var r,i;return D()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return r={ruleId:Number(g),isDraft:1,ruleRego:c},_.next=3,(0,p.saveRego)(r);case 3:if(i=_.sent,!(i.code===200||i.msg==="success")){_.next=8;break}return _.next=7,S(Number(g));case 7:h.success("\u4FDD\u5B58\u6210\u529F");case 8:case"end":return _.stop()}},l)}));return function(){return o.apply(this,arguments)}}(),Pe=function(){var o=P()(D()().mark(function l(){var r,i;return D()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return r={ruleId:Number(g),isDraft:0,ruleRego:c},_.next=3,(0,p.saveRego)(r);case 3:if(i=_.sent,!(i.code===200||i.msg==="success")){_.next=8;break}return _.next=7,S(Number(g));case 7:h.success("\u63D0\u4EA4\u6210\u529F");case 8:case"end":return _.stop()}},l)}));return function(){return o.apply(this,arguments)}}(),Re=function(){ue.current={ruleId:g},oe(!0)};return(0,t.jsxs)(w._z,{ghost:!0,title:!1,loading:te,style:{paddingInline:12},children:[q,(0,t.jsx)(L.Z,{children:(0,t.jsx)(F.Z,{justify:"end",style:{width:"100%"},children:(0,t.jsxs)(j.Z,{children:[(0,t.jsxs)(T.ZP,{type:"link",style:{color:"rgba(54, 110, 255, 1)"},href:"https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/hiw98ff7fzdn3exc",target:"_blank",children:[(0,t.jsx)("img",{src:H.Uk.linkIcon,style:{height:14},alt:"LINK_ICON"}),"\u914D\u7F6E\u8BF4\u660E"]}),(0,t.jsx)(T.ZP,{type:"primary",onClick:function(){return Me()},children:"\u6267\u884C"}),me===1&&(0,t.jsx)(T.ZP,{type:"primary",onClick:function(){return Ce()},children:"\u4FDD\u5B58"}),(0,t.jsx)(T.ZP,{type:"primary",onClick:function(){return Pe()},children:"\u63D0\u4EA4"})]})})}),(0,t.jsxs)(L.Z,{gutter:20,children:[(0,t.jsxs)(A.Z,{md:14,span:24,children:[(0,t.jsx)(B,{level:5,children:"The Rego PlayGround"}),(0,t.jsx)(I.mi,{editorKey:"regoEditor",value:c,onChange:fe,editorStyle:{height:"740px"}})]}),(0,t.jsxs)(A.Z,{md:10,span:24,children:[(0,t.jsx)(B,{level:5,children:"INPUT"}),(0,t.jsx)(I.q9,{editorStyle:{height:"420px"},editorKey:"inputEditor",value:ne,onChange:ge}),(0,t.jsx)(B,{style:{marginTop:8},level:5,children:"OUTPUT"}),(0,t.jsx)(I.Wy,{viewerStyle:{height:"280px"},value:de})]})]}),(0,t.jsxs)(E.Z.Group,{shape:"square",style:{insetInlineEnd:2,top:168,bottom:32},children:[(0,t.jsx)(E.Z,{onClick:function(){return Re()},className:J.Z.floatButton,icon:(0,t.jsx)("div",{style:{fontSize:14},children:"\u5386\u53F2"})}),(0,t.jsx)(E.Z,{className:J.Z.floatButton,icon:(0,t.jsx)("div",{style:{fontSize:14},children:"\u5C5E\u6027"})})]}),(0,t.jsx)(k.Z,{noteDrawerVisible:De,setNoteDrawerVisible:oe,noteDrawerInfo:ue.current,requestRuleDetailById:S})]})};O.default=V},94032:function(se,O,e){var Z=e(97857),D=e.n(Z),G=e(15009),P=e.n(G),N=e(99289),m=e.n(N),I=e(5574),H=e.n(I),k=e(29297),p=e(10736),w=e(90498),b=e(93410),$=e(45830),z=e(68872),L=e(83622),F=e(85265),j=e(96486),T=e.n(j),A=e(62435),E=e(86074),v=function(t){var B=t.noteDrawerVisible,V=t.setNoteDrawerVisible,f=t.noteDrawerInfo,Q=t.requestRuleDetailById,X=z.ZP.useMessage(),x=H()(X,2),Y=x[0],g=x[1],M=(0,$.useIntl)(),K=function(){V(!1)},h=function(){K()},q=(0,A.useRef)(),ee=function(){var d=m()(P()().mark(function a(u){var c,C;return P()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return c={ruleId:f==null?void 0:f.ruleId,isDraft:0,ruleRego:u==null?void 0:u.ruleRego},n.next=3,(0,p.saveRego)(c);case 3:if(C=n.sent,!(C.code===200||C.msg==="success")){n.next=9;break}return Y.success(M.formatMessage({id:"rule.message.text.version.rollback.success"})),n.next=8,Q(Number(f==null?void 0:f.ruleId));case 8:h();case 9:case"end":return n.stop()}},a)}));return function(u){return d.apply(this,arguments)}}(),W=[{title:M.formatMessage({id:"rule.module.text.version"}),dataIndex:"version",align:"center",render:function(a){return"v"+a}},{title:M.formatMessage({id:"rule.module.text.user.name"}),dataIndex:"userName",align:"center"},{title:M.formatMessage({id:"common.table.columns.rule.updateTime"}),dataIndex:"gmtModified",align:"center"},{title:M.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"operate",align:"center",valueType:"option",render:function(a,u){return(0,E.jsx)(L.ZP,{type:"link",onClick:function(){return ee(u)},children:M.formatMessage({id:"common.button.text.rollback"})})}}],te=function(){var d=m()(P()().mark(function a(u){var c,C,U,n;return P()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return U={page:u.current,size:u.pageSize,ruleId:f==null?void 0:f.ruleId},R.next=3,(0,p.queryRegoList)(D()({},U));case 3:return n=R.sent,R.abrupt("return",{data:(n==null||(c=n.content)===null||c===void 0?void 0:c.data)||[],success:(n==null?void 0:n.code)===200||!1,total:(n==null||(C=n.content)===null||C===void 0?void 0:C.total)||0});case 5:case"end":return R.stop()}},a)}));return function(u){return d.apply(this,arguments)}}();return(0,E.jsxs)(F.Z,{title:M.formatMessage({id:"rule.extend.text.historical.records"}),width:"52%",destroyOnClose:!0,open:B,onClose:h,children:[g,(0,E.jsx)(w.Z,{search:!1,scroll:{x:!0},options:!1,rowKey:"id",columns:W,actionRef:q,request:te,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},expandable:{expandRowByClick:!0,expandedRowRender:function(a){return(0,E.jsx)(b.Z,{direction:"column",gutter:[0,16],children:!(0,j.isEmpty)(a.ruleRego)&&(0,E.jsxs)(b.Z,{ghost:!0,children:[(0,E.jsx)("p",{children:M.formatMessage({id:"rule.module.text.info"})}),(0,E.jsx)(k.mi,{editorKey:"regoMsgEditor",value:a.ruleRego,editorStyle:{height:"280px",maxHeight:"280px"}})]})})},rowExpandable:function(a){return!(0,j.isEmpty)(a.ruleRego)}}})]})};O.Z=v},61194:function(se,O){O.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}}}]);
