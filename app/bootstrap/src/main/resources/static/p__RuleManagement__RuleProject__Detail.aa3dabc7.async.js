"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4992],{7401:function(ne,R,e){e.r(R);var k=e(15009),v=e.n(k),Z=e(99289),C=e.n(Z),N=e(5574),m=e.n(N),I=e(29297),V=e(57695),w=e(94032),P=e(10736),$=e(39380),b=e(45830),z=e(25593),G=e(68872),L=e(71230),F=e(86250),j=e(42075),T=e(83622),A=e(15746),E=e(85137),D=e(62435),J=e(61194),t=e(86074),B=z.Z.Title,H=function(){var Q=(0,b.useLocation)(),X=new URLSearchParams(Q.search),x=(0,D.useState)(X.get("id")),Y=m()(x,1),f=Y[0],M=G.ZP.useMessage(),K=m()(M,2),O=K[0],q=K[1],ee=(0,D.useState)(!1),W=m()(ee,2),te=W[0],d=W[1],a=(0,D.useState)(""),u=m()(a,2),c=u[0],p=u[1],y=(0,D.useState)(""),s=m()(y,2),se=s[0],h=s[1],ie=(0,D.useState)({}),re=m()(ie,2),de=re[0],_e=re[1],ce=(0,D.useState)(1),ae=m()(ce,2),me=ae[0],Ee=ae[1],De=(0,D.useState)(!1),le=m()(De,2),ve=le[0],oe=le[1],ue=(0,D.useRef)({}),ge=function(l){p(l)},fe=function(l){h(l)},S=function(){var o=C()(v()().mark(function l(r){var i,n,_;return v()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return d(!0),U.next=3,(0,P.queryLatestById)({ruleId:r});case 3:i=U.sent,d(!1),(i.code===200||i.msg==="success")&&(n=i.content,p((n==null?void 0:n.ruleRego)||""),Ee(n==null?void 0:n.isDraft),_=n!=null&&n.input?JSON.parse(n==null?void 0:n.input):{},h(JSON.stringify(_,null,4)||""));case 6:case"end":return U.stop()}},l)}));return function(r){return o.apply(this,arguments)}}();(0,D.useEffect)(function(){f&&S(Number(f))},[f]);var Me=function(){var o=C()(v()().mark(function l(){var r;return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,P.evaluateRego)({ruleRego:c,input:se});case 2:r=n.sent,r.code===200||r.msg==="success"?(O.success("\u6267\u884C\u6210\u529F"),_e((r==null?void 0:r.content)||{})):r.code!==200&&r.msg!=="success"&&_e(r||{});case 4:case"end":return n.stop()}},l)}));return function(){return o.apply(this,arguments)}}(),pe=function(){var o=C()(v()().mark(function l(){var r,i;return v()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return r={ruleId:Number(f),isDraft:1,ruleRego:c},_.next=3,(0,P.saveRego)(r);case 3:if(i=_.sent,!(i.code===200||i.msg==="success")){_.next=8;break}return _.next=7,S(Number(f));case 7:O.success("\u4FDD\u5B58\u6210\u529F");case 8:case"end":return _.stop()}},l)}));return function(){return o.apply(this,arguments)}}(),Ce=function(){var o=C()(v()().mark(function l(){var r,i;return v()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return r={ruleId:Number(f),isDraft:0,ruleRego:c},_.next=3,(0,P.saveRego)(r);case 3:if(i=_.sent,!(i.code===200||i.msg==="success")){_.next=8;break}return _.next=7,S(Number(f));case 7:O.success("\u63D0\u4EA4\u6210\u529F");case 8:case"end":return _.stop()}},l)}));return function(){return o.apply(this,arguments)}}(),he=function(){ue.current={ruleId:f},oe(!0)};return(0,t.jsxs)($._z,{ghost:!0,title:!1,loading:te,style:{paddingInline:12},children:[q,(0,t.jsx)(L.Z,{children:(0,t.jsx)(F.Z,{justify:"end",style:{width:"100%"},children:(0,t.jsxs)(j.Z,{children:[(0,t.jsxs)(T.ZP,{type:"link",style:{color:"rgba(54, 110, 255, 1)"},href:"https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/hiw98ff7fzdn3exc",target:"_blank",children:[(0,t.jsx)("img",{src:V.Uk.linkIcon,style:{height:14},alt:"LINK_ICON"}),"\u914D\u7F6E\u8BF4\u660E"]}),(0,t.jsx)(T.ZP,{type:"primary",onClick:function(){return Me()},children:"\u6267\u884C"}),me===1&&(0,t.jsx)(T.ZP,{type:"primary",onClick:function(){return pe()},children:"\u4FDD\u5B58"}),(0,t.jsx)(T.ZP,{type:"primary",onClick:function(){return Ce()},children:"\u63D0\u4EA4"})]})})}),(0,t.jsxs)(L.Z,{gutter:20,children:[(0,t.jsxs)(A.Z,{md:14,span:24,children:[(0,t.jsx)(B,{level:5,children:"The Rego PlayGround"}),(0,t.jsx)(I.mi,{editorKey:"regoEditor",value:c,onChange:ge,editorStyle:{height:"740px"}})]}),(0,t.jsxs)(A.Z,{md:10,span:24,children:[(0,t.jsx)(B,{level:5,children:"INPUT"}),(0,t.jsx)(I.q9,{editorStyle:{height:"420px"},editorKey:"inputEditor",value:se,onChange:fe}),(0,t.jsx)(B,{style:{marginTop:8},level:5,children:"OUTPUT"}),(0,t.jsx)(I.Wy,{viewerStyle:{height:"280px"},value:de})]})]}),(0,t.jsxs)(E.Z.Group,{shape:"square",style:{insetInlineEnd:2,top:168,bottom:32},children:[(0,t.jsx)(E.Z,{onClick:function(){return he()},className:J.Z.floatButton,icon:(0,t.jsx)("div",{style:{fontSize:14},children:"\u5386\u53F2"})}),(0,t.jsx)(E.Z,{className:J.Z.floatButton,icon:(0,t.jsx)("div",{style:{fontSize:14},children:"\u5C5E\u6027"})})]}),(0,t.jsx)(w.Z,{noteDrawerVisible:ve,setNoteDrawerVisible:oe,noteDrawerInfo:ue.current,requestRuleDetailById:S})]})};R.default=H},94032:function(ne,R,e){var k=e(97857),v=e.n(k),Z=e(15009),C=e.n(Z),N=e(99289),m=e.n(N),I=e(5574),V=e.n(I),w=e(29297),P=e(10736),$=e(90498),b=e(93410),z=e(45830),G=e(68872),L=e(83622),F=e(85265),j=e(96486),T=e.n(j),A=e(62435),E=e(86074),D=function(t){var B=t.noteDrawerVisible,H=t.setNoteDrawerVisible,g=t.noteDrawerInfo,Q=t.requestRuleDetailById,X=G.ZP.useMessage(),x=V()(X,2),Y=x[0],f=x[1],M=(0,z.useIntl)(),K=function(){H(!1)},O=function(){K()},q=(0,A.useRef)(),ee=function(){var d=m()(C()().mark(function a(u){var c,p;return C()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return c={ruleId:g==null?void 0:g.ruleId,isDraft:0,ruleRego:u==null?void 0:u.ruleRego},s.next=3,(0,P.saveRego)(c);case 3:if(p=s.sent,!(p.code===200||p.msg==="success")){s.next=9;break}return Y.success(M.formatMessage({id:"rule.message.text.version.rollback.success"})),s.next=8,Q(Number(g==null?void 0:g.ruleId));case 8:O();case 9:case"end":return s.stop()}},a)}));return function(u){return d.apply(this,arguments)}}(),W=[{title:M.formatMessage({id:"rule.module.text.version"}),dataIndex:"version",align:"center",render:function(a){return"v"+a}},{title:M.formatMessage({id:"rule.module.text.user.name"}),dataIndex:"userName",align:"center"},{title:M.formatMessage({id:"common.table.columns.rule.updateTime"}),dataIndex:"gmtModified",align:"center"},{title:M.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"operate",align:"center",valueType:"option",render:function(a,u){return(0,E.jsx)(L.ZP,{type:"link",onClick:function(){return ee(u)},children:M.formatMessage({id:"common.button.text.rollback"})})}}],te=function(){var d=m()(C()().mark(function a(u){var c,p,y,s;return C()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return y={page:u.current,size:u.pageSize,ruleId:g==null?void 0:g.ruleId},h.next=3,(0,P.queryRegoList)(v()({},y));case 3:return s=h.sent,h.abrupt("return",{data:(s==null||(c=s.content)===null||c===void 0?void 0:c.data)||[],success:(s==null?void 0:s.code)===200||!1,total:(s==null||(p=s.content)===null||p===void 0?void 0:p.total)||0});case 5:case"end":return h.stop()}},a)}));return function(u){return d.apply(this,arguments)}}();return(0,E.jsxs)(F.Z,{title:M.formatMessage({id:"rule.extend.text.historical.records"}),width:"52%",destroyOnClose:!0,open:B,onClose:O,children:[f,(0,E.jsx)($.Z,{search:!1,scroll:{x:!0},options:!1,rowKey:"id",columns:W,actionRef:q,request:te,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},expandable:{expandRowByClick:!0,expandedRowRender:function(a){return(0,E.jsx)(b.Z,{direction:"column",gutter:[0,16],children:!(0,j.isEmpty)(a.ruleRego)&&(0,E.jsxs)(b.Z,{ghost:!0,children:[(0,E.jsx)("p",{children:M.formatMessage({id:"rule.module.text.info"})}),(0,E.jsx)(w.mi,{editorKey:"regoMsgEditor",value:a.ruleRego,editorStyle:{height:"280px",maxHeight:"280px"}})]})})},rowExpandable:function(a){return!(0,j.isEmpty)(a.ruleRego)}}})]})};R.Z=D},61194:function(ne,R){R.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}}}]);
