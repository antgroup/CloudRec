(self.webpackChunk=self.webpackChunk||[]).push([[9998],{82826:function(ge,_,t){"use strict";t.d(_,{Z:function(){return i}});var f=t(87462),d=t(62435),A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},M=A,Z=t(84089),o=function(E,b){return d.createElement(Z.Z,(0,f.Z)({},E,{ref:b,icon:M}))},se=d.forwardRef(o),i=se},58638:function(ge,_,t){"use strict";t.d(_,{Z:function(){return i}});var f=t(87462),d=t(62435),A={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},M=A,Z=t(84089),o=function(E,b){return d.createElement(Z.Z,(0,f.Z)({},E,{ref:b,icon:M}))},se=d.forwardRef(o),i=se},86615:function(ge,_,t){"use strict";var f=t(1413),d=t(91),A=t(22270),M=t(78045),Z=t(62435),o=t(90789),se=t(58055),i=t(86074),c=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],E=Z.forwardRef(function(h,$){var R=h.fieldProps,N=h.options,O=h.radioType,m=h.layout,I=h.proFieldProps,w=h.valueEnum,le=(0,d.Z)(h,c);return(0,i.jsx)(se.Z,(0,f.Z)((0,f.Z)({valueType:O==="button"?"radioButton":"radio",ref:$,valueEnum:(0,A.h)(w,void 0)},le),{},{fieldProps:(0,f.Z)({options:N,layout:m},R),proFieldProps:I,filedConfig:{customLightMode:!0}}))}),b=Z.forwardRef(function(h,$){var R=h.fieldProps,N=h.children;return(0,i.jsx)(M.ZP,(0,f.Z)((0,f.Z)({},R),{},{ref:$,children:N}))}),Q=(0,o.G)(b,{valuePropName:"checked",ignoreWidth:!0}),G=Q;G.Group=E,G.Button=M.ZP.Button,G.displayName="ProFormComponent",_.Z=G},91618:function(ge,_,t){"use strict";t.d(_,{Z:function(){return $e}});var f=t(62435),d=Object.defineProperty,A=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,o=(j,p,r)=>p in j?d(j,p,{enumerable:!0,configurable:!0,writable:!0,value:r}):j[p]=r,se=(j,p)=>{for(var r in p||(p={}))M.call(p,r)&&o(j,r,p[r]);if(A)for(var r of A(p))Z.call(p,r)&&o(j,r,p[r]);return j};const i=j=>React.createElement("svg",se({width:8,height:8,xmlns:"http://www.w3.org/2000/svg"},j),React.createElement("title",null,"\u5931\u8D25"),React.createElement("path",{d:"M4 0a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm-.81 2.784a.287.287 0 1 0-.406.405l.81.811-.81.81a.287.287 0 1 0 .405.406L4 4.406l.81.81a.287.287 0 1 0 .406-.405L4.406 4l.81-.81a.287.287 0 1 0-.405-.406L4 3.594l-.81-.81Z",fill:"#FF3931",fillRule:"nonzero"}));var c="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik00IDBhNCA0IDAgMSAxIDAgOCA0IDQgMCAwIDEgMC04Wm0tLjgxIDIuNzg0YS4yODcuMjg3IDAgMSAwLS40MDYuNDA1bC44MS44MTEtLjgxLjgxYS4yODcuMjg3IDAgMSAwIC40MDUuNDA2TDQgNC40MDZsLjgxLjgxYS4yODcuMjg3IDAgMSAwIC40MDYtLjQwNUw0LjQwNiA0bC44MS0uODFhLjI4Ny4yODcgMCAxIDAtLjQwNS0uNDA2TDQgMy41OTRsLS44MS0uODFaIiBmaWxsPSIjRkYzOTMxIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48L3N2Zz4=",E=Object.defineProperty,b=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,h=(j,p,r)=>p in j?E(j,p,{enumerable:!0,configurable:!0,writable:!0,value:r}):j[p]=r,$=(j,p)=>{for(var r in p||(p={}))Q.call(p,r)&&h(j,r,p[r]);if(b)for(var r of b(p))G.call(p,r)&&h(j,r,p[r]);return j};const R=j=>React.createElement("svg",$({width:8,height:8,xmlns:"http://www.w3.org/2000/svg"},j),React.createElement("title",null,"\u901A\u8FC7"),React.createElement("path",{d:"M4 0a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm1.712 2.788a.3.3 0 0 0-.424 0L3.502 4.576l-.79-.787a.3.3 0 0 0-.424.425l1.003.999a.3.3 0 0 0 .424-.001l1.997-2a.3.3 0 0 0 0-.424Z",fill:"#379E0E",fillRule:"nonzero"}));var N="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik00IDBhNCA0IDAgMSAxIDAgOCA0IDQgMCAwIDEgMC04Wm0xLjcxMiAyLjc4OGEuMy4zIDAgMCAwLS40MjQgMEwzLjUwMiA0LjU3NmwtLjc5LS43ODdhLjMuMyAwIDAgMC0uNDI0LjQyNWwxLjAwMy45OTlhLjMuMyAwIDAgMCAuNDI0LS4wMDFsMS45OTctMmEuMy4zIDAgMCAwIDAtLjQyNFoiIGZpbGw9IiMzNzlFMEUiIGZpbGwtcnVsZT0ibm9uemVybyIvPjwvc3ZnPg==",O=Object.defineProperty,m=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,le=(j,p,r)=>p in j?O(j,p,{enumerable:!0,configurable:!0,writable:!0,value:r}):j[p]=r,H=(j,p)=>{for(var r in p||(p={}))I.call(p,r)&&le(j,r,p[r]);if(m)for(var r of m(p))w.call(p,r)&&le(j,r,p[r]);return j};const Te=j=>React.createElement("svg",H({width:8,height:8,xmlns:"http://www.w3.org/2000/svg"},j),React.createElement("title",null,"\u5F85\u64CD\u4F5C"),React.createElement("g",{fillRule:"nonzero",fill:"none"},React.createElement("path",{d:"M4 0a4 4 0 1 1 0 8 4 4 0 0 1 0-8Z",fill:"#FFB310"}),React.createElement("path",{d:"M3.775 2.412a.287.287 0 1 0-.573 0v1.71c0 .316.257.573.573.573h1.718a.287.287 0 1 0 0-.573H3.775v-1.71Z",fill:"#FFF1D4"})));var Ge="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PHBhdGggZD0iTTQgMGE0IDQgMCAxIDEgMCA4IDQgNCAwIDAgMSAwLThaIiBmaWxsPSIjRkZCMzEwIi8+PHBhdGggZD0iTTMuNzc1IDIuNDEyYS4yODcuMjg3IDAgMSAwLS41NzMgMHYxLjcxYzAgLjMxNi4yNTcuNTczLjU3My41NzNoMS43MThhLjI4Ny4yODcgMCAxIDAgMC0uNTczSDMuNzc1di0xLjcxWiIgZmlsbD0iI0ZGRjFENCIvPjwvZz48L3N2Zz4=",J=t(66309),ye=t(53846),je=t(86074),$e=function(j){var p=j.state,r=(0,je.jsx)(J.Z,{children:p||"-"});return["success","valid"].includes(p)?r=(0,je.jsxs)(J.Z,{className:ye.Z.validTag,children:[(0,je.jsx)("img",{src:N,alt:"VALID_ICON",className:ye.Z.imgResult}),"Valid"]}):["error","invalid","failed"].includes(p)?r=(0,je.jsxs)(J.Z,{className:ye.Z.invalidTag,children:[(0,je.jsx)("img",{src:c,alt:"VALID_ICON",className:ye.Z.imgResult}),"Invalid"]}):["waiting","wait"].includes(p)&&(r=(0,je.jsxs)(J.Z,{className:ye.Z.waitingTag,children:[(0,je.jsx)("img",{src:Ge,alt:"WAITING_ICON",className:ye.Z.imgProcess}),"Waiting"]})),r}},24163:function(ge,_,t){"use strict";var f=t(97857),d=t.n(f),A=t(25593),M=t(83062),Z=t(62435),o=t(86074),se=A.Z.Paragraph;_.Z=function(i){var c=i.text,E=i.width,b=i.maxWidth,Q=i.rows,G=Q===void 0?2:Q,h=i.placement,$=h===void 0?"top":h,R=i.color,N=R===void 0?"rgba(0, 0, 0, 0.88)":R,O=i.link,m=O===void 0?!1:O,I=i.onClickCallBackFunc,w=i.style,le=w===void 0?{}:w,H=i.copyable,Te=H===void 0?!1:H;return(0,o.jsx)("div",{style:{maxWidth:b,width:E},children:(0,o.jsx)(M.Z,{title:(0,o.jsx)("div",{children:c}),placement:$,children:(0,o.jsx)(se,{ellipsis:{rows:G},style:d()({marginBottom:0,color:N,cursor:m?"pointer":""},le),onClick:I,copyable:Te,children:c})})})}},52078:function(ge,_,t){"use strict";var f=t(97857),d=t.n(f),A=t(27997),M=t(62435),Z=t(86074),o=function(i){A.Mj.register({id:"json"});var c=i.value,E=c===void 0?"{}":c,b=i.onChange,Q=i.editorStyle,G=Q===void 0?{}:Q,h=i.editorKey,$=h===void 0?"json-editor":h,R=i.readOnly,N=R===void 0?!1:R,O=(0,M.useRef)(),m=(0,M.useRef)(),I=function(){var le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(le),le}catch(H){return console.warn("Invalid JSON string:",H),"{}"}};return(0,M.useEffect)(function(){if(O.current)return m.current?m.current.setValue(E):(m.current=A.j6.create(O.current,{value:I(E),language:"json",theme:"vs",readOnly:N,folding:!0,automaticLayout:!0}),m.current.onDidChangeModelContent(function(){var w=m.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:w}),b==null||b(w)})),function(){if(m!=null&&m.current){var w;m==null||(w=m.current)===null||w===void 0||w.dispose(),m.current=null}}},[]),(0,M.useEffect)(function(){m.current&&E!==m.current.getValue()&&m.current.setValue(I(E))},[E]),(0,Z.jsx)("div",{ref:O,style:d()({height:360,borderRadius:4,overflow:"hidden"},G)},$)};_.Z=o},29297:function(ge,_,t){"use strict";t.d(_,{q9:function(){return f.Z},Wy:function(){return i},mi:function(){return Q}});var f=t(52078),d=t(97857),A=t.n(d),M=t(55171),Z=t.n(M),o=t(86074),se=function(h){var $=h.value,R=h.viewerStyle,N=R===void 0?{}:R,O=h.displayDataTypes,m=O===void 0?!1:O,I=h.name,w=I===void 0?"output json":I;return(0,o.jsx)(Z(),{src:$,name:w,collapsed:!1,displayDataTypes:m,style:A()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},N)})},i=se,c=t(27997),E=t(62435),b=function(h){c.Mj.register({id:"rego"});var $=h.value,R=h.onChange,N=h.editorStyle,O=N===void 0?{}:N,m=h.editorKey,I=h.readOnly,w=I===void 0?!1:I,le=(0,E.useRef)(),H=(0,E.useRef)();return(0,E.useEffect)(function(){if(le.current)return H.current||(H.current=c.j6.create(le.current,{value:$,language:"rego",theme:"vs",readOnly:w,automaticLayout:!0}),H.current.onDidChangeModelContent(function(){R==null||R(H.current.getValue())})),function(){if(H.current){var Te;(Te=H.current)===null||Te===void 0||Te.dispose(),H.current=null}}},[]),(0,o.jsx)("div",{ref:le,style:A()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},O)},m)},Q=b},38575:function(ge,_,t){"use strict";t.r(_),t.d(_,{default:function(){return Tr}});var f=t(15009),d=t.n(f),A=t(99289),M=t.n(A),Z=t(97857),o=t.n(Z),se=t(5574),i=t.n(se),c=t(62435),E=Object.defineProperty,b=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,h=(S,u,y)=>u in S?E(S,u,{enumerable:!0,configurable:!0,writable:!0,value:y}):S[u]=y,$=(S,u)=>{for(var y in u||(u={}))Q.call(u,y)&&h(S,y,u[y]);if(b)for(var y of b(u))G.call(u,y)&&h(S,y,u[y]);return S};const R=S=>React.createElement("svg",$({width:12,height:12,xmlns:"http://www.w3.org/2000/svg"},S),React.createElement("title",null,"\u7F16\u7EC4"),React.createElement("g",{fill:"#457AFF",fillRule:"nonzero"},React.createElement("path",{d:"M7.445 11.998H1.983C.89 11.998 0 11.093 0 9.982V2.015C0 .905.89 0 1.983 0h5.129c1.093 0 1.983.904 1.983 2.015v3.943a.5.5 0 0 1-.495.503.5.5 0 0 1-.495-.503V2.015c0-.557-.445-1.008-.993-1.009H1.983c-.548 0-.992.452-.993 1.01v7.966c0 .557.445 1.009.993 1.01h5.462a.5.5 0 0 1 .495.502.5.5 0 0 1-.495.504Z"}),React.createElement("path",{d:"M6.704 3.042H2.391a.5.5 0 0 1-.495-.503.5.5 0 0 1 .495-.503h4.313a.5.5 0 0 1 .495.503.5.5 0 0 1-.495.503Zm0 1.811H2.391a.5.5 0 0 1-.495-.503.5.5 0 0 1 .495-.503h4.313a.5.5 0 0 1 .495.503.5.5 0 0 1-.495.503ZM4.543 6.664H2.39a.5.5 0 0 1-.495-.503.5.5 0 0 1 .495-.503h2.152a.5.5 0 0 1 .495.503.5.5 0 0 1-.495.503ZM7.628 8.84c0 .564.45 1.021 1.006 1.021.555 0 1.005-.457 1.005-1.022 0-.564-.45-1.021-1.005-1.021-.556 0-1.006.457-1.006 1.021Z"}),React.createElement("path",{d:"M9.61 12H7.61c-.497 0-.956-.27-1.205-.707l-1-1.759a1.438 1.438 0 0 1 0-1.414l1-1.758c.25-.437.708-.706 1.205-.707H9.61c.497 0 .956.27 1.205.707l1 1.758c.247.437.247.976 0 1.414l-1 1.76c-.25.436-.708.705-1.205.706ZM7.61 6.661a.402.402 0 0 0-.347.205l-1 1.757a.415.415 0 0 0 0 .408l1 1.759a.402.402 0 0 0 .347.204H9.61a.401.401 0 0 0 .347-.204l1-1.759a.415.415 0 0 0 0-.408l-1-1.757a.401.401 0 0 0-.347-.204L7.61 6.66Z"})));var N="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzQ1N0FGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNNy40NDUgMTEuOTk4SDEuOTgzQy44OSAxMS45OTggMCAxMS4wOTMgMCA5Ljk4MlYyLjAxNUMwIC45MDUuODkgMCAxLjk4MyAwaDUuMTI5YzEuMDkzIDAgMS45ODMuOTA0IDEuOTgzIDIuMDE1djMuOTQzYS41LjUgMCAwIDEtLjQ5NS41MDMuNS41IDAgMCAxLS40OTUtLjUwM1YyLjAxNWMwLS41NTctLjQ0NS0xLjAwOC0uOTkzLTEuMDA5SDEuOTgzYy0uNTQ4IDAtLjk5Mi40NTItLjk5MyAxLjAxdjcuOTY2YzAgLjU1Ny40NDUgMS4wMDkuOTkzIDEuMDFoNS40NjJhLjUuNSAwIDAgMSAuNDk1LjUwMi41LjUgMCAwIDEtLjQ5NS41MDRaIi8+PHBhdGggZD0iTTYuNzA0IDMuMDQySDIuMzkxYS41LjUgMCAwIDEtLjQ5NS0uNTAzLjUuNSAwIDAgMSAuNDk1LS41MDNoNC4zMTNhLjUuNSAwIDAgMSAuNDk1LjUwMy41LjUgMCAwIDEtLjQ5NS41MDNabTAgMS44MTFIMi4zOTFhLjUuNSAwIDAgMS0uNDk1LS41MDMuNS41IDAgMCAxIC40OTUtLjUwM2g0LjMxM2EuNS41IDAgMCAxIC40OTUuNTAzLjUuNSAwIDAgMS0uNDk1LjUwM1pNNC41NDMgNi42NjRIMi4zOWEuNS41IDAgMCAxLS40OTUtLjUwMy41LjUgMCAwIDEgLjQ5NS0uNTAzaDIuMTUyYS41LjUgMCAwIDEgLjQ5NS41MDMuNS41IDAgMCAxLS40OTUuNTAzWk03LjYyOCA4Ljg0YzAgLjU2NC40NSAxLjAyMSAxLjAwNiAxLjAyMS41NTUgMCAxLjAwNS0uNDU3IDEuMDA1LTEuMDIyIDAtLjU2NC0uNDUtMS4wMjEtMS4wMDUtMS4wMjEtLjU1NiAwLTEuMDA2LjQ1Ny0xLjAwNiAxLjAyMVoiLz48cGF0aCBkPSJNOS42MSAxMkg3LjYxYy0uNDk3IDAtLjk1Ni0uMjctMS4yMDUtLjcwN2wtMS0xLjc1OWExLjQzOCAxLjQzOCAwIDAgMSAwLTEuNDE0bDEtMS43NThjLjI1LS40MzcuNzA4LS43MDYgMS4yMDUtLjcwN0g5LjYxYy40OTcgMCAuOTU2LjI3IDEuMjA1LjcwN2wxIDEuNzU4Yy4yNDcuNDM3LjI0Ny45NzYgMCAxLjQxNGwtMSAxLjc2Yy0uMjUuNDM2LS43MDguNzA1LTEuMjA1LjcwNlpNNy42MSA2LjY2MWEuNDAyLjQwMiAwIDAgMC0uMzQ3LjIwNWwtMSAxLjc1N2EuNDE1LjQxNSAwIDAgMCAwIC40MDhsMSAxLjc1OWEuNDAyLjQwMiAwIDAgMCAuMzQ3LjIwNEg5LjYxYS40MDEuNDAxIDAgMCAwIC4zNDctLjIwNGwxLTEuNzU5YS40MTUuNDE1IDAgMCAwIDAtLjQwOGwtMS0xLjc1N2EuNDAxLjQwMSAwIDAgMC0uMzQ3LS4yMDRMNy42MSA2LjY2WiIvPjwvZz48L3N2Zz4=",O=Object.defineProperty,m=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,le=(S,u,y)=>u in S?O(S,u,{enumerable:!0,configurable:!0,writable:!0,value:y}):S[u]=y,H=(S,u)=>{for(var y in u||(u={}))I.call(u,y)&&le(S,y,u[y]);if(m)for(var y of m(u))w.call(u,y)&&le(S,y,u[y]);return S};const Te=S=>React.createElement("svg",H({width:12,height:14,xmlns:"http://www.w3.org/2000/svg"},S),React.createElement("title",null,"\u7F16\u7EC4"),React.createElement("g",{fill:"#FFF",fillRule:"evenodd"},React.createElement("path",{d:"M7.545 0a2.56 2.56 0 0 1 2.56 2.56l.001 4.122a4.072 4.072 0 0 0-3.15-.003A4.143 4.143 0 0 0 4.5 11.307a4.136 4.136 0 0 0 1.064 2.056H2.56A2.56 2.56 0 0 1 0 10.804V2.56A2.56 2.56 0 0 1 2.56 0h4.985ZM6.511 3.127 5.794 4.61 4.36 3.868a.455.455 0 0 0-.62.214L2.818 5.99a.491.491 0 0 0 .02.464c.084.141.233.227.393.227a.46.46 0 0 0 .413-.264l.717-1.482 1.433.74a.455.455 0 0 0 .62-.213l.922-1.909a.485.485 0 0 0-.208-.636.454.454 0 0 0-.617.21Z"}),React.createElement("path",{d:"M11.415 8.556a3.52 3.52 0 0 1-.432 4.419A3.438 3.438 0 0 1 8.527 14a3.48 3.48 0 0 1-3.407-2.817 3.505 3.505 0 0 1 2.077-3.916 3.459 3.459 0 0 1 4.218 1.289Zm-3.502.691a.25.25 0 0 0-.13.22v2.066a.247.247 0 0 0 .386.208l1.536-1.033a.25.25 0 0 0 0-.416L8.168 9.26a.247.247 0 0 0-.255-.012Z",fillRule:"nonzero"})));var Ge="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iI0ZGRiIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNNy41NDUgMGEyLjU2IDIuNTYgMCAwIDEgMi41NiAyLjU2bC4wMDEgNC4xMjJhNC4wNzIgNC4wNzIgMCAwIDAtMy4xNS0uMDAzQTQuMTQzIDQuMTQzIDAgMCAwIDQuNSAxMS4zMDdhNC4xMzYgNC4xMzYgMCAwIDAgMS4wNjQgMi4wNTZIMi41NkEyLjU2IDIuNTYgMCAwIDEgMCAxMC44MDRWMi41NkEyLjU2IDIuNTYgMCAwIDEgMi41NiAwaDQuOTg1Wk02LjUxMSAzLjEyNyA1Ljc5NCA0LjYxIDQuMzYgMy44NjhhLjQ1NS40NTUgMCAwIDAtLjYyLjIxNEwyLjgxOCA1Ljk5YS40OTEuNDkxIDAgMCAwIC4wMi40NjRjLjA4NC4xNDEuMjMzLjIyNy4zOTMuMjI3YS40Ni40NiAwIDAgMCAuNDEzLS4yNjRsLjcxNy0xLjQ4MiAxLjQzMy43NGEuNDU1LjQ1NSAwIDAgMCAuNjItLjIxM2wuOTIyLTEuOTA5YS40ODUuNDg1IDAgMCAwLS4yMDgtLjYzNi40NTQuNDU0IDAgMCAwLS42MTcuMjFaIi8+PHBhdGggZD0iTTExLjQxNSA4LjU1NmEzLjUyIDMuNTIgMCAwIDEtLjQzMiA0LjQxOUEzLjQzOCAzLjQzOCAwIDAgMSA4LjUyNyAxNGEzLjQ4IDMuNDggMCAwIDEtMy40MDctMi44MTcgMy41MDUgMy41MDUgMCAwIDEgMi4wNzctMy45MTYgMy40NTkgMy40NTkgMCAwIDEgNC4yMTggMS4yODlabS0zLjUwMi42OTFhLjI1LjI1IDAgMCAwLS4xMy4yMnYyLjA2NmEuMjQ3LjI0NyAwIDAgMCAuMzg2LjIwOGwxLjUzNi0xLjAzM2EuMjUuMjUgMCAwIDAgMC0uNDE2TDguMTY4IDkuMjZhLjI0Ny4yNDcgMCAwIDAtLjI1NS0uMDEyWiIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==",J=Object.defineProperty,ye=Object.getOwnPropertySymbols,je=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable,j=(S,u,y)=>u in S?J(S,u,{enumerable:!0,configurable:!0,writable:!0,value:y}):S[u]=y,p=(S,u)=>{for(var y in u||(u={}))je.call(u,y)&&j(S,y,u[y]);if(ye)for(var y of ye(u))$e.call(u,y)&&j(S,y,u[y]);return S};const r=S=>React.createElement("svg",p({width:12,height:12,xmlns:"http://www.w3.org/2000/svg"},S),React.createElement("title",null,"\u5173\u8054"),React.createElement("g",{fill:"#457AFF",fillRule:"nonzero"},React.createElement("path",{d:"M8.25 7.507V5.953a.477.477 0 1 0-.956 0v1.341H.956V.956h6.338v1.31a.477.477 0 1 0 .956 0V.744A.744.744 0 0 0 7.507 0H.743A.744.744 0 0 0 0 .743v6.764c0 .41.333.743.743.743h6.764c.41 0 .743-.333.743-.743Z"}),React.createElement("path",{d:"M11.257 3.75H4.493a.744.744 0 0 0-.743.743V6.06a.478.478 0 1 0 .956 0V4.706h6.338v6.34H4.706V9.68a.478.478 0 1 0-.956 0v1.576c0 .41.333.743.743.743h6.764c.41 0 .743-.333.743-.743V4.493a.744.744 0 0 0-.743-.743Z"})));var T="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzQ1N0FGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOC4yNSA3LjUwN1Y1Ljk1M2EuNDc3LjQ3NyAwIDEgMC0uOTU2IDB2MS4zNDFILjk1NlYuOTU2aDYuMzM4djEuMzFhLjQ3Ny40NzcgMCAxIDAgLjk1NiAwVi43NDRBLjc0NC43NDQgMCAwIDAgNy41MDcgMEguNzQzQS43NDQuNzQ0IDAgMCAwIDAgLjc0M3Y2Ljc2NGMwIC40MS4zMzMuNzQzLjc0My43NDNoNi43NjRjLjQxIDAgLjc0My0uMzMzLjc0My0uNzQzWiIvPjxwYXRoIGQ9Ik0xMS4yNTcgMy43NUg0LjQ5M2EuNzQ0Ljc0NCAwIDAgMC0uNzQzLjc0M1Y2LjA2YS40NzguNDc4IDAgMSAwIC45NTYgMFY0LjcwNmg2LjMzOHY2LjM0SDQuNzA2VjkuNjhhLjQ3OC40NzggMCAxIDAtLjk1NiAwdjEuNTc2YzAgLjQxLjMzMy43NDMuNzQzLjc0M2g2Ljc2NGMuNDEgMCAuNzQzLS4zMzMuNzQzLS43NDNWNC40OTNhLjc0NC43NDQgMCAwIDAtLjc0My0uNzQzWiIvPjwvZz48L3N2Zz4=",F=t(91618),v=t(24163),L=t(29297),Me=t(13769),ve=t.n(Me),oe=t(58638),W=t(97269),K=t(93410),ie=t(50727),D=t(92016),fe=t(3303),U=t(85265),V=t(86250),P=t(83622),Pe=t(42075),re=t(96486),e=t(86074),ft=["idx","map_row_parentKey"],pt=fe.Z.SHOW_CHILD,st=[{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.only.associate.once"}),value:"\u4EC5\u5173\u8054\u4E00\u6B21"},{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.related.multiple.times"}),value:"\u5173\u8054\u591A\u6B21"},{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.no.associated.fields"}),value:"\u65E0\u5173\u8054\u5B57\u6BB5"}],It=function(u){var y=u.linkDrawerVisible,He=u.setLinkDrawerVisible,ke=u.linkFormRef,ut=u.resourceTypeList,qe=u.form,et=u.formData,Le=u.setFormData,ue=(0,D.useIntl)(),Ae=(0,c.useRef)(),Ke=(0,c.useState)([]),be=i()(Ke,2),tt=be[0],Ye=be[1],dt=(0,c.useRef)(),X=function(){var ae;(ae=ke.current)===null||ae===void 0||ae.resetFields()},s=function(){He(!1)},ct=function(ae){var q=(0,re.cloneDeep)(ae)||{},ee=q.linkedDataList;if(Array.isArray(ee)&&!(0,re.isEmpty)(ee)){var pe=ee.map(function(we){var Ze=we.idx,Re=we.map_row_parentKey,mt=ve()(we,ft);return o()({},mt)});q.linkedDataList=pe}return q},Je=function(ae){var q=(0,re.cloneDeep)(ae)||{},ee=q,pe=[];if(Array.isArray(ee)&&!(0,re.isEmpty)(ee)){var we=ee==null?void 0:ee.map(function(Ze,Re){return pe.push(Re),o()(o()({},Ze),{},{idx:Re})});q.linkedDataList=we}return q.editableKeyList=pe,q},Ne=function(){var de=M()(d()().mark(function ae(){var q;return d()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:(q=ke.current)===null||q===void 0||q.validateFields().then(function(we){var Ze,Re=((Ze=ct(we))===null||Ze===void 0?void 0:Ze.linkedDataList)||[];qe.setFieldValue("linkedDataList",Re),Le(o()(o()({},et),{},{linkedDataList:Re})),s()});case 1:case"end":return pe.stop()}},ae)}));return function(){return de.apply(this,arguments)}}();(0,c.useEffect)(function(){if(y){var de=qe.getFieldValue("linkedDataList"),ae=Je(de),q=ae.linkedDataList,ee=ae.editableKeyList;if(!(0,re.isEmpty)(q)&&!(0,re.isEmpty)(ee)){var pe;(pe=ke.current)===null||pe===void 0||pe.setFieldsValue({linkedDataList:q}),Ye(ee)}}else X()},[y]);var rt=[{title:ue.formatMessage({id:"involve.extend.title.serial.number"}),dataIndex:"id",editable:!1,width:60,align:"center",render:function(ae,q,ee){return ee+1}},{title:ue.formatMessage({id:"rule.module.text.associative.mode"}),width:200,dataIndex:"associativeMode",formItemProps:{rules:[{required:!1}]},valueType:"select",fieldProps:{options:st,multiple:!1,allowClear:!0,showSearch:!0}},{title:ue.formatMessage({id:"rule.module.text.main.asset.associated.fields"}),dataIndex:"linkedKey1",formItemProps:{rules:[{required:!1}]}},{title:ue.formatMessage({id:"rule.module.text.related.asset.type"}),width:200,dataIndex:"resourceType",formItemProps:{rules:[{required:!0}]},valueType:"cascader",fieldProps:{options:ut,multiple:!1,allowClear:!0,showSearch:!0,showCheckedStrategy:pt}},{title:ue.formatMessage({id:"rule.module.text.associated.assets.associated.fields"}),dataIndex:"linkedKey2",formItemProps:{rules:[{required:!1}]}},{title:ue.formatMessage({id:"rule.module.text.mount.field.name"}),dataIndex:"newKeyName",formItemProps:{rules:[{required:!0}]}},{title:ue.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),valueType:"option",width:140,render:function(){return[]}}];return(0,e.jsx)(U.Z,{title:(0,e.jsxs)(V.Z,{align:"center",children:[(0,e.jsx)("span",{style:{marginRight:4},children:ue.formatMessage({id:"rule.module.text.related.assets"})}),(0,e.jsxs)(P.ZP,{size:"small",type:"link",href:"https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/apka69usk9a3gf1s#jLQrz",target:"_blank",style:{color:"#2f54eb",gap:4},children:[(0,e.jsx)(oe.Z,{}),(0,e.jsx)("span",{children:ue.formatMessage({id:"common.link.text.help.center"})})]})]}),onClose:s,destroyOnClose:!0,open:y,width:"80%",footer:(0,e.jsx)(V.Z,{justify:"flex-end",children:(0,e.jsxs)(Pe.Z,{children:[(0,e.jsx)(P.ZP,{onClick:function(){return s()},children:ue.formatMessage({id:"common.button.text.cancel"})}),(0,e.jsx)(P.ZP,{type:"primary",onClick:function(){return Ne()},children:ue.formatMessage({id:"common.button.text.ok"})})]})}),children:(0,e.jsx)(W.A,{formRef:ke,layout:"horizontal",submitter:!1,children:(0,e.jsx)(K.Z,{bodyStyle:{backgroundColor:"rgb(245, 245, 245)",padding:"0 20px 16px 20px"},children:(0,e.jsx)(ie.Z,{rowKey:"idx",name:"linkedDataList",actionRef:Ae,editableFormRef:dt,headerTitle:(0,e.jsx)("div",{style:{fontSize:14},children:ue.formatMessage({id:"involve.extend.title.conditional.config"})}),recordCreatorProps:{creatorButtonText:ue.formatMessage({id:"involve.extend.title.addRowConfig"}),record:function(){return{idx:(Math.random()*1e6).toFixed(0)}}},columns:rt,editable:{type:"multiple",editableKeys:tt,onChange:Ye,actionRender:function(ae,q,ee){return[ee.delete]}}})})})})},De=It,Lt=t(94032),Ue=t(96655),At=t(61713),Et=t(90498),lt=t(68872),St=function(u){var y=u.variableDrawerVisible,He=u.setVariableDrawerVisible,ke=u.variableDrawerInfo,ut=ke===void 0?{}:ke,qe=u.requestRuleDetailById,et=u.selectedRowKeys,Le=et===void 0?[]:et,ue=u.setSelectedRowKeys,Ae=u.formData,Ke=u.setCurrent,be=ut.id,tt=lt.ZP.useMessage(),Ye=i()(tt,2),dt=Ye[0],X=Ye[1],s=(0,D.useIntl)(),ct=(0,c.useState)(!1),Je=i()(ct,2),Ne=Je[0],rt=Je[1],de=function(){He(!1),ue((Ae==null?void 0:Ae.globalVariableConfigIdList)||[])},ae=function(){de()},q=function(){var me=M()(d()().mark(function B(){var Y,he;return d()().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(!be){ce.next=15;break}return rt(!0),Y={id:be,globalVariableConfigIdList:Le,resourceType:Ae==null?void 0:Ae.resourceType,ruleTypeIdList:Ae.ruleTypeIdList},ce.next=5,(0,Ue.saveRule)(Y);case 5:if(he=ce.sent,rt(!1),!(he.msg==="success"||[200].includes(he.code))){ce.next=13;break}return dt.success(s.formatMessage({id:"common.message.text.batch.add.success"})),ce.next=11,qe(be);case 11:Ke(1),He(!1);case 13:ce.next=16;break;case 15:He(!1);case 16:case"end":return ce.stop()}},B)}));return function(){return me.apply(this,arguments)}}(),ee=function(){var me=M()(d()().mark(function B(){return d()().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:de();case 1:case"end":return he.stop()}},B)}));return function(){return me.apply(this,arguments)}}(),pe=(0,c.useRef)(),we=[{title:s.formatMessage({id:"cloudAccount.extend.title.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(B,Y){return(0,e.jsxs)("div",{children:[(0,e.jsx)("section",{children:(Y==null?void 0:Y.gmtCreate)||"-"}),(0,e.jsx)("section",{children:(Y==null?void 0:Y.gmtModified)||"-"})]})}},{title:s.formatMessage({id:"rule.input.text.rule.group.creator"}),dataIndex:"username",valueType:"text",align:"left",width:200,hideInSearch:!0},{title:s.formatMessage({id:"rule.module.text.variable.name"}),dataIndex:"name",valueType:"text",align:"left",width:150},{title:s.formatMessage({id:"rule.module.text.variable.path"}),dataIndex:"path",valueType:"text",align:"center"},{title:s.formatMessage({id:"rule.module.text.reference.rules"}),dataIndex:"ruleNameList",key:"ruleNameList",hideInSearch:!0,render:function(B,Y){var he;return(0,e.jsx)("ul",{style:{paddingInlineStart:16},children:Y==null||(he=Y.ruleNameList)===null||he===void 0?void 0:he.map(function(Be,ce){return(0,e.jsx)("li",{children:Be},ce)})})}}],Ze=function(){var me=M()(d()().mark(function B(Y){var he,Be,ce,gt,yt,at,Ee,vt;return d()().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return he=Y.name,Be=Y.path,ce=Y.current,gt=Y.pageSize,yt={name:he,path:Be,page:ce,size:gt},Fe.next=4,(0,At.listGlobalVariableConfig)(yt);case 4:return at=Fe.sent,Ee=at.content,vt=at.code,Fe.abrupt("return",{data:(Ee==null?void 0:Ee.data)||[],total:(Ee==null?void 0:Ee.total)||0,success:vt===200||!1});case 8:case"end":return Fe.stop()}},B)}));return function(Y){return me.apply(this,arguments)}}(),Re=function(B){ue(B)},mt={selectedRowKeys:Le,onChange:Re,preserveSelectedRowKeys:!0};return(0,e.jsxs)(U.Z,{footer:(0,e.jsx)(V.Z,{style:{width:"100%"},justify:"end",children:(0,e.jsxs)(Pe.Z,{children:[(0,e.jsx)(P.ZP,{type:"dashed",onClick:function(){return ee()},children:s.formatMessage({id:"common.button.text.cancel"})}),(0,e.jsx)(P.ZP,{loading:Ne,type:"primary",onClick:function(){return q()},children:s.formatMessage({id:"common.button.text.save"})})]})}),title:s.formatMessage({id:"rule.extend.text.variable.information"}),width:"64%",destroyOnClose:!0,open:y,onClose:ae,styles:{body:{padding:8}},children:[X,(0,e.jsx)(Et.Z,{scroll:{x:!0},options:!1,rowKey:"id",columns:we,actionRef:pe,request:Ze,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},search:{labelWidth:s.locale==="en-US"?110:80},rowSelection:mt,expandable:{expandRowByClick:!0,expandedRowRender:function(B){return(0,e.jsx)(K.Z,{direction:"column",gutter:[0,16],children:!(0,re.isEmpty)(B==null?void 0:B.data)&&(0,e.jsxs)(K.Z,{ghost:!0,children:[(0,e.jsx)("p",{children:s.formatMessage({id:"rule.module.text.variable.value"})}),(0,e.jsx)(L.mi,{readOnly:!0,editorKey:"dataEditor",value:B==null?void 0:B.data,editorStyle:{height:"280px",maxHeight:"280px"}})]})})},rowExpandable:function(B){return!(0,re.isEmpty)(B==null?void 0:B.data)}}})]})},Nt=St,ht=`package example

import rego.v1

# Use [input] to get the value from the input data, such as "input.object.field1".

# Use [risk] flag to determine whether it is a risk, When [risk] is true, it is judged as a risk.

default risk = false

# When a user requests a private resource using GET, it is considered a risk.

risk if {
    input.method == "GET"
    input.path == "/private/resource"
}

# When an admin uses GET to request access, it is considered a risk.

risk if {
    input.method == "GET"
    input.path == "/admin/resource"
    input.user.role == "admin"
}

### For more details please see: https://www.openpolicyagent.org/docs/latest/#example`,wt="\u5B9E\u4F8B\uFF1A{$.ResourceId} \uFF0C\u540D\u79F0\uFF1A{$.ResourceName} \u5B58\u5728\u98CE\u9669\u3002",xt=t(92635),Ve=t(10736),Tt=t(79930),_e=t(17910),Ce=t(29448),ot=t(70607),jr=t(82826),Dr=t(39380),Ot=t(97462),Cr=t(86615),Ut=t(90672),Ir=t(5966),Lr=t(25593),Ie=t(23323),Ar=t(17788),Vt=t(55241),Bt=t(38703),it=t(71230),ze=t(15746),Er=t(42119),Sr=t(78045),bt=t(25278),Mt=t(34041),Nr=t(83062),Rt=t(85137),Oe=t(61194),Pt=Lr.Z.Title,Wt=fe.Z.SHOW_CHILD,Se=[{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.example.data"}),value:"INPUT"},{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.appoint.tenant"}),value:"TENANT"},{label:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.appoint.cloud.platform"}),value:"CLOUD_ACCOUNT"}],Qt=0,wr=function(){var u,y=(0,D.useModel)("tenant"),He=y.tenantListAdded,ke=(0,D.useLocation)(),ut=new URLSearchParams(ke.search),qe=(0,c.useState)(ut.get("id")),et=i()(qe,1),Le=et[0],ue=(0,ot.a)({}),Ae=(0,D.useModel)("rule"),Ke=Ae.platformList,be=Ae.ruleGroupList,tt=Ae.ruleTypeList,Ye=Ie.Z.useForm(),dt=i()(Ye,1),X=dt[0],s=(0,D.useIntl)(),ct=lt.ZP.useMessage(),Je=i()(ct,2),Ne=Je[0],rt=Je[1],de=Ar.Z.useModal(),ae=i()(de,2),q=ae[0],ee=ae[1],pe=(0,c.useState)(!1),we=i()(pe,2),Ze=we[0],Re=we[1],mt=(0,c.useState)({}),me=i()(mt,2),B=me[0],Y=me[1],he=(0,c.useState)([]),Be=i()(he,2),ce=Be[0],gt=Be[1],yt=(0,c.useState)(ht),at=i()(yt,2),Ee=at[0],vt=at[1],Gt=(0,c.useState)(""),Fe=i()(Gt,2),$t=Fe[0],Ht=Fe[1],Or=(0,c.useState)({}),Kt=i()(Or,2),br=Kt[0],_t=Kt[1],Rr=(0,c.useState)(!1),Yt=i()(Rr,2),Pr=Yt[0],Jt=Yt[1],Xt=(0,c.useRef)({}),_r=(0,c.useState)(!1),qt=i()(_r,2),Zr=qt[0],er=qt[1],tr=(0,c.useRef)({}),zr=(0,c.useState)([]),rr=i()(zr,2),Zt=rr[0],ar=rr[1],kr=(0,c.useState)({}),nr=i()(kr,2),z=nr[0],jt=nr[1],We=(0,c.useRef)("waiting"),Fr=(0,c.useState)(!1),sr=i()(Fr,2),Ur=sr[0],lr=sr[1],Vr=(0,c.useState)(!1),or=i()(Vr,2),Br=or[0],ir=or[1],Wr=(0,c.useRef)(),Qr=(0,c.useState)(Qt),ur=i()(Qr,2),Gr=ur[0],dr=ur[1],nt=(0,c.useRef)(null),$r=(0,c.useState)(!1),cr=i()($r,2),Hr=cr[0],mr=cr[1],Kr=function(){Xt.current={ruleId:Le},Jt(!0)},Yr=function(){tr.current=o()({},B),er(!0)},Jr=function(a){vt(a),We.current="",Xe(z)},Xr=function(a){Ht(a)},qr=(0,D.useRequest)(function(g){return(0,Tt.queryGroupTypeList)({platformList:[g]})},{manual:!0,formatResult:function(a){var n=a.content;return gt(n||[]),n}}),gr=qr.run,vr=(0,D.useRequest)(function(g){return(0,Ue.queryResourceExampleData)(g)},{formatResult:function(a){if(a.msg==="success"){var n=a.content;try{Ht(JSON.stringify(n,null,4)||"")}catch(x){console.info("Error",x)}}},manual:!0}),fr=vr.run,ea=vr.loading,ta=(0,c.useState)([{title:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.basic.info"}),description:(0,e.jsx)(e.Fragment,{})},{title:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.rule.development"}),description:(0,e.jsx)(e.Fragment,{})},{title:(0,e.jsx)(D.FormattedMessage,{id:"rule.module.text.repair.suggestions.title"}),description:(0,e.jsx)(e.Fragment,{})}]),pr=i()(ta,2),Dt=pr[0],ra=pr[1],aa=(0,c.useState)(0),hr=i()(aa,2),xe=hr[0],Ct=hr[1],Xe=function(a,n){var x=Dt.map(function(l,k){if(k===0){var te;return o()(o()({},l),{},{description:(0,e.jsx)(Vt.Z,{content:(0,e.jsxs)("div",{style:{padding:"2px 6px"},children:[(0,e.jsxs)(V.Z,{style:{marginBottom:7},children:[(0,e.jsxs)("span",{style:{color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"common.select.label.cloudPlatform"}),"\xA0:\xA0"]}),(0,e.jsx)("span",{style:{color:"rgb(48, 48, 48)"},children:(0,Ce.fD)(a==null?void 0:a.platform,Ke)})]}),(0,e.jsxs)(V.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"cloudAccount.extend.title.asset.type"}),"\xA0:\xA0"]}),(0,e.jsx)("span",{style:{color:"rgb(48, 48, 48)"},children:(0,Ce.xF)(n||ce,a==null?void 0:a.resourceType)||"-"})]}),(0,e.jsxs)(V.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"home.module.inform.columns.ruleName"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.ruleName)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(V.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.rule.describe"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.ruleDesc)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(V.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"layout.routes.title.ruleGroup"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(be==null||(te=be.filter(function(C){var Qe;return a==null||(Qe=a.ruleGroupIdList)===null||Qe===void 0?void 0:Qe.includes(C==null?void 0:C.value)}).map(function(C){return C==null?void 0:C.label}))===null||te===void 0?void 0:te.toString())||"-",maxWidth:100,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(V.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(0,Ce.S1)(tt,a==null?void 0:a.ruleTypeIdList)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(V.Z,{style:{marginTop:7},align:"center",children:[(0,e.jsxs)("span",{style:{color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"home.module.inform.columns.riskLevel"}),"\xA0:\xA0"]}),(0,Ce.Uf)(_e.I9,a.riskLevel)]})]}),children:(0,e.jsxs)(V.Z,{style:{margin:"6px 0"},children:[(0,e.jsxs)("span",{style:{color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"common.table.columns.platform"}),"\xA0:\xA0"]}),(0,e.jsx)("span",{style:{color:"rgb(48, 48, 48)"},children:(0,Ce.fD)(a==null?void 0:a.platform,Ke)})]})})})}else return k===1?o()(o()({},l),{},{description:(0,e.jsx)("div",{children:We.current&&(0,e.jsxs)(V.Z,{style:{marginTop:6},align:"center",children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.running.results"}),"\xA0:\xA0"]}),(0,e.jsx)(F.Z,{state:We.current})]})})}):k===2?o()(o()({},l),{},{description:(0,e.jsx)(Vt.Z,{placement:"bottom",content:(0,e.jsxs)("div",{style:{padding:"2px 6px"},children:[(0,e.jsxs)(V.Z,{style:{marginBottom:7},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.repair.suggestions"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.advice)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(V.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.reference.link"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.link)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]}),(0,e.jsxs)(V.Z,{style:{margin:"7px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.risk.context.template"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.context)||"-",maxWidth:240,rows:1,color:"rgb(48, 48, 48)"})]})]}),children:(0,e.jsxs)(V.Z,{style:{margin:"6px 0"},children:[(0,e.jsxs)("span",{style:{flexShrink:0,color:"rgb(168, 168, 168)"},children:[s.formatMessage({id:"rule.module.text.repair.suggestions"}),"\xA0:\xA0"]}),(0,e.jsx)(v.Z,{text:(a==null?void 0:a.advice)||"-",maxWidth:180,rows:1,color:xe===2?"rgba(0, 0, 0, 0.88)":"rgba(0, 0, 0, 0.45)"})]})})}):o()({},l)});ra(x)},na=(0,D.useRequest)(function(g){return(0,Ue.queryAnalysisProgress)({taskId:g})},{formatResult:function(a){var n,x;if((a==null||(n=a.content)===null||n===void 0?void 0:n.percent)===1){var l;We.current="success",_t(JSON.parse(a==null||(l=a.content)===null||l===void 0?void 0:l.result)||{}),Xe(z)}return a==null||(x=a.content)===null||x===void 0?void 0:x.percent},onSuccess:function(a){dr(a)},manual:!0}),sa=na.run,la=(0,D.useRequest)(function(g){return(0,Ue.queryCancelTask)({taskId:g})},{onSuccess:function(){return Ne.warning(s.formatMessage({id:"rule.message.text.task.cancelled"}))},manual:!0}),xr=la.run,oa=function(a){var n=q.info({title:s.formatMessage({id:"common.message.text.execute.loading"}),content:(0,e.jsx)(V.Z,{style:{width:"100"},justify:"center",children:(0,e.jsx)(Bt.Z,{type:"circle",percent:Number((0,Ce.x9)(Gr*100,2)),size:80})}),closable:!0,destroyOnClose:!0,footer:(0,e.jsx)(e.Fragment,{}),onCancel:function(){nt.current&&clearTimeout(nt.current),xr(a)}});nt.current=setInterval(M()(d()().mark(function x(){var l,k;return d()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,sa(a);case 2:l=C.sent,n.update({title:s.formatMessage({id:"common.message.text.execute.loading"}),content:(0,e.jsx)(V.Z,{style:{width:"100"},justify:"center",children:(0,e.jsx)(Bt.Z,{type:"circle",percent:Number((0,Ce.x9)(l*100,2)),size:80})}),closable:!0,destroyOnClose:!0,footer:(0,e.jsx)(e.Fragment,{}),onCancel:function(){nt.current&&clearTimeout(nt.current),xr(a)}}),l===1&&(clearInterval(nt.current),k=setTimeout(function(){clearTimeout(k),dr(Qt),n.destroy()},800));case 5:case"end":return C.stop()}},x)})),1e3)},ia=function(){var g=M()(d()().mark(function a(){var n,x,l,k,te,C,Qe,Ft;return d()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(n={},x=X.getFieldValue("type"),x!==Se[0].value){ne.next=23;break}if(l=X.getFieldValue("instanceId"),!l){ne.next=16;break}return ne.prev=5,k={platform:X.getFieldValue("platform"),resourceType:X.getFieldValue("resourceType"),linkedDataList:(z==null?void 0:z.linkedDataList)||[],resourceId:l},ne.next=9,fr(k);case 9:return ne.next=11,new Promise(function(ha){return setTimeout(ha,2e3)});case 11:ne.next=16;break;case 13:return ne.prev=13,ne.t0=ne.catch(5),ne.abrupt("return");case 16:n.ruleRego=Ee,n.input=$t,n.globalVariableConfigIdList=Zt,n.linkedDataList=(z==null?void 0:z.linkedDataList)||[],l&&(n.instanceId=l),ne.next=36;break;case 23:if(n.type=x,te=X.getFieldValue("selectId"),n.selectId=te,n.ruleRego=Ee,n.platform=X.getFieldValue("platform"),n.resourceType=(0,Ce.g2)(X.getFieldValue("resourceType")),n.linkedDataList=(z==null?void 0:z.linkedDataList)||[],!(x===Se[1].value&&!te)){ne.next=34;break}return ne.abrupt("return",Ne.error("Please Select".concat(Se[1].label)));case 34:if(!(x===Se[2].value&&!te)){ne.next=36;break}return ne.abrupt("return",Ne.error("Please Select".concat(Se[2].label)));case 36:return mr(!0),ne.next=39,(0,Ve.evaluateRego)(n);case 39:C=ne.sent,mr(!1),x===Se[0].value?C.code===200&&C.msg==="success"?(Ne.success(s.formatMessage({id:"common.message.text.execute.success"})),_t((C==null||(Qe=C.content)===null||Qe===void 0?void 0:Qe.result)||{}),We.current="success",Xe(z)):(C.code!==200||C.msg!=="success")&&(_t(C||{}),We.current="error",Xe(z)):C!=null&&(Ft=C.content)!==null&&Ft!==void 0&&Ft.taskId&&oa(C.content.taskId);case 42:case"end":return ne.stop()}},a,null,[[5,13]])}));return function(){return g.apply(this,arguments)}}(),ua=function(a,n){jt(o()(o()({},z),n)),Xe(o()(o()({},z),n))},da=function(){Ct(function(a){return a-1})},ca=function(){X.validateFields().then(function(){var a=M()(d()().mark(function n(x){return d()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(xe!==0){k.next=5;break}return k.next=3,fr({platform:x==null?void 0:x.platform,resourceType:x==null?void 0:x.resourceType,linkedDataList:(x==null?void 0:x.linkedDataList)||[]});case 3:k.next=10;break;case 5:if(xe!==1){k.next=10;break}if(!(0,re.isEmpty)(Ee)){k.next=8;break}return k.abrupt("return",Ne.error(s.formatMessage({id:"rule.message.text.rego.noEmpty"})));case 8:if(We.current==="success"){k.next=10;break}return k.abrupt("return",Ne.error(s.formatMessage({id:"rule.message.text.rego.noPass"})));case 10:Ct(function(te){return te+1});case 11:case"end":return k.stop()}},n)}));return function(n){return a.apply(this,arguments)}}())};(0,c.useEffect)(function(){(0,re.isEmpty)(z)||Xe(z)},[xe]);var ma=function(){X.validateFields().then(function(){var a=M()(d()().mark(function n(x){var l,k;return d()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return Re(!0),l=o()(o()({},z),{},{ruleRego:Ee,globalVariableConfigIdList:Zt,context:x==null?void 0:x.context}),Le&&(l.id=Le),l==null||delete l.type,l==null||delete l.selectId,l==null||delete l.ruleGroupList,C.next=8,(0,Ue.saveRule)(l);case 8:k=C.sent,Re(!1),(k.msg==="success"||[200].includes(k.code))&&(Le?Ne.success(s.formatMessage({id:"common.message.text.edit.success"})):Ne.success(s.formatMessage({id:"common.message.text.create.success"})),D.history.push("/ruleManagement/ruleProject?tab=market"));case 11:case"end":return C.stop()}},n)}));return function(n){return a.apply(this,arguments)}}())},ga=function(){var g=M()(d()().mark(function a(n){var x,l;return d()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:(0,re.isEmpty)(n)||(ar((n==null?void 0:n.globalVariableConfigIdList)||[]),Ct(0),We.current="success",l=o()(o()({},n),{},{ruleGroupIdList:n==null||(x=n.ruleGroupList)===null||x===void 0?void 0:x.map(function(C){return C==null?void 0:C.id})}),jt(l),X.setFieldsValue(l),vt((n==null?void 0:n.ruleRego)||""),n!=null&&n.platform&&gr(n==null?void 0:n.platform).then(function(C){Xe(l,C)}).finally(function(){return lr(!1)}));case 1:case"end":return te.stop()}},a)}));return function(n){return g.apply(this,arguments)}}(),va=(0,D.useRequest)(function(){var g=M()(d()().mark(function a(n){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,Ue.queryRuleDetail)({id:Number(n)});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},a)}));return function(a){return g.apply(this,arguments)}}(),{formatResult:function(){var g=M()(d()().mark(function n(x){var l;return d()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return l=x.content,Y(l),te.next=4,ga(l);case 4:case"end":return te.stop()}},n)}));function a(n){return g.apply(this,arguments)}return a}(),manual:!0}),zt=va.run;(0,c.useEffect)(function(){Le&&(lr(!0),zt(Le))},[Le]);var fa=function(){ir(!0)},Mr=(0,D.useRequest)(function(g){return(0,xt.cloudAccountBaseInfoListV2)(o()({},g))},{manual:!0,formatResult:function(a){return a==null?void 0:a.content}}),kt=Mr.data,pa=Mr.run,yr=(0,re.debounce)(function(g){var a=X.getFieldValue("platform"),n=[];a&&n.push(a),pa({platformList:n,cloudAccountSearch:g})},500);return(0,e.jsxs)(Dr._z,{ghost:!0,breadcrumbRender:!1,header:{ghost:!0},title:(0,e.jsxs)(P.ZP,{type:"link",size:"small",onClick:function(){return D.history===null||D.history===void 0?void 0:D.history.back()},children:[(0,e.jsx)(jr.Z,{}),s.formatMessage({id:"common.button.text.return"})]}),className:xe===1?Oe.Z.ruleEditPageContainerSpecial:Oe.Z.ruleEditPageContainer,footer:[(0,e.jsxs)(Pe.Z,{style:{paddingRight:8},children:[xe>0&&(0,e.jsx)(P.ZP,{type:"primary",onClick:function(){return da()},children:s.formatMessage({id:"common.button.text.pre"})}),xe<Dt.length-1&&(0,e.jsx)(P.ZP,{type:"primary",onClick:function(){return ca()},loading:ea,children:s.formatMessage({id:"common.button.text.next"})}),xe===Dt.length-1&&(0,e.jsx)(P.ZP,{loading:Ze,type:"primary",onClick:function(){return ma()},children:s.formatMessage({id:"common.button.text.submit"})})]},"buttonList")],loading:Ur,children:[rt,ee,(0,e.jsx)(it.Z,{style:{marginBottom:20,padding:xe===1?"0 14px":"unset"},children:(0,e.jsx)(ze.Z,{span:24,style:{minHeight:"100%"},children:(0,e.jsx)(K.Z,{className:Oe.Z.stepListMain,children:(0,e.jsx)(Er.Z,{size:"small",className:Oe.Z.stepsWrap,direction:"horizontal",current:xe,items:Dt})})})}),(0,e.jsx)(it.Z,{style:{minHeight:"calc(100vh - 362px)"},children:(0,e.jsx)(ze.Z,{span:24,style:{minHeight:"100%"},children:(0,e.jsx)(K.Z,{className:xe===1?Oe.Z.contentMainTransparent:Oe.Z.contentMain,bodyStyle:{paddingTop:xe===1?0:16},children:(0,e.jsxs)(Ie.Z,{form:X,layout:"vertical",onValuesChange:(0,re.debounce)(ua,200),children:[xe===0&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ie.Z.Item,{name:"platform",label:s.formatMessage({id:"home.module.overview.platform"}),rules:[{required:!0,message:s.formatMessage({id:"common.select.text.placeholder"})}],children:(0,e.jsx)(Sr.ZP.Group,{disabled:!!Le,onChange:function(a){X.setFieldValue("resourceType",null),X.setFieldValue("linkedDataList",[]),jt(o()(o()({},z),{},{linkedDataList:null})),gt([]),gr(a.target.value)},options:(0,Ce.T$)(Ke)})}),(0,e.jsx)(Ot.Z,{name:["platform"],children:function(a){var n=a.platform;return(0,re.isEmpty)(n)?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)(Ie.Z.Item,{name:"resourceType",label:s.formatMessage({id:"cloudAccount.extend.title.asset.type"}),rules:[{required:!0,message:s.formatMessage({id:"common.select.text.placeholder"})}],style:{marginBottom:0},children:(0,e.jsx)(fe.Z,{options:ce,multiple:!1,placeholder:s.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:Wt,allowClear:!0,showSearch:!0})})}}),(0,e.jsx)(Ot.Z,{name:["platform"],children:function(a){var n=a.platform;return(0,re.isEmpty)(n)?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(Ie.Z.Item,{layout:"horizontal",name:"linkedDataList",label:"",style:{marginBottom:24},children:[(0,e.jsxs)(P.ZP,{type:"link",size:"small",onClick:function(){return fa()},style:{gap:4},children:[(0,e.jsx)("img",{src:T,alt:"RELATION_ICON",style:{width:14,height:14}}),s.formatMessage({id:"rule.module.text.related.assets"})]}),(z==null?void 0:z.linkedDataDesc)&&(0,e.jsx)(Pe.Z,{size:[8,16],wrap:!0,children:(0,e.jsx)("span",{style:{color:"#c5c2c2"},children:z==null?void 0:z.linkedDataDesc})})]})}}),(0,e.jsxs)(it.Z,{gutter:[24,12],children:[(0,e.jsx)(ze.Z,{span:12,children:(0,e.jsx)(Ie.Z.Item,{name:"ruleName",label:s.formatMessage({id:"home.module.inform.columns.ruleName"}),rules:[{required:!0}],children:(0,e.jsx)(bt.Z,{placeholder:s.formatMessage({id:"common.input.text.placeholder"})})})}),(0,e.jsx)(ze.Z,{span:12,children:(0,e.jsx)(Ie.Z.Item,{name:"ruleDesc",label:s.formatMessage({id:"rule.module.text.rule.describe"}),rules:[{required:!0}],children:(0,e.jsx)(bt.Z,{placeholder:s.formatMessage({id:"common.input.text.placeholder"})})})}),(0,e.jsx)(ze.Z,{span:12,children:(0,e.jsx)(Ie.Z.Item,{name:"ruleGroupIdList",label:s.formatMessage({id:"layout.routes.title.ruleGroup"}),rules:[{required:!1,message:s.formatMessage({id:"common.select.text.placeholder"})}],children:(0,e.jsx)(Mt.Z,{options:be||[],placeholder:s.formatMessage({id:"common.select.text.placeholder"}),allowClear:!0,mode:"multiple"})})}),(0,e.jsx)(ze.Z,{span:12,children:(0,e.jsx)(Ie.Z.Item,{label:s.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),name:"ruleTypeIdList",rules:[{required:!0,message:s.formatMessage({id:"common.select.text.placeholder"})}],children:(0,e.jsx)(fe.Z,{showCheckedStrategy:Wt,allowClear:!0,showSearch:!0,fieldNames:{label:"typeName",value:"id",children:"childList"},multiple:!0,options:tt||[]})})}),(0,e.jsx)(ze.Z,{span:12,children:(0,e.jsx)(Cr.Z.Group,{name:"riskLevel",label:s.formatMessage({id:"home.module.inform.columns.riskLevel"}),rules:[{required:!0,message:s.formatMessage({id:"common.select.text.placeholder"})}],options:(0,Ce.at)(_e.I9)})})]})]}),xe===1&&(0,e.jsxs)("div",{children:[(0,e.jsx)(it.Z,{children:(0,e.jsx)(V.Z,{justify:"end",style:{width:"100%"},children:(0,e.jsxs)(Pe.Z,{children:[(0,e.jsxs)(P.ZP,{href:"https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/un0z2rchy084tnww",target:"_blank",style:{gap:4,border:"1px solid #457aff",color:"#457aff",padding:"4px 10px",backgroundColor:"transparent"},children:[(0,e.jsx)("img",{src:N,style:{height:14},alt:"LINK_ICON"}),s.formatMessage({id:"rule.extend.text.config"})]}),(0,e.jsxs)(P.ZP,{type:"primary",onClick:function(){return ia()},style:{gap:4},loading:Hr,children:[(0,e.jsx)("img",{src:Ge,style:{height:14},alt:"linkIcon"}),s.formatMessage({id:"rule.extend.text.execute"})]})]})})}),(0,e.jsxs)(it.Z,{gutter:16,style:{marginTop:4},children:[(0,e.jsxs)(ze.Z,{md:14,span:24,children:[(0,e.jsx)(Pt,{level:5,className:Oe.Z.customTitle,style:{marginBottom:16},children:"The Rego PlayGround"}),(0,e.jsx)(L.mi,{editorKey:"regoEditor",value:Ee,onChange:Jr,editorStyle:{height:"680px"}})]}),(0,e.jsxs)(ze.Z,{md:10,span:24,children:[(0,e.jsx)(Pt,{level:5,className:Oe.Z.customTitle,children:(0,e.jsxs)(V.Z,{align:"center",children:[(0,e.jsx)("span",{style:{marginRight:12},children:"INPUT"}),(0,e.jsxs)(Pe.Z.Compact,{children:[(0,e.jsx)(Ie.Z.Item,{name:"type",noStyle:!0,initialValue:Se[0].value,children:(0,e.jsx)(Mt.Z,{options:Se,style:{width:114},onChange:function(a){X.setFieldValue("selectId",null),X.setFieldValue("instanceId",null),a===Se[2].value&&yr()}})}),(0,e.jsx)(Ot.Z,{name:["type"],children:function(a){var n=a.type,x=(0,e.jsx)(e.Fragment,{});return n===Se[0].value?x=(0,e.jsx)(Ie.Z.Item,{name:"instanceId",noStyle:!0,children:(0,e.jsx)(bt.Z,{placeholder:s.formatMessage({id:"rule.extend.placeholder.input"}),style:{width:160},allowClear:!0})}):n===Se[1].value?x=(0,e.jsx)(Ie.Z.Item,{noStyle:!0,name:"selectId",children:(0,e.jsx)(Mt.Z,{options:He||[],style:{width:160},fieldNames:{label:"tenantName",value:"id"}})}):n===Se[2].value&&(x=(0,e.jsx)(Ie.Z.Item,{name:"selectId",noStyle:!0,children:(0,e.jsx)(Mt.Z,{allowClear:!0,showSearch:!0,filterOption:!1,placeholder:s.formatMessage({id:"common.select.query.text.placeholder"}),onSearch:yr,options:(kt==null?void 0:kt.map(function(l){return{label:(0,e.jsx)(Nr.Z,{placement:"topLeft",title:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:l==null?void 0:l.alias}),(0,e.jsx)("div",{children:l==null?void 0:l.cloudAccountId})]}),children:(l==null?void 0:l.alias)+"/"+(l==null?void 0:l.cloudAccountId)}),value:l==null?void 0:l.cloudAccountId}}))||[],style:{width:160}})})),x}})]})]})}),(0,e.jsx)(L.q9,{editorStyle:{height:"360px"},editorKey:"inputEditor",value:$t,onChange:Xr}),(0,e.jsx)(Pt,{style:{marginTop:8},level:5,className:Oe.Z.customTitle,children:"OUTPUT"}),(0,e.jsx)(L.Wy,{viewerStyle:{height:"280px"},value:br})]})]})]}),xe===2&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ut.Z,{name:"advice",label:s.formatMessage({id:"rule.module.text.repair.suggestions"}),placeholder:s.formatMessage({id:"common.input.text.placeholder"})}),(0,e.jsx)(Ir.Z,{name:"link",label:s.formatMessage({id:"rule.module.text.reference.link"}),placeholder:s.formatMessage({id:"common.input.text.placeholder"}),rules:[{pattern:new RegExp("^(https?|ftp):\\/\\/[^\\s/$.?#].[^\\s]*$","i"),message:s.formatMessage({id:"common.input.text.link.check"})}]}),(0,e.jsx)(Ut.Z,{name:"context",label:s.formatMessage({id:"rule.module.text.risk.context.template"}),placeholder:wt})]})]})})})}),xe===1&&(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Rt.Z.Group,{shape:"square",style:{insetInlineEnd:-2,top:(u=["xxLProMax","xxLFullHD","xxLPro"])!==null&&u!==void 0&&u.includes(ue)?"7vh":"36vh",boxShadow:"none"},children:[(0,e.jsx)(Rt.Z,{onClick:function(){return Kr()},className:Oe.Z.floatButton,icon:(0,e.jsx)("div",{style:{fontSize:14},children:s.formatMessage({id:"rule.extend.text.history"})})}),(0,e.jsx)(Rt.Z,{onClick:function(){return Yr()},className:Oe.Z.floatButton,icon:(0,e.jsx)("div",{style:{fontSize:14},children:s.formatMessage({id:"rule.extend.text.variable"})})})]})}),(0,e.jsx)(Lt.Z,{noteDrawerVisible:Pr,setNoteDrawerVisible:Jt,noteDrawerInfo:Xt.current,requestRuleDetailById:zt}),(0,e.jsx)(Nt,{formData:z,setCurrent:Ct,variableDrawerVisible:Zr,setVariableDrawerVisible:er,variableDrawerInfo:tr.current,requestRuleDetailById:zt,selectedRowKeys:Zt,setSelectedRowKeys:ar}),(0,e.jsx)(De,{linkDrawerVisible:Br,setLinkDrawerVisible:ir,linkFormRef:Wr,resourceTypeList:ce,form:X,formData:z,setFormData:jt})]})},Tr=wr},94032:function(ge,_,t){"use strict";var f=t(97857),d=t.n(f),A=t(15009),M=t.n(A),Z=t(99289),o=t.n(Z),se=t(5574),i=t.n(se),c=t(29297),E=t(10736),b=t(90498),Q=t(93410),G=t(92016),h=t(68872),$=t(83622),R=t(85265),N=t(96486),O=t.n(N),m=t(62435),I=t(86074),w=function(H){var Te=H.noteDrawerVisible,Ge=H.setNoteDrawerVisible,J=H.noteDrawerInfo,ye=H.requestRuleDetailById,je=h.ZP.useMessage(),$e=i()(je,2),j=$e[0],p=$e[1],r=(0,G.useIntl)(),T=function(){Ge(!1)},F=function(){T()},v=(0,m.useRef)(),L=function(){var oe=o()(M()().mark(function W(K){var ie,D;return M()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return ie={ruleId:J==null?void 0:J.ruleId,isDraft:0,ruleRego:K==null?void 0:K.ruleRego},U.next=3,(0,E.saveRego)(ie);case 3:if(D=U.sent,!(D.code===200||D.msg==="success")){U.next=9;break}return j.success(r.formatMessage({id:"rule.message.text.version.rollback.success"})),U.next=8,ye(Number(J==null?void 0:J.ruleId));case 8:F();case 9:case"end":return U.stop()}},W)}));return function(K){return oe.apply(this,arguments)}}(),Me=[{title:r.formatMessage({id:"rule.module.text.version"}),dataIndex:"version",align:"center",render:function(W){return"v"+W}},{title:r.formatMessage({id:"rule.module.text.user.name"}),dataIndex:"userName",align:"center"},{title:r.formatMessage({id:"common.table.columns.rule.updateTime"}),dataIndex:"gmtModified",align:"center"},{title:r.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"operate",align:"center",valueType:"option",render:function(W,K){return(0,I.jsx)($.ZP,{type:"link",onClick:function(){return L(K)},children:r.formatMessage({id:"common.button.text.rollback"})})}}],ve=function(){var oe=o()(M()().mark(function W(K){var ie,D,fe,U;return M()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return fe={page:K.current,size:K.pageSize,ruleId:J==null?void 0:J.ruleId},P.next=3,(0,E.queryRegoList)(d()({},fe));case 3:return U=P.sent,P.abrupt("return",{data:(U==null||(ie=U.content)===null||ie===void 0?void 0:ie.data)||[],success:(U==null?void 0:U.code)===200||!1,total:(U==null||(D=U.content)===null||D===void 0?void 0:D.total)||0});case 5:case"end":return P.stop()}},W)}));return function(K){return oe.apply(this,arguments)}}();return(0,I.jsxs)(R.Z,{title:r.formatMessage({id:"rule.extend.text.historical.records"}),width:"52%",destroyOnClose:!0,open:Te,onClose:F,children:[p,(0,I.jsx)(b.Z,{search:!1,scroll:{x:!0},options:!1,rowKey:"id",columns:Me,actionRef:v,request:ve,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},expandable:{expandRowByClick:!0,expandedRowRender:function(W){return(0,I.jsx)(Q.Z,{direction:"column",gutter:[0,16],children:!(0,N.isEmpty)(W.ruleRego)&&(0,I.jsxs)(Q.Z,{ghost:!0,children:[(0,I.jsx)("p",{children:r.formatMessage({id:"rule.module.text.info"})}),(0,I.jsx)(c.mi,{editorKey:"regoMsgEditor",value:W.ruleRego,editorStyle:{height:"280px",maxHeight:"280px"}})]})})},rowExpandable:function(W){return!(0,N.isEmpty)(W.ruleRego)}}})]})};_.Z=w},70607:function(ge,_,t){"use strict";t.d(_,{a:function(){return i}});var f=t(5574),d=t.n(f),A=t(96486),M=t.n(A),Z=t(62435),o={xs:575,sm:576,md:768,lg:992,xL:1200,xxL:1600,xxLPro:1800,xxLFullHD:1920,xxLProMax:2200},se=function(E){var b=E.query,Q=b===void 0?"":b,G=E.throttleTime,h=G===void 0?200:G,$=useState(!1),R=_slicedToArray($,2),N=R[0],O=R[1],m=useCallback(throttle(function(){var I=window.matchMedia(Q);O(I.matches)},h),[h]);return useEffect(function(){var I;return(I=window)===null||I===void 0||I.addEventListener("resize",m),m(),function(){var w;(w=window)===null||w===void 0||w.removeEventListener("resize",m)}},[m]),N},i=function(E){var b=E.throttleTime,Q=b===void 0?200:b,G=(0,Z.useState)("xxL"),h=d()(G,2),$=h[0],R=h[1],N=(0,Z.useCallback)((0,A.throttle)(function(){for(var O in o)if(Object.prototype.hasOwnProperty.call(o,O)){var m,I=O,w="(min-width: ".concat(o[I],"px)");I==="xs"&&(w="(max-width: ".concat(o[I],"px)")),(m=window)!==null&&m!==void 0&&(m=m.matchMedia(w))!==null&&m!==void 0&&m.matches&&R(I)}},Q),[Q]);return(0,Z.useEffect)(function(){var O;return(O=window)===null||O===void 0||O.addEventListener("resize",N),N(),function(){var m;(m=window)===null||m===void 0||m.removeEventListener("resize",N)}},[N]),$}},53846:function(ge,_){"use strict";_.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},61194:function(ge,_){"use strict";_.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}},66309:function(ge,_,t){"use strict";t.d(_,{Z:function(){return p}});var f=t(62435),d=t(93967),A=t.n(d),M=t(98423),Z=t(98787),o=t(69760),se=t(96159),i=t(45353),c=t(53124),E=t(861),b=t(15063),Q=t(14747),G=t(83262),h=t(83559);const $=r=>{const{paddingXXS:T,lineWidth:F,tagPaddingHorizontal:v,componentCls:L,calc:Me}=r,ve=Me(v).sub(F).equal(),oe=Me(T).sub(F).equal();return{[L]:Object.assign(Object.assign({},(0,Q.Wf)(r)),{display:"inline-block",height:"auto",marginInlineEnd:r.marginXS,paddingInline:ve,fontSize:r.tagFontSize,lineHeight:r.tagLineHeight,whiteSpace:"nowrap",background:r.defaultBg,border:`${(0,E.unit)(r.lineWidth)} ${r.lineType} ${r.colorBorder}`,borderRadius:r.borderRadiusSM,opacity:1,transition:`all ${r.motionDurationMid}`,textAlign:"start",position:"relative",[`&${L}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:r.defaultColor},[`${L}-close-icon`]:{marginInlineStart:oe,fontSize:r.tagIconSize,color:r.colorIcon,cursor:"pointer",transition:`all ${r.motionDurationMid}`,"&:hover":{color:r.colorTextHeading}},[`&${L}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${r.iconCls}-close, ${r.iconCls}-close:hover`]:{color:r.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${L}-checkable-checked):hover`]:{color:r.colorPrimary,backgroundColor:r.colorFillSecondary},"&:active, &-checked":{color:r.colorTextLightSolid},"&-checked":{backgroundColor:r.colorPrimary,"&:hover":{backgroundColor:r.colorPrimaryHover}},"&:active":{backgroundColor:r.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${r.iconCls} + span, > span + ${r.iconCls}`]:{marginInlineStart:ve}}),[`${L}-borderless`]:{borderColor:"transparent",background:r.tagBorderlessBg}}},R=r=>{const{lineWidth:T,fontSizeIcon:F,calc:v}=r,L=r.fontSizeSM;return(0,G.mergeToken)(r,{tagFontSize:L,tagLineHeight:(0,E.unit)(v(r.lineHeightSM).mul(L).equal()),tagIconSize:v(F).sub(v(T).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:r.defaultBg})},N=r=>({defaultBg:new b.FastColor(r.colorFillQuaternary).onBackground(r.colorBgContainer).toHexString(),defaultColor:r.colorText});var O=(0,h.I$)("Tag",r=>{const T=R(r);return $(T)},N),m=function(r,T){var F={};for(var v in r)Object.prototype.hasOwnProperty.call(r,v)&&T.indexOf(v)<0&&(F[v]=r[v]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var L=0,v=Object.getOwnPropertySymbols(r);L<v.length;L++)T.indexOf(v[L])<0&&Object.prototype.propertyIsEnumerable.call(r,v[L])&&(F[v[L]]=r[v[L]]);return F},w=f.forwardRef((r,T)=>{const{prefixCls:F,style:v,className:L,checked:Me,onChange:ve,onClick:oe}=r,W=m(r,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:K,tag:ie}=f.useContext(c.E_),D=re=>{ve==null||ve(!Me),oe==null||oe(re)},fe=K("tag",F),[U,V,P]=O(fe),Pe=A()(fe,`${fe}-checkable`,{[`${fe}-checkable-checked`]:Me},ie==null?void 0:ie.className,L,V,P);return U(f.createElement("span",Object.assign({},W,{ref:T,style:Object.assign(Object.assign({},v),ie==null?void 0:ie.style),className:Pe,onClick:D})))}),le=t(98719);const H=r=>(0,le.Z)(r,(T,{textColor:F,lightBorderColor:v,lightColor:L,darkColor:Me})=>({[`${r.componentCls}${r.componentCls}-${T}`]:{color:F,background:L,borderColor:v,"&-inverse":{color:r.colorTextLightSolid,background:Me,borderColor:Me},[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}));var Te=(0,h.bk)(["Tag","preset"],r=>{const T=R(r);return H(T)},N);function Ge(r){return typeof r!="string"?r:r.charAt(0).toUpperCase()+r.slice(1)}const J=(r,T,F)=>{const v=Ge(F);return{[`${r.componentCls}${r.componentCls}-${T}`]:{color:r[`color${F}`],background:r[`color${v}Bg`],borderColor:r[`color${v}Border`],[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}};var ye=(0,h.bk)(["Tag","status"],r=>{const T=R(r);return[J(T,"success","Success"),J(T,"processing","Info"),J(T,"error","Error"),J(T,"warning","Warning")]},N),je=function(r,T){var F={};for(var v in r)Object.prototype.hasOwnProperty.call(r,v)&&T.indexOf(v)<0&&(F[v]=r[v]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var L=0,v=Object.getOwnPropertySymbols(r);L<v.length;L++)T.indexOf(v[L])<0&&Object.prototype.propertyIsEnumerable.call(r,v[L])&&(F[v[L]]=r[v[L]]);return F};const j=f.forwardRef((r,T)=>{const{prefixCls:F,className:v,rootClassName:L,style:Me,children:ve,icon:oe,color:W,onClose:K,bordered:ie=!0,visible:D}=r,fe=je(r,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:U,direction:V,tag:P}=f.useContext(c.E_),[Pe,re]=f.useState(!0),e=(0,M.Z)(fe,["closeIcon","closable"]);f.useEffect(()=>{D!==void 0&&re(D)},[D]);const ft=(0,Z.o2)(W),pt=(0,Z.yT)(W),st=ft||pt,It=Object.assign(Object.assign({backgroundColor:W&&!st?W:void 0},P==null?void 0:P.style),Me),De=U("tag",F),[Lt,Ue,At]=O(De),Et=A()(De,P==null?void 0:P.className,{[`${De}-${W}`]:st,[`${De}-has-color`]:W&&!st,[`${De}-hidden`]:!Pe,[`${De}-rtl`]:V==="rtl",[`${De}-borderless`]:!ie},v,L,Ue,At),lt=Ve=>{Ve.stopPropagation(),K==null||K(Ve),!Ve.defaultPrevented&&re(!1)},[,St]=(0,o.Z)((0,o.w)(r),(0,o.w)(P),{closable:!1,closeIconRender:Ve=>{const Tt=f.createElement("span",{className:`${De}-close-icon`,onClick:lt},Ve);return(0,se.wm)(Ve,Tt,_e=>({onClick:Ce=>{var ot;(ot=_e==null?void 0:_e.onClick)===null||ot===void 0||ot.call(_e,Ce),lt(Ce)},className:A()(_e==null?void 0:_e.className,`${De}-close-icon`)}))}}),Nt=typeof fe.onClick=="function"||ve&&ve.type==="a",ht=oe||null,wt=ht?f.createElement(f.Fragment,null,ht,ve&&f.createElement("span",null,ve)):ve,xt=f.createElement("span",Object.assign({},e,{ref:T,className:Et,style:It}),wt,St,ft&&f.createElement(Te,{key:"preset",prefixCls:De}),pt&&f.createElement(ye,{key:"status",prefixCls:De}));return Lt(Nt?f.createElement(i.Z,{component:"Tag"},xt):xt)});j.CheckableTag=w;var p=j},85674:function(ge,_,t){var f={"./simpleWorker":18352,"./simpleWorker.js":18352};function d(A){return Promise.resolve().then(function(){if(!t.o(f,A)){var M=new Error("Cannot find module '"+A+"'");throw M.code="MODULE_NOT_FOUND",M}var Z=f[A];return t(Z)})}d.keys=function(){return Object.keys(f)},d.id=85674,ge.exports=d},10131:function(ge,_,t){var f={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function d(A){if(!t.o(f,A))return Promise.resolve().then(function(){var o=new Error("Cannot find module '"+A+"'");throw o.code="MODULE_NOT_FOUND",o});var M=f[A],Z=M[0];return Promise.all(M.slice(1).map(t.e)).then(function(){return t(Z)})}d.keys=function(){return Object.keys(f)},d.id=10131,ge.exports=d}}]);
