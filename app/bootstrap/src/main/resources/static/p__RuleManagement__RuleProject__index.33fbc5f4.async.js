(self.webpackChunk=self.webpackChunk||[]).push([[6673],{52745:function(se,$,t){"use strict";t.d($,{Z:function(){return c}});var j=t(87462),g=t(62435),Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"},I=Z,B=t(84089),i=function(w,M){return g.createElement(B.Z,(0,j.Z)({},w,{ref:M,icon:I}))},A=g.forwardRef(i),c=A},31732:function(se,$,t){"use strict";var j=t(97857),g=t.n(j),Z=t(66309),I=t(62435),B=t(86074);$.Z=function(i){var A=i.text,c=i.style;return(0,B.jsx)(Z.Z,{style:g()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},c),children:A})}},24163:function(se,$,t){"use strict";var j=t(97857),g=t.n(j),Z=t(25593),I=t(83062),B=t(62435),i=t(86074),A=Z.Z.Paragraph;$.Z=function(c){var K=c.text,w=c.width,M=c.maxWidth,O=c.rows,G=O===void 0?2:O,N=c.placement,ie=N===void 0?"top":N,H=c.color,x=H===void 0?"rgba(0, 0, 0, 0.88)":H,ue=c.link,te=ue===void 0?!1:ue,le=c.onClickCallBackFunc,Y=c.style,ae=Y===void 0?{}:Y,b=c.copyable,ve=b===void 0?!1:b;return(0,i.jsx)("div",{style:{maxWidth:M,width:w},children:(0,i.jsx)(I.Z,{title:(0,i.jsx)("div",{children:K}),placement:ie,children:(0,i.jsx)(A,{ellipsis:{rows:G},style:g()({marginBottom:0,color:x,cursor:te?"pointer":""},ae),onClick:le,copyable:ve,children:K})})})}},28235:function(se,$,t){"use strict";var j=t(97857),g=t.n(j),Z=t(25593),I=t(83062),B=t(62435),i=t(86074),A=Z.Z.Paragraph;$.Z=function(c){var K=c.text,w=c.width,M=c.maxWidth,O=c.rows,G=O===void 0?2:O,N=c.placement,ie=N===void 0?"top":N,H=c.color,x=H===void 0?"rgba(0, 0, 0, 0.88)":H,ue=c.link,te=ue===void 0?!1:ue,le=c.onClickCallBackFunc,Y=c.style,ae=Y===void 0?{}:Y,b=c.copyable,ve=b===void 0?!1:b,xe=c.tooltipText;return(0,i.jsx)("div",{style:{maxWidth:M,width:w},children:(0,i.jsx)(I.Z,{title:xe,placement:ie,children:(0,i.jsx)(A,{ellipsis:{rows:G},style:g()({marginBottom:0,color:x,cursor:te?"pointer":""},ae),onClick:le,copyable:ve,children:K})})})}},59999:function(se,$,t){"use strict";t.d($,{j:function(){return B}});var j=t(62435),g=t(96486),Z=t.n(g),I=t(45830),B=function(A){var c=A.platformList,K=A.form,w=A.onPlatformChange,M=A.requestResourceTypeList,O=A.requestCloudAccountBaseInfoList,G=A.platformFieldName,N=G===void 0?"platformList":G,ie=A.resourceTypeFieldName,H=ie===void 0?"resourceTypeList":ie,x=(0,I.useLocation)(),ue=x.search,te=new URLSearchParams(ue),le=te.get("platform");(0,j.useEffect)(function(){var Y;if(!(!c||c.length===0)&&(0,g.isEmpty)(le)){var ae=K.getFieldValue(N);if((0,g.isEmpty)(ae)){var b=((Y=c[0])===null||Y===void 0?void 0:Y.value)||c[0];if(b){var ve=[b];K.setFieldValue(N,ve),H&&K.setFieldValue(H,null),w&&w(ve),M&&M(ve),O&&O({platformList:ve})}}}},[c,le,K,w,M,O,N,H])}},64818:function(se,$,t){"use strict";var j=t(15009),g=t.n(j),Z=t(99289),I=t.n(Z),B=t(5574),i=t.n(B),A=t(62435),c=t(68872),K=t(66309),w=t(85265),M=t(57381),O=t(26412),G=t(25593),N=t(45830),ie=t(96655),H=t(29448),x=t(86074),ue=function(le){var Y=le.visible,ae=le.onClose,b=le.ruleId,ve=le.ruleCode,xe=(0,N.useIntl)(),$e=c.ZP.useMessage(),Me=i()($e,2),m=Me[0],Dt=Me[1],He=(0,A.useState)(!1),it=i()(He,2),r=it[0],P=it[1],p=(0,A.useState)(null),y=i()(p,2),h=y[0],re=y[1];(0,A.useEffect)(function(){Y&&b&&ee()},[Y,b]);var ee=function(){var ge=I()(g()().mark(function Q(){var he;return g()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(P(!0),k.prev=1,!b){k.next=6;break}return k.next=5,(0,ie.queryRuleDetail)({id:b});case 5:he=k.sent;case 6:he&&he.content&&re(he.content),k.next=12;break;case 9:k.prev=9,k.t0=k.catch(1),m.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return k.prev=12,P(!1),k.finish(12);case 15:case"end":return k.stop()}},Q,null,[[1,9,12,15]])}));return function(){return ge.apply(this,arguments)}}(),ce=function(){re(null),ae()},pe=function(Q){switch(Q.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},we=function(Q){if(!Q)return null;var he=Q.split(",");return he.map(function(je,k){return(0,x.jsx)(K.Z,{color:pe(je.trim()),children:je.trim()},k)})},de=function(Q){return(0,H.c5)(Q)};return(0,x.jsxs)(x.Fragment,{children:[Dt,(0,x.jsx)(w.Z,{placement:"right",onClose:ce,open:Y,width:1e3,destroyOnClose:!0,children:(0,x.jsx)(M.Z,{spinning:r,children:h&&(0,x.jsxs)(O.Z,{column:1,bordered:!0,children:[(0,x.jsx)(O.Z.Item,{label:xe.formatMessage({id:"home.module.inform.columns.ruleName"},{}),children:(0,x.jsx)(G.Z.Text,{copyable:!0,children:h.ruleName})}),(0,x.jsx)(O.Z.Item,{label:"Code",children:(0,x.jsx)(G.Z.Text,{copyable:!0,children:h.ruleCode})}),(0,x.jsx)(O.Z.Item,{label:xe.formatMessage({id:"rule.module.text.repair.suggestions"},{}),children:(0,x.jsx)(G.Z.Text,{copyable:!0,children:h.advice})}),(0,x.jsx)(O.Z.Item,{label:xe.formatMessage({id:"rule.module.text.reference.link"},{}),children:(0,x.jsx)(G.Z.Text,{copyable:!0,children:h.link})}),(0,x.jsx)(O.Z.Item,{label:xe.formatMessage({id:"rule.module.text.risk.context.template"},{}),children:(0,x.jsx)(G.Z.Text,{copyable:!0,children:h.context})}),h.ruleRego&&(0,x.jsx)(O.Z.Item,{label:"Rego Policy",children:(0,x.jsx)(G.Z.Text,{copyable:{text:h.ruleRego},children:(0,x.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"2048px",overflow:"auto"},children:h.ruleRego})})}),h.gmtModified&&(0,x.jsx)(O.Z.Item,{label:xe.formatMessage({id:"common.text.update.time"},{}),children:(0,x.jsx)(G.Z.Text,{copyable:!0,children:h.gmtModified})})]})})})]})};$.Z=ue},14842:function(se,$,t){"use strict";t.r($),t.d($,{default:function(){return Ra}});var j=t(15009),g=t.n(j),Z=t(99289),I=t.n(Z),B=t(5574),i=t.n(B),A=t(79930),c=t(96655),K=t(59999),w=t(17910),M=t(29448),O=t(39380),G=t(93410),N=t(45830),ie=t(3303),H=t(68872),x=t(99859),ue=t(71230),te=t(15746),le=t(84567),Y=t(34041),ae=t(42075),b=t(83622),ve=t(92398),xe=t(68795),$e=t(33160),Me=t(96486),m=t(62435),Dt=t(13769),He=t.n(Dt),it=t(9783),r=t.n(it),P=t(97857),p=t.n(P),y=t(31732),h=t(24163),re=t(28235),ee=t(64818),ce=t(87462),pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"},we=pe,de=t(84089),ge=function(T,E){return m.createElement(de.Z,(0,ce.Z)({},T,{ref:E,icon:we}))},Q=m.forwardRef(ge),he=Q,je=t(86548),k={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},Ct=k,ut=function(T,E){return m.createElement(de.Z,(0,ce.Z)({},T,{ref:E,icon:Ct}))},Vt=m.forwardRef(ut),Zt=Vt,xt=t(52745),Rt=t(24969),kt=t(90498),me=t(75302),Qe=t(83062),At=t(55241),St=t(86738),Gt=t(72269),Bt=function(){return{style:{cursor:"pointer"},onMouseEnter:function(E){E.currentTarget.style.backgroundColor="#f5f5f5",E.currentTarget.style.transform="scale(1.01)",E.currentTarget.style.transition="all 0.2s ease",E.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)"},onMouseLeave:function(E){E.currentTarget.style.backgroundColor="",E.currentTarget.style.transform="scale(1)",E.currentTarget.style.boxShadow=""}}},$t=function(T){return function(E){return p()({onClick:function(){return T(E)}},Bt())}},a=t(86074),wt=["pageSize","current"],Ht=me.ZP.useBreakpoint,Wt=function(T){var E=T.form,fe=T.platformList,_e=T.resourceTypeList,Ne=T.ruleGroupList,Tt=T.ruleTypeList,Ie=T.allRuleList,ye=T.checkNewRules,Oe=T.newRulesCount,be=T.queryTrigger,ne=H.ZP.useMessage(),ct=i()(ne,2),U=ct[0],Re=ct[1],Te=Ht(),R=(0,m.useRef)(),Lt=(0,m.useRef)(),d=(0,N.useIntl)(),V=(0,m.useState)(),Mt=i()(V,2),dt=Mt[0],jt=Mt[1],mt=(0,m.useState)({}),Je=i()(mt,2),Pt=Je[0],Ut=Je[1],Jt=(0,m.useState)(!1),Et=i()(Jt,2),ft=Et[0],Xe=Et[1],Ye=(0,m.useState)(),qe=i()(Ye,2),vt=qe[0],gt=qe[1],Ce=(0,m.useState)({}),De=i()(Ce,2),ze=De[0],pt=De[1],Ft=(0,m.useState)({}),et=i()(Ft,2),Ue=et[0],Ze=et[1],Fe=(0,m.useState)({}),tt=i()(Fe,2),at=tt[0],Ke=tt[1],rt=(0,m.useState)([]),Ve=i()(rt,2),ke=Ve[0],Ge=Ve[1],_t=(0,m.useState)(!1),Ae=i()(_t,2),It=Ae[0],Le=Ae[1],Ot=(0,m.useState)(!1),Se=i()(Ot,2),st=Se[0],Be=Se[1],ht=(0,m.useState)(!1),lt=i()(ht,2),q=lt[0],W=lt[1],J=(0,m.useState)(!1),nt=i()(J,2),oe=nt[0],Kt=nt[1];(0,m.useEffect)(function(){if(be!==void 0&&be>0){var f;(f=R.current)===null||f===void 0||f.reload()}},[be]);var Xt=function(u){return u.id===dt?"ant-table-row-selected":""},Yt=function(u){gt(u.id),Xe(!0)},qt=function(){Xe(!1),gt(void 0)},ea=function(){var f=I()(g()().mark(function u(e){var l,n,v,C;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return l=U.loading(d.formatMessage({id:"common.message.text.delete.loading"})),s.next=3,(0,c.deleteRule)({id:e});case 3:n=s.sent,l(),(n.code===200||n.msg==="success")&&(U.success(d.formatMessage({id:"common.message.text.delete.success"})),(v=R.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v));case 6:case"end":return s.stop()}},u)}));return function(e){return f.apply(this,arguments)}}(),ta=function(){var f=I()(g()().mark(function u(e){var l,n,v,C;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return pt(p()(p()({},ze),{},r()({},e,!0))),l=U.loading(d.formatMessage({id:"common.message.text.copy.loading"})),s.next=4,(0,c.copyRule)({id:e});case 4:n=s.sent,pt(p()(p()({},ze),{},r()({},e,!1))),l(),(n.code===200||n.msg==="success")&&(U.success(d.formatMessage({id:"common.message.text.copy.success"})),(v=R.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v));case 8:case"end":return s.stop()}},u)}));return function(e){return f.apply(this,arguments)}}(),aa=function(){var f=I()(g()().mark(function u(e){var l,n,v,C;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return l=e.id,Ze(p()(p()({},Ue),{},r()({},l,!0))),s.prev=2,s.next=5,(0,c.addTenantSelectRule)({ruleCode:e.ruleCode});case 5:n=s.sent,(n.code===200||n.msg==="success")&&(U.success(d.formatMessage({id:"common.message.text.success"})),(v=R.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v)),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),U.error(d.formatMessage({id:"common.message.text.failed"}));case 12:return s.prev=12,Ze(p()(p()({},Ue),{},r()({},l,!1))),s.finish(12);case 15:case"end":return s.stop()}},u,null,[[2,9,12,15]])}));return function(e){return f.apply(this,arguments)}}(),D=function(){var f=I()(g()().mark(function u(e){var l,n,v,C;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return l=e.id,Ke(p()(p()({},at),{},r()({},l,!0))),s.prev=2,s.next=5,(0,c.removeTenantSelectRule)({ruleCode:e.ruleCode});case 5:n=s.sent,(n.code===200||n.msg==="success")&&(U.success(d.formatMessage({id:"common.message.text.success"})),(v=R.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v)),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),U.error(d.formatMessage({id:"common.message.text.failed"}));case 12:return s.prev=12,Ke(p()(p()({},at),{},r()({},l,!1))),s.finish(12);case 15:case"end":return s.stop()}},u,null,[[2,9,12,15]])}));return function(e){return f.apply(this,arguments)}}(),_=function(){var f=I()(g()().mark(function u(){var e,l,n,v,C;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(Kt(!0),s.prev=1,e=Ie==null?void 0:Ie.filter(function(X){return ke.includes(X.id)}),l=(e==null?void 0:e.map(function(X){return X.ruleCode}))||[],l.length!==0){s.next=7;break}return U.warning(d.formatMessage({id:"common.message.text.no.valid.data"})),s.abrupt("return");case 7:return s.next=9,(0,c.batchAddTenantSelectRule)({ruleCodeList:l});case 9:n=s.sent,(n.code===200||n.msg==="success")&&(U.success(d.formatMessage({id:"common.message.text.success"})),(v=R.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v),Ge([])),s.next=16;break;case 13:s.prev=13,s.t0=s.catch(1),U.error(d.formatMessage({id:"common.message.text.failed"}));case 16:return s.prev=16,Kt(!1),s.finish(16);case 19:case"end":return s.stop()}},u,null,[[1,13,16,19]])}));return function(){return f.apply(this,arguments)}}(),o=function(u){W(!0),(0,c.queryExportRuleList)(u?{idList:u}:void 0,{responseType:"blob"}).then(function(e){(0,M.a5)(e,"CloudRec ".concat(d.formatMessage({id:"rule.module.text.rule.data"}))),U.success(d.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return W(!1)})},S=function(){var f=I()(g()().mark(function u(e,l){var n,v,C,L;return g()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return n={id:e,status:l},X.next=3,(0,c.changeRuleStatus)(n);case 3:v=X.sent,(v.code===200||v.msg==="success")&&(U.success(d.formatMessage({id:"common.message.text.edit.success"})),(C=R.current)===null||C===void 0||(L=C.reloadAndRest)===null||L===void 0||L.call(C));case 5:case"end":return X.stop()}},u)}));return function(e,l){return f.apply(this,arguments)}}(),z=[{title:d.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(u,e){var l,n,v=(e==null?void 0:e.selectedTenantNameList)&&e.selectedTenantNameList.length>0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,a.jsx)(re.Z,{placement:"topLeft",maxWidth:Te!=null&&Te.xxl?600:400,rows:1,text:(e==null?void 0:e.ruleName)||"-",style:{fontWeight:500,color:"rgb(58, 58, 58)"}}),v&&(0,a.jsx)(Qe.Z,{title:(0,a.jsx)("div",{children:(l=e.selectedTenantNameList)===null||l===void 0?void 0:l.map(function(C,L){return(0,a.jsxs)("div",{style:{fontSize:12},children:["\u2022 ",C]},L)})}),placement:"topRight",children:(0,a.jsx)(he,{style:{color:"#1890ff",fontSize:14,cursor:"pointer"}})})]}),(0,a.jsx)(h.Z,{placement:"topLeft",maxWidth:Te!=null&&Te.xxl?600:400,rows:1,text:(e==null||(n=e.ruleTypeNameList)===null||n===void 0?void 0:n.toString())||"-",style:{color:"rgb(166, 167, 167)",fontSize:13}})]})}},{title:d.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(u,e){return(0,a.jsx)(y.Z,{text:(e==null?void 0:e.resourceTypeStr)||"-"})}},{title:d.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,M.W_)(w.I9),align:"center",hideInSearch:!0,render:function(u,e){return(0,M.Dd)(w.I9,e==null?void 0:e.riskLevel)}},{title:d.formatMessage({id:"common.table.columns.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(u,e){return(0,a.jsxs)("div",{children:[(0,a.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,a.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:d.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,M.W_)(fe),align:"center",hideInSearch:!0,render:function(u,e){return(0,M.c5)(e.platform,fe)}},{title:d.formatMessage({id:"rule.input.text.rule.group.creator"}),dataIndex:"username",valueType:"text",hideInSearch:!0,width:120},{title:d.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(u,e){return(0,a.jsxs)(ae.Z,{size:"small",children:[(0,a.jsx)(b.ZP,{size:"small",onClick:function(n){n.stopPropagation(),jt(e.id)},type:"link",target:"_self",href:"/ruleManagement/ruleProject/edit?id=".concat(e==null?void 0:e.id),children:(0,a.jsx)(Qe.Z,{title:d.formatMessage({id:"common.button.text.edit"}),children:(0,a.jsx)(je.Z,{})})}),(0,a.jsx)(At.Z,{content:(0,a.jsxs)(ae.Z,{children:[(0,a.jsx)(St.Z,{title:d.formatMessage({id:"common.button.text.delete.confirm"}),onConfirm:function(n){n==null||n.stopPropagation(),ea(e.id)},okText:d.formatMessage({id:"common.button.text.ok"}),cancelText:d.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(b.ZP,{block:!0,type:"link",danger:!0,size:"small",onClick:function(n){return n.stopPropagation()},children:d.formatMessage({id:"common.button.text.delete"})})}),(0,a.jsx)(b.ZP,{block:!0,loading:ze[Number(e.id)],onClick:function(n){n.stopPropagation(),ta(e.id)},type:"link",target:"_blank",size:"small",children:d.formatMessage({id:"common.button.text.copy"})})]}),children:(0,a.jsx)(b.ZP,{type:"link",icon:(0,a.jsx)(Zt,{}),onClick:function(n){return n.stopPropagation()}})}),e.tenantSelected?(0,a.jsx)(St.Z,{title:d.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(n){n==null||n.stopPropagation(),D(e)},onCancel:function(n){return n==null?void 0:n.stopPropagation()},okText:d.formatMessage({id:"common.button.text.ok"}),cancelText:d.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(b.ZP,{type:"default",size:"small",loading:at[Number(e.id)],onClick:function(n){return n.stopPropagation()},icon:(0,a.jsx)(xt.Z,{}),danger:!0})}):(0,a.jsx)(b.ZP,{type:"primary",size:"small",loading:Ue[Number(e.id)],onClick:function(n){n.stopPropagation(),aa(e)},icon:(0,a.jsx)(Rt.Z,{})}),(0,a.jsx)(Qe.Z,{title:d.formatMessage({id:"rule.module.text.tooltip.status"}),children:(0,a.jsx)(Gt.Z,{checked:(e==null?void 0:e.status)==="valid",onClick:function(n,v){v==null||v.stopPropagation(),S(e.id,(e==null?void 0:e.status)==="valid"?"invalid":"valid")}})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[Re,(0,a.jsx)(kt.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:ke,onChange:function(u){return Ge(u)},preserveSelectedRowKeys:!0},actionRef:R,formRef:Lt,rowClassName:Xt,rowKey:"id",search:!1,toolBarRender:function(){return[(0,a.jsx)(b.ZP,{type:"primary",href:"/ruleManagement/ruleProject/edit",children:d.formatMessage({id:"rule.extend.basic.add"})},"CREATE"),(0,a.jsx)(At.Z,{open:It,onOpenChange:function(e){return Le(e)},title:d.formatMessage({id:"rule.module.text.sync.confirm"}),content:(0,a.jsxs)(ae.Z,{children:[(0,a.jsx)(b.ZP,{danger:!0,type:"default",loading:st,onClick:I()(g()().mark(function u(){var e,l,n,v;return g()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return Be(!0),e=U.loading(d.formatMessage({id:"rule.module.text.sync.loading"})),L.prev=2,L.next=5,(0,c.loadRuleFromGithub)({coverage:!0});case 5:l=L.sent,(l.code===200||l.msg==="success")&&(U.success(d.formatMessage({id:"rule.module.text.sync.success"})),(n=R.current)===null||n===void 0||(v=n.reloadAndRest)===null||v===void 0||v.call(n),ye());case 7:return L.prev=7,e(),Be(!1),Le(!1),L.finish(7);case 12:case"end":return L.stop()}},u,null,[[2,,7,12]])})),children:d.formatMessage({id:"rule.module.text.sync.overwrite"})}),(0,a.jsx)(b.ZP,{type:"default",loading:st,onClick:I()(g()().mark(function u(){var e,l,n,v;return g()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return Be(!0),e=U.loading(d.formatMessage({id:"rule.module.text.sync.loading"})),L.prev=2,L.next=5,(0,c.loadRuleFromGithub)({coverage:!1});case 5:l=L.sent,(l.code===200||l.msg==="success")&&(U.success(d.formatMessage({id:"rule.module.text.sync.success"})),(n=R.current)===null||n===void 0||(v=n.reloadAndRest)===null||v===void 0||v.call(n),ye());case 7:return L.prev=7,e(),Be(!1),Le(!1),L.finish(7);case 12:case"end":return L.stop()}},u,null,[[2,,7,12]])})),children:d.formatMessage({id:"rule.module.text.sync.no.overwrite"})}),(0,a.jsx)(b.ZP,{onClick:function(){Le(!1)},children:d.formatMessage({id:"common.button.text.cancel"})})]}),trigger:"click",children:(0,a.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,a.jsx)(b.ZP,{type:"default",children:d.formatMessage({id:"rule.module.text.sync.button"})}),Oe>0&&(0,a.jsx)("div",{style:{position:"absolute",top:"-8px",right:"-8px",backgroundColor:"#ff4d4f",color:"white",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",zIndex:1},children:Oe>99?"99+":Oe})]})},"sync"),(0,a.jsx)(b.ZP,{type:"default",loading:oe,disabled:ke.length===0,onClick:_,children:d.formatMessage({id:"rule.module.text.batch.add.to.favorites"})},"BATCH_ADD_TO_FAVORITES"),(0,a.jsx)(b.ZP,{loading:q,type:"default",disabled:ke.length===0,onClick:function(){return o(ke)},children:d.formatMessage({id:"common.button.text.export"})},"EXPORT")]},request:function(){var f=I()(g()().mark(function u(e,l){var n,v,C,L,s,X,F,ra,ot,na;return g()().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:return n=e.pageSize,v=e.current,C=He()(e,wt),L=E.getFieldsValue(),s=(0,M.Hm)(l),X=p()(p()(p()({},C),L),{},{page:v,size:n}),(0,Me.isEmpty)(s)||(X.sortParam=s==null?void 0:s.key,X.sortType=s==null||(F=s.value)===null||F===void 0||(F=F.slice(0,-3))===null||F===void 0?void 0:F.toUpperCase()),yt.next=7,(0,c.queryRuleList)(X);case 7:return ra=yt.sent,ot=ra.content,na=ra.code,yt.abrupt("return",{data:(ot==null?void 0:ot.data)||[],total:(ot==null?void 0:ot.total)||0,success:na===200||!1});case 11:case"end":return yt.stop()}},u)}));return function(u,e){return f.apply(this,arguments)}}(),columns:z,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:$t(Yt)}),(0,a.jsx)(ee.Z,{visible:ft,onClose:qt,ruleId:vt})]})},We=Wt,Qt=t(53846),Pe=t(90598),Nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 01-12.7-6.5V353.7a8 8 0 0112.7-6.5L656.1 506a7.9 7.9 0 010 12.9z"}}]},name:"play-circle",theme:"filled"},bt=Nt,oa=function(T,E){return m.createElement(de.Z,(0,ce.Z)({},T,{ref:E,icon:bt}))},ia=m.forwardRef(oa),ua=ia,ca={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},da=ca,ma=function(T,E){return m.createElement(de.Z,(0,ce.Z)({},T,{ref:E,icon:da}))},fa=m.forwardRef(ma),va=fa,zt=t(78045),ga=["pageSize","current"],pa=me.ZP.useBreakpoint,ha=function(T){var E=T.form,fe=T.platformList,_e=T.resourceTypeList,Ne=T.ruleGroupList,Tt=T.ruleTypeList,Ie=T.allRuleList,ye=T.queryTrigger,Oe=H.ZP.useMessage(),be=i()(Oe,2),ne=be[0],ct=be[1],U=pa(),Re=(0,m.useRef)(),Te=(0,m.useRef)(),R=(0,N.useIntl)(),Lt=(0,m.useState)(),d=i()(Lt,2),V=d[0],Mt=d[1],dt=(0,m.useState)({}),jt=i()(dt,2),mt=jt[0],Je=jt[1],Pt=(0,m.useState)({}),Ut=i()(Pt,2),Jt=Ut[0],Et=Ut[1],ft=(0,m.useState)({}),Xe=i()(ft,2),Ye=Xe[0],qe=Xe[1],vt=(0,m.useState)([]),gt=i()(vt,2),Ce=gt[0],De=gt[1],ze=(0,m.useState)(!1),pt=i()(ze,2),Ft=pt[0],et=pt[1],Ue=(0,m.useState)(!1),Ze=i()(Ue,2),Fe=Ze[0],tt=Ze[1],at=(0,m.useState)(!1),Ke=i()(at,2),rt=Ke[0],Ve=Ke[1],ke=(0,m.useState)(),Ge=i()(ke,2),_t=Ge[0],Ae=Ge[1],It=(0,m.useState)(!0),Le=i()(It,2),Ot=Le[0],Se=Le[1],st=(0,m.useState)(!1),Be=i()(st,2),ht=Be[0],lt=Be[1],q=(0,m.useState)("all"),W=i()(q,2),J=W[0],nt=W[1],oe=function(_){return _.id===V?"ant-table-row-selected":""},Kt=function(_){Ae(_.id),Ve(!0)};(0,m.useEffect)(function(){if(ye!==void 0&&ye>0){var D;(D=Re.current)===null||D===void 0||D.reload()}},[ye]);var Xt=function(){var D=I()(g()().mark(function _(o){var S,z,f,u;return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return Je(p()(p()({},mt),{},r()({},o,!0))),S=ne.loading(R.formatMessage({id:"common.message.text.execute.loading"})),l.next=4,(0,c.scanByRule)({id:o});case 4:z=l.sent,Je(p()(p()({},mt),{},r()({},o,!1))),S(),(z.code===200||z.msg==="success")&&(ne.success(R.formatMessage({id:"common.message.text.execute.success"})),(f=Re.current)===null||f===void 0||(u=f.reloadAndRest)===null||u===void 0||u.call(f));case 8:case"end":return l.stop()}},_)}));return function(o){return D.apply(this,arguments)}}(),Yt=function(){var D=I()(g()().mark(function _(o){var S,z,f,u;return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return S=o.id,qe(p()(p()({},Ye),{},r()({},S,!0))),l.prev=2,l.next=5,(0,c.removeTenantSelectRule)({ruleCode:o.ruleCode});case 5:z=l.sent,(z.code===200||z.msg==="success")&&(ne.success(R.formatMessage({id:"common.message.text.success"})),(f=Re.current)===null||f===void 0||(u=f.reloadAndRest)===null||u===void 0||u.call(f)),l.next=12;break;case 9:l.prev=9,l.t0=l.catch(2),ne.error(R.formatMessage({id:"common.message.text.fail"}));case 12:return l.prev=12,qe(p()(p()({},Ye),{},r()({},S,!1))),l.finish(12);case 15:case"end":return l.stop()}},_,null,[[2,9,12,15]])}));return function(o){return D.apply(this,arguments)}}(),qt=function(){var D=I()(g()().mark(function _(){var o,S,z,f;return g()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ce.length!==0){e.next=2;break}return e.abrupt("return");case 2:return et(!0),e.prev=3,o=Ce.map(function(l){return Number(l)}),e.next=7,(0,c.scanRuleList)({idList:o});case 7:S=e.sent,(S.code===200||S.msg==="success")&&(ne.success(R.formatMessage({id:"common.message.text.success"})),De([]),(z=Re.current)===null||z===void 0||(f=z.reloadAndRest)===null||f===void 0||f.call(z)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),ne.error(R.formatMessage({id:"common.message.text.fail"}));case 14:return e.prev=14,et(!1),e.finish(14);case 17:case"end":return e.stop()}},_,null,[[3,11,14,17]])}));return function(){return D.apply(this,arguments)}}(),ea=function(){var D=I()(g()().mark(function _(){var o,S,z,f,u,e,l,n,v,C;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(Ce.length!==0){s.next=2;break}return s.abrupt("return");case 2:return tt(!0),s.prev=3,S=E.getFieldsValue(),z={page:1,size:1e3,platformList:S.platformList,riskLevelList:S.riskLevelList,ruleCodeList:S.ruleCodeList,resourceTypeList:S.resourceTypeList,ruleGroupIdList:S.ruleGroupIdList,ruleTypeIdList:S.ruleTypeIdList},s.next=8,(0,c.queryEffectRuleList)(z);case 8:return f=s.sent,u=(f==null||(o=f.content)===null||o===void 0?void 0:o.data)||[],e=u.filter(function(X){return Ce.includes(X.id)}),l=e.map(function(X){return X.ruleCode}),s.next=14,(0,c.batchDeleteTenantSelectRule)({ruleCodeList:l});case 14:n=s.sent,(n.code===200||n.msg==="success")&&(ne.success(R.formatMessage({id:"common.message.text.success"})),De([]),(v=Re.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v)),s.next=21;break;case 18:s.prev=18,s.t0=s.catch(3),ne.error(R.formatMessage({id:"common.message.text.fail"}));case 21:return s.prev=21,tt(!1),s.finish(21);case 24:case"end":return s.stop()}},_,null,[[3,18,21,24]])}));return function(){return D.apply(this,arguments)}}(),ta=function(){var D=I()(g()().mark(function _(o,S){var z,f,u,e,l,n,v,C,L,s;return g()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return z=o.pageSize,f=o.current,u=He()(o,ga),F.prev=1,e=E.getFieldsValue(),l=p()({page:f||1,size:z||10,platformList:e.platformList,riskLevelList:e.riskLevelList,ruleCodeList:e.ruleCodeList,resourceTypeList:e.resourceTypeList,ruleGroupIdList:e.ruleGroupIdList,ruleTypeIdList:e.ruleTypeIdList,effectRuleType:J},u),S&&Object.keys(S).length>0&&(n=Object.keys(S)[0],v=S[n],l.sortParam=n,l.sortType=v==="ascend"?"ASC":"DESC"),F.next=7,(0,c.queryEffectRuleList)(l);case 7:if(C=F.sent,!(C!=null&&C.content)){F.next=16;break}return L=C.content.data||[],s=C.content.total||0,Se(s>0),lt(!0),F.abrupt("return",{data:L,total:s,success:!0});case 16:return Se(!1),lt(!0),F.abrupt("return",{data:[],total:0,success:!1});case 19:F.next=26;break;case 21:return F.prev=21,F.t0=F.catch(1),Se(!1),lt(!0),F.abrupt("return",{data:[],total:0,success:!1});case 26:case"end":return F.stop()}},_,null,[[1,21]])}));return function(o,S){return D.apply(this,arguments)}}(),aa=[{title:R.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(_,o){var S;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{fontWeight:500,color:"rgb(58, 58, 58)",display:"flex",alignItems:"center",gap:"8px"},children:[(0,a.jsx)("span",{children:(o==null?void 0:o.ruleName)||"-"}),(o==null?void 0:o.defaultRuleSelected)&&(0,a.jsx)(Qe.Z,{title:"default",children:(0,a.jsx)(Pe.Z,{style:{color:"#faad14",fontSize:"14px"}})})]}),(0,a.jsx)("div",{style:{color:"rgb(166, 167, 167)",fontSize:13},children:(o==null||(S=o.ruleTypeNameList)===null||S===void 0?void 0:S.toString())||"-"})]})}},{title:R.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(_,o){return(0,a.jsx)(y.Z,{text:(o==null?void 0:o.resourceTypeStr)||"-"})}},{title:R.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,M.W_)(w.I9),align:"center",hideInSearch:!0,render:function(_,o){return(0,M.Dd)(w.I9,o==null?void 0:o.riskLevel)}},{title:R.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,M.W_)(fe),align:"center",hideInSearch:!0,render:function(_,o){return(0,M.c5)(o.platform,fe)}},{title:R.formatMessage({id:"asset.module.risk.number"}),dataIndex:"riskCount",valueType:"text",hideInSearch:!0,align:"center",sorter:!0,render:function(_,o){return(0,a.jsx)(b.ZP,{type:"link",size:"small",href:"/riskManagement/riskList?platform=".concat(o==null?void 0:o.platform,"&ruleCode=").concat(o==null?void 0:o.ruleCode),children:o==null?void 0:o.riskCount})}},{title:R.formatMessage({id:"cloudAccount.extend.title.lastScanTime"}),dataIndex:"lastScanTime",valueType:"text",hideInSearch:!0,align:"center",width:150,sorter:!0,render:function(_,o){return o!=null&&o.lastScanTime?(0,a.jsx)(Qe.Z,{title:o.lastScanTime,children:(0,a.jsx)("span",{children:o.lastScanTime})}):"-"}},{title:R.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",width:180,render:function(_,o){var S=o==null?void 0:o.isRunning,z=S===0,f=function(){return S===1?(0,a.jsx)(ua,{}):(0,a.jsx)(va,{})};return(0,a.jsxs)(ae.Z,{size:"small",children:[(0,a.jsx)(b.ZP,{block:!0,loading:mt[Number(o.id)],disabled:!z,onClick:function(e){e.stopPropagation(),Xt(o.id)},type:"default",target:"_blank",size:"small",icon:f(),style:{color:S===1?"#52c41a":void 0,borderColor:S===1?"#52c41a":void 0},children:R.formatMessage({id:S===1?"common.button.text.running":"common.button.text.test"})}),J==="selected"&&(0,a.jsx)(St.Z,{title:R.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(e){e==null||e.stopPropagation(),Yt(o)},onCancel:function(e){return e==null?void 0:e.stopPropagation()},okText:R.formatMessage({id:"common.button.text.ok"}),cancelText:R.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(b.ZP,{danger:!0,size:"small",loading:Ye[Number(o.id)],disabled:S===1,icon:(0,a.jsx)(xt.Z,{}),onClick:function(e){return e.stopPropagation()}})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[ct,(0,a.jsx)(kt.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:Ce,onChange:function(_){return De(_)},preserveSelectedRowKeys:!0},headerTitle:(0,a.jsx)("div",{className:Qt.Z.customTitle,children:(0,a.jsx)(ae.Z,{children:(0,a.jsxs)(zt.ZP.Group,{value:J,onChange:function(_){var o;nt(_.target.value),De([]),(o=Re.current)===null||o===void 0||o.reload()},size:"middle",buttonStyle:"solid",children:[(0,a.jsx)(zt.ZP.Button,{value:"all",children:R.formatMessage({id:"common.module.text.all"})}),(0,a.jsx)(zt.ZP.Button,{value:"selected",children:R.formatMessage({id:"common.module.text.selected"})}),(0,a.jsx)(zt.ZP.Button,{value:"default",children:R.formatMessage({id:"common.module.text.default"})})]})})}),actionRef:Re,formRef:Te,rowClassName:oe,rowKey:"id",search:!1,toolBarRender:function(){return[(0,a.jsx)(b.ZP,{type:"primary",loading:Ft,disabled:Ce.length===0,onClick:qt,children:R.formatMessage({id:"rule.module.text.batch.test"})},"BATCH_DETECT"),J==="selected"&&(0,a.jsx)(b.ZP,{danger:!0,loading:Fe,disabled:Ce.length===0,onClick:ea,children:R.formatMessage({id:"rule.module.text.batch.remove"})},"BATCH_REMOVE")].filter(Boolean)},request:ta,columns:aa,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:$t(Kt)}),(0,a.jsx)(ee.Z,{visible:rt,onClose:function(){return Ve(!1)},ruleId:_t})]})},ya=ha,sa=t(61194),la=ie.Z.SHOW_CHILD,Ca=function(T,E){var fe,_e,Ne=T.toLowerCase(),Tt=((fe=E.label)===null||fe===void 0?void 0:fe.toLowerCase())||"",Ie=((_e=E.value)===null||_e===void 0?void 0:_e.toLowerCase())||"";return Tt.includes(Ne)||Ie.includes(Ne)},xa=function(){var T=(0,N.useModel)("rule"),E=T.platformList,fe=T.ruleTypeList,_e=T.allRuleList,Ne=T.ruleGroupList,Tt=(0,N.useLocation)(),Ie=Tt.search,ye=new URLSearchParams(Ie),Oe=ye.get("groupId"),be=ye.get("ruleCode"),ne=ye.get("platform"),ct=H.ZP.useMessage(),U=i()(ct,2),Re=U[0],Te=U[1],R=x.Z.useForm(),Lt=i()(R,1),d=Lt[0],V=(0,N.useIntl)(),Mt=(0,m.useState)(!1),dt=i()(Mt,2),jt=dt[0],mt=dt[1],Je=(0,m.useState)(!1),Pt=i()(Je,2),Ut=Pt[0],Jt=Pt[1],Et=(0,m.useState)(0),ft=i()(Et,2),Xe=ft[0],Ye=ft[1],qe=(0,m.useState)(!1),vt=i()(qe,2),gt=vt[0],Ce=vt[1],De=(0,m.useState)([]),ze=i()(De,2),pt=ze[0],Ft=ze[1],et=(0,m.useState)([]),Ue=i()(et,2),Ze=Ue[0],Fe=Ue[1],tt=ye.get("tab"),at=(0,m.useState)(tt||"selected"),Ke=i()(at,2),rt=Ke[0],Ve=Ke[1];(0,m.useEffect)(function(){var q=ye.get("tab");q&&q!==rt&&Ve(q)},[Ie,rt]);var ke=(0,m.useState)(!1),Ge=i()(ke,2),_t=Ge[0],Ae=Ge[1],It=(0,m.useState)(0),Le=i()(It,2),Ot=Le[0],Se=Le[1],st=function(){var q=I()(g()().mark(function W(){var J;return g()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.prev=0,oe.next=3,(0,c.checkExistNewRule)();case 3:J=oe.sent,J.code===200&&typeof J.content=="number"&&Ye(J.content),oe.next=10;break;case 7:oe.prev=7,oe.t0=oe.catch(0),console.error("Failed to check new rules:",oe.t0);case 10:case"end":return oe.stop()}},W,null,[[0,7]])}));return function(){return q.apply(this,arguments)}}(),Be=(0,N.useRequest)(function(q){return(0,A.queryGroupTypeList)({platformList:q})},{manual:!0,formatResult:function(W){var J=W.content;Fe(J||[])}}),ht=Be.run,lt=function(W){Ce(!0),(0,c.queryExportRuleList)(W?{idList:W}:void 0,{responseType:"blob"}).then(function(J){(0,M.a5)(J,"CloudRec ".concat(V.formatMessage({id:"rule.module.text.rule.data"}))),Re.success(V.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return Ce(!1)})};return(0,m.useEffect)(function(){(0,Me.isEmpty)(Oe)||d.setFieldValue("ruleGroupIdList",[Number(Oe)]),(0,Me.isEmpty)(be)||d.setFieldValue("ruleCodeList",[be]),(0,Me.isEmpty)(ne)||(d.setFieldValue("platformList",[ne]),ht([ne])),st()},[Oe,be,ne]),(0,K.j)({platformList:E,form:d,requestResourceTypeList:function(W){Fe([]),ht(W)},platformFieldName:"platformList",resourceTypeFieldName:"resourceTypeList"}),(0,a.jsxs)(O._z,{ghost:!0,title:!1,className:sa.Z.rulePageContainer,breadcrumbRender:!1,children:[Te,(0,a.jsx)(G.Z,{bodyStyle:{paddingBottom:0},className:sa.Z.customFilterCard,children:(0,a.jsx)(x.Z,{form:d,children:(0,a.jsxs)(ue.Z,{gutter:[24,10],style:{marginBottom:20},children:[(0,a.jsx)(te.Z,{span:24,children:(0,a.jsx)(x.Z.Item,{name:"platformList",label:V.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,a.jsx)(le.Z.Group,{options:(0,M.T$)(E),onChange:function(W){var J=W||[];d.setFieldValue("resourceTypeList",null),Fe([]),ht(J),Se(function(nt){return nt+1})}})})}),(0,a.jsx)(te.Z,{span:24,children:(0,a.jsx)(x.Z.Item,{name:"riskLevelList",label:V.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,a.jsx)(le.Z.Group,{options:(0,M.at)(w.I9)})})}),(0,a.jsx)(te.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{name:"resourceTypeList",label:V.formatMessage({id:"cloudAccount.extend.title.asset.type"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(ie.Z,{options:Ze,multiple:!0,placeholder:V.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:la,allowClear:!0,showSearch:!0})})}),(0,a.jsx)(te.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{name:"ruleTypeIdList",label:V.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(ie.Z,{placeholder:V.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:la,allowClear:!0,showSearch:!0,fieldNames:{label:"typeName",value:"id",children:"childList"},multiple:!0,options:fe||[]})})}),(0,a.jsx)(te.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{name:"ruleGroupIdList",label:V.formatMessage({id:"layout.routes.title.ruleGroup"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(Y.Z,{placeholder:V.formatMessage({id:"common.select.text.placeholder"}),options:Ne,allowClear:!0,mode:"multiple"})})}),(0,a.jsx)(te.Z,{span:18,children:(0,a.jsx)(x.Z.Item,{name:"ruleCodeList",label:V.formatMessage({id:"home.module.inform.columns.ruleName"}),style:{marginBottom:0},children:(0,a.jsx)(Y.Z,{filterOption:Ca,placeholder:V.formatMessage({id:"common.select.text.placeholder"}),allowClear:!0,options:_e,mode:"multiple"})})}),(0,a.jsx)(te.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{style:{marginBottom:0,textAlign:"right"},children:(0,a.jsxs)(ae.Z,{children:[(0,a.jsx)(b.ZP,{type:"primary",icon:(0,a.jsx)(xe.Z,{}),loading:_t,onClick:function(){Ae(!0),Se(function(W){return W+1}),setTimeout(function(){Ae(!1)},500)},children:V.formatMessage({id:"common.button.text.query"})}),(0,a.jsx)(b.ZP,{icon:(0,a.jsx)($e.Z,{}),onClick:function(){d.resetFields(),Fe([]),Ae(!0),Se(function(W){return W+1}),setTimeout(function(){Ae(!1)},500)},children:V.formatMessage({id:"common.button.text.reset"})})]})})})]})})}),(0,a.jsx)(G.Z,{style:{marginTop:16},children:(0,a.jsx)(ve.Z,{activeKey:rt,onChange:function(W){Ve(W),Se(function(J){return J+1})},items:[{key:"selected",label:V.formatMessage({id:"rule.module.text.selected.rules"}),children:(0,a.jsx)(ya,{form:d,platformList:E,resourceTypeList:Ze,ruleGroupList:Ne,ruleTypeList:fe,allRuleList:_e,queryTrigger:Ot})},{key:"market",label:V.formatMessage({id:"rule.module.text.market.rules"}),children:(0,a.jsx)(We,{form:d,platformList:E,resourceTypeList:Ze,ruleGroupList:Ne,ruleTypeList:fe,allRuleList:_e,checkNewRules:st,newRulesCount:Xe,queryTrigger:Ot})}]})})]})},Ra=xa},53846:function(se,$){"use strict";$.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},61194:function(se,$){"use strict";$.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}},75302:function(se,$,t){"use strict";var j=t(25378);function g(){return(0,j.Z)()}$.ZP={useBreakpoint:g}},66309:function(se,$,t){"use strict";t.d($,{Z:function(){return it}});var j=t(62435),g=t(93967),Z=t.n(g),I=t(98423),B=t(98787),i=t(69760),A=t(96159),c=t(45353),K=t(53124),w=t(861),M=t(15063),O=t(14747),G=t(83262),N=t(83559);const ie=r=>{const{paddingXXS:P,lineWidth:p,tagPaddingHorizontal:y,componentCls:h,calc:re}=r,ee=re(y).sub(p).equal(),ce=re(P).sub(p).equal();return{[h]:Object.assign(Object.assign({},(0,O.Wf)(r)),{display:"inline-block",height:"auto",marginInlineEnd:r.marginXS,paddingInline:ee,fontSize:r.tagFontSize,lineHeight:r.tagLineHeight,whiteSpace:"nowrap",background:r.defaultBg,border:`${(0,w.unit)(r.lineWidth)} ${r.lineType} ${r.colorBorder}`,borderRadius:r.borderRadiusSM,opacity:1,transition:`all ${r.motionDurationMid}`,textAlign:"start",position:"relative",[`&${h}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:r.defaultColor},[`${h}-close-icon`]:{marginInlineStart:ce,fontSize:r.tagIconSize,color:r.colorIcon,cursor:"pointer",transition:`all ${r.motionDurationMid}`,"&:hover":{color:r.colorTextHeading}},[`&${h}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${r.iconCls}-close, ${r.iconCls}-close:hover`]:{color:r.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${h}-checkable-checked):hover`]:{color:r.colorPrimary,backgroundColor:r.colorFillSecondary},"&:active, &-checked":{color:r.colorTextLightSolid},"&-checked":{backgroundColor:r.colorPrimary,"&:hover":{backgroundColor:r.colorPrimaryHover}},"&:active":{backgroundColor:r.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${r.iconCls} + span, > span + ${r.iconCls}`]:{marginInlineStart:ee}}),[`${h}-borderless`]:{borderColor:"transparent",background:r.tagBorderlessBg}}},H=r=>{const{lineWidth:P,fontSizeIcon:p,calc:y}=r,h=r.fontSizeSM;return(0,G.mergeToken)(r,{tagFontSize:h,tagLineHeight:(0,w.unit)(y(r.lineHeightSM).mul(h).equal()),tagIconSize:y(p).sub(y(P).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:r.defaultBg})},x=r=>({defaultBg:new M.FastColor(r.colorFillQuaternary).onBackground(r.colorBgContainer).toHexString(),defaultColor:r.colorText});var ue=(0,N.I$)("Tag",r=>{const P=H(r);return ie(P)},x),te=function(r,P){var p={};for(var y in r)Object.prototype.hasOwnProperty.call(r,y)&&P.indexOf(y)<0&&(p[y]=r[y]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,y=Object.getOwnPropertySymbols(r);h<y.length;h++)P.indexOf(y[h])<0&&Object.prototype.propertyIsEnumerable.call(r,y[h])&&(p[y[h]]=r[y[h]]);return p},Y=j.forwardRef((r,P)=>{const{prefixCls:p,style:y,className:h,checked:re,onChange:ee,onClick:ce}=r,pe=te(r,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:we,tag:de}=j.useContext(K.E_),ge=ut=>{ee==null||ee(!re),ce==null||ce(ut)},Q=we("tag",p),[he,je,k]=ue(Q),Ct=Z()(Q,`${Q}-checkable`,{[`${Q}-checkable-checked`]:re},de==null?void 0:de.className,h,je,k);return he(j.createElement("span",Object.assign({},pe,{ref:P,style:Object.assign(Object.assign({},y),de==null?void 0:de.style),className:Ct,onClick:ge})))}),ae=t(98719);const b=r=>(0,ae.Z)(r,(P,{textColor:p,lightBorderColor:y,lightColor:h,darkColor:re})=>({[`${r.componentCls}${r.componentCls}-${P}`]:{color:p,background:h,borderColor:y,"&-inverse":{color:r.colorTextLightSolid,background:re,borderColor:re},[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}));var ve=(0,N.bk)(["Tag","preset"],r=>{const P=H(r);return b(P)},x);function xe(r){return typeof r!="string"?r:r.charAt(0).toUpperCase()+r.slice(1)}const $e=(r,P,p)=>{const y=xe(p);return{[`${r.componentCls}${r.componentCls}-${P}`]:{color:r[`color${p}`],background:r[`color${y}Bg`],borderColor:r[`color${y}Border`],[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}};var Me=(0,N.bk)(["Tag","status"],r=>{const P=H(r);return[$e(P,"success","Success"),$e(P,"processing","Info"),$e(P,"error","Error"),$e(P,"warning","Warning")]},x),m=function(r,P){var p={};for(var y in r)Object.prototype.hasOwnProperty.call(r,y)&&P.indexOf(y)<0&&(p[y]=r[y]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,y=Object.getOwnPropertySymbols(r);h<y.length;h++)P.indexOf(y[h])<0&&Object.prototype.propertyIsEnumerable.call(r,y[h])&&(p[y[h]]=r[y[h]]);return p};const He=j.forwardRef((r,P)=>{const{prefixCls:p,className:y,rootClassName:h,style:re,children:ee,icon:ce,color:pe,onClose:we,bordered:de=!0,visible:ge}=r,Q=m(r,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:he,direction:je,tag:k}=j.useContext(K.E_),[Ct,ut]=j.useState(!0),Vt=(0,I.Z)(Q,["closeIcon","closable"]);j.useEffect(()=>{ge!==void 0&&ut(ge)},[ge]);const Zt=(0,B.o2)(pe),xt=(0,B.yT)(pe),Rt=Zt||xt,kt=Object.assign(Object.assign({backgroundColor:pe&&!Rt?pe:void 0},k==null?void 0:k.style),re),me=he("tag",p),[Qe,At,St]=ue(me),Gt=Z()(me,k==null?void 0:k.className,{[`${me}-${pe}`]:Rt,[`${me}-has-color`]:pe&&!Rt,[`${me}-hidden`]:!Ct,[`${me}-rtl`]:je==="rtl",[`${me}-borderless`]:!de},y,h,At,St),Bt=We=>{We.stopPropagation(),we==null||we(We),!We.defaultPrevented&&ut(!1)},[,$t]=(0,i.Z)((0,i.w)(r),(0,i.w)(k),{closable:!1,closeIconRender:We=>{const Qt=j.createElement("span",{className:`${me}-close-icon`,onClick:Bt},We);return(0,A.wm)(We,Qt,Pe=>({onClick:Nt=>{var bt;(bt=Pe==null?void 0:Pe.onClick)===null||bt===void 0||bt.call(Pe,Nt),Bt(Nt)},className:Z()(Pe==null?void 0:Pe.className,`${me}-close-icon`)}))}}),a=typeof Q.onClick=="function"||ee&&ee.type==="a",wt=ce||null,Ht=wt?j.createElement(j.Fragment,null,wt,ee&&j.createElement("span",null,ee)):ee,Wt=j.createElement("span",Object.assign({},Vt,{ref:P,className:Gt,style:kt}),Ht,$t,Zt&&j.createElement(ve,{key:"preset",prefixCls:me}),xt&&j.createElement(Me,{key:"status",prefixCls:me}));return Qe(a?j.createElement(c.Z,{component:"Tag"},Wt):Wt)});He.CheckableTag=Y;var it=He},64599:function(se,$,t){var j=t(96263);function g(Z,I){var B=typeof Symbol!="undefined"&&Z[Symbol.iterator]||Z["@@iterator"];if(!B){if(Array.isArray(Z)||(B=j(Z))||I&&Z&&typeof Z.length=="number"){B&&(Z=B);var i=0,A=function(){};return{s:A,n:function(){return i>=Z.length?{done:!0}:{done:!1,value:Z[i++]}},e:function(O){throw O},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,K=!1,w;return{s:function(){B=B.call(Z)},n:function(){var O=B.next();return c=O.done,O},e:function(O){K=!0,w=O},f:function(){try{!c&&B.return!=null&&B.return()}finally{if(K)throw w}}}}se.exports=g,se.exports.__esModule=!0,se.exports.default=se.exports}}]);
