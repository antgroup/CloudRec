"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6673],{52745:function(Se,A,t){t.d(A,{Z:function(){return d}});var M=t(87462),g=t(62435),Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"},_=Y,ne=t(84089),u=function(z,O){return g.createElement(ne.Z,(0,M.Z)({},z,{ref:O,icon:_}))},B=g.forwardRef(u),d=B},31732:function(Se,A,t){var M=t(97857),g=t.n(M),Y=t(66309),_=t(62435),ne=t(86074);A.Z=function(u){var B=u.text,d=u.style;return(0,ne.jsx)(Y.Z,{style:g()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},d),children:B})}},24163:function(Se,A,t){var M=t(97857),g=t.n(M),Y=t(25593),_=t(83062),ne=t(62435),u=t(86074),B=Y.Z.Paragraph;A.Z=function(d){var X=d.text,z=d.width,O=d.maxWidth,k=d.rows,K=k===void 0?2:k,$=d.placement,oe=$===void 0?"top":$,G=d.color,x=G===void 0?"rgba(0, 0, 0, 0.88)":G,ie=d.link,q=ie===void 0?!1:ie,ae=d.onClickCallBackFunc,Q=d.style,ee=Q===void 0?{}:Q,T=d.copyable,me=T===void 0?!1:T;return(0,u.jsx)("div",{style:{maxWidth:O,width:z},children:(0,u.jsx)(_.Z,{title:(0,u.jsx)("div",{children:X}),placement:oe,children:(0,u.jsx)(B,{ellipsis:{rows:K},style:g()({marginBottom:0,color:x,cursor:q?"pointer":""},ee),onClick:ae,copyable:me,children:X})})})}},28235:function(Se,A,t){var M=t(97857),g=t.n(M),Y=t(25593),_=t(83062),ne=t(62435),u=t(86074),B=Y.Z.Paragraph;A.Z=function(d){var X=d.text,z=d.width,O=d.maxWidth,k=d.rows,K=k===void 0?2:k,$=d.placement,oe=$===void 0?"top":$,G=d.color,x=G===void 0?"rgba(0, 0, 0, 0.88)":G,ie=d.link,q=ie===void 0?!1:ie,ae=d.onClickCallBackFunc,Q=d.style,ee=Q===void 0?{}:Q,T=d.copyable,me=T===void 0?!1:T,ye=d.tooltipText;return(0,u.jsx)("div",{style:{maxWidth:O,width:z},children:(0,u.jsx)(_.Z,{title:ye,placement:oe,children:(0,u.jsx)(B,{ellipsis:{rows:K},style:g()({marginBottom:0,color:x,cursor:q?"pointer":""},ee),onClick:ae,copyable:me,children:X})})})}},59999:function(Se,A,t){t.d(A,{j:function(){return ne}});var M=t(62435),g=t(96486),Y=t.n(g),_=t(45830),ne=function(B){var d=B.platformList,X=B.form,z=B.onPlatformChange,O=B.requestResourceTypeList,k=B.requestCloudAccountBaseInfoList,K=B.platformFieldName,$=K===void 0?"platformList":K,oe=B.resourceTypeFieldName,G=oe===void 0?"resourceTypeList":oe,x=(0,_.useLocation)(),ie=x.search,q=new URLSearchParams(ie),ae=q.get("platform");(0,M.useEffect)(function(){var Q;if(!(!d||d.length===0)&&(0,g.isEmpty)(ae)){var ee=X.getFieldValue($);if((0,g.isEmpty)(ee)){var T=((Q=d[0])===null||Q===void 0?void 0:Q.value)||d[0];if(T){var me=[T];X.setFieldValue($,me),G&&X.setFieldValue(G,null),z&&z(me),O&&O(me),k&&k({platformList:me})}}}},[d,ae,X,z,O,k,$,G])}},64818:function(Se,A,t){var M=t(15009),g=t.n(M),Y=t(99289),_=t.n(Y),ne=t(5574),u=t.n(ne),B=t(62435),d=t(68872),X=t(66309),z=t(85265),O=t(57381),k=t(26412),K=t(25593),$=t(45830),oe=t(96655),G=t(29448),x=t(86074),ie=function(ae){var Q=ae.visible,ee=ae.onClose,T=ae.ruleId,me=ae.ruleCode,ye=(0,$.useIntl)(),we=d.ZP.useMessage(),je=u()(we,2),m=je[0],Dt=je[1],Ve=(0,B.useState)(!1),it=u()(Ve,2),r=it[0],j=it[1],p=(0,B.useState)(null),C=u()(p,2),h=C[0],te=C[1];(0,B.useEffect)(function(){Q&&T&&re()},[Q,T]);var re=function(){var fe=_()(g()().mark(function U(){var ge;return g()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(j(!0),Z.prev=1,!T){Z.next=6;break}return Z.next=5,(0,oe.queryRuleDetail)({id:T});case 5:ge=Z.sent;case 6:ge&&ge.content&&te(ge.content),Z.next=12;break;case 9:Z.prev=9,Z.t0=Z.catch(1),m.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return Z.prev=12,j(!1),Z.finish(12);case 15:case"end":return Z.stop()}},U,null,[[1,9,12,15]])}));return function(){return fe.apply(this,arguments)}}(),ve=function(){te(null),ee()},ue=function(U){switch(U.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},Te=function(U){if(!U)return null;var ge=U.split(",");return ge.map(function(pe,Z){return(0,x.jsx)(X.Z,{color:ue(pe.trim()),children:pe.trim()},Z)})},Pe=function(U){return(0,G.c5)(U)};return(0,x.jsxs)(x.Fragment,{children:[Dt,(0,x.jsx)(z.Z,{placement:"right",onClose:ve,open:Q,width:1e3,destroyOnClose:!0,children:(0,x.jsx)(O.Z,{spinning:r,children:h&&(0,x.jsxs)(k.Z,{column:1,bordered:!0,children:[(0,x.jsx)(k.Z.Item,{label:ye.formatMessage({id:"home.module.inform.columns.ruleName"},{}),children:(0,x.jsx)(K.Z.Text,{copyable:!0,children:h.ruleName})}),(0,x.jsx)(k.Z.Item,{label:"Code",children:(0,x.jsx)(K.Z.Text,{copyable:!0,children:h.ruleCode})}),(0,x.jsx)(k.Z.Item,{label:ye.formatMessage({id:"rule.module.text.repair.suggestions"},{}),children:(0,x.jsx)(K.Z.Text,{copyable:!0,children:h.advice})}),(0,x.jsx)(k.Z.Item,{label:ye.formatMessage({id:"rule.module.text.reference.link"},{}),children:(0,x.jsx)(K.Z.Text,{copyable:!0,children:h.link})}),(0,x.jsx)(k.Z.Item,{label:ye.formatMessage({id:"rule.module.text.risk.context.template"},{}),children:(0,x.jsx)(K.Z.Text,{copyable:!0,children:h.context})}),h.ruleRego&&(0,x.jsx)(k.Z.Item,{label:"Rego Policy",children:(0,x.jsx)(K.Z.Text,{copyable:{text:h.ruleRego},children:(0,x.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"2048px",overflow:"auto"},children:h.ruleRego})})}),h.gmtModified&&(0,x.jsx)(k.Z.Item,{label:ye.formatMessage({id:"common.text.update.time"},{}),children:(0,x.jsx)(K.Z.Text,{copyable:!0,children:h.gmtModified})})]})})})]})};A.Z=ie},14842:function(Se,A,t){t.r(A),t.d(A,{default:function(){return Ra}});var M=t(15009),g=t.n(M),Y=t(99289),_=t.n(Y),ne=t(5574),u=t.n(ne),B=t(79930),d=t(96655),X=t(59999),z=t(17910),O=t(29448),k=t(39380),K=t(93410),$=t(45830),oe=t(3303),G=t(68872),x=t(18922),ie=t(71230),q=t(15746),ae=t(84567),Q=t(34041),ee=t(42075),T=t(83622),me=t(92398),ye=t(68795),we=t(33160),je=t(96486),m=t(62435),Dt=t(13769),Ve=t.n(Dt),it=t(9783),r=t.n(it),j=t(97857),p=t.n(j),C=t(31732),h=t(24163),te=t(28235),re=t(64818),ve=t(87462),ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"},Te=ue,Pe=t(84089),fe=function(b,P){return m.createElement(Pe.Z,(0,ve.Z)({},b,{ref:P,icon:Te}))},U=m.forwardRef(fe),ge=U,pe=t(86548),Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},xt=Z,ut=function(b,P){return m.createElement(Pe.Z,(0,ve.Z)({},b,{ref:P,icon:xt}))},Rt=m.forwardRef(ut),ct=Rt,St=t(52745),Tt=t(24969),At=t(90498),ce=t(75302),Qe=t(83062),kt=t(55241),bt=t(86738),Ht=t(72269),$t=function(){return{style:{cursor:"pointer"},onMouseEnter:function(P){P.currentTarget.style.backgroundColor="#f5f5f5",P.currentTarget.style.transform="scale(1.01)",P.currentTarget.style.transition="all 0.2s ease",P.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)"},onMouseLeave:function(P){P.currentTarget.style.backgroundColor="",P.currentTarget.style.transform="scale(1)",P.currentTarget.style.boxShadow=""}}},wt=function(b){return function(P){return p()({onClick:function(){return b(P)}},$t())}},a=t(86074),Ut=["pageSize","current"],Vt=ce.ZP.useBreakpoint,Wt=function(b){var P=b.form,de=b.platformList,Ie=b.resourceTypeList,We=b.ruleGroupList,Mt=b.ruleTypeList,Oe=b.allRuleList,he=b.checkNewRules,Ze=b.newRulesCount,be=b.queryTrigger,le=G.ZP.useMessage(),dt=u()(le,2),W=dt[0],xe=dt[1],Le=Vt(),R=(0,m.useRef)(),jt=(0,m.useRef)(),c=(0,$.useIntl)(),F=(0,m.useState)(),Pt=u()(F,2),mt=Pt[0],Et=Pt[1],ft=(0,m.useState)({}),Je=u()(ft,2),_t=Je[0],Ft=Je[1],Jt=(0,m.useState)(!1),It=u()(Jt,2),vt=It[0],Xe=It[1],Ye=(0,m.useState)(),qe=u()(Ye,2),gt=qe[0],pt=qe[1],Ce=(0,m.useState)({}),Be=u()(Ce,2),Ne=Be[0],ht=Be[1],Kt=(0,m.useState)({}),et=u()(Kt,2),ze=et[0],De=et[1],Fe=(0,m.useState)({}),tt=u()(Fe,2),at=tt[0],Ke=tt[1],rt=(0,m.useState)([]),Ge=u()(rt,2),Ae=Ge[0],He=Ge[1],Ot=(0,m.useState)(!1),ke=u()(Ot,2),Zt=ke[0],Me=ke[1],Bt=(0,m.useState)(!1),Re=u()(Bt,2),lt=Re[0],$e=Re[1],Ct=(0,m.useState)(!1),st=u()(Ct,2),J=st[0],D=st[1],H=(0,m.useState)(!1),nt=u()(H,2),se=nt[0],Gt=nt[1];(0,m.useEffect)(function(){if(be!==void 0&&be>0){var f;(f=R.current)===null||f===void 0||f.reload()}},[be]);var Xt=function(i){return i.id===mt?"ant-table-row-selected":""},Yt=function(i){pt(i.id),Xe(!0)},qt=function(){Xe(!1),pt(void 0)},ea=function(){var f=_()(g()().mark(function i(e){var s,n,v,y;return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return s=W.loading(c.formatMessage({id:"common.message.text.delete.loading"})),l.next=3,(0,d.deleteRule)({id:e});case 3:n=l.sent,s(),(n.code===200||n.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.delete.success"})),(v=R.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v));case 6:case"end":return l.stop()}},i)}));return function(e){return f.apply(this,arguments)}}(),ta=function(){var f=_()(g()().mark(function i(e){var s,n,v,y;return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return ht(p()(p()({},Ne),{},r()({},e,!0))),s=W.loading(c.formatMessage({id:"common.message.text.copy.loading"})),l.next=4,(0,d.copyRule)({id:e});case 4:n=l.sent,ht(p()(p()({},Ne),{},r()({},e,!1))),s(),(n.code===200||n.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.copy.success"})),(v=R.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v));case 8:case"end":return l.stop()}},i)}));return function(e){return f.apply(this,arguments)}}(),aa=function(){var f=_()(g()().mark(function i(e){var s,n,v,y;return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return s=e.id,De(p()(p()({},ze),{},r()({},s,!0))),l.prev=2,l.next=5,(0,d.addTenantSelectRule)({ruleCode:e.ruleCode});case 5:n=l.sent,(n.code===200||n.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.success"})),(v=R.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v)),l.next=12;break;case 9:l.prev=9,l.t0=l.catch(2),W.error(c.formatMessage({id:"common.message.text.failed"}));case 12:return l.prev=12,De(p()(p()({},ze),{},r()({},s,!1))),l.finish(12);case 15:case"end":return l.stop()}},i,null,[[2,9,12,15]])}));return function(e){return f.apply(this,arguments)}}(),I=function(){var f=_()(g()().mark(function i(e){var s,n,v,y;return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return s=e.id,Ke(p()(p()({},at),{},r()({},s,!0))),l.prev=2,l.next=5,(0,d.removeTenantSelectRule)({ruleCode:e.ruleCode});case 5:n=l.sent,(n.code===200||n.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.success"})),(v=R.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v)),l.next=12;break;case 9:l.prev=9,l.t0=l.catch(2),W.error(c.formatMessage({id:"common.message.text.failed"}));case 12:return l.prev=12,Ke(p()(p()({},at),{},r()({},s,!1))),l.finish(12);case 15:case"end":return l.stop()}},i,null,[[2,9,12,15]])}));return function(e){return f.apply(this,arguments)}}(),E=function(){var f=_()(g()().mark(function i(){var e,s,n,v,y;return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(Gt(!0),l.prev=1,e=Oe==null?void 0:Oe.filter(function(V){return Ae.includes(V.id)}),s=(e==null?void 0:e.map(function(V){return V.ruleCode}))||[],s.length!==0){l.next=7;break}return W.warning(c.formatMessage({id:"common.message.text.no.valid.data"})),l.abrupt("return");case 7:return l.next=9,(0,d.batchAddTenantSelectRule)({ruleCodeList:s});case 9:n=l.sent,(n.code===200||n.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.success"})),(v=R.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v),He([])),l.next=16;break;case 13:l.prev=13,l.t0=l.catch(1),W.error(c.formatMessage({id:"common.message.text.failed"}));case 16:return l.prev=16,Gt(!1),l.finish(16);case 19:case"end":return l.stop()}},i,null,[[1,13,16,19]])}));return function(){return f.apply(this,arguments)}}(),o=function(i){D(!0),(0,d.queryExportRuleList)(i?{idList:i}:void 0,{responseType:"blob"}).then(function(e){(0,O.a5)(e,"CloudRec ".concat(c.formatMessage({id:"rule.module.text.rule.data"}))),W.success(c.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return D(!1)})},S=function(){var f=_()(g()().mark(function i(e,s){var n,v,y,L;return g()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return n={id:e,status:s},V.next=3,(0,d.changeRuleStatus)(n);case 3:v=V.sent,(v.code===200||v.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.edit.success"})),(y=R.current)===null||y===void 0||(L=y.reloadAndRest)===null||L===void 0||L.call(y));case 5:case"end":return V.stop()}},i)}));return function(e,s){return f.apply(this,arguments)}}(),w=[{title:c.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(i,e){var s,n,v=(e==null?void 0:e.selectedTenantNameList)&&e.selectedTenantNameList.length>0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,a.jsx)(te.Z,{placement:"topLeft",maxWidth:Le!=null&&Le.xxl?600:400,rows:1,text:(e==null?void 0:e.ruleName)||"-",style:{fontWeight:500,color:"rgb(58, 58, 58)"}}),v&&(0,a.jsx)(Qe.Z,{title:(0,a.jsx)("div",{children:(s=e.selectedTenantNameList)===null||s===void 0?void 0:s.map(function(y,L){return(0,a.jsxs)("div",{style:{fontSize:12},children:["\u2022 ",y]},L)})}),placement:"topRight",children:(0,a.jsx)(ge,{style:{color:"#1890ff",fontSize:14,cursor:"pointer"}})})]}),(0,a.jsx)(h.Z,{placement:"topLeft",maxWidth:Le!=null&&Le.xxl?600:400,rows:1,text:(e==null||(n=e.ruleTypeNameList)===null||n===void 0?void 0:n.toString())||"-",style:{color:"rgb(166, 167, 167)",fontSize:13}})]})}},{title:c.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(i,e){return(0,a.jsx)(C.Z,{text:(e==null?void 0:e.resourceTypeStr)||"-"})}},{title:c.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,O.W_)(z.I9),align:"center",hideInSearch:!0,render:function(i,e){return(0,O.Dd)(z.I9,e==null?void 0:e.riskLevel)}},{title:c.formatMessage({id:"common.table.columns.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(i,e){return(0,a.jsxs)("div",{children:[(0,a.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,a.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:c.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,O.W_)(de),align:"center",hideInSearch:!0,render:function(i,e){return(0,O.c5)(e.platform,de)}},{title:c.formatMessage({id:"rule.input.text.rule.group.creator"}),dataIndex:"username",valueType:"text",hideInSearch:!0,width:120},{title:c.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(i,e){return(0,a.jsxs)(ee.Z,{size:"small",children:[(0,a.jsx)(T.ZP,{size:"small",onClick:function(n){n.stopPropagation(),Et(e.id)},type:"link",target:"_self",href:"/ruleManagement/ruleProject/edit?id=".concat(e==null?void 0:e.id),children:(0,a.jsx)(Qe.Z,{title:c.formatMessage({id:"common.button.text.edit"}),children:(0,a.jsx)(pe.Z,{})})}),(0,a.jsx)(kt.Z,{content:(0,a.jsxs)(ee.Z,{children:[(0,a.jsx)(bt.Z,{title:c.formatMessage({id:"common.button.text.delete.confirm"}),onConfirm:function(n){n==null||n.stopPropagation(),ea(e.id)},okText:c.formatMessage({id:"common.button.text.ok"}),cancelText:c.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(T.ZP,{block:!0,type:"link",danger:!0,size:"small",onClick:function(n){return n.stopPropagation()},children:c.formatMessage({id:"common.button.text.delete"})})}),(0,a.jsx)(T.ZP,{block:!0,loading:Ne[Number(e.id)],onClick:function(n){n.stopPropagation(),ta(e.id)},type:"link",target:"_blank",size:"small",children:c.formatMessage({id:"common.button.text.copy"})})]}),children:(0,a.jsx)(T.ZP,{type:"link",icon:(0,a.jsx)(ct,{}),onClick:function(n){return n.stopPropagation()}})}),e.tenantSelected?(0,a.jsx)(bt.Z,{title:c.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(n){n==null||n.stopPropagation(),I(e)},onCancel:function(n){return n==null?void 0:n.stopPropagation()},okText:c.formatMessage({id:"common.button.text.ok"}),cancelText:c.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(T.ZP,{type:"default",size:"small",loading:at[Number(e.id)],onClick:function(n){return n.stopPropagation()},icon:(0,a.jsx)(St.Z,{}),danger:!0})}):(0,a.jsx)(T.ZP,{type:"primary",size:"small",loading:ze[Number(e.id)],onClick:function(n){n.stopPropagation(),aa(e)},icon:(0,a.jsx)(Tt.Z,{})}),(0,a.jsx)(Qe.Z,{title:c.formatMessage({id:"rule.module.text.tooltip.status"}),children:(0,a.jsx)(Ht.Z,{checked:(e==null?void 0:e.status)==="valid",onClick:function(n,v){v==null||v.stopPropagation(),S(e.id,(e==null?void 0:e.status)==="valid"?"invalid":"valid")}})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[xe,(0,a.jsx)(At.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:Ae,onChange:function(i){return He(i)},preserveSelectedRowKeys:!0},actionRef:R,formRef:jt,rowClassName:Xt,rowKey:"id",search:!1,toolBarRender:function(){return[(0,a.jsx)(T.ZP,{type:"primary",href:"/ruleManagement/ruleProject/edit",children:c.formatMessage({id:"rule.extend.basic.add"})},"CREATE"),(0,a.jsx)(kt.Z,{open:Zt,onOpenChange:function(e){return Me(e)},title:c.formatMessage({id:"rule.module.text.sync.confirm"}),content:(0,a.jsxs)(ee.Z,{children:[(0,a.jsx)(T.ZP,{danger:!0,type:"default",loading:lt,onClick:_()(g()().mark(function i(){var e,s,n,v;return g()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return $e(!0),e=W.loading(c.formatMessage({id:"rule.module.text.sync.loading"})),L.prev=2,L.next=5,(0,d.loadRuleFromGithub)({coverage:!0});case 5:s=L.sent,(s.code===200||s.msg==="success")&&(W.success(c.formatMessage({id:"rule.module.text.sync.success"})),(n=R.current)===null||n===void 0||(v=n.reloadAndRest)===null||v===void 0||v.call(n),he());case 7:return L.prev=7,e(),$e(!1),Me(!1),L.finish(7);case 12:case"end":return L.stop()}},i,null,[[2,,7,12]])})),children:c.formatMessage({id:"rule.module.text.sync.overwrite"})}),(0,a.jsx)(T.ZP,{type:"default",loading:lt,onClick:_()(g()().mark(function i(){var e,s,n,v;return g()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return $e(!0),e=W.loading(c.formatMessage({id:"rule.module.text.sync.loading"})),L.prev=2,L.next=5,(0,d.loadRuleFromGithub)({coverage:!1});case 5:s=L.sent,(s.code===200||s.msg==="success")&&(W.success(c.formatMessage({id:"rule.module.text.sync.success"})),(n=R.current)===null||n===void 0||(v=n.reloadAndRest)===null||v===void 0||v.call(n),he());case 7:return L.prev=7,e(),$e(!1),Me(!1),L.finish(7);case 12:case"end":return L.stop()}},i,null,[[2,,7,12]])})),children:c.formatMessage({id:"rule.module.text.sync.no.overwrite"})}),(0,a.jsx)(T.ZP,{onClick:function(){Me(!1)},children:c.formatMessage({id:"common.button.text.cancel"})})]}),trigger:"click",children:(0,a.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,a.jsx)(T.ZP,{type:"default",children:c.formatMessage({id:"rule.module.text.sync.button"})}),Ze>0&&(0,a.jsx)("div",{style:{position:"absolute",top:"-8px",right:"-8px",backgroundColor:"#ff4d4f",color:"white",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",zIndex:1},children:Ze>99?"99+":Ze})]})},"sync"),(0,a.jsx)(T.ZP,{type:"default",loading:se,disabled:Ae.length===0,onClick:E,children:c.formatMessage({id:"rule.module.text.batch.add.to.favorites"})},"BATCH_ADD_TO_FAVORITES"),(0,a.jsx)(T.ZP,{loading:J,type:"default",disabled:Ae.length===0,onClick:function(){return o(Ae)},children:c.formatMessage({id:"common.button.text.export"})},"EXPORT")]},request:function(){var f=_()(g()().mark(function i(e,s){var n,v,y,L,l,V,N,ra,ot,na;return g()().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:return n=e.pageSize,v=e.current,y=Ve()(e,Ut),L=P.getFieldsValue(),l=(0,O.Hm)(s),V=p()(p()(p()({},y),L),{},{page:v,size:n}),(0,je.isEmpty)(l)||(V.sortParam=l==null?void 0:l.key,V.sortType=l==null||(N=l.value)===null||N===void 0||(N=N.slice(0,-3))===null||N===void 0?void 0:N.toUpperCase()),yt.next=7,(0,d.queryRuleList)(V);case 7:return ra=yt.sent,ot=ra.content,na=ra.code,yt.abrupt("return",{data:(ot==null?void 0:ot.data)||[],total:(ot==null?void 0:ot.total)||0,success:na===200||!1});case 11:case"end":return yt.stop()}},i)}));return function(i,e){return f.apply(this,arguments)}}(),columns:w,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:wt(Yt)}),(0,a.jsx)(re.Z,{visible:vt,onClose:qt,ruleId:gt})]})},Ue=Wt,Qt=t(53846),Ee=t(90598),Nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 01-12.7-6.5V353.7a8 8 0 0112.7-6.5L656.1 506a7.9 7.9 0 010 12.9z"}}]},name:"play-circle",theme:"filled"},Lt=Nt,oa=function(b,P){return m.createElement(Pe.Z,(0,ve.Z)({},b,{ref:P,icon:Lt}))},ia=m.forwardRef(oa),ua=ia,ca={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},da=ca,ma=function(b,P){return m.createElement(Pe.Z,(0,ve.Z)({},b,{ref:P,icon:da}))},fa=m.forwardRef(ma),va=fa,zt=t(78045),ga=["pageSize","current"],pa=ce.ZP.useBreakpoint,ha=function(b){var P=b.form,de=b.platformList,Ie=b.resourceTypeList,We=b.ruleGroupList,Mt=b.ruleTypeList,Oe=b.allRuleList,he=b.queryTrigger,Ze=G.ZP.useMessage(),be=u()(Ze,2),le=be[0],dt=be[1],W=pa(),xe=(0,m.useRef)(),Le=(0,m.useRef)(),R=(0,$.useIntl)(),jt=(0,m.useState)(),c=u()(jt,2),F=c[0],Pt=c[1],mt=(0,m.useState)({}),Et=u()(mt,2),ft=Et[0],Je=Et[1],_t=(0,m.useState)({}),Ft=u()(_t,2),Jt=Ft[0],It=Ft[1],vt=(0,m.useState)({}),Xe=u()(vt,2),Ye=Xe[0],qe=Xe[1],gt=(0,m.useState)([]),pt=u()(gt,2),Ce=pt[0],Be=pt[1],Ne=(0,m.useState)(!1),ht=u()(Ne,2),Kt=ht[0],et=ht[1],ze=(0,m.useState)(!1),De=u()(ze,2),Fe=De[0],tt=De[1],at=(0,m.useState)(!1),Ke=u()(at,2),rt=Ke[0],Ge=Ke[1],Ae=(0,m.useState)(),He=u()(Ae,2),Ot=He[0],ke=He[1],Zt=(0,m.useState)(!0),Me=u()(Zt,2),Bt=Me[0],Re=Me[1],lt=(0,m.useState)(!1),$e=u()(lt,2),Ct=$e[0],st=$e[1],J=(0,m.useState)("all"),D=u()(J,2),H=D[0],nt=D[1],se=function(E){return E.id===F?"ant-table-row-selected":""},Gt=function(E){ke(E.id),Ge(!0)};(0,m.useEffect)(function(){if(he!==void 0&&he>0){var I;(I=xe.current)===null||I===void 0||I.reload()}},[he]);var Xt=function(){var I=_()(g()().mark(function E(o){var S,w,f,i;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return Je(p()(p()({},ft),{},r()({},o,!0))),S=le.loading(R.formatMessage({id:"common.message.text.execute.loading"})),s.next=4,(0,d.scanByRule)({id:o});case 4:w=s.sent,Je(p()(p()({},ft),{},r()({},o,!1))),S(),(w.code===200||w.msg==="success")&&(le.success(R.formatMessage({id:"common.message.text.execute.success"})),(f=xe.current)===null||f===void 0||(i=f.reloadAndRest)===null||i===void 0||i.call(f));case 8:case"end":return s.stop()}},E)}));return function(o){return I.apply(this,arguments)}}(),Yt=function(){var I=_()(g()().mark(function E(o){var S,w,f,i;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return S=o.id,qe(p()(p()({},Ye),{},r()({},S,!0))),s.prev=2,s.next=5,(0,d.removeTenantSelectRule)({ruleCode:o.ruleCode});case 5:w=s.sent,(w.code===200||w.msg==="success")&&(le.success(R.formatMessage({id:"common.message.text.success"})),(f=xe.current)===null||f===void 0||(i=f.reloadAndRest)===null||i===void 0||i.call(f)),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),le.error(R.formatMessage({id:"common.message.text.fail"}));case 12:return s.prev=12,qe(p()(p()({},Ye),{},r()({},S,!1))),s.finish(12);case 15:case"end":return s.stop()}},E,null,[[2,9,12,15]])}));return function(o){return I.apply(this,arguments)}}(),qt=function(){var I=_()(g()().mark(function E(){var o,S,w,f;return g()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ce.length!==0){e.next=2;break}return e.abrupt("return");case 2:return et(!0),e.prev=3,o=Ce.map(function(s){return Number(s)}),e.next=7,(0,d.scanRuleList)({idList:o});case 7:S=e.sent,(S.code===200||S.msg==="success")&&(le.success(R.formatMessage({id:"common.message.text.success"})),Be([]),(w=xe.current)===null||w===void 0||(f=w.reloadAndRest)===null||f===void 0||f.call(w)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),le.error(R.formatMessage({id:"common.message.text.fail"}));case 14:return e.prev=14,et(!1),e.finish(14);case 17:case"end":return e.stop()}},E,null,[[3,11,14,17]])}));return function(){return I.apply(this,arguments)}}(),ea=function(){var I=_()(g()().mark(function E(){var o,S,w,f,i,e,s,n,v,y;return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(Ce.length!==0){l.next=2;break}return l.abrupt("return");case 2:return tt(!0),l.prev=3,S=P.getFieldsValue(),w={page:1,size:1e3,platformList:S.platformList,riskLevelList:S.riskLevelList,ruleCodeList:S.ruleCodeList,resourceTypeList:S.resourceTypeList,ruleGroupIdList:S.ruleGroupIdList,ruleTypeIdList:S.ruleTypeIdList},l.next=8,(0,d.queryEffectRuleList)(w);case 8:return f=l.sent,i=(f==null||(o=f.content)===null||o===void 0?void 0:o.data)||[],e=i.filter(function(V){return Ce.includes(V.id)}),s=e.map(function(V){return V.ruleCode}),l.next=14,(0,d.batchDeleteTenantSelectRule)({ruleCodeList:s});case 14:n=l.sent,(n.code===200||n.msg==="success")&&(le.success(R.formatMessage({id:"common.message.text.success"})),Be([]),(v=xe.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v)),l.next=21;break;case 18:l.prev=18,l.t0=l.catch(3),le.error(R.formatMessage({id:"common.message.text.fail"}));case 21:return l.prev=21,tt(!1),l.finish(21);case 24:case"end":return l.stop()}},E,null,[[3,18,21,24]])}));return function(){return I.apply(this,arguments)}}(),ta=function(){var I=_()(g()().mark(function E(o,S){var w,f,i,e,s,n,v,y,L,l;return g()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return w=o.pageSize,f=o.current,i=Ve()(o,ga),N.prev=1,e=P.getFieldsValue(),s=p()({page:f||1,size:w||10,platformList:e.platformList,riskLevelList:e.riskLevelList,ruleCodeList:e.ruleCodeList,resourceTypeList:e.resourceTypeList,ruleGroupIdList:e.ruleGroupIdList,ruleTypeIdList:e.ruleTypeIdList,effectRuleType:H},i),S&&Object.keys(S).length>0&&(n=Object.keys(S)[0],v=S[n],s.sortParam=n,s.sortType=v==="ascend"?"ASC":"DESC"),N.next=7,(0,d.queryEffectRuleList)(s);case 7:if(y=N.sent,!(y!=null&&y.content)){N.next=16;break}return L=y.content.data||[],l=y.content.total||0,Re(l>0),st(!0),N.abrupt("return",{data:L,total:l,success:!0});case 16:return Re(!1),st(!0),N.abrupt("return",{data:[],total:0,success:!1});case 19:N.next=26;break;case 21:return N.prev=21,N.t0=N.catch(1),Re(!1),st(!0),N.abrupt("return",{data:[],total:0,success:!1});case 26:case"end":return N.stop()}},E,null,[[1,21]])}));return function(o,S){return I.apply(this,arguments)}}(),aa=[{title:R.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(E,o){var S;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{fontWeight:500,color:"rgb(58, 58, 58)",display:"flex",alignItems:"center",gap:"8px"},children:[(0,a.jsx)("span",{children:(o==null?void 0:o.ruleName)||"-"}),(o==null?void 0:o.defaultRuleSelected)&&(0,a.jsx)(Qe.Z,{title:"default",children:(0,a.jsx)(Ee.Z,{style:{color:"#faad14",fontSize:"14px"}})})]}),(0,a.jsx)("div",{style:{color:"rgb(166, 167, 167)",fontSize:13},children:(o==null||(S=o.ruleTypeNameList)===null||S===void 0?void 0:S.toString())||"-"})]})}},{title:R.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(E,o){return(0,a.jsx)(C.Z,{text:(o==null?void 0:o.resourceTypeStr)||"-"})}},{title:R.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,O.W_)(z.I9),align:"center",hideInSearch:!0,render:function(E,o){return(0,O.Dd)(z.I9,o==null?void 0:o.riskLevel)}},{title:R.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,O.W_)(de),align:"center",hideInSearch:!0,render:function(E,o){return(0,O.c5)(o.platform,de)}},{title:R.formatMessage({id:"asset.module.risk.number"}),dataIndex:"riskCount",valueType:"text",hideInSearch:!0,align:"center",sorter:!0,render:function(E,o){return(0,a.jsx)(T.ZP,{type:"link",size:"small",href:"/riskManagement/riskList?platform=".concat(o==null?void 0:o.platform,"&ruleCode=").concat(o==null?void 0:o.ruleCode),children:o==null?void 0:o.riskCount})}},{title:R.formatMessage({id:"cloudAccount.extend.title.lastScanTime"}),dataIndex:"lastScanTime",valueType:"text",hideInSearch:!0,align:"center",width:150,sorter:!0,render:function(E,o){return o!=null&&o.lastScanTime?(0,a.jsx)(Qe.Z,{title:o.lastScanTime,children:(0,a.jsx)("span",{children:o.lastScanTime})}):"-"}},{title:R.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",width:180,render:function(E,o){var S=o==null?void 0:o.isRunning,w=S===0,f=function(){return S===1?(0,a.jsx)(ua,{}):(0,a.jsx)(va,{})};return(0,a.jsxs)(ee.Z,{size:"small",children:[(0,a.jsx)(T.ZP,{block:!0,loading:ft[Number(o.id)],disabled:!w,onClick:function(e){e.stopPropagation(),Xt(o.id)},type:"default",target:"_blank",size:"small",icon:f(),style:{color:S===1?"#52c41a":void 0,borderColor:S===1?"#52c41a":void 0},children:R.formatMessage({id:S===1?"common.button.text.running":"common.button.text.test"})}),H==="selected"&&(0,a.jsx)(bt.Z,{title:R.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(e){e==null||e.stopPropagation(),Yt(o)},onCancel:function(e){return e==null?void 0:e.stopPropagation()},okText:R.formatMessage({id:"common.button.text.ok"}),cancelText:R.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(T.ZP,{danger:!0,size:"small",loading:Ye[Number(o.id)],disabled:S===1,icon:(0,a.jsx)(St.Z,{}),onClick:function(e){return e.stopPropagation()}})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[dt,(0,a.jsx)(At.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:Ce,onChange:function(E){return Be(E)},preserveSelectedRowKeys:!0},headerTitle:(0,a.jsx)("div",{className:Qt.Z.customTitle,children:(0,a.jsx)(ee.Z,{children:(0,a.jsxs)(zt.ZP.Group,{value:H,onChange:function(E){var o;nt(E.target.value),Be([]),(o=xe.current)===null||o===void 0||o.reload()},size:"middle",buttonStyle:"solid",children:[(0,a.jsx)(zt.ZP.Button,{value:"all",children:R.formatMessage({id:"common.module.text.all"})}),(0,a.jsx)(zt.ZP.Button,{value:"selected",children:R.formatMessage({id:"common.module.text.selected"})}),(0,a.jsx)(zt.ZP.Button,{value:"default",children:R.formatMessage({id:"common.module.text.default"})})]})})}),actionRef:xe,formRef:Le,rowClassName:se,rowKey:"id",search:!1,toolBarRender:function(){return[(0,a.jsx)(T.ZP,{type:"primary",loading:Kt,disabled:Ce.length===0,onClick:qt,children:R.formatMessage({id:"rule.module.text.batch.test"})},"BATCH_DETECT"),H==="selected"&&(0,a.jsx)(T.ZP,{danger:!0,loading:Fe,disabled:Ce.length===0,onClick:ea,children:R.formatMessage({id:"rule.module.text.batch.remove"})},"BATCH_REMOVE")].filter(Boolean)},request:ta,columns:aa,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:wt(Gt)}),(0,a.jsx)(re.Z,{visible:rt,onClose:function(){return Ge(!1)},ruleId:Ot})]})},Ca=ha,la=t(61194),sa=oe.Z.SHOW_CHILD,ya=function(b,P){var de,Ie,We=b.toLowerCase(),Mt=((de=P.label)===null||de===void 0?void 0:de.toLowerCase())||"",Oe=((Ie=P.value)===null||Ie===void 0?void 0:Ie.toLowerCase())||"";return Mt.includes(We)||Oe.includes(We)},xa=function(){var b=(0,$.useModel)("rule"),P=b.platformList,de=b.ruleTypeList,Ie=b.allRuleList,We=b.ruleGroupList,Mt=(0,$.useLocation)(),Oe=Mt.search,he=new URLSearchParams(Oe),Ze=he.get("groupId"),be=he.get("ruleCode"),le=he.get("platform"),dt=G.ZP.useMessage(),W=u()(dt,2),xe=W[0],Le=W[1],R=x.Z.useForm(),jt=u()(R,1),c=jt[0],F=(0,$.useIntl)(),Pt=(0,m.useState)(!1),mt=u()(Pt,2),Et=mt[0],ft=mt[1],Je=(0,m.useState)(!1),_t=u()(Je,2),Ft=_t[0],Jt=_t[1],It=(0,m.useState)(0),vt=u()(It,2),Xe=vt[0],Ye=vt[1],qe=(0,m.useState)(!1),gt=u()(qe,2),pt=gt[0],Ce=gt[1],Be=(0,m.useState)([]),Ne=u()(Be,2),ht=Ne[0],Kt=Ne[1],et=(0,m.useState)([]),ze=u()(et,2),De=ze[0],Fe=ze[1],tt=he.get("tab"),at=(0,m.useState)(tt||"selected"),Ke=u()(at,2),rt=Ke[0],Ge=Ke[1];(0,m.useEffect)(function(){var J=he.get("tab");J&&J!==rt&&Ge(J)},[Oe,rt]);var Ae=(0,m.useState)(!1),He=u()(Ae,2),Ot=He[0],ke=He[1],Zt=(0,m.useState)(0),Me=u()(Zt,2),Bt=Me[0],Re=Me[1],lt=function(){var J=_()(g()().mark(function D(){var H;return g()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.prev=0,se.next=3,(0,d.checkExistNewRule)();case 3:H=se.sent,H.code===200&&typeof H.content=="number"&&Ye(H.content),se.next=10;break;case 7:se.prev=7,se.t0=se.catch(0),console.error("Failed to check new rules:",se.t0);case 10:case"end":return se.stop()}},D,null,[[0,7]])}));return function(){return J.apply(this,arguments)}}(),$e=(0,$.useRequest)(function(J){return(0,B.queryGroupTypeList)({platformList:J})},{manual:!0,formatResult:function(D){var H=D.content;Fe(H||[])}}),Ct=$e.run,st=function(D){Ce(!0),(0,d.queryExportRuleList)(D?{idList:D}:void 0,{responseType:"blob"}).then(function(H){(0,O.a5)(H,"CloudRec ".concat(F.formatMessage({id:"rule.module.text.rule.data"}))),xe.success(F.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return Ce(!1)})};return(0,m.useEffect)(function(){(0,je.isEmpty)(Ze)||c.setFieldValue("ruleGroupIdList",[Number(Ze)]),(0,je.isEmpty)(be)||c.setFieldValue("ruleCodeList",[be]),(0,je.isEmpty)(le)||(c.setFieldValue("platformList",[le]),Ct([le])),lt()},[Ze,be,le]),(0,X.j)({platformList:P,form:c,requestResourceTypeList:function(D){Fe([]),Ct(D)},platformFieldName:"platformList",resourceTypeFieldName:"resourceTypeList"}),(0,a.jsxs)(k._z,{ghost:!0,title:!1,className:la.Z.rulePageContainer,breadcrumbRender:!1,children:[Le,(0,a.jsx)(K.Z,{bodyStyle:{paddingBottom:0},className:la.Z.customFilterCard,children:(0,a.jsx)(x.Z,{form:c,children:(0,a.jsxs)(ie.Z,{gutter:[24,10],style:{marginBottom:20},children:[(0,a.jsx)(q.Z,{span:24,children:(0,a.jsx)(x.Z.Item,{name:"platformList",label:F.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,a.jsx)(ae.Z.Group,{options:(0,O.T$)(P),onChange:function(D){var H=D||[];c.setFieldValue("resourceTypeList",null),Fe([]),Ct(H),Re(function(nt){return nt+1})}})})}),(0,a.jsx)(q.Z,{span:24,children:(0,a.jsx)(x.Z.Item,{name:"riskLevelList",label:F.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,a.jsx)(ae.Z.Group,{options:(0,O.at)(z.I9)})})}),(0,a.jsx)(q.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{name:"resourceTypeList",label:F.formatMessage({id:"cloudAccount.extend.title.asset.type"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(oe.Z,{options:De,multiple:!0,placeholder:F.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:sa,allowClear:!0,showSearch:!0})})}),(0,a.jsx)(q.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{name:"ruleTypeIdList",label:F.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(oe.Z,{placeholder:F.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:sa,allowClear:!0,showSearch:!0,fieldNames:{label:"typeName",value:"id",children:"childList"},multiple:!0,options:de||[]})})}),(0,a.jsx)(q.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{name:"ruleGroupIdList",label:F.formatMessage({id:"layout.routes.title.ruleGroup"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(Q.Z,{placeholder:F.formatMessage({id:"common.select.text.placeholder"}),options:We,allowClear:!0,mode:"multiple"})})}),(0,a.jsx)(q.Z,{span:18,children:(0,a.jsx)(x.Z.Item,{name:"ruleCodeList",label:F.formatMessage({id:"home.module.inform.columns.ruleName"}),style:{marginBottom:0},children:(0,a.jsx)(Q.Z,{filterOption:ya,placeholder:F.formatMessage({id:"common.select.text.placeholder"}),allowClear:!0,options:Ie,mode:"multiple"})})}),(0,a.jsx)(q.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{style:{marginBottom:0,textAlign:"right"},children:(0,a.jsxs)(ee.Z,{children:[(0,a.jsx)(T.ZP,{type:"primary",icon:(0,a.jsx)(ye.Z,{}),loading:Ot,onClick:function(){ke(!0),Re(function(D){return D+1}),setTimeout(function(){ke(!1)},500)},children:F.formatMessage({id:"common.button.text.query"})}),(0,a.jsx)(T.ZP,{icon:(0,a.jsx)(we.Z,{}),onClick:function(){c.resetFields(),Fe([]),ke(!0),Re(function(D){return D+1}),setTimeout(function(){ke(!1)},500)},children:F.formatMessage({id:"common.button.text.reset"})})]})})})]})})}),(0,a.jsx)(K.Z,{style:{marginTop:16},children:(0,a.jsx)(me.Z,{activeKey:rt,onChange:function(D){Ge(D),Re(function(H){return H+1})},items:[{key:"selected",label:F.formatMessage({id:"rule.module.text.selected.rules"}),children:(0,a.jsx)(Ca,{form:c,platformList:P,resourceTypeList:De,ruleGroupList:We,ruleTypeList:de,allRuleList:Ie,queryTrigger:Bt})},{key:"market",label:F.formatMessage({id:"rule.module.text.market.rules"}),children:(0,a.jsx)(Ue,{form:c,platformList:P,resourceTypeList:De,ruleGroupList:We,ruleTypeList:de,allRuleList:Ie,checkNewRules:lt,newRulesCount:Xe,queryTrigger:Bt})}]})})]})},Ra=xa},53846:function(Se,A){A.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},61194:function(Se,A){A.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}},75302:function(Se,A,t){var M=t(25378);function g(){return(0,M.Z)()}A.ZP={useBreakpoint:g}},66309:function(Se,A,t){t.d(A,{Z:function(){return it}});var M=t(62435),g=t(93967),Y=t.n(g),_=t(98423),ne=t(98787),u=t(69760),B=t(96159),d=t(45353),X=t(53124),z=t(861),O=t(15063),k=t(14747),K=t(83262),$=t(83559);const oe=r=>{const{paddingXXS:j,lineWidth:p,tagPaddingHorizontal:C,componentCls:h,calc:te}=r,re=te(C).sub(p).equal(),ve=te(j).sub(p).equal();return{[h]:Object.assign(Object.assign({},(0,k.Wf)(r)),{display:"inline-block",height:"auto",marginInlineEnd:r.marginXS,paddingInline:re,fontSize:r.tagFontSize,lineHeight:r.tagLineHeight,whiteSpace:"nowrap",background:r.defaultBg,border:`${(0,z.unit)(r.lineWidth)} ${r.lineType} ${r.colorBorder}`,borderRadius:r.borderRadiusSM,opacity:1,transition:`all ${r.motionDurationMid}`,textAlign:"start",position:"relative",[`&${h}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:r.defaultColor},[`${h}-close-icon`]:{marginInlineStart:ve,fontSize:r.tagIconSize,color:r.colorIcon,cursor:"pointer",transition:`all ${r.motionDurationMid}`,"&:hover":{color:r.colorTextHeading}},[`&${h}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${r.iconCls}-close, ${r.iconCls}-close:hover`]:{color:r.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${h}-checkable-checked):hover`]:{color:r.colorPrimary,backgroundColor:r.colorFillSecondary},"&:active, &-checked":{color:r.colorTextLightSolid},"&-checked":{backgroundColor:r.colorPrimary,"&:hover":{backgroundColor:r.colorPrimaryHover}},"&:active":{backgroundColor:r.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${r.iconCls} + span, > span + ${r.iconCls}`]:{marginInlineStart:re}}),[`${h}-borderless`]:{borderColor:"transparent",background:r.tagBorderlessBg}}},G=r=>{const{lineWidth:j,fontSizeIcon:p,calc:C}=r,h=r.fontSizeSM;return(0,K.mergeToken)(r,{tagFontSize:h,tagLineHeight:(0,z.unit)(C(r.lineHeightSM).mul(h).equal()),tagIconSize:C(p).sub(C(j).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:r.defaultBg})},x=r=>({defaultBg:new O.FastColor(r.colorFillQuaternary).onBackground(r.colorBgContainer).toHexString(),defaultColor:r.colorText});var ie=(0,$.I$)("Tag",r=>{const j=G(r);return oe(j)},x),q=function(r,j){var p={};for(var C in r)Object.prototype.hasOwnProperty.call(r,C)&&j.indexOf(C)<0&&(p[C]=r[C]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,C=Object.getOwnPropertySymbols(r);h<C.length;h++)j.indexOf(C[h])<0&&Object.prototype.propertyIsEnumerable.call(r,C[h])&&(p[C[h]]=r[C[h]]);return p},Q=M.forwardRef((r,j)=>{const{prefixCls:p,style:C,className:h,checked:te,children:re,icon:ve,onChange:ue,onClick:Te}=r,Pe=q(r,["prefixCls","style","className","checked","children","icon","onChange","onClick"]),{getPrefixCls:fe,tag:U}=M.useContext(X.E_),ge=ct=>{ue==null||ue(!te),Te==null||Te(ct)},pe=fe("tag",p),[Z,xt,ut]=ie(pe),Rt=Y()(pe,`${pe}-checkable`,{[`${pe}-checkable-checked`]:te},U==null?void 0:U.className,h,xt,ut);return Z(M.createElement("span",Object.assign({},Pe,{ref:j,style:Object.assign(Object.assign({},C),U==null?void 0:U.style),className:Rt,onClick:ge}),ve,M.createElement("span",null,re)))}),ee=t(98719);const T=r=>(0,ee.Z)(r,(j,{textColor:p,lightBorderColor:C,lightColor:h,darkColor:te})=>({[`${r.componentCls}${r.componentCls}-${j}`]:{color:p,background:h,borderColor:C,"&-inverse":{color:r.colorTextLightSolid,background:te,borderColor:te},[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}));var me=(0,$.bk)(["Tag","preset"],r=>{const j=G(r);return T(j)},x);function ye(r){return typeof r!="string"?r:r.charAt(0).toUpperCase()+r.slice(1)}const we=(r,j,p)=>{const C=ye(p);return{[`${r.componentCls}${r.componentCls}-${j}`]:{color:r[`color${p}`],background:r[`color${C}Bg`],borderColor:r[`color${C}Border`],[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}};var je=(0,$.bk)(["Tag","status"],r=>{const j=G(r);return[we(j,"success","Success"),we(j,"processing","Info"),we(j,"error","Error"),we(j,"warning","Warning")]},x),m=function(r,j){var p={};for(var C in r)Object.prototype.hasOwnProperty.call(r,C)&&j.indexOf(C)<0&&(p[C]=r[C]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,C=Object.getOwnPropertySymbols(r);h<C.length;h++)j.indexOf(C[h])<0&&Object.prototype.propertyIsEnumerable.call(r,C[h])&&(p[C[h]]=r[C[h]]);return p};const Ve=M.forwardRef((r,j)=>{const{prefixCls:p,className:C,rootClassName:h,style:te,children:re,icon:ve,color:ue,onClose:Te,bordered:Pe=!0,visible:fe}=r,U=m(r,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:ge,direction:pe,tag:Z}=M.useContext(X.E_),[xt,ut]=M.useState(!0),Rt=(0,_.Z)(U,["closeIcon","closable"]);M.useEffect(()=>{fe!==void 0&&ut(fe)},[fe]);const ct=(0,ne.o2)(ue),St=(0,ne.yT)(ue),Tt=ct||St,At=Object.assign(Object.assign({backgroundColor:ue&&!Tt?ue:void 0},Z==null?void 0:Z.style),te),ce=ge("tag",p),[Qe,kt,bt]=ie(ce),Ht=Y()(ce,Z==null?void 0:Z.className,{[`${ce}-${ue}`]:Tt,[`${ce}-has-color`]:ue&&!Tt,[`${ce}-hidden`]:!xt,[`${ce}-rtl`]:pe==="rtl",[`${ce}-borderless`]:!Pe},C,h,kt,bt),$t=Ue=>{Ue.stopPropagation(),Te==null||Te(Ue),!Ue.defaultPrevented&&ut(!1)},[,wt]=(0,u.b)((0,u.w)(r),(0,u.w)(Z),{closable:!1,closeIconRender:Ue=>{const Qt=M.createElement("span",{className:`${ce}-close-icon`,onClick:$t},Ue);return(0,B.wm)(Ue,Qt,Ee=>({onClick:Nt=>{var Lt;(Lt=Ee==null?void 0:Ee.onClick)===null||Lt===void 0||Lt.call(Ee,Nt),$t(Nt)},className:Y()(Ee==null?void 0:Ee.className,`${ce}-close-icon`)}))}}),a=typeof U.onClick=="function"||re&&re.type==="a",Ut=ve||null,Vt=Ut?M.createElement(M.Fragment,null,Ut,re&&M.createElement("span",null,re)):re,Wt=M.createElement("span",Object.assign({},Rt,{ref:j,className:Ht,style:At}),Vt,wt,ct&&M.createElement(me,{key:"preset",prefixCls:ce}),St&&M.createElement(je,{key:"status",prefixCls:ce}));return Qe(a?M.createElement(d.Z,{component:"Tag"},Wt):Wt)});Ve.CheckableTag=Q;var it=Ve}}]);
