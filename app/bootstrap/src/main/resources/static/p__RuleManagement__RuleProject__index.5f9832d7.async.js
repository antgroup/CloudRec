"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6673],{52745:function(Se,A,t){t.d(A,{Z:function(){return d}});var j=t(87462),g=t(62435),q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"},_=q,ne=t(84089),u=function(z,I){return g.createElement(ne.Z,(0,j.Z)({},z,{ref:I,icon:_}))},Z=g.forwardRef(u),d=Z},31732:function(Se,A,t){var j=t(97857),g=t.n(j),q=t(66309),_=t(62435),ne=t(86074);A.Z=function(u){var Z=u.text,d=u.style;return(0,ne.jsx)(q.Z,{style:g()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},d),children:Z})}},24163:function(Se,A,t){var j=t(97857),g=t.n(j),q=t(25593),_=t(83062),ne=t(62435),u=t(86074),Z=q.Z.Paragraph;A.Z=function(d){var X=d.text,z=d.width,I=d.maxWidth,B=d.rows,F=B===void 0?2:B,$=d.placement,oe=$===void 0?"top":$,K=d.color,x=K===void 0?"rgba(0, 0, 0, 0.88)":K,ie=d.link,ee=ie===void 0?!1:ie,re=d.onClickCallBackFunc,Q=d.style,te=Q===void 0?{}:Q,T=d.copyable,fe=T===void 0?!1:T;return(0,u.jsx)("div",{style:{maxWidth:I,width:z},children:(0,u.jsx)(_.Z,{title:(0,u.jsx)("div",{children:X}),placement:oe,children:(0,u.jsx)(Z,{ellipsis:{rows:F},style:g()({marginBottom:0,color:x,cursor:ee?"pointer":""},te),onClick:re,copyable:fe,children:X})})})}},28235:function(Se,A,t){var j=t(97857),g=t.n(j),q=t(25593),_=t(83062),ne=t(62435),u=t(86074),Z=q.Z.Paragraph;A.Z=function(d){var X=d.text,z=d.width,I=d.maxWidth,B=d.rows,F=B===void 0?2:B,$=d.placement,oe=$===void 0?"top":$,K=d.color,x=K===void 0?"rgba(0, 0, 0, 0.88)":K,ie=d.link,ee=ie===void 0?!1:ie,re=d.onClickCallBackFunc,Q=d.style,te=Q===void 0?{}:Q,T=d.copyable,fe=T===void 0?!1:T,ye=d.tooltipText;return(0,u.jsx)("div",{style:{maxWidth:I,width:z},children:(0,u.jsx)(_.Z,{title:ye,placement:oe,children:(0,u.jsx)(Z,{ellipsis:{rows:F},style:g()({marginBottom:0,color:x,cursor:ee?"pointer":""},te),onClick:re,copyable:fe,children:X})})})}},59999:function(Se,A,t){t.d(A,{j:function(){return ne}});var j=t(62435),g=t(96486),q=t.n(g),_=t(45830),ne=function(Z){var d=Z.platformList,X=Z.form,z=Z.onPlatformChange,I=Z.requestResourceTypeList,B=Z.requestCloudAccountBaseInfoList,F=Z.platformFieldName,$=F===void 0?"platformList":F,oe=Z.resourceTypeFieldName,K=oe===void 0?"resourceTypeList":oe,x=(0,_.useLocation)(),ie=x.search,ee=new URLSearchParams(ie),re=ee.get("platform");(0,j.useEffect)(function(){var Q;if(!(!d||d.length===0)&&(0,g.isEmpty)(re)){var te=X.getFieldValue($);if((0,g.isEmpty)(te)){var T=((Q=d[0])===null||Q===void 0?void 0:Q.value)||d[0];if(T){var fe=[T];X.setFieldValue($,fe),K&&X.setFieldValue(K,null),z&&z(fe),I&&I(fe),B&&B({platformList:fe})}}}},[d,re,X,z,I,B,$,K])}},64818:function(Se,A,t){var j=t(15009),g=t.n(j),q=t(99289),_=t.n(q),ne=t(5574),u=t.n(ne),Z=t(62435),d=t(68872),X=t(66309),z=t(85265),I=t(57381),B=t(26412),F=t(25593),$=t(45830),oe=t(96655),K=t(29448),x=t(86074),ie=function(re){var Q=re.visible,te=re.onClose,T=re.ruleId,fe=re.ruleCode,ye=(0,$.useIntl)(),$e=d.ZP.useMessage(),Me=u()($e,2),m=Me[0],Dt=Me[1],He=(0,Z.useState)(!1),it=u()(He,2),r=it[0],M=it[1],p=(0,Z.useState)(null),C=u()(p,2),h=C[0],ae=C[1];(0,Z.useEffect)(function(){Q&&T&&Y()},[Q,T]);var Y=function(){var ve=_()(g()().mark(function V(){var pe;return g()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(M(!0),D.prev=1,!T){D.next=6;break}return D.next=5,(0,oe.queryRuleDetail)({id:T});case 5:pe=D.sent;case 6:pe&&pe.content&&ae(pe.content),D.next=12;break;case 9:D.prev=9,D.t0=D.catch(1),m.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return D.prev=12,M(!1),D.finish(12);case 15:case"end":return D.stop()}},V,null,[[1,9,12,15]])}));return function(){return ve.apply(this,arguments)}}(),ue=function(){ae(null),te()},ge=function(V){switch(V.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},we=function(V){if(!V)return null;var pe=V.split(",");return pe.map(function(je,D){return(0,x.jsx)(X.Z,{color:ge(je.trim()),children:je.trim()},D)})},ce=function(V){return(0,K.c5)(V)};return(0,x.jsxs)(x.Fragment,{children:[Dt,(0,x.jsx)(z.Z,{placement:"right",onClose:ue,open:Q,width:1e3,destroyOnClose:!0,children:(0,x.jsx)(I.Z,{spinning:r,children:h&&(0,x.jsxs)(B.Z,{column:1,bordered:!0,children:[(0,x.jsx)(B.Z.Item,{label:ye.formatMessage({id:"home.module.inform.columns.ruleName"},{}),children:(0,x.jsx)(F.Z.Text,{copyable:!0,children:h.ruleName})}),(0,x.jsx)(B.Z.Item,{label:"Code",children:(0,x.jsx)(F.Z.Text,{copyable:!0,children:h.ruleCode})}),(0,x.jsx)(B.Z.Item,{label:ye.formatMessage({id:"rule.module.text.repair.suggestions"},{}),children:(0,x.jsx)(F.Z.Text,{copyable:!0,children:h.advice})}),(0,x.jsx)(B.Z.Item,{label:ye.formatMessage({id:"rule.module.text.reference.link"},{}),children:(0,x.jsx)(F.Z.Text,{copyable:!0,children:h.link})}),(0,x.jsx)(B.Z.Item,{label:ye.formatMessage({id:"rule.module.text.risk.context.template"},{}),children:(0,x.jsx)(F.Z.Text,{copyable:!0,children:h.context})}),h.ruleRego&&(0,x.jsx)(B.Z.Item,{label:"Rego Policy",children:(0,x.jsx)(F.Z.Text,{copyable:{text:h.ruleRego},children:(0,x.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"2048px",overflow:"auto"},children:h.ruleRego})})}),h.gmtModified&&(0,x.jsx)(B.Z.Item,{label:ye.formatMessage({id:"common.text.update.time"},{}),children:(0,x.jsx)(F.Z.Text,{copyable:!0,children:h.gmtModified})})]})})})]})};A.Z=ie},14842:function(Se,A,t){t.r(A),t.d(A,{default:function(){return Ra}});var j=t(15009),g=t.n(j),q=t(99289),_=t.n(q),ne=t(5574),u=t.n(ne),Z=t(79930),d=t(96655),X=t(59999),z=t(17910),I=t(29448),B=t(39380),F=t(93410),$=t(45830),oe=t(3303),K=t(68872),x=t(99859),ie=t(71230),ee=t(15746),re=t(84567),Q=t(34041),te=t(42075),T=t(83622),fe=t(92398),ye=t(68795),$e=t(33160),Me=t(96486),m=t(62435),Dt=t(13769),He=t.n(Dt),it=t(9783),r=t.n(it),M=t(97857),p=t.n(M),C=t(31732),h=t(24163),ae=t(28235),Y=t(64818),ue=t(87462),ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"},we=ge,ce=t(84089),ve=function(b,P){return m.createElement(ce.Z,(0,ue.Z)({},b,{ref:P,icon:we}))},V=m.forwardRef(ve),pe=V,je=t(86548),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},yt=D,ut=function(b,P){return m.createElement(ce.Z,(0,ue.Z)({},b,{ref:P,icon:yt}))},Vt=m.forwardRef(ut),Zt=Vt,xt=t(52745),Rt=t(24969),kt=t(90498),de=t(75302),Qe=t(83062),At=t(55241),St=t(86738),Gt=t(72269),Bt=function(){return{style:{cursor:"pointer"},onMouseEnter:function(P){P.currentTarget.style.backgroundColor="#f5f5f5",P.currentTarget.style.transform="scale(1.01)",P.currentTarget.style.transition="all 0.2s ease",P.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)"},onMouseLeave:function(P){P.currentTarget.style.backgroundColor="",P.currentTarget.style.transform="scale(1)",P.currentTarget.style.boxShadow=""}}},$t=function(b){return function(P){return p()({onClick:function(){return b(P)}},Bt())}},a=t(86074),wt=["pageSize","current"],Ht=de.ZP.useBreakpoint,Wt=function(b){var P=b.form,me=b.platformList,_e=b.resourceTypeList,Ne=b.ruleGroupList,bt=b.ruleTypeList,Oe=b.allRuleList,he=b.checkNewRules,Ie=b.newRulesCount,Te=b.queryTrigger,se=K.ZP.useMessage(),ct=u()(se,2),W=ct[0],xe=ct[1],be=Ht(),R=(0,m.useRef)(),Lt=(0,m.useRef)(),c=(0,$.useIntl)(),U=(0,m.useState)(),Mt=u()(U,2),dt=Mt[0],jt=Mt[1],mt=(0,m.useState)({}),Je=u()(mt,2),Pt=Je[0],Ut=Je[1],Jt=(0,m.useState)(!1),Et=u()(Jt,2),ft=Et[0],Xe=Et[1],Ye=(0,m.useState)(),qe=u()(Ye,2),vt=qe[0],gt=qe[1],Ce=(0,m.useState)({}),De=u()(Ce,2),ze=De[0],pt=De[1],Ft=(0,m.useState)({}),et=u()(Ft,2),Ue=et[0],Ze=et[1],Fe=(0,m.useState)({}),tt=u()(Fe,2),at=tt[0],Ke=tt[1],rt=(0,m.useState)([]),Ve=u()(rt,2),ke=Ve[0],Ge=Ve[1],_t=(0,m.useState)(!1),Ae=u()(_t,2),Ot=Ae[0],Le=Ae[1],It=(0,m.useState)(!1),Re=u()(It,2),st=Re[0],Be=Re[1],ht=(0,m.useState)(!1),lt=u()(ht,2),J=lt[0],k=lt[1],G=(0,m.useState)(!1),nt=u()(G,2),le=nt[0],Kt=nt[1];(0,m.useEffect)(function(){if(Te!==void 0&&Te>0){var f;(f=R.current)===null||f===void 0||f.reload()}},[Te]);var Xt=function(i){return i.id===dt?"ant-table-row-selected":""},Yt=function(i){gt(i.id),Xe(!0)},qt=function(){Xe(!1),gt(void 0)},ea=function(){var f=_()(g()().mark(function i(e){var l,n,v,y;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return l=W.loading(c.formatMessage({id:"common.message.text.delete.loading"})),s.next=3,(0,d.deleteRule)({id:e});case 3:n=s.sent,l(),(n.code===200||n.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.delete.success"})),(v=R.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v));case 6:case"end":return s.stop()}},i)}));return function(e){return f.apply(this,arguments)}}(),ta=function(){var f=_()(g()().mark(function i(e){var l,n,v,y;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return pt(p()(p()({},ze),{},r()({},e,!0))),l=W.loading(c.formatMessage({id:"common.message.text.copy.loading"})),s.next=4,(0,d.copyRule)({id:e});case 4:n=s.sent,pt(p()(p()({},ze),{},r()({},e,!1))),l(),(n.code===200||n.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.copy.success"})),(v=R.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v));case 8:case"end":return s.stop()}},i)}));return function(e){return f.apply(this,arguments)}}(),aa=function(){var f=_()(g()().mark(function i(e){var l,n,v,y;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return l=e.id,Ze(p()(p()({},Ue),{},r()({},l,!0))),s.prev=2,s.next=5,(0,d.addTenantSelectRule)({ruleCode:e.ruleCode});case 5:n=s.sent,(n.code===200||n.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.success"})),(v=R.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v)),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),W.error(c.formatMessage({id:"common.message.text.failed"}));case 12:return s.prev=12,Ze(p()(p()({},Ue),{},r()({},l,!1))),s.finish(12);case 15:case"end":return s.stop()}},i,null,[[2,9,12,15]])}));return function(e){return f.apply(this,arguments)}}(),O=function(){var f=_()(g()().mark(function i(e){var l,n,v,y;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return l=e.id,Ke(p()(p()({},at),{},r()({},l,!0))),s.prev=2,s.next=5,(0,d.removeTenantSelectRule)({ruleCode:e.ruleCode});case 5:n=s.sent,(n.code===200||n.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.success"})),(v=R.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v)),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),W.error(c.formatMessage({id:"common.message.text.failed"}));case 12:return s.prev=12,Ke(p()(p()({},at),{},r()({},l,!1))),s.finish(12);case 15:case"end":return s.stop()}},i,null,[[2,9,12,15]])}));return function(e){return f.apply(this,arguments)}}(),E=function(){var f=_()(g()().mark(function i(){var e,l,n,v,y;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(Kt(!0),s.prev=1,e=Oe==null?void 0:Oe.filter(function(H){return ke.includes(H.id)}),l=(e==null?void 0:e.map(function(H){return H.ruleCode}))||[],l.length!==0){s.next=7;break}return W.warning(c.formatMessage({id:"common.message.text.no.valid.data"})),s.abrupt("return");case 7:return s.next=9,(0,d.batchAddTenantSelectRule)({ruleCodeList:l});case 9:n=s.sent,(n.code===200||n.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.success"})),(v=R.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v),Ge([])),s.next=16;break;case 13:s.prev=13,s.t0=s.catch(1),W.error(c.formatMessage({id:"common.message.text.failed"}));case 16:return s.prev=16,Kt(!1),s.finish(16);case 19:case"end":return s.stop()}},i,null,[[1,13,16,19]])}));return function(){return f.apply(this,arguments)}}(),o=function(i){k(!0),(0,d.queryExportRuleList)(i?{idList:i}:void 0,{responseType:"blob"}).then(function(e){(0,I.a5)(e,"CloudRec ".concat(c.formatMessage({id:"rule.module.text.rule.data"}))),W.success(c.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return k(!1)})},S=function(){var f=_()(g()().mark(function i(e,l){var n,v,y,L;return g()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return n={id:e,status:l},H.next=3,(0,d.changeRuleStatus)(n);case 3:v=H.sent,(v.code===200||v.msg==="success")&&(W.success(c.formatMessage({id:"common.message.text.edit.success"})),(y=R.current)===null||y===void 0||(L=y.reloadAndRest)===null||L===void 0||L.call(y));case 5:case"end":return H.stop()}},i)}));return function(e,l){return f.apply(this,arguments)}}(),w=[{title:c.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(i,e){var l,n,v=(e==null?void 0:e.selectedTenantNameList)&&e.selectedTenantNameList.length>0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,a.jsx)(ae.Z,{placement:"topLeft",maxWidth:be!=null&&be.xxl?600:400,rows:1,text:(e==null?void 0:e.ruleName)||"-",style:{fontWeight:500,color:"rgb(58, 58, 58)"}}),v&&(0,a.jsx)(Qe.Z,{title:(0,a.jsx)("div",{children:(l=e.selectedTenantNameList)===null||l===void 0?void 0:l.map(function(y,L){return(0,a.jsxs)("div",{style:{fontSize:12},children:["\u2022 ",y]},L)})}),placement:"topRight",children:(0,a.jsx)(pe,{style:{color:"#1890ff",fontSize:14,cursor:"pointer"}})})]}),(0,a.jsx)(h.Z,{placement:"topLeft",maxWidth:be!=null&&be.xxl?600:400,rows:1,text:(e==null||(n=e.ruleTypeNameList)===null||n===void 0?void 0:n.toString())||"-",style:{color:"rgb(166, 167, 167)",fontSize:13}})]})}},{title:c.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(i,e){return(0,a.jsx)(C.Z,{text:(e==null?void 0:e.resourceTypeStr)||"-"})}},{title:c.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,I.W_)(z.I9),align:"center",hideInSearch:!0,render:function(i,e){return(0,I.Dd)(z.I9,e==null?void 0:e.riskLevel)}},{title:c.formatMessage({id:"common.table.columns.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(i,e){return(0,a.jsxs)("div",{children:[(0,a.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,a.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:c.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,I.W_)(me),align:"center",hideInSearch:!0,render:function(i,e){return(0,I.c5)(e.platform,me)}},{title:c.formatMessage({id:"rule.input.text.rule.group.creator"}),dataIndex:"username",valueType:"text",hideInSearch:!0,width:120},{title:c.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(i,e){return(0,a.jsxs)(te.Z,{size:"small",children:[(0,a.jsx)(T.ZP,{size:"small",onClick:function(n){n.stopPropagation(),jt(e.id)},type:"link",target:"_self",href:"/ruleManagement/ruleProject/edit?id=".concat(e==null?void 0:e.id),children:(0,a.jsx)(Qe.Z,{title:c.formatMessage({id:"common.button.text.edit"}),children:(0,a.jsx)(je.Z,{})})}),(0,a.jsx)(At.Z,{content:(0,a.jsxs)(te.Z,{children:[(0,a.jsx)(St.Z,{title:c.formatMessage({id:"common.button.text.delete.confirm"}),onConfirm:function(n){n==null||n.stopPropagation(),ea(e.id)},okText:c.formatMessage({id:"common.button.text.ok"}),cancelText:c.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(T.ZP,{block:!0,type:"link",danger:!0,size:"small",onClick:function(n){return n.stopPropagation()},children:c.formatMessage({id:"common.button.text.delete"})})}),(0,a.jsx)(T.ZP,{block:!0,loading:ze[Number(e.id)],onClick:function(n){n.stopPropagation(),ta(e.id)},type:"link",target:"_blank",size:"small",children:c.formatMessage({id:"common.button.text.copy"})})]}),children:(0,a.jsx)(T.ZP,{type:"link",icon:(0,a.jsx)(Zt,{}),onClick:function(n){return n.stopPropagation()}})}),e.tenantSelected?(0,a.jsx)(St.Z,{title:c.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(n){n==null||n.stopPropagation(),O(e)},onCancel:function(n){return n==null?void 0:n.stopPropagation()},okText:c.formatMessage({id:"common.button.text.ok"}),cancelText:c.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(T.ZP,{type:"default",size:"small",loading:at[Number(e.id)],onClick:function(n){return n.stopPropagation()},icon:(0,a.jsx)(xt.Z,{}),danger:!0})}):(0,a.jsx)(T.ZP,{type:"primary",size:"small",loading:Ue[Number(e.id)],onClick:function(n){n.stopPropagation(),aa(e)},icon:(0,a.jsx)(Rt.Z,{})}),(0,a.jsx)(Qe.Z,{title:c.formatMessage({id:"rule.module.text.tooltip.status"}),children:(0,a.jsx)(Gt.Z,{checked:(e==null?void 0:e.status)==="valid",onClick:function(n,v){v==null||v.stopPropagation(),S(e.id,(e==null?void 0:e.status)==="valid"?"invalid":"valid")}})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[xe,(0,a.jsx)(kt.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:ke,onChange:function(i){return Ge(i)},preserveSelectedRowKeys:!0},actionRef:R,formRef:Lt,rowClassName:Xt,rowKey:"id",search:!1,toolBarRender:function(){return[(0,a.jsx)(T.ZP,{type:"primary",href:"/ruleManagement/ruleProject/edit",children:c.formatMessage({id:"rule.extend.basic.add"})},"CREATE"),(0,a.jsx)(At.Z,{open:Ot,onOpenChange:function(e){return Le(e)},title:c.formatMessage({id:"rule.module.text.sync.confirm"}),content:(0,a.jsxs)(te.Z,{children:[(0,a.jsx)(T.ZP,{danger:!0,type:"default",loading:st,onClick:_()(g()().mark(function i(){var e,l,n,v;return g()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return Be(!0),e=W.loading(c.formatMessage({id:"rule.module.text.sync.loading"})),L.prev=2,L.next=5,(0,d.loadRuleFromGithub)({coverage:!0});case 5:l=L.sent,(l.code===200||l.msg==="success")&&(W.success(c.formatMessage({id:"rule.module.text.sync.success"})),(n=R.current)===null||n===void 0||(v=n.reloadAndRest)===null||v===void 0||v.call(n),he());case 7:return L.prev=7,e(),Be(!1),Le(!1),L.finish(7);case 12:case"end":return L.stop()}},i,null,[[2,,7,12]])})),children:c.formatMessage({id:"rule.module.text.sync.overwrite"})}),(0,a.jsx)(T.ZP,{type:"default",loading:st,onClick:_()(g()().mark(function i(){var e,l,n,v;return g()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return Be(!0),e=W.loading(c.formatMessage({id:"rule.module.text.sync.loading"})),L.prev=2,L.next=5,(0,d.loadRuleFromGithub)({coverage:!1});case 5:l=L.sent,(l.code===200||l.msg==="success")&&(W.success(c.formatMessage({id:"rule.module.text.sync.success"})),(n=R.current)===null||n===void 0||(v=n.reloadAndRest)===null||v===void 0||v.call(n),he());case 7:return L.prev=7,e(),Be(!1),Le(!1),L.finish(7);case 12:case"end":return L.stop()}},i,null,[[2,,7,12]])})),children:c.formatMessage({id:"rule.module.text.sync.no.overwrite"})}),(0,a.jsx)(T.ZP,{onClick:function(){Le(!1)},children:c.formatMessage({id:"common.button.text.cancel"})})]}),trigger:"click",children:(0,a.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,a.jsx)(T.ZP,{type:"default",children:c.formatMessage({id:"rule.module.text.sync.button"})}),Ie>0&&(0,a.jsx)("div",{style:{position:"absolute",top:"-8px",right:"-8px",backgroundColor:"#ff4d4f",color:"white",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",zIndex:1},children:Ie>99?"99+":Ie})]})},"sync"),(0,a.jsx)(T.ZP,{type:"default",loading:le,disabled:ke.length===0,onClick:E,children:c.formatMessage({id:"rule.module.text.batch.add.to.favorites"})},"BATCH_ADD_TO_FAVORITES"),(0,a.jsx)(T.ZP,{loading:J,type:"default",disabled:ke.length===0,onClick:function(){return o(ke)},children:c.formatMessage({id:"common.button.text.export"})},"EXPORT")]},request:function(){var f=_()(g()().mark(function i(e,l){var n,v,y,L,s,H,N,ra,ot,na;return g()().wrap(function(Ct){for(;;)switch(Ct.prev=Ct.next){case 0:return n=e.pageSize,v=e.current,y=He()(e,wt),L=P.getFieldsValue(),s=(0,I.Hm)(l),H=p()(p()(p()({},y),L),{},{page:v,size:n}),(0,Me.isEmpty)(s)||(H.sortParam=s==null?void 0:s.key,H.sortType=s==null||(N=s.value)===null||N===void 0||(N=N.slice(0,-3))===null||N===void 0?void 0:N.toUpperCase()),Ct.next=7,(0,d.queryRuleList)(H);case 7:return ra=Ct.sent,ot=ra.content,na=ra.code,Ct.abrupt("return",{data:(ot==null?void 0:ot.data)||[],total:(ot==null?void 0:ot.total)||0,success:na===200||!1});case 11:case"end":return Ct.stop()}},i)}));return function(i,e){return f.apply(this,arguments)}}(),columns:w,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:$t(Yt)}),(0,a.jsx)(Y.Z,{visible:ft,onClose:qt,ruleId:vt})]})},We=Wt,Qt=t(53846),Pe=t(90598),Nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 01-12.7-6.5V353.7a8 8 0 0112.7-6.5L656.1 506a7.9 7.9 0 010 12.9z"}}]},name:"play-circle",theme:"filled"},Tt=Nt,oa=function(b,P){return m.createElement(ce.Z,(0,ue.Z)({},b,{ref:P,icon:Tt}))},ia=m.forwardRef(oa),ua=ia,ca={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},da=ca,ma=function(b,P){return m.createElement(ce.Z,(0,ue.Z)({},b,{ref:P,icon:da}))},fa=m.forwardRef(ma),va=fa,zt=t(78045),ga=["pageSize","current"],pa=de.ZP.useBreakpoint,ha=function(b){var P=b.form,me=b.platformList,_e=b.resourceTypeList,Ne=b.ruleGroupList,bt=b.ruleTypeList,Oe=b.allRuleList,he=b.queryTrigger,Ie=K.ZP.useMessage(),Te=u()(Ie,2),se=Te[0],ct=Te[1],W=pa(),xe=(0,m.useRef)(),be=(0,m.useRef)(),R=(0,$.useIntl)(),Lt=(0,m.useState)(),c=u()(Lt,2),U=c[0],Mt=c[1],dt=(0,m.useState)({}),jt=u()(dt,2),mt=jt[0],Je=jt[1],Pt=(0,m.useState)({}),Ut=u()(Pt,2),Jt=Ut[0],Et=Ut[1],ft=(0,m.useState)({}),Xe=u()(ft,2),Ye=Xe[0],qe=Xe[1],vt=(0,m.useState)([]),gt=u()(vt,2),Ce=gt[0],De=gt[1],ze=(0,m.useState)(!1),pt=u()(ze,2),Ft=pt[0],et=pt[1],Ue=(0,m.useState)(!1),Ze=u()(Ue,2),Fe=Ze[0],tt=Ze[1],at=(0,m.useState)(!1),Ke=u()(at,2),rt=Ke[0],Ve=Ke[1],ke=(0,m.useState)(),Ge=u()(ke,2),_t=Ge[0],Ae=Ge[1],Ot=(0,m.useState)(!0),Le=u()(Ot,2),It=Le[0],Re=Le[1],st=(0,m.useState)(!1),Be=u()(st,2),ht=Be[0],lt=Be[1],J=(0,m.useState)("all"),k=u()(J,2),G=k[0],nt=k[1],le=function(E){return E.id===U?"ant-table-row-selected":""},Kt=function(E){Ae(E.id),Ve(!0)};(0,m.useEffect)(function(){if(he!==void 0&&he>0){var O;(O=xe.current)===null||O===void 0||O.reload()}},[he]);var Xt=function(){var O=_()(g()().mark(function E(o){var S,w,f,i;return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return Je(p()(p()({},mt),{},r()({},o,!0))),S=se.loading(R.formatMessage({id:"common.message.text.execute.loading"})),l.next=4,(0,d.scanByRule)({id:o});case 4:w=l.sent,Je(p()(p()({},mt),{},r()({},o,!1))),S(),(w.code===200||w.msg==="success")&&(se.success(R.formatMessage({id:"common.message.text.execute.success"})),(f=xe.current)===null||f===void 0||(i=f.reloadAndRest)===null||i===void 0||i.call(f));case 8:case"end":return l.stop()}},E)}));return function(o){return O.apply(this,arguments)}}(),Yt=function(){var O=_()(g()().mark(function E(o){var S,w,f,i;return g()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return S=o.id,qe(p()(p()({},Ye),{},r()({},S,!0))),l.prev=2,l.next=5,(0,d.removeTenantSelectRule)({ruleCode:o.ruleCode});case 5:w=l.sent,(w.code===200||w.msg==="success")&&(se.success(R.formatMessage({id:"common.message.text.success"})),(f=xe.current)===null||f===void 0||(i=f.reloadAndRest)===null||i===void 0||i.call(f)),l.next=12;break;case 9:l.prev=9,l.t0=l.catch(2),se.error(R.formatMessage({id:"common.message.text.fail"}));case 12:return l.prev=12,qe(p()(p()({},Ye),{},r()({},S,!1))),l.finish(12);case 15:case"end":return l.stop()}},E,null,[[2,9,12,15]])}));return function(o){return O.apply(this,arguments)}}(),qt=function(){var O=_()(g()().mark(function E(){var o,S,w,f;return g()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ce.length!==0){e.next=2;break}return e.abrupt("return");case 2:return et(!0),e.prev=3,o=Ce.map(function(l){return Number(l)}),e.next=7,(0,d.scanRuleList)({idList:o});case 7:S=e.sent,(S.code===200||S.msg==="success")&&(se.success(R.formatMessage({id:"common.message.text.success"})),De([]),(w=xe.current)===null||w===void 0||(f=w.reloadAndRest)===null||f===void 0||f.call(w)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),se.error(R.formatMessage({id:"common.message.text.fail"}));case 14:return e.prev=14,et(!1),e.finish(14);case 17:case"end":return e.stop()}},E,null,[[3,11,14,17]])}));return function(){return O.apply(this,arguments)}}(),ea=function(){var O=_()(g()().mark(function E(){var o,S,w,f,i,e,l,n,v,y;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(Ce.length!==0){s.next=2;break}return s.abrupt("return");case 2:return tt(!0),s.prev=3,S=P.getFieldsValue(),w={page:1,size:1e3,platformList:S.platformList,riskLevelList:S.riskLevelList,ruleCodeList:S.ruleCodeList,resourceTypeList:S.resourceTypeList,ruleGroupIdList:S.ruleGroupIdList,ruleTypeIdList:S.ruleTypeIdList},s.next=8,(0,d.queryEffectRuleList)(w);case 8:return f=s.sent,i=(f==null||(o=f.content)===null||o===void 0?void 0:o.data)||[],e=i.filter(function(H){return Ce.includes(H.id)}),l=e.map(function(H){return H.ruleCode}),s.next=14,(0,d.batchDeleteTenantSelectRule)({ruleCodeList:l});case 14:n=s.sent,(n.code===200||n.msg==="success")&&(se.success(R.formatMessage({id:"common.message.text.success"})),De([]),(v=xe.current)===null||v===void 0||(y=v.reloadAndRest)===null||y===void 0||y.call(v)),s.next=21;break;case 18:s.prev=18,s.t0=s.catch(3),se.error(R.formatMessage({id:"common.message.text.fail"}));case 21:return s.prev=21,tt(!1),s.finish(21);case 24:case"end":return s.stop()}},E,null,[[3,18,21,24]])}));return function(){return O.apply(this,arguments)}}(),ta=function(){var O=_()(g()().mark(function E(o,S){var w,f,i,e,l,n,v,y,L,s;return g()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return w=o.pageSize,f=o.current,i=He()(o,ga),N.prev=1,e=P.getFieldsValue(),l=p()({page:f||1,size:w||10,platformList:e.platformList,riskLevelList:e.riskLevelList,ruleCodeList:e.ruleCodeList,resourceTypeList:e.resourceTypeList,ruleGroupIdList:e.ruleGroupIdList,ruleTypeIdList:e.ruleTypeIdList,effectRuleType:G},i),S&&Object.keys(S).length>0&&(n=Object.keys(S)[0],v=S[n],l.sortParam=n,l.sortType=v==="ascend"?"ASC":"DESC"),N.next=7,(0,d.queryEffectRuleList)(l);case 7:if(y=N.sent,!(y!=null&&y.content)){N.next=16;break}return L=y.content.data||[],s=y.content.total||0,Re(s>0),lt(!0),N.abrupt("return",{data:L,total:s,success:!0});case 16:return Re(!1),lt(!0),N.abrupt("return",{data:[],total:0,success:!1});case 19:N.next=26;break;case 21:return N.prev=21,N.t0=N.catch(1),Re(!1),lt(!0),N.abrupt("return",{data:[],total:0,success:!1});case 26:case"end":return N.stop()}},E,null,[[1,21]])}));return function(o,S){return O.apply(this,arguments)}}(),aa=[{title:R.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(E,o){var S;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{fontWeight:500,color:"rgb(58, 58, 58)",display:"flex",alignItems:"center",gap:"8px"},children:[(0,a.jsx)("span",{children:(o==null?void 0:o.ruleName)||"-"}),(o==null?void 0:o.defaultRuleSelected)&&(0,a.jsx)(Qe.Z,{title:"default",children:(0,a.jsx)(Pe.Z,{style:{color:"#faad14",fontSize:"14px"}})})]}),(0,a.jsx)("div",{style:{color:"rgb(166, 167, 167)",fontSize:13},children:(o==null||(S=o.ruleTypeNameList)===null||S===void 0?void 0:S.toString())||"-"})]})}},{title:R.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(E,o){return(0,a.jsx)(C.Z,{text:(o==null?void 0:o.resourceTypeStr)||"-"})}},{title:R.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,I.W_)(z.I9),align:"center",hideInSearch:!0,render:function(E,o){return(0,I.Dd)(z.I9,o==null?void 0:o.riskLevel)}},{title:R.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,I.W_)(me),align:"center",hideInSearch:!0,render:function(E,o){return(0,I.c5)(o.platform,me)}},{title:R.formatMessage({id:"asset.module.risk.number"}),dataIndex:"riskCount",valueType:"text",hideInSearch:!0,align:"center",sorter:!0,render:function(E,o){return(0,a.jsx)(T.ZP,{type:"link",size:"small",href:"/riskManagement/riskList?platform=".concat(o==null?void 0:o.platform,"&ruleCode=").concat(o==null?void 0:o.ruleCode),children:o==null?void 0:o.riskCount})}},{title:R.formatMessage({id:"cloudAccount.extend.title.lastScanTime"}),dataIndex:"lastScanTime",valueType:"text",hideInSearch:!0,align:"center",width:150,sorter:!0,render:function(E,o){return o!=null&&o.lastScanTime?(0,a.jsx)(Qe.Z,{title:o.lastScanTime,children:(0,a.jsx)("span",{children:o.lastScanTime})}):"-"}},{title:R.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",width:180,render:function(E,o){var S=o==null?void 0:o.isRunning,w=S===0,f=function(){return S===1?(0,a.jsx)(ua,{}):(0,a.jsx)(va,{})};return(0,a.jsxs)(te.Z,{size:"small",children:[(0,a.jsx)(T.ZP,{block:!0,loading:mt[Number(o.id)],disabled:!w,onClick:function(e){e.stopPropagation(),Xt(o.id)},type:"default",target:"_blank",size:"small",icon:f(),style:{color:S===1?"#52c41a":void 0,borderColor:S===1?"#52c41a":void 0},children:R.formatMessage({id:S===1?"common.button.text.running":"common.button.text.test"})}),G==="selected"&&(0,a.jsx)(St.Z,{title:R.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(e){e==null||e.stopPropagation(),Yt(o)},onCancel:function(e){return e==null?void 0:e.stopPropagation()},okText:R.formatMessage({id:"common.button.text.ok"}),cancelText:R.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(T.ZP,{danger:!0,size:"small",loading:Ye[Number(o.id)],disabled:S===1,icon:(0,a.jsx)(xt.Z,{}),onClick:function(e){return e.stopPropagation()}})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[ct,(0,a.jsx)(kt.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:Ce,onChange:function(E){return De(E)},preserveSelectedRowKeys:!0},headerTitle:(0,a.jsx)("div",{className:Qt.Z.customTitle,children:(0,a.jsx)(te.Z,{children:(0,a.jsxs)(zt.ZP.Group,{value:G,onChange:function(E){var o;nt(E.target.value),De([]),(o=xe.current)===null||o===void 0||o.reload()},size:"middle",buttonStyle:"solid",children:[(0,a.jsx)(zt.ZP.Button,{value:"all",children:R.formatMessage({id:"common.module.text.all"})}),(0,a.jsx)(zt.ZP.Button,{value:"selected",children:R.formatMessage({id:"common.module.text.selected"})}),(0,a.jsx)(zt.ZP.Button,{value:"default",children:R.formatMessage({id:"common.module.text.default"})})]})})}),actionRef:xe,formRef:be,rowClassName:le,rowKey:"id",search:!1,toolBarRender:function(){return[(0,a.jsx)(T.ZP,{type:"primary",loading:Ft,disabled:Ce.length===0,onClick:qt,children:R.formatMessage({id:"rule.module.text.batch.test"})},"BATCH_DETECT"),G==="selected"&&(0,a.jsx)(T.ZP,{danger:!0,loading:Fe,disabled:Ce.length===0,onClick:ea,children:R.formatMessage({id:"rule.module.text.batch.remove"})},"BATCH_REMOVE")].filter(Boolean)},request:ta,columns:aa,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:$t(Kt)}),(0,a.jsx)(Y.Z,{visible:rt,onClose:function(){return Ve(!1)},ruleId:_t})]})},Ca=ha,sa=t(61194),la=oe.Z.SHOW_CHILD,ya=function(b,P){var me,_e,Ne=b.toLowerCase(),bt=((me=P.label)===null||me===void 0?void 0:me.toLowerCase())||"",Oe=((_e=P.value)===null||_e===void 0?void 0:_e.toLowerCase())||"";return bt.includes(Ne)||Oe.includes(Ne)},xa=function(){var b=(0,$.useModel)("rule"),P=b.platformList,me=b.ruleTypeList,_e=b.allRuleList,Ne=b.ruleGroupList,bt=(0,$.useLocation)(),Oe=bt.search,he=new URLSearchParams(Oe),Ie=he.get("groupId"),Te=he.get("ruleCode"),se=he.get("platform"),ct=K.ZP.useMessage(),W=u()(ct,2),xe=W[0],be=W[1],R=x.Z.useForm(),Lt=u()(R,1),c=Lt[0],U=(0,$.useIntl)(),Mt=(0,m.useState)(!1),dt=u()(Mt,2),jt=dt[0],mt=dt[1],Je=(0,m.useState)(!1),Pt=u()(Je,2),Ut=Pt[0],Jt=Pt[1],Et=(0,m.useState)(0),ft=u()(Et,2),Xe=ft[0],Ye=ft[1],qe=(0,m.useState)(!1),vt=u()(qe,2),gt=vt[0],Ce=vt[1],De=(0,m.useState)([]),ze=u()(De,2),pt=ze[0],Ft=ze[1],et=(0,m.useState)([]),Ue=u()(et,2),Ze=Ue[0],Fe=Ue[1],tt=he.get("tab"),at=(0,m.useState)(tt||"selected"),Ke=u()(at,2),rt=Ke[0],Ve=Ke[1];(0,m.useEffect)(function(){var J=he.get("tab");J&&J!==rt&&Ve(J)},[Oe,rt]);var ke=(0,m.useState)(!1),Ge=u()(ke,2),_t=Ge[0],Ae=Ge[1],Ot=(0,m.useState)(0),Le=u()(Ot,2),It=Le[0],Re=Le[1],st=function(){var J=_()(g()().mark(function k(){var G;return g()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return le.prev=0,le.next=3,(0,d.checkExistNewRule)();case 3:G=le.sent,G.code===200&&typeof G.content=="number"&&Ye(G.content),le.next=10;break;case 7:le.prev=7,le.t0=le.catch(0),console.error("Failed to check new rules:",le.t0);case 10:case"end":return le.stop()}},k,null,[[0,7]])}));return function(){return J.apply(this,arguments)}}(),Be=(0,$.useRequest)(function(J){return(0,Z.queryGroupTypeList)({platformList:J})},{manual:!0,formatResult:function(k){var G=k.content;Fe(G||[])}}),ht=Be.run,lt=function(k){Ce(!0),(0,d.queryExportRuleList)(k?{idList:k}:void 0,{responseType:"blob"}).then(function(G){(0,I.a5)(G,"CloudRec ".concat(U.formatMessage({id:"rule.module.text.rule.data"}))),xe.success(U.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return Ce(!1)})};return(0,m.useEffect)(function(){(0,Me.isEmpty)(Ie)||c.setFieldValue("ruleGroupIdList",[Number(Ie)]),(0,Me.isEmpty)(Te)||c.setFieldValue("ruleCodeList",[Te]),(0,Me.isEmpty)(se)||(c.setFieldValue("platformList",[se]),ht([se])),st()},[Ie,Te,se]),(0,X.j)({platformList:P,form:c,requestResourceTypeList:function(k){Fe([]),ht(k)},platformFieldName:"platformList",resourceTypeFieldName:"resourceTypeList"}),(0,a.jsxs)(B._z,{ghost:!0,title:!1,className:sa.Z.rulePageContainer,breadcrumbRender:!1,children:[be,(0,a.jsx)(F.Z,{bodyStyle:{paddingBottom:0},className:sa.Z.customFilterCard,children:(0,a.jsx)(x.Z,{form:c,children:(0,a.jsxs)(ie.Z,{gutter:[24,10],style:{marginBottom:20},children:[(0,a.jsx)(ee.Z,{span:24,children:(0,a.jsx)(x.Z.Item,{name:"platformList",label:U.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,a.jsx)(re.Z.Group,{options:(0,I.T$)(P),onChange:function(k){var G=k||[];c.setFieldValue("resourceTypeList",null),Fe([]),ht(G),Re(function(nt){return nt+1})}})})}),(0,a.jsx)(ee.Z,{span:24,children:(0,a.jsx)(x.Z.Item,{name:"riskLevelList",label:U.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,a.jsx)(re.Z.Group,{options:(0,I.at)(z.I9)})})}),(0,a.jsx)(ee.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{name:"resourceTypeList",label:U.formatMessage({id:"cloudAccount.extend.title.asset.type"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(oe.Z,{options:Ze,multiple:!0,placeholder:U.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:la,allowClear:!0,showSearch:!0})})}),(0,a.jsx)(ee.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{name:"ruleTypeIdList",label:U.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(oe.Z,{placeholder:U.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:la,allowClear:!0,showSearch:!0,fieldNames:{label:"typeName",value:"id",children:"childList"},multiple:!0,options:me||[]})})}),(0,a.jsx)(ee.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{name:"ruleGroupIdList",label:U.formatMessage({id:"layout.routes.title.ruleGroup"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(Q.Z,{placeholder:U.formatMessage({id:"common.select.text.placeholder"}),options:Ne,allowClear:!0,mode:"multiple"})})}),(0,a.jsx)(ee.Z,{span:18,children:(0,a.jsx)(x.Z.Item,{name:"ruleCodeList",label:U.formatMessage({id:"home.module.inform.columns.ruleName"}),style:{marginBottom:0},children:(0,a.jsx)(Q.Z,{filterOption:ya,placeholder:U.formatMessage({id:"common.select.text.placeholder"}),allowClear:!0,options:_e,mode:"multiple"})})}),(0,a.jsx)(ee.Z,{span:6,children:(0,a.jsx)(x.Z.Item,{style:{marginBottom:0,textAlign:"right"},children:(0,a.jsxs)(te.Z,{children:[(0,a.jsx)(T.ZP,{type:"primary",icon:(0,a.jsx)(ye.Z,{}),loading:_t,onClick:function(){Ae(!0),Re(function(k){return k+1}),setTimeout(function(){Ae(!1)},500)},children:U.formatMessage({id:"common.button.text.query"})}),(0,a.jsx)(T.ZP,{icon:(0,a.jsx)($e.Z,{}),onClick:function(){c.resetFields(),Fe([]),Ae(!0),Re(function(k){return k+1}),setTimeout(function(){Ae(!1)},500)},children:U.formatMessage({id:"common.button.text.reset"})})]})})})]})})}),(0,a.jsx)(F.Z,{style:{marginTop:16},children:(0,a.jsx)(fe.Z,{activeKey:rt,onChange:function(k){Ve(k),Re(function(G){return G+1})},items:[{key:"selected",label:U.formatMessage({id:"rule.module.text.selected.rules"}),children:(0,a.jsx)(Ca,{form:c,platformList:P,resourceTypeList:Ze,ruleGroupList:Ne,ruleTypeList:me,allRuleList:_e,queryTrigger:It})},{key:"market",label:U.formatMessage({id:"rule.module.text.market.rules"}),children:(0,a.jsx)(We,{form:c,platformList:P,resourceTypeList:Ze,ruleGroupList:Ne,ruleTypeList:me,allRuleList:_e,checkNewRules:st,newRulesCount:Xe,queryTrigger:It})}]})})]})},Ra=xa},53846:function(Se,A){A.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},61194:function(Se,A){A.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}},75302:function(Se,A,t){var j=t(25378);function g(){return(0,j.Z)()}A.ZP={useBreakpoint:g}},66309:function(Se,A,t){t.d(A,{Z:function(){return it}});var j=t(62435),g=t(93967),q=t.n(g),_=t(98423),ne=t(98787),u=t(69760),Z=t(96159),d=t(45353),X=t(53124),z=t(861),I=t(15063),B=t(14747),F=t(83262),$=t(83559);const oe=r=>{const{paddingXXS:M,lineWidth:p,tagPaddingHorizontal:C,componentCls:h,calc:ae}=r,Y=ae(C).sub(p).equal(),ue=ae(M).sub(p).equal();return{[h]:Object.assign(Object.assign({},(0,B.Wf)(r)),{display:"inline-block",height:"auto",marginInlineEnd:r.marginXS,paddingInline:Y,fontSize:r.tagFontSize,lineHeight:r.tagLineHeight,whiteSpace:"nowrap",background:r.defaultBg,border:`${(0,z.unit)(r.lineWidth)} ${r.lineType} ${r.colorBorder}`,borderRadius:r.borderRadiusSM,opacity:1,transition:`all ${r.motionDurationMid}`,textAlign:"start",position:"relative",[`&${h}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:r.defaultColor},[`${h}-close-icon`]:{marginInlineStart:ue,fontSize:r.tagIconSize,color:r.colorIcon,cursor:"pointer",transition:`all ${r.motionDurationMid}`,"&:hover":{color:r.colorTextHeading}},[`&${h}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${r.iconCls}-close, ${r.iconCls}-close:hover`]:{color:r.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${h}-checkable-checked):hover`]:{color:r.colorPrimary,backgroundColor:r.colorFillSecondary},"&:active, &-checked":{color:r.colorTextLightSolid},"&-checked":{backgroundColor:r.colorPrimary,"&:hover":{backgroundColor:r.colorPrimaryHover}},"&:active":{backgroundColor:r.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${r.iconCls} + span, > span + ${r.iconCls}`]:{marginInlineStart:Y}}),[`${h}-borderless`]:{borderColor:"transparent",background:r.tagBorderlessBg}}},K=r=>{const{lineWidth:M,fontSizeIcon:p,calc:C}=r,h=r.fontSizeSM;return(0,F.mergeToken)(r,{tagFontSize:h,tagLineHeight:(0,z.unit)(C(r.lineHeightSM).mul(h).equal()),tagIconSize:C(p).sub(C(M).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:r.defaultBg})},x=r=>({defaultBg:new I.FastColor(r.colorFillQuaternary).onBackground(r.colorBgContainer).toHexString(),defaultColor:r.colorText});var ie=(0,$.I$)("Tag",r=>{const M=K(r);return oe(M)},x),ee=function(r,M){var p={};for(var C in r)Object.prototype.hasOwnProperty.call(r,C)&&M.indexOf(C)<0&&(p[C]=r[C]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,C=Object.getOwnPropertySymbols(r);h<C.length;h++)M.indexOf(C[h])<0&&Object.prototype.propertyIsEnumerable.call(r,C[h])&&(p[C[h]]=r[C[h]]);return p},Q=j.forwardRef((r,M)=>{const{prefixCls:p,style:C,className:h,checked:ae,onChange:Y,onClick:ue}=r,ge=ee(r,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:we,tag:ce}=j.useContext(X.E_),ve=ut=>{Y==null||Y(!ae),ue==null||ue(ut)},V=we("tag",p),[pe,je,D]=ie(V),yt=q()(V,`${V}-checkable`,{[`${V}-checkable-checked`]:ae},ce==null?void 0:ce.className,h,je,D);return pe(j.createElement("span",Object.assign({},ge,{ref:M,style:Object.assign(Object.assign({},C),ce==null?void 0:ce.style),className:yt,onClick:ve})))}),te=t(98719);const T=r=>(0,te.Z)(r,(M,{textColor:p,lightBorderColor:C,lightColor:h,darkColor:ae})=>({[`${r.componentCls}${r.componentCls}-${M}`]:{color:p,background:h,borderColor:C,"&-inverse":{color:r.colorTextLightSolid,background:ae,borderColor:ae},[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}));var fe=(0,$.bk)(["Tag","preset"],r=>{const M=K(r);return T(M)},x);function ye(r){return typeof r!="string"?r:r.charAt(0).toUpperCase()+r.slice(1)}const $e=(r,M,p)=>{const C=ye(p);return{[`${r.componentCls}${r.componentCls}-${M}`]:{color:r[`color${p}`],background:r[`color${C}Bg`],borderColor:r[`color${C}Border`],[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}};var Me=(0,$.bk)(["Tag","status"],r=>{const M=K(r);return[$e(M,"success","Success"),$e(M,"processing","Info"),$e(M,"error","Error"),$e(M,"warning","Warning")]},x),m=function(r,M){var p={};for(var C in r)Object.prototype.hasOwnProperty.call(r,C)&&M.indexOf(C)<0&&(p[C]=r[C]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,C=Object.getOwnPropertySymbols(r);h<C.length;h++)M.indexOf(C[h])<0&&Object.prototype.propertyIsEnumerable.call(r,C[h])&&(p[C[h]]=r[C[h]]);return p};const He=j.forwardRef((r,M)=>{const{prefixCls:p,className:C,rootClassName:h,style:ae,children:Y,icon:ue,color:ge,onClose:we,bordered:ce=!0,visible:ve}=r,V=m(r,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:pe,direction:je,tag:D}=j.useContext(X.E_),[yt,ut]=j.useState(!0),Vt=(0,_.Z)(V,["closeIcon","closable"]);j.useEffect(()=>{ve!==void 0&&ut(ve)},[ve]);const Zt=(0,ne.o2)(ge),xt=(0,ne.yT)(ge),Rt=Zt||xt,kt=Object.assign(Object.assign({backgroundColor:ge&&!Rt?ge:void 0},D==null?void 0:D.style),ae),de=pe("tag",p),[Qe,At,St]=ie(de),Gt=q()(de,D==null?void 0:D.className,{[`${de}-${ge}`]:Rt,[`${de}-has-color`]:ge&&!Rt,[`${de}-hidden`]:!yt,[`${de}-rtl`]:je==="rtl",[`${de}-borderless`]:!ce},C,h,At,St),Bt=We=>{We.stopPropagation(),we==null||we(We),!We.defaultPrevented&&ut(!1)},[,$t]=(0,u.Z)((0,u.w)(r),(0,u.w)(D),{closable:!1,closeIconRender:We=>{const Qt=j.createElement("span",{className:`${de}-close-icon`,onClick:Bt},We);return(0,Z.wm)(We,Qt,Pe=>({onClick:Nt=>{var Tt;(Tt=Pe==null?void 0:Pe.onClick)===null||Tt===void 0||Tt.call(Pe,Nt),Bt(Nt)},className:q()(Pe==null?void 0:Pe.className,`${de}-close-icon`)}))}}),a=typeof V.onClick=="function"||Y&&Y.type==="a",wt=ue||null,Ht=wt?j.createElement(j.Fragment,null,wt,Y&&j.createElement("span",null,Y)):Y,Wt=j.createElement("span",Object.assign({},Vt,{ref:M,className:Gt,style:kt}),Ht,$t,Zt&&j.createElement(fe,{key:"preset",prefixCls:de}),xt&&j.createElement(Me,{key:"status",prefixCls:de}));return Qe(a?j.createElement(d.Z,{component:"Tag"},Wt):Wt)});He.CheckableTag=Q;var it=He}}]);
