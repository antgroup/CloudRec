(self.webpackChunk=self.webpackChunk||[]).push([[6673],{52745:function(oe,F,a){"use strict";a.d(F,{Z:function(){return g}});var j=a(87462),p=a(62435),E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"},P=E,z=a(84089),u=function(Z,X){return p.createElement(z.Z,(0,j.Z)({},Z,{ref:X,icon:P}))},ae=p.forwardRef(u),g=ae},31732:function(oe,F,a){"use strict";var j=a(97857),p=a.n(j),E=a(66309),P=a(62435),z=a(86074);F.Z=function(u){var ae=u.text,g=u.style;return(0,z.jsx)(E.Z,{style:p()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},g),children:ae})}},24163:function(oe,F,a){"use strict";var j=a(97857),p=a.n(j),E=a(25593),P=a(83062),z=a(62435),u=a(86074),ae=E.Z.Paragraph;F.Z=function(g){var U=g.text,Z=g.width,X=g.maxWidth,G=g.rows,ie=G===void 0?2:G,ue=g.placement,xe=ue===void 0?"top":ue,N=g.color,je=N===void 0?"rgba(0, 0, 0, 0.88)":N,Y=g.link,De=Y===void 0?!1:Y,Qe=g.onClickCallBackFunc,re=g.style,k=re===void 0?{}:re,Me=g.copyable,Je=Me===void 0?!1:Me;return(0,u.jsx)("div",{style:{maxWidth:X,width:Z},children:(0,u.jsx)(P.Z,{title:(0,u.jsx)("div",{children:U}),placement:xe,children:(0,u.jsx)(ae,{ellipsis:{rows:ie},style:p()({marginBottom:0,color:je,cursor:De?"pointer":""},k),onClick:Qe,copyable:Je,children:U})})})}},28235:function(oe,F,a){"use strict";var j=a(97857),p=a.n(j),E=a(25593),P=a(83062),z=a(62435),u=a(86074),ae=E.Z.Paragraph;F.Z=function(g){var U=g.text,Z=g.width,X=g.maxWidth,G=g.rows,ie=G===void 0?2:G,ue=g.placement,xe=ue===void 0?"top":ue,N=g.color,je=N===void 0?"rgba(0, 0, 0, 0.88)":N,Y=g.link,De=Y===void 0?!1:Y,Qe=g.onClickCallBackFunc,re=g.style,k=re===void 0?{}:re,Me=g.copyable,Je=Me===void 0?!1:Me,xt=g.tooltipText;return(0,u.jsx)("div",{style:{maxWidth:X,width:Z},children:(0,u.jsx)(P.Z,{title:xt,placement:xe,children:(0,u.jsx)(ae,{ellipsis:{rows:ie},style:p()({marginBottom:0,color:je,cursor:De?"pointer":""},k),onClick:Qe,copyable:Je,children:U})})})}},28326:function(oe,F,a){"use strict";a.r(F),a.d(F,{default:function(){return ja}});var j=a(15009),p=a.n(j),E=a(99289),P=a.n(E),z=a(5574),u=a.n(z),ae=a(79930),g=a(96655),U=a(17910),Z=a(29448),X=a(39380),G=a(93410),ie=a(92016),ue=a(3303),xe=a(68872),N=a(23323),je=a(71230),Y=a(15746),De=a(84567),Qe=a(34041),re=a(42075),k=a(83622),Me=a(92398),Je=a(68795),xt=a(33160),Pe=a(96486),d=a(62435),Vt=a(13769),Ut=a.n(Vt),It=a(9783),fe=a.n(It),r=a(97857),m=a.n(r),I=a(31732),x=a(24163),T=a(28235),ce=a(66309),ne=a(85265),Ze=a(57381),K=a(26412),se=a(25593),e=a(86074),Xe=function(y){var R=y.visible,_=y.onClose,Re=y.ruleId,ft=y.ruleCode,Nt=(0,ie.useIntl)(),Ee=xe.ZP.useMessage(),q=u()(Ee,2),ye=q[0],ve=q[1],H=(0,d.useState)(!1),Ie=u()(H,2),O=Ie[0],le=Ie[1],ge=(0,d.useState)(null),C=u()(ge,2),V=C[0],c=C[1];(0,d.useEffect)(function(){R&&Re&&w()},[R,Re]);var w=function(){var me=P()(p()().mark(function ee(){var Ce;return p()().wrap(function($){for(;;)switch($.prev=$.next){case 0:if(le(!0),$.prev=1,!Re){$.next=6;break}return $.next=5,(0,g.queryRuleDetail)({id:Re});case 5:Ce=$.sent;case 6:Ce&&Ce.content&&c(Ce.content),$.next=12;break;case 9:$.prev=9,$.t0=$.catch(1),ye.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return $.prev=12,le(!1),$.finish(12);case 15:case"end":return $.stop()}},ee,null,[[1,9,12,15]])}));return function(){return me.apply(this,arguments)}}(),_e=function(){c(null),_()},We=function(ee){switch(ee.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},vt=function(ee){if(!ee)return null;var Ce=ee.split(",");return Ce.map(function(et,$){return(0,e.jsx)(ce.Z,{color:We(et.trim()),children:et.trim()},$)})},qe=function(ee){return(0,Z.c5)(ee)};return(0,e.jsxs)(e.Fragment,{children:[ve,(0,e.jsx)(ne.Z,{title:"\u89C4\u5219\u8BE6\u60C5",placement:"right",onClose:_e,open:R,width:1e3,destroyOnClose:!0,children:(0,e.jsx)(Ze.Z,{spinning:O,children:V&&(0,e.jsxs)(K.Z,{column:1,bordered:!0,children:[(0,e.jsx)(K.Z.Item,{label:"\u89C4\u5219\u540D\u79F0",children:(0,e.jsx)(se.Z.Text,{copyable:!0,children:V.ruleName})}),(0,e.jsx)(K.Z.Item,{label:"\u89C4\u5219code",children:(0,e.jsx)(se.Z.Text,{copyable:!0,children:V.ruleCode})}),(0,e.jsx)(K.Z.Item,{label:"\u4FEE\u590D\u5EFA\u8BAE",children:(0,e.jsx)(se.Z.Text,{copyable:!0,children:V.advice})}),(0,e.jsx)(K.Z.Item,{label:"\u4FEE\u590D\u6587\u6863",children:(0,e.jsx)(se.Z.Text,{copyable:!0,children:V.link})}),(0,e.jsx)(K.Z.Item,{label:"\u4E0A\u4E0B\u6587\u6A21\u677F",children:(0,e.jsx)(se.Z.Text,{copyable:!0,children:V.context})}),V.ruleRego&&(0,e.jsx)(K.Z.Item,{label:"\u7B56\u7565",children:(0,e.jsx)(se.Z.Paragraph,{copyable:!0,children:(0,e.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"1000px",overflow:"auto"},children:V.ruleRego})})}),V.createTime&&(0,e.jsx)(K.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:(0,e.jsx)(se.Z.Text,{copyable:!0,children:V.createTime})}),V.updateTime&&(0,e.jsx)(K.Z.Item,{label:"\u66F4\u65B0\u65F6\u95F4",children:(0,e.jsx)(se.Z.Text,{copyable:!0,children:V.updateTime})})]})})})]})},Se=Xe,ze=a(87462),St={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"},he=St,Fe=a(84089),mt=function(y,R){return d.createElement(Fe.Z,(0,ze.Z)({},y,{ref:R,icon:he}))},Gt=d.forwardRef(mt),Ot=Gt,wt=a(86548),bt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},Ht=bt,de=function(y,R){return d.createElement(Fe.Z,(0,ze.Z)({},y,{ref:R,icon:Ht}))},Qt=d.forwardRef(de),Jt=Qt,At=a(52745),Xt=a(24969),Rt=a(90498),$t=a(75302),Ye=a(83062),Tt=a(55241),Lt=a(86738),Bt=a(72269),Ne=function(){return{style:{cursor:"pointer"},onMouseEnter:function(R){R.currentTarget.style.backgroundColor="#f5f5f5",R.currentTarget.style.transform="scale(1.01)",R.currentTarget.style.transition="all 0.2s ease",R.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)"},onMouseLeave:function(R){R.currentTarget.style.backgroundColor="",R.currentTarget.style.transform="scale(1)",R.currentTarget.style.boxShadow=""}}},Dt=function(y){return function(R){return m()({onClick:function(){return y(R)}},Ne())}},ke=["pageSize","current"],zt=$t.ZP.useBreakpoint,jt=function(y){var R=y.form,_=y.platformList,Re=y.resourceTypeList,ft=y.ruleGroupList,Nt=y.ruleTypeList,Ee=y.allRuleList,q=y.checkNewRules,ye=y.newRulesCount,ve=y.queryTrigger,H=xe.ZP.useMessage(),Ie=u()(H,2),O=Ie[0],le=Ie[1],ge=zt(),C=(0,d.useRef)(),V=(0,d.useRef)(),c=(0,ie.useIntl)(),w=(0,d.useState)(),_e=u()(w,2),We=_e[0],vt=_e[1],qe=(0,d.useState)({}),me=u()(qe,2),ee=me[0],Ce=me[1],et=(0,d.useState)(!1),$=u()(et,2),gt=$[0],tt=$[1],at=(0,d.useState)(),rt=u()(at,2),pt=rt[0],ht=rt[1],pe=(0,d.useState)({}),Oe=u()(pe,2),Ke=Oe[0],yt=Oe[1],Wt=(0,d.useState)({}),nt=u()(Wt,2),Ve=nt[0],we=nt[1],st=(0,d.useState)({}),lt=u()(st,2),ot=lt[0],Ue=lt[1],it=(0,d.useState)([]),Ge=u()(it,2),Ae=Ge[0],He=Ge[1],Mt=(0,d.useState)(!1),$e=u()(Mt,2),Pt=$e[0],Te=$e[1],Zt=(0,d.useState)(!1),Le=u()(Zt,2),ut=Le[0],Be=Le[1],kt=(0,d.useState)(!1),ct=u()(kt,2),Q=ct[0],B=ct[1],J=(0,d.useState)(!1),Et=u()(J,2),te=Et[0],Kt=Et[1];(0,d.useEffect)(function(){if(ve!==void 0&&ve>0){var f;(f=C.current)===null||f===void 0||f.reload()}},[ve]);var Yt=function(i){return i.id===We?"ant-table-row-selected":""},_t=function(i){ht(i.id),tt(!0)},qt=function(){tt(!1),ht(void 0)},ea=function(){var f=P()(p()().mark(function i(t){var s,l,v,h;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=O.loading(c.formatMessage({id:"common.message.text.delete.loading"})),n.next=3,(0,g.deleteRule)({id:t});case 3:l=n.sent,s(),(l.code===200||l.msg==="success")&&(O.success(c.formatMessage({id:"common.message.text.delete.success"})),(v=C.current)===null||v===void 0||(h=v.reloadAndRest)===null||h===void 0||h.call(v));case 6:case"end":return n.stop()}},i)}));return function(t){return f.apply(this,arguments)}}(),ta=function(){var f=P()(p()().mark(function i(t){var s,l,v,h;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return yt(m()(m()({},Ke),{},fe()({},t,!0))),s=O.loading(c.formatMessage({id:"common.message.text.copy.loading"})),n.next=4,(0,g.copyRule)({id:t});case 4:l=n.sent,yt(m()(m()({},Ke),{},fe()({},t,!1))),s(),(l.code===200||l.msg==="success")&&(O.success(c.formatMessage({id:"common.message.text.copy.success"})),(v=C.current)===null||v===void 0||(h=v.reloadAndRest)===null||h===void 0||h.call(v));case 8:case"end":return n.stop()}},i)}));return function(t){return f.apply(this,arguments)}}(),aa=function(){var f=P()(p()().mark(function i(t){var s,l,v,h;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=t.id,we(m()(m()({},Ve),{},fe()({},s,!0))),n.prev=2,n.next=5,(0,g.addTenantSelectRule)({ruleCode:t.ruleCode});case 5:l=n.sent,(l.code===200||l.msg==="success")&&(O.success(c.formatMessage({id:"common.message.text.success"})),(v=C.current)===null||v===void 0||(h=v.reloadAndRest)===null||h===void 0||h.call(v)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),O.error(c.formatMessage({id:"common.message.text.failed"}));case 12:return n.prev=12,we(m()(m()({},Ve),{},fe()({},s,!1))),n.finish(12);case 15:case"end":return n.stop()}},i,null,[[2,9,12,15]])}));return function(t){return f.apply(this,arguments)}}(),M=function(){var f=P()(p()().mark(function i(t){var s,l,v,h;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=t.id,Ue(m()(m()({},ot),{},fe()({},s,!0))),n.prev=2,n.next=5,(0,g.removeTenantSelectRule)({ruleCode:t.ruleCode});case 5:l=n.sent,(l.code===200||l.msg==="success")&&(O.success(c.formatMessage({id:"common.message.text.success"})),(v=C.current)===null||v===void 0||(h=v.reloadAndRest)===null||h===void 0||h.call(v)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),O.error(c.formatMessage({id:"common.message.text.failed"}));case 12:return n.prev=12,Ue(m()(m()({},ot),{},fe()({},s,!1))),n.finish(12);case 15:case"end":return n.stop()}},i,null,[[2,9,12,15]])}));return function(t){return f.apply(this,arguments)}}(),L=function(){var f=P()(p()().mark(function i(){var t,s,l,v,h;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(Kt(!0),n.prev=1,t=Ee==null?void 0:Ee.filter(function(W){return Ae.includes(W.id)}),s=(t==null?void 0:t.map(function(W){return W.ruleCode}))||[],s.length!==0){n.next=7;break}return O.warning(c.formatMessage({id:"common.message.text.no.valid.data"})),n.abrupt("return");case 7:return n.next=9,(0,g.batchAddTenantSelectRule)({ruleCodeList:s});case 9:l=n.sent,(l.code===200||l.msg==="success")&&(O.success(c.formatMessage({id:"common.message.text.success"})),(v=C.current)===null||v===void 0||(h=v.reloadAndRest)===null||h===void 0||h.call(v),He([])),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(1),O.error(c.formatMessage({id:"common.message.text.failed"}));case 16:return n.prev=16,Kt(!1),n.finish(16);case 19:case"end":return n.stop()}},i,null,[[1,13,16,19]])}));return function(){return f.apply(this,arguments)}}(),o=function(i){B(!0),(0,g.queryExportRuleList)(i?{idList:i}:void 0,{responseType:"blob"}).then(function(t){(0,Z.a5)(t,"CloudRec ".concat(c.formatMessage({id:"rule.module.text.rule.data"}))),O.success(c.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return B(!1)})},S=function(){var f=P()(p()().mark(function i(t,s){var l,v,h,b;return p()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return l={id:t,status:s},W.next=3,(0,g.changeRuleStatus)(l);case 3:v=W.sent,(v.code===200||v.msg==="success")&&(O.success(c.formatMessage({id:"common.message.text.edit.success"})),(h=C.current)===null||h===void 0||(b=h.reloadAndRest)===null||b===void 0||b.call(h));case 5:case"end":return W.stop()}},i)}));return function(t,s){return f.apply(this,arguments)}}(),A=[{title:c.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(i,t){var s,l,v=(t==null?void 0:t.selectedTenantNameList)&&t.selectedTenantNameList.length>0;return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,e.jsx)(T.Z,{placement:"topLeft",maxWidth:ge!=null&&ge.xxl?600:400,rows:1,text:(t==null?void 0:t.ruleName)||"-",style:{fontWeight:500,color:"rgb(58, 58, 58)"}}),v&&(0,e.jsx)(Ye.Z,{title:(0,e.jsx)("div",{children:(s=t.selectedTenantNameList)===null||s===void 0?void 0:s.map(function(h,b){return(0,e.jsxs)("div",{style:{fontSize:12},children:["\u2022 ",h]},b)})}),placement:"topRight",children:(0,e.jsx)(Ot,{style:{color:"#1890ff",fontSize:14,cursor:"pointer"}})})]}),(0,e.jsx)(x.Z,{placement:"topLeft",maxWidth:ge!=null&&ge.xxl?600:400,rows:1,text:(t==null||(l=t.ruleTypeNameList)===null||l===void 0?void 0:l.toString())||"-",style:{color:"rgb(166, 167, 167)",fontSize:13}})]})}},{title:c.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(i,t){return(0,e.jsx)(I.Z,{text:(t==null?void 0:t.resourceTypeStr)||"-"})}},{title:c.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,Z.W_)(U.I9),align:"center",hideInSearch:!0,render:function(i,t){return(0,Z.Dd)(U.I9,t==null?void 0:t.riskLevel)}},{title:c.formatMessage({id:"common.table.columns.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(i,t){return(0,e.jsxs)("div",{children:[(0,e.jsx)("section",{style:{color:"#999"},children:(t==null?void 0:t.gmtCreate)||"-"}),(0,e.jsx)("section",{style:{color:"#999"},children:(t==null?void 0:t.gmtModified)||"-"})]})}},{title:c.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,Z.W_)(_),align:"center",hideInSearch:!0,render:function(i,t){return(0,Z.c5)(t.platform,_)}},{title:c.formatMessage({id:"rule.input.text.rule.group.creator"}),dataIndex:"username",valueType:"text",hideInSearch:!0,width:120},{title:c.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(i,t){return(0,e.jsxs)(re.Z,{size:"small",children:[(0,e.jsx)(k.ZP,{size:"small",onClick:function(l){l.stopPropagation(),vt(t.id)},type:"link",target:"_self",href:"/ruleManagement/ruleProject/edit?id=".concat(t==null?void 0:t.id),children:(0,e.jsx)(Ye.Z,{title:c.formatMessage({id:"common.button.text.edit"}),children:(0,e.jsx)(wt.Z,{})})}),(0,e.jsx)(Tt.Z,{content:(0,e.jsxs)(re.Z,{children:[(0,e.jsx)(Lt.Z,{title:c.formatMessage({id:"common.button.text.delete.confirm"}),onConfirm:function(l){l==null||l.stopPropagation(),ea(t.id)},okText:c.formatMessage({id:"common.button.text.ok"}),cancelText:c.formatMessage({id:"common.button.text.cancel"}),children:(0,e.jsx)(k.ZP,{block:!0,type:"link",danger:!0,size:"small",onClick:function(l){return l.stopPropagation()},children:c.formatMessage({id:"common.button.text.delete"})})}),(0,e.jsx)(k.ZP,{block:!0,loading:Ke[Number(t.id)],onClick:function(l){l.stopPropagation(),ta(t.id)},type:"link",target:"_blank",size:"small",children:c.formatMessage({id:"common.button.text.copy"})})]}),children:(0,e.jsx)(k.ZP,{type:"link",icon:(0,e.jsx)(Jt,{}),onClick:function(l){return l.stopPropagation()}})}),t.tenantSelected?(0,e.jsx)(Lt.Z,{title:c.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(l){l==null||l.stopPropagation(),M(t)},onCancel:function(l){return l==null?void 0:l.stopPropagation()},okText:c.formatMessage({id:"common.button.text.ok"}),cancelText:c.formatMessage({id:"common.button.text.cancel"}),children:(0,e.jsx)(k.ZP,{type:"default",size:"small",loading:ot[Number(t.id)],onClick:function(l){return l.stopPropagation()},icon:(0,e.jsx)(At.Z,{}),danger:!0})}):(0,e.jsx)(k.ZP,{type:"primary",size:"small",loading:Ve[Number(t.id)],onClick:function(l){l.stopPropagation(),aa(t)},icon:(0,e.jsx)(Xt.Z,{})}),(0,e.jsx)(Ye.Z,{title:c.formatMessage({id:"rule.module.text.tooltip.status"}),children:(0,e.jsx)(Bt.Z,{checked:(t==null?void 0:t.status)==="valid",onClick:function(l,v){v==null||v.stopPropagation(),S(t.id,(t==null?void 0:t.status)==="valid"?"invalid":"valid")}})})]})}}];return(0,e.jsxs)(e.Fragment,{children:[le,(0,e.jsx)(Rt.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:Ae,onChange:function(i){return He(i)},preserveSelectedRowKeys:!0},actionRef:C,formRef:V,rowClassName:Yt,rowKey:"id",search:!1,toolBarRender:function(){return[(0,e.jsx)(k.ZP,{type:"primary",href:"/ruleManagement/ruleProject/edit",children:c.formatMessage({id:"rule.extend.basic.add"})},"CREATE"),(0,e.jsx)(Tt.Z,{open:Pt,onOpenChange:function(t){return Te(t)},title:c.formatMessage({id:"rule.module.text.sync.confirm"}),content:(0,e.jsxs)(re.Z,{children:[(0,e.jsx)(k.ZP,{danger:!0,type:"default",loading:ut,onClick:P()(p()().mark(function i(){var t,s,l,v;return p()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return Be(!0),t=O.loading(c.formatMessage({id:"rule.module.text.sync.loading"})),b.prev=2,b.next=5,(0,g.loadRuleFromGithub)({coverage:!0});case 5:s=b.sent,(s.code===200||s.msg==="success")&&(O.success(c.formatMessage({id:"rule.module.text.sync.success"})),(l=C.current)===null||l===void 0||(v=l.reloadAndRest)===null||v===void 0||v.call(l),q());case 7:return b.prev=7,t(),Be(!1),Te(!1),b.finish(7);case 12:case"end":return b.stop()}},i,null,[[2,,7,12]])})),children:c.formatMessage({id:"rule.module.text.sync.overwrite"})}),(0,e.jsx)(k.ZP,{type:"default",loading:ut,onClick:P()(p()().mark(function i(){var t,s,l,v;return p()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return Be(!0),t=O.loading(c.formatMessage({id:"rule.module.text.sync.loading"})),b.prev=2,b.next=5,(0,g.loadRuleFromGithub)({coverage:!1});case 5:s=b.sent,(s.code===200||s.msg==="success")&&(O.success(c.formatMessage({id:"rule.module.text.sync.success"})),(l=C.current)===null||l===void 0||(v=l.reloadAndRest)===null||v===void 0||v.call(l),q());case 7:return b.prev=7,t(),Be(!1),Te(!1),b.finish(7);case 12:case"end":return b.stop()}},i,null,[[2,,7,12]])})),children:c.formatMessage({id:"rule.module.text.sync.no.overwrite"})}),(0,e.jsx)(k.ZP,{onClick:function(){Te(!1)},children:c.formatMessage({id:"common.button.text.cancel"})})]}),trigger:"click",children:(0,e.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,e.jsx)(k.ZP,{type:"default",children:c.formatMessage({id:"rule.module.text.sync.button"})}),ye>0&&(0,e.jsx)("div",{style:{position:"absolute",top:"-8px",right:"-8px",backgroundColor:"#ff4d4f",color:"white",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",zIndex:1},children:ye>99?"99+":ye})]})},"sync"),(0,e.jsx)(k.ZP,{type:"default",loading:te,disabled:Ae.length===0,onClick:L,children:c.formatMessage({id:"rule.module.text.batch.add.to.favorites"})},"BATCH_ADD_TO_FAVORITES"),(0,e.jsx)(k.ZP,{loading:Q,type:"default",disabled:Ae.length===0,onClick:function(){return o(Ae)},children:c.formatMessage({id:"common.button.text.export"})},"EXPORT")]},request:function(){var f=P()(p()().mark(function i(t,s){var l,v,h,b,n,W,D,ra,dt,la;return p()().wrap(function(Ct){for(;;)switch(Ct.prev=Ct.next){case 0:return l=t.pageSize,v=t.current,h=Ut()(t,ke),b=R.getFieldsValue(),n=(0,Z.Hm)(s),W=m()(m()(m()({},h),b),{},{page:v,size:l}),(0,Pe.isEmpty)(n)||(W.sortParam=n==null?void 0:n.key,W.sortType=n==null||(D=n.value)===null||D===void 0||(D=D.slice(0,-3))===null||D===void 0?void 0:D.toUpperCase()),Ct.next=7,(0,g.queryRuleList)(W);case 7:return ra=Ct.sent,dt=ra.content,la=ra.code,Ct.abrupt("return",{data:(dt==null?void 0:dt.data)||[],total:(dt==null?void 0:dt.total)||0,success:la===200||!1});case 11:case"end":return Ct.stop()}},i)}));return function(i,t){return f.apply(this,arguments)}}(),columns:A,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:Dt(_t)}),(0,e.jsx)(Se,{visible:gt,onClose:qt,ruleId:pt})]})},oa=jt,ia=a(53846),ua=a(90598),ca={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 01-12.7-6.5V353.7a8 8 0 0112.7-6.5L656.1 506a7.9 7.9 0 010 12.9z"}}]},name:"play-circle",theme:"filled"},da=ca,ma=function(y,R){return d.createElement(Fe.Z,(0,ze.Z)({},y,{ref:R,icon:da}))},fa=d.forwardRef(ma),va=fa,ga={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},pa=ga,ha=function(y,R){return d.createElement(Fe.Z,(0,ze.Z)({},y,{ref:R,icon:pa}))},ya=d.forwardRef(ha),Ca=ya,Ft=a(78045),xa=["pageSize","current"],Sa=$t.ZP.useBreakpoint,ba=function(y){var R=y.form,_=y.platformList,Re=y.resourceTypeList,ft=y.ruleGroupList,Nt=y.ruleTypeList,Ee=y.allRuleList,q=y.queryTrigger,ye=xe.ZP.useMessage(),ve=u()(ye,2),H=ve[0],Ie=ve[1],O=Sa(),le=(0,d.useRef)(),ge=(0,d.useRef)(),C=(0,ie.useIntl)(),V=(0,d.useState)(),c=u()(V,2),w=c[0],_e=c[1],We=(0,d.useState)({}),vt=u()(We,2),qe=vt[0],me=vt[1],ee=(0,d.useState)({}),Ce=u()(ee,2),et=Ce[0],$=Ce[1],gt=(0,d.useState)({}),tt=u()(gt,2),at=tt[0],rt=tt[1],pt=(0,d.useState)([]),ht=u()(pt,2),pe=ht[0],Oe=ht[1],Ke=(0,d.useState)(!1),yt=u()(Ke,2),Wt=yt[0],nt=yt[1],Ve=(0,d.useState)(!1),we=u()(Ve,2),st=we[0],lt=we[1],ot=(0,d.useState)(!1),Ue=u()(ot,2),it=Ue[0],Ge=Ue[1],Ae=(0,d.useState)(),He=u()(Ae,2),Mt=He[0],$e=He[1],Pt=(0,d.useState)(!0),Te=u()(Pt,2),Zt=Te[0],Le=Te[1],ut=(0,d.useState)(!1),Be=u()(ut,2),kt=Be[0],ct=Be[1],Q=(0,d.useState)("all"),B=u()(Q,2),J=B[0],Et=B[1],te=function(L){return L.id===w?"ant-table-row-selected":""},Kt=function(L){$e(L.id),Ge(!0)};(0,d.useEffect)(function(){if(q!==void 0&&q>0){var M;(M=le.current)===null||M===void 0||M.reload()}},[q]);var Yt=function(){var M=P()(p()().mark(function L(o){var S,A,f,i;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return me(m()(m()({},qe),{},fe()({},o,!0))),S=H.loading(C.formatMessage({id:"common.message.text.execute.loading"})),s.next=4,(0,g.scanByRule)({id:o});case 4:A=s.sent,me(m()(m()({},qe),{},fe()({},o,!1))),S(),(A.code===200||A.msg==="success")&&(H.success(C.formatMessage({id:"common.message.text.execute.success"})),(f=le.current)===null||f===void 0||(i=f.reloadAndRest)===null||i===void 0||i.call(f));case 8:case"end":return s.stop()}},L)}));return function(o){return M.apply(this,arguments)}}(),_t=function(){var M=P()(p()().mark(function L(o){var S,A,f,i;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return S=o.id,rt(m()(m()({},at),{},fe()({},S,!0))),s.prev=2,s.next=5,(0,g.removeTenantSelectRule)({ruleCode:o.ruleCode});case 5:A=s.sent,(A.code===200||A.msg==="success")&&(H.success(C.formatMessage({id:"common.message.text.success"})),(f=le.current)===null||f===void 0||(i=f.reloadAndRest)===null||i===void 0||i.call(f)),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),H.error(C.formatMessage({id:"common.message.text.fail"}));case 12:return s.prev=12,rt(m()(m()({},at),{},fe()({},S,!1))),s.finish(12);case 15:case"end":return s.stop()}},L,null,[[2,9,12,15]])}));return function(o){return M.apply(this,arguments)}}(),qt=function(){var M=P()(p()().mark(function L(){var o,S,A,f;return p()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(pe.length!==0){t.next=2;break}return t.abrupt("return");case 2:return nt(!0),t.prev=3,o=pe.map(function(s){return Number(s)}),t.next=7,(0,g.scanRuleList)({idList:o});case 7:S=t.sent,(S.code===200||S.msg==="success")&&(H.success(C.formatMessage({id:"common.message.text.success"})),Oe([]),(A=le.current)===null||A===void 0||(f=A.reloadAndRest)===null||f===void 0||f.call(A)),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),H.error(C.formatMessage({id:"common.message.text.fail"}));case 14:return t.prev=14,nt(!1),t.finish(14);case 17:case"end":return t.stop()}},L,null,[[3,11,14,17]])}));return function(){return M.apply(this,arguments)}}(),ea=function(){var M=P()(p()().mark(function L(){var o,S,A,f,i,t,s,l,v,h;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(pe.length!==0){n.next=2;break}return n.abrupt("return");case 2:return lt(!0),n.prev=3,S=R.getFieldsValue(),A={page:1,size:1e3,platformList:S.platformList,riskLevelList:S.riskLevelList,ruleCodeList:S.ruleCodeList,resourceTypeList:S.resourceTypeList,ruleGroupIdList:S.ruleGroupIdList,ruleTypeIdList:S.ruleTypeIdList},n.next=8,(0,g.queryEffectRuleList)(A);case 8:return f=n.sent,i=(f==null||(o=f.content)===null||o===void 0?void 0:o.data)||[],t=i.filter(function(W){return pe.includes(W.id)}),s=t.map(function(W){return W.ruleCode}),n.next=14,(0,g.batchDeleteTenantSelectRule)({ruleCodeList:s});case 14:l=n.sent,(l.code===200||l.msg==="success")&&(H.success(C.formatMessage({id:"common.message.text.success"})),Oe([]),(v=le.current)===null||v===void 0||(h=v.reloadAndRest)===null||h===void 0||h.call(v)),n.next=21;break;case 18:n.prev=18,n.t0=n.catch(3),H.error(C.formatMessage({id:"common.message.text.fail"}));case 21:return n.prev=21,lt(!1),n.finish(21);case 24:case"end":return n.stop()}},L,null,[[3,18,21,24]])}));return function(){return M.apply(this,arguments)}}(),ta=function(){var M=P()(p()().mark(function L(o,S){var A,f,i,t,s,l,v,h,b,n;return p()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return A=o.pageSize,f=o.current,i=Ut()(o,xa),D.prev=1,t=R.getFieldsValue(),s=m()({page:f||1,size:A||10,platformList:t.platformList,riskLevelList:t.riskLevelList,ruleCodeList:t.ruleCodeList,resourceTypeList:t.resourceTypeList,ruleGroupIdList:t.ruleGroupIdList,ruleTypeIdList:t.ruleTypeIdList,effectRuleType:J},i),S&&Object.keys(S).length>0&&(l=Object.keys(S)[0],v=S[l],s.sortParam=l,s.sortType=v==="ascend"?"ASC":"DESC"),D.next=7,(0,g.queryEffectRuleList)(s);case 7:if(h=D.sent,!(h!=null&&h.content)){D.next=16;break}return b=h.content.data||[],n=h.content.total||0,Le(n>0),ct(!0),D.abrupt("return",{data:b,total:n,success:!0});case 16:return Le(!1),ct(!0),D.abrupt("return",{data:[],total:0,success:!1});case 19:D.next=26;break;case 21:return D.prev=21,D.t0=D.catch(1),Le(!1),ct(!0),D.abrupt("return",{data:[],total:0,success:!1});case 26:case"end":return D.stop()}},L,null,[[1,21]])}));return function(o,S){return M.apply(this,arguments)}}(),aa=[{title:C.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(L,o){var S;return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{style:{fontWeight:500,color:"rgb(58, 58, 58)",display:"flex",alignItems:"center",gap:"8px"},children:[(0,e.jsx)("span",{children:(o==null?void 0:o.ruleName)||"-"}),(o==null?void 0:o.defaultRuleSelected)&&(0,e.jsx)(Ye.Z,{title:"default",children:(0,e.jsx)(ua.Z,{style:{color:"#faad14",fontSize:"14px"}})})]}),(0,e.jsx)("div",{style:{color:"rgb(166, 167, 167)",fontSize:13},children:(o==null||(S=o.ruleTypeNameList)===null||S===void 0?void 0:S.toString())||"-"})]})}},{title:C.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(L,o){return(0,e.jsx)(I.Z,{text:(o==null?void 0:o.resourceTypeStr)||"-"})}},{title:C.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,Z.W_)(U.I9),align:"center",hideInSearch:!0,render:function(L,o){return(0,Z.Dd)(U.I9,o==null?void 0:o.riskLevel)}},{title:C.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,Z.W_)(_),align:"center",hideInSearch:!0,render:function(L,o){return(0,Z.c5)(o.platform,_)}},{title:C.formatMessage({id:"asset.module.risk.number"}),dataIndex:"riskCount",valueType:"text",hideInSearch:!0,align:"center",sorter:!0,render:function(L,o){return(0,e.jsx)(k.ZP,{type:"link",size:"small",href:"/riskManagement/riskList?platform=".concat(o==null?void 0:o.platform,"&ruleCode=").concat(o==null?void 0:o.ruleCode),children:o==null?void 0:o.riskCount})}},{title:C.formatMessage({id:"cloudAccount.extend.title.lastScanTime"}),dataIndex:"lastScanTime",valueType:"text",hideInSearch:!0,align:"center",width:150,sorter:!0,render:function(L,o){return o!=null&&o.lastScanTime?(0,e.jsx)(Ye.Z,{title:o.lastScanTime,children:(0,e.jsx)("span",{children:o.lastScanTime})}):"-"}},{title:C.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",width:180,render:function(L,o){var S=o==null?void 0:o.isRunning,A=S===0,f=function(){return S===1?(0,e.jsx)(va,{}):(0,e.jsx)(Ca,{})};return(0,e.jsxs)(re.Z,{size:"small",children:[(0,e.jsx)(k.ZP,{block:!0,loading:qe[Number(o.id)],disabled:!A,onClick:function(t){t.stopPropagation(),Yt(o.id)},type:"default",target:"_blank",size:"small",icon:f(),style:{color:S===1?"#52c41a":void 0,borderColor:S===1?"#52c41a":void 0},children:C.formatMessage({id:"common.button.text.test"})}),J==="selected"&&(0,e.jsx)(Lt.Z,{title:C.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(t){t==null||t.stopPropagation(),_t(o)},onCancel:function(t){return t==null?void 0:t.stopPropagation()},okText:C.formatMessage({id:"common.button.text.ok"}),cancelText:C.formatMessage({id:"common.button.text.cancel"}),children:(0,e.jsx)(k.ZP,{danger:!0,size:"small",loading:at[Number(o.id)],icon:(0,e.jsx)(At.Z,{}),onClick:function(t){return t.stopPropagation()}})})]})}}];return(0,e.jsxs)(e.Fragment,{children:[Ie,(0,e.jsx)(Rt.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:pe,onChange:function(L){return Oe(L)},preserveSelectedRowKeys:!0},headerTitle:(0,e.jsx)("div",{className:ia.Z.customTitle,children:(0,e.jsx)(re.Z,{children:(0,e.jsxs)(Ft.ZP.Group,{value:J,onChange:function(L){var o;Et(L.target.value),Oe([]),(o=le.current)===null||o===void 0||o.reload()},size:"middle",buttonStyle:"solid",children:[(0,e.jsx)(Ft.ZP.Button,{value:"all",children:C.formatMessage({id:"common.module.text.all"})}),(0,e.jsx)(Ft.ZP.Button,{value:"selected",children:C.formatMessage({id:"common.module.text.selected"})}),(0,e.jsx)(Ft.ZP.Button,{value:"default",children:C.formatMessage({id:"common.module.text.default"})})]})})}),actionRef:le,formRef:ge,rowClassName:te,rowKey:"id",search:!1,toolBarRender:function(){return[(0,e.jsx)(k.ZP,{type:"primary",loading:Wt,disabled:pe.length===0,onClick:qt,children:C.formatMessage({id:"rule.module.text.batch.test"})},"BATCH_DETECT"),J==="selected"&&(0,e.jsx)(k.ZP,{danger:!0,loading:st,disabled:pe.length===0,onClick:ea,children:C.formatMessage({id:"rule.module.text.batch.remove"})},"BATCH_REMOVE")].filter(Boolean)},request:ta,columns:aa,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:Dt(Kt)}),(0,e.jsx)(Se,{visible:it,onClose:function(){return Ge(!1)},ruleId:Mt})]})},Ra=ba,na=a(61194),sa=ue.Z.SHOW_CHILD,Ta=function(y,R){var _;return(_=R.label)===null||_===void 0?void 0:_.includes(y)},La=function(){var y=(0,ie.useModel)("rule"),R=y.platformList,_=y.ruleTypeList,Re=y.allRuleList,ft=y.ruleGroupList,Nt=(0,ie.useLocation)(),Ee=Nt.search,q=new URLSearchParams(Ee),ye=q.get("groupId"),ve=q.get("ruleCode"),H=q.get("platform"),Ie=xe.ZP.useMessage(),O=u()(Ie,2),le=O[0],ge=O[1],C=N.Z.useForm(),V=u()(C,1),c=V[0],w=(0,ie.useIntl)(),_e=(0,d.useState)(!1),We=u()(_e,2),vt=We[0],qe=We[1],me=(0,d.useState)(!1),ee=u()(me,2),Ce=ee[0],et=ee[1],$=(0,d.useState)(0),gt=u()($,2),tt=gt[0],at=gt[1],rt=(0,d.useState)(!1),pt=u()(rt,2),ht=pt[0],pe=pt[1],Oe=(0,d.useState)([]),Ke=u()(Oe,2),yt=Ke[0],Wt=Ke[1],nt=(0,d.useState)([]),Ve=u()(nt,2),we=Ve[0],st=Ve[1],lt=q.get("tab"),ot=(0,d.useState)(lt||"selected"),Ue=u()(ot,2),it=Ue[0],Ge=Ue[1];(0,d.useEffect)(function(){var Q=q.get("tab");Q&&Q!==it&&Ge(Q)},[Ee,it]);var Ae=(0,d.useState)(!1),He=u()(Ae,2),Mt=He[0],$e=He[1],Pt=(0,d.useState)(0),Te=u()(Pt,2),Zt=Te[0],Le=Te[1],ut=function(){var Q=P()(p()().mark(function B(){var J;return p()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.prev=0,te.next=3,(0,g.checkExistNewRule)();case 3:J=te.sent,J.code===200&&typeof J.content=="number"&&at(J.content),te.next=10;break;case 7:te.prev=7,te.t0=te.catch(0),console.error("Failed to check new rules:",te.t0);case 10:case"end":return te.stop()}},B,null,[[0,7]])}));return function(){return Q.apply(this,arguments)}}(),Be=(0,ie.useRequest)(function(Q){return(0,ae.queryGroupTypeList)({platformList:Q})},{manual:!0,formatResult:function(B){var J=B.content;st(J||[])}}),kt=Be.run,ct=function(B){pe(!0),(0,g.queryExportRuleList)(B?{idList:B}:void 0,{responseType:"blob"}).then(function(J){(0,Z.a5)(J,"CloudRec ".concat(w.formatMessage({id:"rule.module.text.rule.data"}))),le.success(w.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return pe(!1)})};return(0,d.useEffect)(function(){(0,Pe.isEmpty)(ye)||c.setFieldValue("ruleGroupIdList",[Number(ye)]),(0,Pe.isEmpty)(ve)||c.setFieldValue("ruleCodeList",[ve]),(0,Pe.isEmpty)(H)||(c.setFieldValue("platformList",[H]),kt([H])),ut()},[ye,ve,H]),(0,e.jsxs)(X._z,{ghost:!0,title:!1,className:na.Z.rulePageContainer,breadcrumbRender:!1,children:[ge,(0,e.jsx)(G.Z,{bodyStyle:{paddingBottom:0},className:na.Z.customFilterCard,children:(0,e.jsx)(N.Z,{form:c,children:(0,e.jsxs)(je.Z,{gutter:[24,10],children:[(0,e.jsx)(Y.Z,{span:24,children:(0,e.jsx)(N.Z.Item,{name:"platformList",label:w.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,e.jsx)(De.Z.Group,{options:(0,Z.T$)(R),onChange:function(B){c.setFieldValue("resourceTypeList",null),st([]),kt(B)}})})}),(0,e.jsx)(Y.Z,{span:24,children:(0,e.jsx)(N.Z.Item,{name:"riskLevelList",label:w.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,e.jsx)(De.Z.Group,{options:(0,Z.at)(U.I9)})})}),(0,e.jsx)(Y.Z,{span:6,children:(0,e.jsx)(N.Z.Item,{name:"ruleCodeList",label:w.formatMessage({id:"home.module.inform.columns.ruleName"}),style:{marginBottom:0},children:(0,e.jsx)(Qe.Z,{filterOption:Ta,placeholder:w.formatMessage({id:"common.select.text.placeholder"}),allowClear:!0,options:Re,mode:"multiple"})})}),(0,e.jsx)(Y.Z,{span:6,children:(0,e.jsx)(N.Z.Item,{name:"resourceTypeList",label:w.formatMessage({id:"cloudAccount.extend.title.asset.type"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(ue.Z,{options:we,multiple:!0,placeholder:w.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:sa,allowClear:!0,showSearch:!0})})}),(0,e.jsx)(Y.Z,{span:6,children:(0,e.jsx)(N.Z.Item,{name:"ruleGroupIdList",label:w.formatMessage({id:"layout.routes.title.ruleGroup"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(Qe.Z,{placeholder:w.formatMessage({id:"common.select.text.placeholder"}),options:ft,allowClear:!0,mode:"multiple"})})}),(0,e.jsx)(Y.Z,{span:6,children:(0,e.jsx)(N.Z.Item,{name:"ruleTypeIdList",label:w.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(ue.Z,{placeholder:w.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:sa,allowClear:!0,showSearch:!0,fieldNames:{label:"typeName",value:"id",children:"childList"},multiple:!0,options:_||[]})})}),(0,e.jsx)(Y.Z,{span:24,children:(0,e.jsx)(N.Z.Item,{style:{marginBottom:0,textAlign:"right"},children:(0,e.jsxs)(re.Z,{children:[(0,e.jsx)(k.ZP,{type:"primary",icon:(0,e.jsx)(Je.Z,{}),loading:Mt,onClick:function(){$e(!0),Le(function(B){return B+1}),setTimeout(function(){$e(!1)},500)},children:w.formatMessage({id:"common.button.text.query"})}),(0,e.jsx)(k.ZP,{icon:(0,e.jsx)(xt.Z,{}),onClick:function(){c.resetFields(),st([]),$e(!0),Le(function(B){return B+1}),setTimeout(function(){$e(!1)},500)},children:w.formatMessage({id:"common.button.text.reset"})})]})})})]})})}),(0,e.jsx)(G.Z,{style:{marginTop:16},children:(0,e.jsx)(Me.Z,{activeKey:it,onChange:function(B){Ge(B),Le(function(J){return J+1})},items:[{key:"selected",label:w.formatMessage({id:"rule.module.text.selected.rules"}),children:(0,e.jsx)(Ra,{form:c,platformList:R,resourceTypeList:we,ruleGroupList:ft,ruleTypeList:_,allRuleList:Re,queryTrigger:Zt})},{key:"market",label:w.formatMessage({id:"rule.module.text.market.rules"}),children:(0,e.jsx)(oa,{form:c,platformList:R,resourceTypeList:we,ruleGroupList:ft,ruleTypeList:_,allRuleList:Re,checkNewRules:ut,newRulesCount:tt,queryTrigger:Zt})}]})})]})},ja=La},53846:function(oe,F){"use strict";F.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},61194:function(oe,F){"use strict";F.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}},75302:function(oe,F,a){"use strict";var j=a(25378);function p(){return(0,j.Z)()}F.ZP={useBreakpoint:p}},66309:function(oe,F,a){"use strict";a.d(F,{Z:function(){return fe}});var j=a(62435),p=a(93967),E=a.n(p),P=a(98423),z=a(98787),u=a(69760),ae=a(96159),g=a(45353),U=a(53124),Z=a(861),X=a(15063),G=a(14747),ie=a(83262),ue=a(83559);const xe=r=>{const{paddingXXS:m,lineWidth:I,tagPaddingHorizontal:x,componentCls:T,calc:ce}=r,ne=ce(x).sub(I).equal(),Ze=ce(m).sub(I).equal();return{[T]:Object.assign(Object.assign({},(0,G.Wf)(r)),{display:"inline-block",height:"auto",marginInlineEnd:r.marginXS,paddingInline:ne,fontSize:r.tagFontSize,lineHeight:r.tagLineHeight,whiteSpace:"nowrap",background:r.defaultBg,border:`${(0,Z.unit)(r.lineWidth)} ${r.lineType} ${r.colorBorder}`,borderRadius:r.borderRadiusSM,opacity:1,transition:`all ${r.motionDurationMid}`,textAlign:"start",position:"relative",[`&${T}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:r.defaultColor},[`${T}-close-icon`]:{marginInlineStart:Ze,fontSize:r.tagIconSize,color:r.colorIcon,cursor:"pointer",transition:`all ${r.motionDurationMid}`,"&:hover":{color:r.colorTextHeading}},[`&${T}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${r.iconCls}-close, ${r.iconCls}-close:hover`]:{color:r.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${T}-checkable-checked):hover`]:{color:r.colorPrimary,backgroundColor:r.colorFillSecondary},"&:active, &-checked":{color:r.colorTextLightSolid},"&-checked":{backgroundColor:r.colorPrimary,"&:hover":{backgroundColor:r.colorPrimaryHover}},"&:active":{backgroundColor:r.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${r.iconCls} + span, > span + ${r.iconCls}`]:{marginInlineStart:ne}}),[`${T}-borderless`]:{borderColor:"transparent",background:r.tagBorderlessBg}}},N=r=>{const{lineWidth:m,fontSizeIcon:I,calc:x}=r,T=r.fontSizeSM;return(0,ie.mergeToken)(r,{tagFontSize:T,tagLineHeight:(0,Z.unit)(x(r.lineHeightSM).mul(T).equal()),tagIconSize:x(I).sub(x(m).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:r.defaultBg})},je=r=>({defaultBg:new X.FastColor(r.colorFillQuaternary).onBackground(r.colorBgContainer).toHexString(),defaultColor:r.colorText});var Y=(0,ue.I$)("Tag",r=>{const m=N(r);return xe(m)},je),De=function(r,m){var I={};for(var x in r)Object.prototype.hasOwnProperty.call(r,x)&&m.indexOf(x)<0&&(I[x]=r[x]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var T=0,x=Object.getOwnPropertySymbols(r);T<x.length;T++)m.indexOf(x[T])<0&&Object.prototype.propertyIsEnumerable.call(r,x[T])&&(I[x[T]]=r[x[T]]);return I},re=j.forwardRef((r,m)=>{const{prefixCls:I,style:x,className:T,checked:ce,onChange:ne,onClick:Ze}=r,K=De(r,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:se,tag:e}=j.useContext(U.E_),Xe=mt=>{ne==null||ne(!ce),Ze==null||Ze(mt)},Se=se("tag",I),[ze,St,he]=Y(Se),Fe=E()(Se,`${Se}-checkable`,{[`${Se}-checkable-checked`]:ce},e==null?void 0:e.className,T,St,he);return ze(j.createElement("span",Object.assign({},K,{ref:m,style:Object.assign(Object.assign({},x),e==null?void 0:e.style),className:Fe,onClick:Xe})))}),k=a(98719);const Me=r=>(0,k.Z)(r,(m,{textColor:I,lightBorderColor:x,lightColor:T,darkColor:ce})=>({[`${r.componentCls}${r.componentCls}-${m}`]:{color:I,background:T,borderColor:x,"&-inverse":{color:r.colorTextLightSolid,background:ce,borderColor:ce},[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}));var Je=(0,ue.bk)(["Tag","preset"],r=>{const m=N(r);return Me(m)},je);function xt(r){return typeof r!="string"?r:r.charAt(0).toUpperCase()+r.slice(1)}const Pe=(r,m,I)=>{const x=xt(I);return{[`${r.componentCls}${r.componentCls}-${m}`]:{color:r[`color${I}`],background:r[`color${x}Bg`],borderColor:r[`color${x}Border`],[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}};var d=(0,ue.bk)(["Tag","status"],r=>{const m=N(r);return[Pe(m,"success","Success"),Pe(m,"processing","Info"),Pe(m,"error","Error"),Pe(m,"warning","Warning")]},je),Vt=function(r,m){var I={};for(var x in r)Object.prototype.hasOwnProperty.call(r,x)&&m.indexOf(x)<0&&(I[x]=r[x]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var T=0,x=Object.getOwnPropertySymbols(r);T<x.length;T++)m.indexOf(x[T])<0&&Object.prototype.propertyIsEnumerable.call(r,x[T])&&(I[x[T]]=r[x[T]]);return I};const It=j.forwardRef((r,m)=>{const{prefixCls:I,className:x,rootClassName:T,style:ce,children:ne,icon:Ze,color:K,onClose:se,bordered:e=!0,visible:Xe}=r,Se=Vt(r,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:ze,direction:St,tag:he}=j.useContext(U.E_),[Fe,mt]=j.useState(!0),Gt=(0,P.Z)(Se,["closeIcon","closable"]);j.useEffect(()=>{Xe!==void 0&&mt(Xe)},[Xe]);const Ot=(0,z.o2)(K),wt=(0,z.yT)(K),bt=Ot||wt,Ht=Object.assign(Object.assign({backgroundColor:K&&!bt?K:void 0},he==null?void 0:he.style),ce),de=ze("tag",I),[Qt,Jt,At]=Y(de),Xt=E()(de,he==null?void 0:he.className,{[`${de}-${K}`]:bt,[`${de}-has-color`]:K&&!bt,[`${de}-hidden`]:!Fe,[`${de}-rtl`]:St==="rtl",[`${de}-borderless`]:!e},x,T,Jt,At),Rt=Ne=>{Ne.stopPropagation(),se==null||se(Ne),!Ne.defaultPrevented&&mt(!1)},[,$t]=(0,u.Z)((0,u.w)(r),(0,u.w)(he),{closable:!1,closeIconRender:Ne=>{const Dt=j.createElement("span",{className:`${de}-close-icon`,onClick:Rt},Ne);return(0,ae.wm)(Ne,Dt,ke=>({onClick:zt=>{var jt;(jt=ke==null?void 0:ke.onClick)===null||jt===void 0||jt.call(ke,zt),Rt(zt)},className:E()(ke==null?void 0:ke.className,`${de}-close-icon`)}))}}),Ye=typeof Se.onClick=="function"||ne&&ne.type==="a",Tt=Ze||null,Lt=Tt?j.createElement(j.Fragment,null,Tt,ne&&j.createElement("span",null,ne)):ne,Bt=j.createElement("span",Object.assign({},Gt,{ref:m,className:Xt,style:Ht}),Lt,$t,Ot&&j.createElement(Je,{key:"preset",prefixCls:de}),wt&&j.createElement(d,{key:"status",prefixCls:de}));return Qt(Ye?j.createElement(g.Z,{component:"Tag"},Bt):Bt)});It.CheckableTag=re;var fe=It},64599:function(oe,F,a){var j=a(96263);function p(E,P){var z=typeof Symbol!="undefined"&&E[Symbol.iterator]||E["@@iterator"];if(!z){if(Array.isArray(E)||(z=j(E))||P&&E&&typeof E.length=="number"){z&&(E=z);var u=0,ae=function(){};return{s:ae,n:function(){return u>=E.length?{done:!0}:{done:!1,value:E[u++]}},e:function(G){throw G},f:ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,U=!1,Z;return{s:function(){z=z.call(E)},n:function(){var G=z.next();return g=G.done,G},e:function(G){U=!0,Z=G},f:function(){try{!g&&z.return!=null&&z.return()}finally{if(U)throw Z}}}}oe.exports=p,oe.exports.__esModule=!0,oe.exports.default=oe.exports}}]);
