(self.webpackChunk=self.webpackChunk||[]).push([[6673],{52745:function(oe,$,t){"use strict";t.d($,{Z:function(){return g}});var M=t(87462),p=t(62435),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"},E=D,A=t(84089),i=function(I,J){return p.createElement(A.Z,(0,M.Z)({},I,{ref:J,icon:E}))},Q=p.forwardRef(i),g=Q},31732:function(oe,$,t){"use strict";var M=t(97857),p=t.n(M),D=t(66309),E=t(62435),A=t(86074);$.Z=function(i){var Q=i.text,g=i.style;return(0,A.jsx)(D.Z,{style:p()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},g),children:Q})}},24163:function(oe,$,t){"use strict";var M=t(97857),p=t.n(M),D=t(25593),E=t(83062),A=t(62435),i=t(86074),Q=D.Z.Paragraph;$.Z=function(g){var K=g.text,I=g.width,J=g.maxWidth,O=g.rows,w=O===void 0?2:O,re=g.placement,pe=re===void 0?"top":re,z=g.color,T=z===void 0?"rgba(0, 0, 0, 0.88)":z,X=g.link,Le=X===void 0?!1:X,de=g.onClickCallBackFunc,Y=g.style,P=Y===void 0?{}:Y,ie=g.copyable,$e=ie===void 0?!1:ie;return(0,i.jsx)("div",{style:{maxWidth:J,width:I},children:(0,i.jsx)(E.Z,{title:(0,i.jsx)("div",{children:K}),placement:pe,children:(0,i.jsx)(Q,{ellipsis:{rows:w},style:p()({marginBottom:0,color:T,cursor:Le?"pointer":""},P),onClick:de,copyable:$e,children:K})})})}},28235:function(oe,$,t){"use strict";var M=t(97857),p=t.n(M),D=t(25593),E=t(83062),A=t(62435),i=t(86074),Q=D.Z.Paragraph;$.Z=function(g){var K=g.text,I=g.width,J=g.maxWidth,O=g.rows,w=O===void 0?2:O,re=g.placement,pe=re===void 0?"top":re,z=g.color,T=z===void 0?"rgba(0, 0, 0, 0.88)":z,X=g.link,Le=X===void 0?!1:X,de=g.onClickCallBackFunc,Y=g.style,P=Y===void 0?{}:Y,ie=g.copyable,$e=ie===void 0?!1:ie,st=g.tooltipText;return(0,i.jsx)("div",{style:{maxWidth:J,width:I},children:(0,i.jsx)(E.Z,{title:st,placement:pe,children:(0,i.jsx)(Q,{ellipsis:{rows:w},style:p()({marginBottom:0,color:T,cursor:Le?"pointer":""},P),onClick:de,copyable:$e,children:K})})})}},64818:function(oe,$,t){"use strict";var M=t(15009),p=t.n(M),D=t(99289),E=t.n(D),A=t(5574),i=t.n(A),Q=t(62435),g=t(68872),K=t(66309),I=t(85265),J=t(57381),O=t(26412),w=t(25593),re=t(92016),pe=t(96655),z=t(29448),T=t(86074),X=function(de){var Y=de.visible,P=de.onClose,ie=de.ruleId,$e=de.ruleCode,st=(0,re.useIntl)(),he=g.ZP.useMessage(),m=i()(he,2),pt=m[0],ht=m[1],nt=(0,Q.useState)(!1),se=i()(nt,2),r=se[0],c=se[1],k=(0,Q.useState)(null),y=i()(k,2),h=y[0],q=y[1];(0,Q.useEffect)(function(){Y&&ie&&V()},[Y,ie]);var V=function(){var ce=E()(p()().mark(function G(){var fe;return p()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(c(!0),Z.prev=1,!ie){Z.next=6;break}return Z.next=5,(0,pe.queryRuleDetail)({id:ie});case 5:fe=Z.sent;case 6:fe&&fe.content&&q(fe.content),Z.next=12;break;case 9:Z.prev=9,Z.t0=Z.catch(1),pt.error("\u83B7\u53D6\u89C4\u5219\u8BE6\u60C5\u5931\u8D25");case 12:return Z.prev=12,c(!1),Z.finish(12);case 15:case"end":return Z.stop()}},G,null,[[1,9,12,15]])}));return function(){return ce.apply(this,arguments)}}(),Ce=function(){q(null),P()},me=function(G){switch(G.toLowerCase()){case"high":case"\u9AD8":return"red";case"medium":case"\u4E2D":return"orange";case"low":case"\u4F4E":return"green";default:return"default"}},ye=function(G){if(!G)return null;var fe=G.split(",");return fe.map(function(je,Z){return(0,T.jsx)(K.Z,{color:me(je.trim()),children:je.trim()},Z)})},xe=function(G){return(0,z.c5)(G)};return(0,T.jsxs)(T.Fragment,{children:[ht,(0,T.jsx)(I.Z,{title:"\u89C4\u5219\u8BE6\u60C5",placement:"right",onClose:Ce,open:Y,width:1e3,destroyOnClose:!0,children:(0,T.jsx)(J.Z,{spinning:r,children:h&&(0,T.jsxs)(O.Z,{column:1,bordered:!0,children:[(0,T.jsx)(O.Z.Item,{label:"\u89C4\u5219\u540D\u79F0",children:(0,T.jsx)(w.Z.Text,{copyable:!0,children:h.ruleName})}),(0,T.jsx)(O.Z.Item,{label:"\u89C4\u5219code",children:(0,T.jsx)(w.Z.Text,{copyable:!0,children:h.ruleCode})}),(0,T.jsx)(O.Z.Item,{label:"\u4FEE\u590D\u5EFA\u8BAE",children:(0,T.jsx)(w.Z.Text,{copyable:!0,children:h.advice})}),(0,T.jsx)(O.Z.Item,{label:"\u4FEE\u590D\u6587\u6863",children:(0,T.jsx)(w.Z.Text,{copyable:!0,children:h.link})}),(0,T.jsx)(O.Z.Item,{label:"\u4E0A\u4E0B\u6587\u6A21\u677F",children:(0,T.jsx)(w.Z.Text,{copyable:!0,children:h.context})}),h.ruleRego&&(0,T.jsx)(O.Z.Item,{label:"\u7B56\u7565",children:(0,T.jsx)(w.Z.Paragraph,{copyable:!0,children:(0,T.jsx)("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",fontSize:"12px",maxHeight:"1000px",overflow:"auto"},children:h.ruleRego})})}),h.createTime&&(0,T.jsx)(O.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:(0,T.jsx)(w.Z.Text,{copyable:!0,children:h.createTime})}),h.updateTime&&(0,T.jsx)(O.Z.Item,{label:"\u66F4\u65B0\u65F6\u95F4",children:(0,T.jsx)(w.Z.Text,{copyable:!0,children:h.updateTime})})]})})})]})};$.Z=X},14842:function(oe,$,t){"use strict";t.r($),t.d($,{default:function(){return xa}});var M=t(15009),p=t.n(M),D=t(99289),E=t.n(D),A=t(5574),i=t.n(A),Q=t(79930),g=t(96655),K=t(17910),I=t(29448),J=t(39380),O=t(93410),w=t(92016),re=t(3303),pe=t(68872),z=t(23323),T=t(71230),X=t(15746),Le=t(84567),de=t(34041),Y=t(42075),P=t(83622),ie=t(92398),$e=t(68795),st=t(33160),he=t(96486),m=t(62435),pt=t(13769),ht=t.n(pt),nt=t(9783),se=t.n(nt),r=t(97857),c=t.n(r),k=t(31732),y=t(24163),h=t(28235),q=t(64818),V=t(87462),Ce={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"},me=Ce,ye=t(84089),xe=function(S,j){return m.createElement(ye.Z,(0,V.Z)({},S,{ref:j,icon:me}))},ce=m.forwardRef(xe),G=ce,fe=t(86548),je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},Z=je,Ct=function(S,j){return m.createElement(ye.Z,(0,V.Z)({},S,{ref:j,icon:Z}))},lt=m.forwardRef(Ct),Ut=lt,yt=t(52745),Dt=t(24969),ot=t(90498),kt=t(75302),ee=t(83062),At=t(55241),xt=t(86738),Kt=t(72269),Vt=function(){return{style:{cursor:"pointer"},onMouseEnter:function(j){j.currentTarget.style.backgroundColor="#f5f5f5",j.currentTarget.style.transform="scale(1.01)",j.currentTarget.style.transition="all 0.2s ease",j.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)"},onMouseLeave:function(j){j.currentTarget.style.backgroundColor="",j.currentTarget.style.transform="scale(1)",j.currentTarget.style.boxShadow=""}}},Rt=function(S){return function(j){return c()({onClick:function(){return S(j)}},Vt())}},a=t(86074),Gt=["pageSize","current"],Bt=kt.ZP.useBreakpoint,Ht=function(S){var j=S.form,ue=S.platformList,_e=S.resourceTypeList,ze=S.ruleGroupList,bt=S.ruleTypeList,Ie=S.allRuleList,ve=S.checkNewRules,Oe=S.newRulesCount,Se=S.queryTrigger,ne=pe.ZP.useMessage(),it=i()(ne,2),W=it[0],Re=it[1],be=Bt(),x=(0,m.useRef)(),Tt=(0,m.useRef)(),d=(0,w.useIntl)(),U=(0,m.useState)(),Mt=i()(U,2),ut=Mt[0],Lt=Mt[1],ct=(0,m.useState)({}),Ve=i()(ct,2),jt=Ve[0],Wt=Ve[1],Jt=(0,m.useState)(!1),Et=i()(Jt,2),dt=Et[0],Ge=Et[1],He=(0,m.useState)(),Qe=i()(He,2),mt=Qe[0],ft=Qe[1],ge=(0,m.useState)({}),Ze=i()(ge,2),We=Ze[0],vt=Ze[1],Ft=(0,m.useState)({}),Je=i()(Ft,2),Fe=Je[0],De=Je[1],Xe=(0,m.useState)({}),Ye=i()(Xe,2),qe=Ye[0],Ne=Ye[1],et=(0,m.useState)([]),Ue=i()(et,2),ke=Ue[0],Ke=Ue[1],Pt=(0,m.useState)(!1),Ae=i()(Pt,2),_t=Ae[0],Te=Ae[1],It=(0,m.useState)(!1),Me=i()(It,2),tt=Me[0],Be=Me[1],Ot=(0,m.useState)(!1),at=i()(Ot,2),te=at[0],F=at[1],ae=(0,m.useState)(!1),Zt=i()(ae,2),le=Zt[0],Nt=Zt[1];(0,m.useEffect)(function(){if(Se!==void 0&&Se>0){var f;(f=x.current)===null||f===void 0||f.reload()}},[Se]);var Xt=function(u){return u.id===ut?"ant-table-row-selected":""},Yt=function(u){ft(u.id),Ge(!0)},qt=function(){Ge(!1),ft(void 0)},ea=function(){var f=E()(p()().mark(function u(e){var n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=W.loading(d.formatMessage({id:"common.message.text.delete.loading"})),s.next=3,(0,g.deleteRule)({id:e});case 3:l=s.sent,n(),(l.code===200||l.msg==="success")&&(W.success(d.formatMessage({id:"common.message.text.delete.success"})),(v=x.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v));case 6:case"end":return s.stop()}},u)}));return function(e){return f.apply(this,arguments)}}(),ta=function(){var f=E()(p()().mark(function u(e){var n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return vt(c()(c()({},We),{},se()({},e,!0))),n=W.loading(d.formatMessage({id:"common.message.text.copy.loading"})),s.next=4,(0,g.copyRule)({id:e});case 4:l=s.sent,vt(c()(c()({},We),{},se()({},e,!1))),n(),(l.code===200||l.msg==="success")&&(W.success(d.formatMessage({id:"common.message.text.copy.success"})),(v=x.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v));case 8:case"end":return s.stop()}},u)}));return function(e){return f.apply(this,arguments)}}(),aa=function(){var f=E()(p()().mark(function u(e){var n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=e.id,De(c()(c()({},Fe),{},se()({},n,!0))),s.prev=2,s.next=5,(0,g.addTenantSelectRule)({ruleCode:e.ruleCode});case 5:l=s.sent,(l.code===200||l.msg==="success")&&(W.success(d.formatMessage({id:"common.message.text.success"})),(v=x.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v)),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),W.error(d.formatMessage({id:"common.message.text.failed"}));case 12:return s.prev=12,De(c()(c()({},Fe),{},se()({},n,!1))),s.finish(12);case 15:case"end":return s.stop()}},u,null,[[2,9,12,15]])}));return function(e){return f.apply(this,arguments)}}(),_=function(){var f=E()(p()().mark(function u(e){var n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=e.id,Ne(c()(c()({},qe),{},se()({},n,!0))),s.prev=2,s.next=5,(0,g.removeTenantSelectRule)({ruleCode:e.ruleCode});case 5:l=s.sent,(l.code===200||l.msg==="success")&&(W.success(d.formatMessage({id:"common.message.text.success"})),(v=x.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v)),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),W.error(d.formatMessage({id:"common.message.text.failed"}));case 12:return s.prev=12,Ne(c()(c()({},qe),{},se()({},n,!1))),s.finish(12);case 15:case"end":return s.stop()}},u,null,[[2,9,12,15]])}));return function(e){return f.apply(this,arguments)}}(),L=function(){var f=E()(p()().mark(function u(){var e,n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(Nt(!0),s.prev=1,e=Ie==null?void 0:Ie.filter(function(H){return ke.includes(H.id)}),n=(e==null?void 0:e.map(function(H){return H.ruleCode}))||[],n.length!==0){s.next=7;break}return W.warning(d.formatMessage({id:"common.message.text.no.valid.data"})),s.abrupt("return");case 7:return s.next=9,(0,g.batchAddTenantSelectRule)({ruleCodeList:n});case 9:l=s.sent,(l.code===200||l.msg==="success")&&(W.success(d.formatMessage({id:"common.message.text.success"})),(v=x.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v),Ke([])),s.next=16;break;case 13:s.prev=13,s.t0=s.catch(1),W.error(d.formatMessage({id:"common.message.text.failed"}));case 16:return s.prev=16,Nt(!1),s.finish(16);case 19:case"end":return s.stop()}},u,null,[[1,13,16,19]])}));return function(){return f.apply(this,arguments)}}(),o=function(u){F(!0),(0,g.queryExportRuleList)(u?{idList:u}:void 0,{responseType:"blob"}).then(function(e){(0,I.a5)(e,"CloudRec ".concat(d.formatMessage({id:"rule.module.text.rule.data"}))),W.success(d.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return F(!1)})},R=function(){var f=E()(p()().mark(function u(e,n){var l,v,C,b;return p()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return l={id:e,status:n},H.next=3,(0,g.changeRuleStatus)(l);case 3:v=H.sent,(v.code===200||v.msg==="success")&&(W.success(d.formatMessage({id:"common.message.text.edit.success"})),(C=x.current)===null||C===void 0||(b=C.reloadAndRest)===null||b===void 0||b.call(C));case 5:case"end":return H.stop()}},u)}));return function(e,n){return f.apply(this,arguments)}}(),B=[{title:d.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(u,e){var n,l,v=(e==null?void 0:e.selectedTenantNameList)&&e.selectedTenantNameList.length>0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,a.jsx)(h.Z,{placement:"topLeft",maxWidth:be!=null&&be.xxl?600:400,rows:1,text:(e==null?void 0:e.ruleName)||"-",style:{fontWeight:500,color:"rgb(58, 58, 58)"}}),v&&(0,a.jsx)(ee.Z,{title:(0,a.jsx)("div",{children:(n=e.selectedTenantNameList)===null||n===void 0?void 0:n.map(function(C,b){return(0,a.jsxs)("div",{style:{fontSize:12},children:["\u2022 ",C]},b)})}),placement:"topRight",children:(0,a.jsx)(G,{style:{color:"#1890ff",fontSize:14,cursor:"pointer"}})})]}),(0,a.jsx)(y.Z,{placement:"topLeft",maxWidth:be!=null&&be.xxl?600:400,rows:1,text:(e==null||(l=e.ruleTypeNameList)===null||l===void 0?void 0:l.toString())||"-",style:{color:"rgb(166, 167, 167)",fontSize:13}})]})}},{title:d.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(u,e){return(0,a.jsx)(k.Z,{text:(e==null?void 0:e.resourceTypeStr)||"-"})}},{title:d.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,I.W_)(K.I9),align:"center",hideInSearch:!0,render:function(u,e){return(0,I.Dd)(K.I9,e==null?void 0:e.riskLevel)}},{title:d.formatMessage({id:"common.table.columns.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(u,e){return(0,a.jsxs)("div",{children:[(0,a.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,a.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:d.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,I.W_)(ue),align:"center",hideInSearch:!0,render:function(u,e){return(0,I.c5)(e.platform,ue)}},{title:d.formatMessage({id:"rule.input.text.rule.group.creator"}),dataIndex:"username",valueType:"text",hideInSearch:!0,width:120},{title:d.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(u,e){return(0,a.jsxs)(Y.Z,{size:"small",children:[(0,a.jsx)(P.ZP,{size:"small",onClick:function(l){l.stopPropagation(),Lt(e.id)},type:"link",target:"_self",href:"/ruleManagement/ruleProject/edit?id=".concat(e==null?void 0:e.id),children:(0,a.jsx)(ee.Z,{title:d.formatMessage({id:"common.button.text.edit"}),children:(0,a.jsx)(fe.Z,{})})}),(0,a.jsx)(At.Z,{content:(0,a.jsxs)(Y.Z,{children:[(0,a.jsx)(xt.Z,{title:d.formatMessage({id:"common.button.text.delete.confirm"}),onConfirm:function(l){l==null||l.stopPropagation(),ea(e.id)},okText:d.formatMessage({id:"common.button.text.ok"}),cancelText:d.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(P.ZP,{block:!0,type:"link",danger:!0,size:"small",onClick:function(l){return l.stopPropagation()},children:d.formatMessage({id:"common.button.text.delete"})})}),(0,a.jsx)(P.ZP,{block:!0,loading:We[Number(e.id)],onClick:function(l){l.stopPropagation(),ta(e.id)},type:"link",target:"_blank",size:"small",children:d.formatMessage({id:"common.button.text.copy"})})]}),children:(0,a.jsx)(P.ZP,{type:"link",icon:(0,a.jsx)(Ut,{}),onClick:function(l){return l.stopPropagation()}})}),e.tenantSelected?(0,a.jsx)(xt.Z,{title:d.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(l){l==null||l.stopPropagation(),_(e)},onCancel:function(l){return l==null?void 0:l.stopPropagation()},okText:d.formatMessage({id:"common.button.text.ok"}),cancelText:d.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(P.ZP,{type:"default",size:"small",loading:qe[Number(e.id)],onClick:function(l){return l.stopPropagation()},icon:(0,a.jsx)(yt.Z,{}),danger:!0})}):(0,a.jsx)(P.ZP,{type:"primary",size:"small",loading:Fe[Number(e.id)],onClick:function(l){l.stopPropagation(),aa(e)},icon:(0,a.jsx)(Dt.Z,{})}),(0,a.jsx)(ee.Z,{title:d.formatMessage({id:"rule.module.text.tooltip.status"}),children:(0,a.jsx)(Kt.Z,{checked:(e==null?void 0:e.status)==="valid",onClick:function(l,v){v==null||v.stopPropagation(),R(e.id,(e==null?void 0:e.status)==="valid"?"invalid":"valid")}})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[Re,(0,a.jsx)(ot.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:ke,onChange:function(u){return Ke(u)},preserveSelectedRowKeys:!0},actionRef:x,formRef:Tt,rowClassName:Xt,rowKey:"id",search:!1,toolBarRender:function(){return[(0,a.jsx)(P.ZP,{type:"primary",href:"/ruleManagement/ruleProject/edit",children:d.formatMessage({id:"rule.extend.basic.add"})},"CREATE"),(0,a.jsx)(At.Z,{open:_t,onOpenChange:function(e){return Te(e)},title:d.formatMessage({id:"rule.module.text.sync.confirm"}),content:(0,a.jsxs)(Y.Z,{children:[(0,a.jsx)(P.ZP,{danger:!0,type:"default",loading:tt,onClick:E()(p()().mark(function u(){var e,n,l,v;return p()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return Be(!0),e=W.loading(d.formatMessage({id:"rule.module.text.sync.loading"})),b.prev=2,b.next=5,(0,g.loadRuleFromGithub)({coverage:!0});case 5:n=b.sent,(n.code===200||n.msg==="success")&&(W.success(d.formatMessage({id:"rule.module.text.sync.success"})),(l=x.current)===null||l===void 0||(v=l.reloadAndRest)===null||v===void 0||v.call(l),ve());case 7:return b.prev=7,e(),Be(!1),Te(!1),b.finish(7);case 12:case"end":return b.stop()}},u,null,[[2,,7,12]])})),children:d.formatMessage({id:"rule.module.text.sync.overwrite"})}),(0,a.jsx)(P.ZP,{type:"default",loading:tt,onClick:E()(p()().mark(function u(){var e,n,l,v;return p()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return Be(!0),e=W.loading(d.formatMessage({id:"rule.module.text.sync.loading"})),b.prev=2,b.next=5,(0,g.loadRuleFromGithub)({coverage:!1});case 5:n=b.sent,(n.code===200||n.msg==="success")&&(W.success(d.formatMessage({id:"rule.module.text.sync.success"})),(l=x.current)===null||l===void 0||(v=l.reloadAndRest)===null||v===void 0||v.call(l),ve());case 7:return b.prev=7,e(),Be(!1),Te(!1),b.finish(7);case 12:case"end":return b.stop()}},u,null,[[2,,7,12]])})),children:d.formatMessage({id:"rule.module.text.sync.no.overwrite"})}),(0,a.jsx)(P.ZP,{onClick:function(){Te(!1)},children:d.formatMessage({id:"common.button.text.cancel"})})]}),trigger:"click",children:(0,a.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,a.jsx)(P.ZP,{type:"default",children:d.formatMessage({id:"rule.module.text.sync.button"})}),Oe>0&&(0,a.jsx)("div",{style:{position:"absolute",top:"-8px",right:"-8px",backgroundColor:"#ff4d4f",color:"white",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",zIndex:1},children:Oe>99?"99+":Oe})]})},"sync"),(0,a.jsx)(P.ZP,{type:"default",loading:le,disabled:ke.length===0,onClick:L,children:d.formatMessage({id:"rule.module.text.batch.add.to.favorites"})},"BATCH_ADD_TO_FAVORITES"),(0,a.jsx)(P.ZP,{loading:te,type:"default",disabled:ke.length===0,onClick:function(){return o(ke)},children:d.formatMessage({id:"common.button.text.export"})},"EXPORT")]},request:function(){var f=E()(p()().mark(function u(e,n){var l,v,C,b,s,H,N,ra,rt,la;return p()().wrap(function(gt){for(;;)switch(gt.prev=gt.next){case 0:return l=e.pageSize,v=e.current,C=ht()(e,Gt),b=j.getFieldsValue(),s=(0,I.Hm)(n),H=c()(c()(c()({},C),b),{},{page:v,size:l}),(0,he.isEmpty)(s)||(H.sortParam=s==null?void 0:s.key,H.sortType=s==null||(N=s.value)===null||N===void 0||(N=N.slice(0,-3))===null||N===void 0?void 0:N.toUpperCase()),gt.next=7,(0,g.queryRuleList)(H);case 7:return ra=gt.sent,rt=ra.content,la=ra.code,gt.abrupt("return",{data:(rt==null?void 0:rt.data)||[],total:(rt==null?void 0:rt.total)||0,success:la===200||!1});case 11:case"end":return gt.stop()}},u)}));return function(u,e){return f.apply(this,arguments)}}(),columns:B,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:Rt(Yt)}),(0,a.jsx)(q.Z,{visible:dt,onClose:qt,ruleId:mt})]})},$t=Ht,we=t(53846),Qt=t(90598),Ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 01-12.7-6.5V353.7a8 8 0 0112.7-6.5L656.1 506a7.9 7.9 0 010 12.9z"}}]},name:"play-circle",theme:"filled"},wt=Ee,St=function(S,j){return m.createElement(ye.Z,(0,V.Z)({},S,{ref:j,icon:wt}))},oa=m.forwardRef(St),ia=oa,ua={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},ca=ua,da=function(S,j){return m.createElement(ye.Z,(0,V.Z)({},S,{ref:j,icon:ca}))},ma=m.forwardRef(da),fa=ma,zt=t(78045),va=["pageSize","current"],ga=kt.ZP.useBreakpoint,pa=function(S){var j=S.form,ue=S.platformList,_e=S.resourceTypeList,ze=S.ruleGroupList,bt=S.ruleTypeList,Ie=S.allRuleList,ve=S.queryTrigger,Oe=pe.ZP.useMessage(),Se=i()(Oe,2),ne=Se[0],it=Se[1],W=ga(),Re=(0,m.useRef)(),be=(0,m.useRef)(),x=(0,w.useIntl)(),Tt=(0,m.useState)(),d=i()(Tt,2),U=d[0],Mt=d[1],ut=(0,m.useState)({}),Lt=i()(ut,2),ct=Lt[0],Ve=Lt[1],jt=(0,m.useState)({}),Wt=i()(jt,2),Jt=Wt[0],Et=Wt[1],dt=(0,m.useState)({}),Ge=i()(dt,2),He=Ge[0],Qe=Ge[1],mt=(0,m.useState)([]),ft=i()(mt,2),ge=ft[0],Ze=ft[1],We=(0,m.useState)(!1),vt=i()(We,2),Ft=vt[0],Je=vt[1],Fe=(0,m.useState)(!1),De=i()(Fe,2),Xe=De[0],Ye=De[1],qe=(0,m.useState)(!1),Ne=i()(qe,2),et=Ne[0],Ue=Ne[1],ke=(0,m.useState)(),Ke=i()(ke,2),Pt=Ke[0],Ae=Ke[1],_t=(0,m.useState)(!0),Te=i()(_t,2),It=Te[0],Me=Te[1],tt=(0,m.useState)(!1),Be=i()(tt,2),Ot=Be[0],at=Be[1],te=(0,m.useState)("all"),F=i()(te,2),ae=F[0],Zt=F[1],le=function(L){return L.id===U?"ant-table-row-selected":""},Nt=function(L){Ae(L.id),Ue(!0)};(0,m.useEffect)(function(){if(ve!==void 0&&ve>0){var _;(_=Re.current)===null||_===void 0||_.reload()}},[ve]);var Xt=function(){var _=E()(p()().mark(function L(o){var R,B,f,u;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Ve(c()(c()({},ct),{},se()({},o,!0))),R=ne.loading(x.formatMessage({id:"common.message.text.execute.loading"})),n.next=4,(0,g.scanByRule)({id:o});case 4:B=n.sent,Ve(c()(c()({},ct),{},se()({},o,!1))),R(),(B.code===200||B.msg==="success")&&(ne.success(x.formatMessage({id:"common.message.text.execute.success"})),(f=Re.current)===null||f===void 0||(u=f.reloadAndRest)===null||u===void 0||u.call(f));case 8:case"end":return n.stop()}},L)}));return function(o){return _.apply(this,arguments)}}(),Yt=function(){var _=E()(p()().mark(function L(o){var R,B,f,u;return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return R=o.id,Qe(c()(c()({},He),{},se()({},R,!0))),n.prev=2,n.next=5,(0,g.removeTenantSelectRule)({ruleCode:o.ruleCode});case 5:B=n.sent,(B.code===200||B.msg==="success")&&(ne.success(x.formatMessage({id:"common.message.text.success"})),(f=Re.current)===null||f===void 0||(u=f.reloadAndRest)===null||u===void 0||u.call(f)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),ne.error(x.formatMessage({id:"common.message.text.fail"}));case 12:return n.prev=12,Qe(c()(c()({},He),{},se()({},R,!1))),n.finish(12);case 15:case"end":return n.stop()}},L,null,[[2,9,12,15]])}));return function(o){return _.apply(this,arguments)}}(),qt=function(){var _=E()(p()().mark(function L(){var o,R,B,f;return p()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ge.length!==0){e.next=2;break}return e.abrupt("return");case 2:return Je(!0),e.prev=3,o=ge.map(function(n){return Number(n)}),e.next=7,(0,g.scanRuleList)({idList:o});case 7:R=e.sent,(R.code===200||R.msg==="success")&&(ne.success(x.formatMessage({id:"common.message.text.success"})),Ze([]),(B=Re.current)===null||B===void 0||(f=B.reloadAndRest)===null||f===void 0||f.call(B)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),ne.error(x.formatMessage({id:"common.message.text.fail"}));case 14:return e.prev=14,Je(!1),e.finish(14);case 17:case"end":return e.stop()}},L,null,[[3,11,14,17]])}));return function(){return _.apply(this,arguments)}}(),ea=function(){var _=E()(p()().mark(function L(){var o,R,B,f,u,e,n,l,v,C;return p()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(ge.length!==0){s.next=2;break}return s.abrupt("return");case 2:return Ye(!0),s.prev=3,R=j.getFieldsValue(),B={page:1,size:1e3,platformList:R.platformList,riskLevelList:R.riskLevelList,ruleCodeList:R.ruleCodeList,resourceTypeList:R.resourceTypeList,ruleGroupIdList:R.ruleGroupIdList,ruleTypeIdList:R.ruleTypeIdList},s.next=8,(0,g.queryEffectRuleList)(B);case 8:return f=s.sent,u=(f==null||(o=f.content)===null||o===void 0?void 0:o.data)||[],e=u.filter(function(H){return ge.includes(H.id)}),n=e.map(function(H){return H.ruleCode}),s.next=14,(0,g.batchDeleteTenantSelectRule)({ruleCodeList:n});case 14:l=s.sent,(l.code===200||l.msg==="success")&&(ne.success(x.formatMessage({id:"common.message.text.success"})),Ze([]),(v=Re.current)===null||v===void 0||(C=v.reloadAndRest)===null||C===void 0||C.call(v)),s.next=21;break;case 18:s.prev=18,s.t0=s.catch(3),ne.error(x.formatMessage({id:"common.message.text.fail"}));case 21:return s.prev=21,Ye(!1),s.finish(21);case 24:case"end":return s.stop()}},L,null,[[3,18,21,24]])}));return function(){return _.apply(this,arguments)}}(),ta=function(){var _=E()(p()().mark(function L(o,R){var B,f,u,e,n,l,v,C,b,s;return p()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return B=o.pageSize,f=o.current,u=ht()(o,va),N.prev=1,e=j.getFieldsValue(),n=c()({page:f||1,size:B||10,platformList:e.platformList,riskLevelList:e.riskLevelList,ruleCodeList:e.ruleCodeList,resourceTypeList:e.resourceTypeList,ruleGroupIdList:e.ruleGroupIdList,ruleTypeIdList:e.ruleTypeIdList,effectRuleType:ae},u),R&&Object.keys(R).length>0&&(l=Object.keys(R)[0],v=R[l],n.sortParam=l,n.sortType=v==="ascend"?"ASC":"DESC"),N.next=7,(0,g.queryEffectRuleList)(n);case 7:if(C=N.sent,!(C!=null&&C.content)){N.next=16;break}return b=C.content.data||[],s=C.content.total||0,Me(s>0),at(!0),N.abrupt("return",{data:b,total:s,success:!0});case 16:return Me(!1),at(!0),N.abrupt("return",{data:[],total:0,success:!1});case 19:N.next=26;break;case 21:return N.prev=21,N.t0=N.catch(1),Me(!1),at(!0),N.abrupt("return",{data:[],total:0,success:!1});case 26:case"end":return N.stop()}},L,null,[[1,21]])}));return function(o,R){return _.apply(this,arguments)}}(),aa=[{title:x.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(L,o){var R;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{fontWeight:500,color:"rgb(58, 58, 58)",display:"flex",alignItems:"center",gap:"8px"},children:[(0,a.jsx)("span",{children:(o==null?void 0:o.ruleName)||"-"}),(o==null?void 0:o.defaultRuleSelected)&&(0,a.jsx)(ee.Z,{title:"default",children:(0,a.jsx)(Qt.Z,{style:{color:"#faad14",fontSize:"14px"}})})]}),(0,a.jsx)("div",{style:{color:"rgb(166, 167, 167)",fontSize:13},children:(o==null||(R=o.ruleTypeNameList)===null||R===void 0?void 0:R.toString())||"-"})]})}},{title:x.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(L,o){return(0,a.jsx)(k.Z,{text:(o==null?void 0:o.resourceTypeStr)||"-"})}},{title:x.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,I.W_)(K.I9),align:"center",hideInSearch:!0,render:function(L,o){return(0,I.Dd)(K.I9,o==null?void 0:o.riskLevel)}},{title:x.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,I.W_)(ue),align:"center",hideInSearch:!0,render:function(L,o){return(0,I.c5)(o.platform,ue)}},{title:x.formatMessage({id:"asset.module.risk.number"}),dataIndex:"riskCount",valueType:"text",hideInSearch:!0,align:"center",sorter:!0,render:function(L,o){return(0,a.jsx)(P.ZP,{type:"link",size:"small",href:"/riskManagement/riskList?platform=".concat(o==null?void 0:o.platform,"&ruleCode=").concat(o==null?void 0:o.ruleCode),children:o==null?void 0:o.riskCount})}},{title:x.formatMessage({id:"cloudAccount.extend.title.lastScanTime"}),dataIndex:"lastScanTime",valueType:"text",hideInSearch:!0,align:"center",width:150,sorter:!0,render:function(L,o){return o!=null&&o.lastScanTime?(0,a.jsx)(ee.Z,{title:o.lastScanTime,children:(0,a.jsx)("span",{children:o.lastScanTime})}):"-"}},{title:x.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",width:180,render:function(L,o){var R=o==null?void 0:o.isRunning,B=R===0,f=function(){return R===1?(0,a.jsx)(ia,{}):(0,a.jsx)(fa,{})};return(0,a.jsxs)(Y.Z,{size:"small",children:[(0,a.jsx)(P.ZP,{block:!0,loading:ct[Number(o.id)],disabled:!B,onClick:function(e){e.stopPropagation(),Xt(o.id)},type:"default",target:"_blank",size:"small",icon:f(),style:{color:R===1?"#52c41a":void 0,borderColor:R===1?"#52c41a":void 0},children:x.formatMessage({id:R===1?"common.button.text.running":"common.button.text.test"})}),ae==="selected"&&(0,a.jsx)(xt.Z,{title:x.formatMessage({id:"rule.module.selected.rules.popconfirm.content"}),onConfirm:function(e){e==null||e.stopPropagation(),Yt(o)},onCancel:function(e){return e==null?void 0:e.stopPropagation()},okText:x.formatMessage({id:"common.button.text.ok"}),cancelText:x.formatMessage({id:"common.button.text.cancel"}),children:(0,a.jsx)(P.ZP,{danger:!0,size:"small",loading:He[Number(o.id)],disabled:R===1,icon:(0,a.jsx)(yt.Z,{}),onClick:function(e){return e.stopPropagation()}})})]})}}];return(0,a.jsxs)(a.Fragment,{children:[it,(0,a.jsx)(ot.Z,{scroll:{x:"max-content"},rowSelection:{type:"checkbox",selectedRowKeys:ge,onChange:function(L){return Ze(L)},preserveSelectedRowKeys:!0},headerTitle:(0,a.jsx)("div",{className:we.Z.customTitle,children:(0,a.jsx)(Y.Z,{children:(0,a.jsxs)(zt.ZP.Group,{value:ae,onChange:function(L){var o;Zt(L.target.value),Ze([]),(o=Re.current)===null||o===void 0||o.reload()},size:"middle",buttonStyle:"solid",children:[(0,a.jsx)(zt.ZP.Button,{value:"all",children:x.formatMessage({id:"common.module.text.all"})}),(0,a.jsx)(zt.ZP.Button,{value:"selected",children:x.formatMessage({id:"common.module.text.selected"})}),(0,a.jsx)(zt.ZP.Button,{value:"default",children:x.formatMessage({id:"common.module.text.default"})})]})})}),actionRef:Re,formRef:be,rowClassName:le,rowKey:"id",search:!1,toolBarRender:function(){return[(0,a.jsx)(P.ZP,{type:"primary",loading:Ft,disabled:ge.length===0,onClick:qt,children:x.formatMessage({id:"rule.module.text.batch.test"})},"BATCH_DETECT"),ae==="selected"&&(0,a.jsx)(P.ZP,{danger:!0,loading:Xe,disabled:ge.length===0,onClick:ea,children:x.formatMessage({id:"rule.module.text.batch.remove"})},"BATCH_REMOVE")].filter(Boolean)},request:ta,columns:aa,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},onRow:Rt(Nt)}),(0,a.jsx)(q.Z,{visible:et,onClose:function(){return Ue(!1)},ruleId:Pt})]})},ha=pa,sa=t(61194),na=re.Z.SHOW_CHILD,Ca=function(S,j){var ue,_e,ze=S.toLowerCase(),bt=((ue=j.label)===null||ue===void 0?void 0:ue.toLowerCase())||"",Ie=((_e=j.value)===null||_e===void 0?void 0:_e.toLowerCase())||"";return bt.includes(ze)||Ie.includes(ze)},ya=function(){var S=(0,w.useModel)("rule"),j=S.platformList,ue=S.ruleTypeList,_e=S.allRuleList,ze=S.ruleGroupList,bt=(0,w.useLocation)(),Ie=bt.search,ve=new URLSearchParams(Ie),Oe=ve.get("groupId"),Se=ve.get("ruleCode"),ne=ve.get("platform"),it=pe.ZP.useMessage(),W=i()(it,2),Re=W[0],be=W[1],x=z.Z.useForm(),Tt=i()(x,1),d=Tt[0],U=(0,w.useIntl)(),Mt=(0,m.useState)(!1),ut=i()(Mt,2),Lt=ut[0],ct=ut[1],Ve=(0,m.useState)(!1),jt=i()(Ve,2),Wt=jt[0],Jt=jt[1],Et=(0,m.useState)(0),dt=i()(Et,2),Ge=dt[0],He=dt[1],Qe=(0,m.useState)(!1),mt=i()(Qe,2),ft=mt[0],ge=mt[1],Ze=(0,m.useState)([]),We=i()(Ze,2),vt=We[0],Ft=We[1],Je=(0,m.useState)([]),Fe=i()(Je,2),De=Fe[0],Xe=Fe[1],Ye=ve.get("tab"),qe=(0,m.useState)(Ye||"selected"),Ne=i()(qe,2),et=Ne[0],Ue=Ne[1];(0,m.useEffect)(function(){var te=ve.get("tab");te&&te!==et&&Ue(te)},[Ie,et]);var ke=(0,m.useState)(!1),Ke=i()(ke,2),Pt=Ke[0],Ae=Ke[1],_t=(0,m.useState)(0),Te=i()(_t,2),It=Te[0],Me=Te[1],tt=function(){var te=E()(p()().mark(function F(){var ae;return p()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return le.prev=0,le.next=3,(0,g.checkExistNewRule)();case 3:ae=le.sent,ae.code===200&&typeof ae.content=="number"&&He(ae.content),le.next=10;break;case 7:le.prev=7,le.t0=le.catch(0),console.error("Failed to check new rules:",le.t0);case 10:case"end":return le.stop()}},F,null,[[0,7]])}));return function(){return te.apply(this,arguments)}}(),Be=(0,w.useRequest)(function(te){return(0,Q.queryGroupTypeList)({platformList:te})},{manual:!0,formatResult:function(F){var ae=F.content;Xe(ae||[])}}),Ot=Be.run,at=function(F){ge(!0),(0,g.queryExportRuleList)(F?{idList:F}:void 0,{responseType:"blob"}).then(function(ae){(0,I.a5)(ae,"CloudRec ".concat(U.formatMessage({id:"rule.module.text.rule.data"}))),Re.success(U.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return ge(!1)})};return(0,m.useEffect)(function(){(0,he.isEmpty)(Oe)||d.setFieldValue("ruleGroupIdList",[Number(Oe)]),(0,he.isEmpty)(Se)||d.setFieldValue("ruleCodeList",[Se]),(0,he.isEmpty)(ne)||(d.setFieldValue("platformList",[ne]),Ot([ne])),tt()},[Oe,Se,ne]),(0,a.jsxs)(J._z,{ghost:!0,title:!1,className:sa.Z.rulePageContainer,breadcrumbRender:!1,children:[be,(0,a.jsx)(O.Z,{bodyStyle:{paddingBottom:0},className:sa.Z.customFilterCard,children:(0,a.jsx)(z.Z,{form:d,children:(0,a.jsxs)(T.Z,{gutter:[24,10],style:{marginBottom:20},children:[(0,a.jsx)(X.Z,{span:24,children:(0,a.jsx)(z.Z.Item,{name:"platformList",label:U.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,a.jsx)(Le.Z.Group,{options:(0,I.T$)(j),onChange:function(F){d.setFieldValue("resourceTypeList",null),Xe([]),Ot(F)}})})}),(0,a.jsx)(X.Z,{span:24,children:(0,a.jsx)(z.Z.Item,{name:"riskLevelList",label:U.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,a.jsx)(Le.Z.Group,{options:(0,I.at)(K.I9)})})}),(0,a.jsx)(X.Z,{span:6,children:(0,a.jsx)(z.Z.Item,{name:"resourceTypeList",label:U.formatMessage({id:"cloudAccount.extend.title.asset.type"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(re.Z,{options:De,multiple:!0,placeholder:U.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:na,allowClear:!0,showSearch:!0})})}),(0,a.jsx)(X.Z,{span:6,children:(0,a.jsx)(z.Z.Item,{name:"ruleTypeIdList",label:U.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(re.Z,{placeholder:U.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:na,allowClear:!0,showSearch:!0,fieldNames:{label:"typeName",value:"id",children:"childList"},multiple:!0,options:ue||[]})})}),(0,a.jsx)(X.Z,{span:6,children:(0,a.jsx)(z.Z.Item,{name:"ruleGroupIdList",label:U.formatMessage({id:"layout.routes.title.ruleGroup"}),style:{marginBottom:0,width:"100%"},children:(0,a.jsx)(de.Z,{placeholder:U.formatMessage({id:"common.select.text.placeholder"}),options:ze,allowClear:!0,mode:"multiple"})})}),(0,a.jsx)(X.Z,{span:18,children:(0,a.jsx)(z.Z.Item,{name:"ruleCodeList",label:U.formatMessage({id:"home.module.inform.columns.ruleName"}),style:{marginBottom:0},children:(0,a.jsx)(de.Z,{filterOption:Ca,placeholder:U.formatMessage({id:"common.select.text.placeholder"}),allowClear:!0,options:_e,mode:"multiple"})})}),(0,a.jsx)(X.Z,{span:6,children:(0,a.jsx)(z.Z.Item,{style:{marginBottom:0,textAlign:"right"},children:(0,a.jsxs)(Y.Z,{children:[(0,a.jsx)(P.ZP,{type:"primary",icon:(0,a.jsx)($e.Z,{}),loading:Pt,onClick:function(){Ae(!0),Me(function(F){return F+1}),setTimeout(function(){Ae(!1)},500)},children:U.formatMessage({id:"common.button.text.query"})}),(0,a.jsx)(P.ZP,{icon:(0,a.jsx)(st.Z,{}),onClick:function(){d.resetFields(),Xe([]),Ae(!0),Me(function(F){return F+1}),setTimeout(function(){Ae(!1)},500)},children:U.formatMessage({id:"common.button.text.reset"})})]})})})]})})}),(0,a.jsx)(O.Z,{style:{marginTop:16},children:(0,a.jsx)(ie.Z,{activeKey:et,onChange:function(F){Ue(F),Me(function(ae){return ae+1})},items:[{key:"selected",label:U.formatMessage({id:"rule.module.text.selected.rules"}),children:(0,a.jsx)(ha,{form:d,platformList:j,resourceTypeList:De,ruleGroupList:ze,ruleTypeList:ue,allRuleList:_e,queryTrigger:It})},{key:"market",label:U.formatMessage({id:"rule.module.text.market.rules"}),children:(0,a.jsx)($t,{form:d,platformList:j,resourceTypeList:De,ruleGroupList:ze,ruleTypeList:ue,allRuleList:_e,checkNewRules:tt,newRulesCount:Ge,queryTrigger:It})}]})})]})},xa=ya},53846:function(oe,$){"use strict";$.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},61194:function(oe,$){"use strict";$.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}},75302:function(oe,$,t){"use strict";var M=t(25378);function p(){return(0,M.Z)()}$.ZP={useBreakpoint:p}},66309:function(oe,$,t){"use strict";t.d($,{Z:function(){return se}});var M=t(62435),p=t(93967),D=t.n(p),E=t(98423),A=t(98787),i=t(69760),Q=t(96159),g=t(45353),K=t(53124),I=t(861),J=t(15063),O=t(14747),w=t(83262),re=t(83559);const pe=r=>{const{paddingXXS:c,lineWidth:k,tagPaddingHorizontal:y,componentCls:h,calc:q}=r,V=q(y).sub(k).equal(),Ce=q(c).sub(k).equal();return{[h]:Object.assign(Object.assign({},(0,O.Wf)(r)),{display:"inline-block",height:"auto",marginInlineEnd:r.marginXS,paddingInline:V,fontSize:r.tagFontSize,lineHeight:r.tagLineHeight,whiteSpace:"nowrap",background:r.defaultBg,border:`${(0,I.unit)(r.lineWidth)} ${r.lineType} ${r.colorBorder}`,borderRadius:r.borderRadiusSM,opacity:1,transition:`all ${r.motionDurationMid}`,textAlign:"start",position:"relative",[`&${h}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:r.defaultColor},[`${h}-close-icon`]:{marginInlineStart:Ce,fontSize:r.tagIconSize,color:r.colorIcon,cursor:"pointer",transition:`all ${r.motionDurationMid}`,"&:hover":{color:r.colorTextHeading}},[`&${h}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${r.iconCls}-close, ${r.iconCls}-close:hover`]:{color:r.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${h}-checkable-checked):hover`]:{color:r.colorPrimary,backgroundColor:r.colorFillSecondary},"&:active, &-checked":{color:r.colorTextLightSolid},"&-checked":{backgroundColor:r.colorPrimary,"&:hover":{backgroundColor:r.colorPrimaryHover}},"&:active":{backgroundColor:r.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${r.iconCls} + span, > span + ${r.iconCls}`]:{marginInlineStart:V}}),[`${h}-borderless`]:{borderColor:"transparent",background:r.tagBorderlessBg}}},z=r=>{const{lineWidth:c,fontSizeIcon:k,calc:y}=r,h=r.fontSizeSM;return(0,w.mergeToken)(r,{tagFontSize:h,tagLineHeight:(0,I.unit)(y(r.lineHeightSM).mul(h).equal()),tagIconSize:y(k).sub(y(c).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:r.defaultBg})},T=r=>({defaultBg:new J.FastColor(r.colorFillQuaternary).onBackground(r.colorBgContainer).toHexString(),defaultColor:r.colorText});var X=(0,re.I$)("Tag",r=>{const c=z(r);return pe(c)},T),Le=function(r,c){var k={};for(var y in r)Object.prototype.hasOwnProperty.call(r,y)&&c.indexOf(y)<0&&(k[y]=r[y]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,y=Object.getOwnPropertySymbols(r);h<y.length;h++)c.indexOf(y[h])<0&&Object.prototype.propertyIsEnumerable.call(r,y[h])&&(k[y[h]]=r[y[h]]);return k},Y=M.forwardRef((r,c)=>{const{prefixCls:k,style:y,className:h,checked:q,onChange:V,onClick:Ce}=r,me=Le(r,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:ye,tag:xe}=M.useContext(K.E_),ce=lt=>{V==null||V(!q),Ce==null||Ce(lt)},G=ye("tag",k),[fe,je,Z]=X(G),Ct=D()(G,`${G}-checkable`,{[`${G}-checkable-checked`]:q},xe==null?void 0:xe.className,h,je,Z);return fe(M.createElement("span",Object.assign({},me,{ref:c,style:Object.assign(Object.assign({},y),xe==null?void 0:xe.style),className:Ct,onClick:ce})))}),P=t(98719);const ie=r=>(0,P.Z)(r,(c,{textColor:k,lightBorderColor:y,lightColor:h,darkColor:q})=>({[`${r.componentCls}${r.componentCls}-${c}`]:{color:k,background:h,borderColor:y,"&-inverse":{color:r.colorTextLightSolid,background:q,borderColor:q},[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}));var $e=(0,re.bk)(["Tag","preset"],r=>{const c=z(r);return ie(c)},T);function st(r){return typeof r!="string"?r:r.charAt(0).toUpperCase()+r.slice(1)}const he=(r,c,k)=>{const y=st(k);return{[`${r.componentCls}${r.componentCls}-${c}`]:{color:r[`color${k}`],background:r[`color${y}Bg`],borderColor:r[`color${y}Border`],[`&${r.componentCls}-borderless`]:{borderColor:"transparent"}}}};var m=(0,re.bk)(["Tag","status"],r=>{const c=z(r);return[he(c,"success","Success"),he(c,"processing","Info"),he(c,"error","Error"),he(c,"warning","Warning")]},T),pt=function(r,c){var k={};for(var y in r)Object.prototype.hasOwnProperty.call(r,y)&&c.indexOf(y)<0&&(k[y]=r[y]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,y=Object.getOwnPropertySymbols(r);h<y.length;h++)c.indexOf(y[h])<0&&Object.prototype.propertyIsEnumerable.call(r,y[h])&&(k[y[h]]=r[y[h]]);return k};const nt=M.forwardRef((r,c)=>{const{prefixCls:k,className:y,rootClassName:h,style:q,children:V,icon:Ce,color:me,onClose:ye,bordered:xe=!0,visible:ce}=r,G=pt(r,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:fe,direction:je,tag:Z}=M.useContext(K.E_),[Ct,lt]=M.useState(!0),Ut=(0,E.Z)(G,["closeIcon","closable"]);M.useEffect(()=>{ce!==void 0&&lt(ce)},[ce]);const yt=(0,A.o2)(me),Dt=(0,A.yT)(me),ot=yt||Dt,kt=Object.assign(Object.assign({backgroundColor:me&&!ot?me:void 0},Z==null?void 0:Z.style),q),ee=fe("tag",k),[At,xt,Kt]=X(ee),Vt=D()(ee,Z==null?void 0:Z.className,{[`${ee}-${me}`]:ot,[`${ee}-has-color`]:me&&!ot,[`${ee}-hidden`]:!Ct,[`${ee}-rtl`]:je==="rtl",[`${ee}-borderless`]:!xe},y,h,xt,Kt),Rt=we=>{we.stopPropagation(),ye==null||ye(we),!we.defaultPrevented&&lt(!1)},[,a]=(0,i.Z)((0,i.w)(r),(0,i.w)(Z),{closable:!1,closeIconRender:we=>{const Qt=M.createElement("span",{className:`${ee}-close-icon`,onClick:Rt},we);return(0,Q.wm)(we,Qt,Ee=>({onClick:wt=>{var St;(St=Ee==null?void 0:Ee.onClick)===null||St===void 0||St.call(Ee,wt),Rt(wt)},className:D()(Ee==null?void 0:Ee.className,`${ee}-close-icon`)}))}}),Gt=typeof G.onClick=="function"||V&&V.type==="a",Bt=Ce||null,Ht=Bt?M.createElement(M.Fragment,null,Bt,V&&M.createElement("span",null,V)):V,$t=M.createElement("span",Object.assign({},Ut,{ref:c,className:Vt,style:kt}),Ht,a,yt&&M.createElement($e,{key:"preset",prefixCls:ee}),Dt&&M.createElement(m,{key:"status",prefixCls:ee}));return At(Gt?M.createElement(g.Z,{component:"Tag"},$t):$t)});nt.CheckableTag=Y;var se=nt},64599:function(oe,$,t){var M=t(96263);function p(D,E){var A=typeof Symbol!="undefined"&&D[Symbol.iterator]||D["@@iterator"];if(!A){if(Array.isArray(D)||(A=M(D))||E&&D&&typeof D.length=="number"){A&&(D=A);var i=0,Q=function(){};return{s:Q,n:function(){return i>=D.length?{done:!0}:{done:!1,value:D[i++]}},e:function(O){throw O},f:Q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,K=!1,I;return{s:function(){A=A.call(D)},n:function(){var O=A.next();return g=O.done,O},e:function(O){K=!0,I=O},f:function(){try{!g&&A.return!=null&&A.return()}finally{if(K)throw I}}}}oe.exports=p,oe.exports.__esModule=!0,oe.exports.default=oe.exports}}]);
