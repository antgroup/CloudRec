(self.webpackChunk=self.webpackChunk||[]).push([[4559],{52078:function(q,V,t){"use strict";var D=t(97857),o=t.n(D),S=t(27997),u=t(62435),w=t(86074),g=function(O){S.Mj.register({id:"json"});var U=O.value,k=U===void 0?"{}":U,J=O.onChange,W=O.editorStyle,_=W===void 0?{}:W,i=O.editorKey,$=i===void 0?"json-editor":i,x=O.readOnly,T=x===void 0?!1:x,m=(0,u.useRef)(),r=(0,u.useRef)(),N=function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(Z),Z}catch(E){return console.warn("Invalid JSON string:",E),"{}"}};return(0,u.useEffect)(function(){if(m.current)return r.current?r.current.setValue(k):(r.current=S.j6.create(m.current,{value:N(k),language:"json",theme:"vs",readOnly:T,folding:!0,automaticLayout:!0}),r.current.onDidChangeModelContent(function(){var A=r.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:A}),J==null||J(A)})),function(){if(r!=null&&r.current){var A;r==null||(A=r.current)===null||A===void 0||A.dispose(),r.current=null}}},[]),(0,u.useEffect)(function(){r.current&&k!==r.current.getValue()&&r.current.setValue(N(k))},[k]),(0,w.jsx)("div",{ref:m,style:o()({height:360,borderRadius:4,overflow:"hidden"},_)},$)};V.Z=g},29297:function(q,V,t){"use strict";t.d(V,{q9:function(){return D.Z},Wy:function(){return O},mi:function(){return W}});var D=t(52078),o=t(97857),S=t.n(o),u=t(55171),w=t.n(u),g=t(86074),ae=function(i){var $=i.value,x=i.viewerStyle,T=x===void 0?{}:x,m=i.displayDataTypes,r=m===void 0?!1:m,N=i.name,A=N===void 0?"output json":N;return(0,g.jsx)(w(),{src:$,name:A,collapsed:!1,displayDataTypes:r,style:S()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},T)})},O=ae,U=t(27997),k=t(62435),J=function(i){U.Mj.register({id:"rego"});var $=i.value,x=i.onChange,T=i.editorStyle,m=T===void 0?{}:T,r=i.editorKey,N=i.readOnly,A=N===void 0?!1:N,Z=(0,k.useRef)(),E=(0,k.useRef)();return(0,k.useEffect)(function(){if(Z.current)return E.current||(E.current=U.j6.create(Z.current,{value:$,language:"rego",theme:"vs",readOnly:A,automaticLayout:!0}),E.current.onDidChangeModelContent(function(){x==null||x(E.current.getValue())})),function(){if(E.current){var re;(re=E.current)===null||re===void 0||re.dispose(),E.current=null}}},[]),(0,g.jsx)("div",{ref:Z,style:S()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},m)},r)},W=J},38805:function(q,V,t){"use strict";t.r(V),t.d(V,{default:function(){return je}});var D=t(97857),o=t.n(D),S=t(5574),u=t.n(S),w=t(15009),g=t.n(w),ae=t(52677),O=t.n(ae),U=t(13769),k=t.n(U),J=t(99289),W=t.n(J),_=t(53846),i=t(96655),$=t(90498),x=t(45830),T=t(83622),m=t(62435),r=t(86074),N=["pageSize","current","ruleCodeList"],A=function(R){var G=R.tableActionRef,K=R.onEnterDetailView,Y=R.onCreateWhiteList,P=(0,x.useIntl)(),ne=(0,x.useRequest)(function(){return(0,i.queryAllRuleList)({})},{formatResult:function(j){var c;return((c=j.content)===null||c===void 0?void 0:c.map(function(d){return o()(o()({},d),{},{key:d==null?void 0:d.id,label:d==null?void 0:d.ruleName,value:d==null?void 0:d.ruleCode})}))||[]}}),a=ne.data,ee=[{title:P.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",align:"left",fieldProps:{mode:"multiple",placeholder:P.formatMessage({id:"common.select.text.placeholder"}),options:a||[],allowClear:!0},hideInTable:!0},{title:P.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCode",valueType:"text",align:"left",hideInSearch:!0,render:function(j,c){var d=c.ruleCode==="GLOBAL_CONFIG";return(0,r.jsxs)(T.ZP,{type:"link",style:{padding:0,fontWeight:d?"bold":"normal"},onClick:function(){return K(c.ruleCode,c.ruleName)},children:[d&&(0,r.jsx)("span",{style:{marginRight:4},children:"\u{1F4CC}"}),d?P.formatMessage({id:"rule.text.global.config.whitelist"}):c.ruleName]})}},{title:P.formatMessage({id:"common.text.count"}),dataIndex:"count",valueType:"text",align:"center",hideInSearch:!0}];return(0,r.jsx)($.Z,{headerTitle:(0,r.jsx)("div",{className:_.Z.customTitle,children:P.formatMessage({id:"rule.module.text.whiteList.inquiry"})}),scroll:{x:"max-content"},actionRef:G,search:{span:12,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},rowKey:"id",request:function(){var I=W()(g()().mark(function j(c){var d,F,z,Q,h,s,e,f,v,l,y;return g()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return d=c.pageSize,F=c.current,z=c.ruleCodeList,Q=k()(c,N),h=o()(o()({},Q),{},{ruleCodeList:z,page:F,size:d}),n.prev=2,n.next=5,(0,i.listGroupByRuleCode)(h);case 5:return s=n.sent,e=s.content,f=s.code,v=[],l=0,Array.isArray(e)?(v=e,l=e.length):e&&O()(e)==="object"&&(v=Array.isArray(e.data)?e.data:[],l=e.total||v.length),y=v.sort(function(L,H){return L.ruleCode==="GLOBAL"?-1:H.ruleCode==="GLOBAL"?1:0}),n.abrupt("return",{data:y,total:l,success:f===200||!1});case 15:return n.prev=15,n.t0=n.catch(2),console.error("Error fetching aggregate data:",n.t0),n.abrupt("return",{data:[],total:0,success:!1});case 19:case"end":return n.stop()}},j,null,[[2,15]])}));return function(j){return I.apply(this,arguments)}}(),toolBarRender:function(){return[(0,r.jsx)(T.ZP,{type:"primary",onClick:Y,children:P.formatMessage({id:"rule.module.text.createWhiteList"})},"create")]},columns:ee,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}})},Z=A,E=t(24163),re=t(68431),fe=t(29448),se=t(68872),ie=t(96074),oe=t(83062),ve=t(72269),ge=t(86738),me=t(27484),ue=t.n(me),he=["pageSize","current","ruleNameFilter"],ye=function(R){var G=R.tableActionRef,K=R.selectedRuleCode,Y=R.selectedRuleName,P=R.onBackToAggregate,ne=R.onViewWhiteList,a=(0,x.useIntl)();console.log("DetailList props - selectedRuleCode:",K),console.log("DetailList props - selectedRuleName:",Y);var ee=se.ZP.useMessage(),I=u()(ee,2),j=I[0],c=I[1],d=function(){var h=W()(g()().mark(function s(e){var f,v,l;return g()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return f={id:e.id},b.next=3,(0,i.queryWhiteRuleGrabLock)(f);case 3:v=b.sent,v.code===200&&(j.success(a.formatMessage({id:"common.message.text.edit.success"})),(l=G.current)===null||l===void 0||l.reloadAndRest());case 5:case"end":return b.stop()}},s)}));return function(e){return h.apply(this,arguments)}}(),F=function(){var h=W()(g()().mark(function s(e){var f,v,l,y;return g()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.isLockHolder){n.next=3;break}return j.warning(a.formatMessage({id:"rule.message.not.holding.lock"})),n.abrupt("return");case 3:return f={id:e==null?void 0:e.id,enable:(e==null?void 0:e.enable)===1?0:1},n.next=6,(0,i.queryChangeWhiteListRuleStatus)(f);case 6:v=n.sent,v.code===200&&(j.success(a.formatMessage({id:"common.message.text.edit.success"})),(l=G.current)===null||l===void 0||(y=l.reloadAndRest)===null||y===void 0||y.call(l));case 8:case"end":return n.stop()}},s)}));return function(e){return h.apply(this,arguments)}}(),z=function(){var h=W()(g()().mark(function s(e){var f,v,l,y;return g()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.isLockHolder){n.next=3;break}return j.warning(a.formatMessage({id:"rule.message.not.holding.lock"})),n.abrupt("return");case 3:return f={id:e==null?void 0:e.id},n.next=6,(0,i.queryDeleteWhiteListRuleById)(f);case 6:v=n.sent,v.code===200&&(j.success(a.formatMessage({id:"common.message.text.delete.success"})),(l=G.current)===null||l===void 0||(y=l.reloadAndRest)===null||y===void 0||y.call(l));case 8:case"end":return n.stop()}},s)}));return function(e){return h.apply(this,arguments)}}(),Q=[{title:a.formatMessage({id:"cloudAccount.extend.title.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(s,e){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{style:{color:"#999"},children:ue()(e==null?void 0:e.gmtCreate).format("YYYY-MM-DD 18:00:00")||"-"}),(0,r.jsx)("section",{style:{color:"#999"},children:ue()(e==null?void 0:e.gmtModified).format("YYYY-MM-DD 18:00:00")||"-"})]})}},{title:a.formatMessage({id:"rule.extend.text.whiteList.title"}),dataIndex:"ruleName",valueType:"text",align:"left",copyable:!0},{title:a.formatMessage({id:"rule.extend.text.whiteList.describe"}),dataIndex:"ruleDesc",valueType:"text",align:"left",hideInSearch:!0,render:function(s,e){return(0,r.jsx)(E.Z,{text:(e==null?void 0:e.ruleDesc)||"-",maxWidth:240,rows:1,style:{color:"rgb(51, 51, 51)"},placement:"topLeft"})}},{title:a.formatMessage({id:"rule.table.columns.text.type"}),dataIndex:"ruleType",valueType:"select",valueEnum:(0,fe.W_)(re.sN),align:"center"},{title:a.formatMessage({id:"rule.table.columns.text.creator"}),dataIndex:"creatorName",valueType:"text",align:"center",copyable:!0},{title:a.formatMessage({id:"rule.table.columns.text.config"}),dataIndex:"search",valueType:"text",align:"center",hideInTable:!0},{title:a.formatMessage({id:"rule.table.columns.text.lockor"}),dataIndex:"lockHolderName",valueType:"text",align:"center",hideInSearch:!0},{title:a.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(s,e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T.ZP,{size:"small",type:"link",onClick:function(){return ne(e)},children:a.formatMessage({id:"common.button.text.view"})}),(0,r.jsx)(ie.Z,{type:"vertical",style:{margin:"0 8px 0 0"}}),(0,r.jsx)(oe.Z,{title:e.isLockHolder?"":"please grab the lock first",placement:"top",children:(0,r.jsx)(ve.Z,{disabled:!(e!=null&&e.isLockHolder),checkedChildren:a.formatMessage({id:"common.button.text.enable"}),unCheckedChildren:a.formatMessage({id:"common.button.text.disable"}),checked:(e==null?void 0:e.enable)===1,onClick:function(){return F(e)}})}),(0,r.jsx)(ie.Z,{type:"vertical",style:{margin:"0 0 0 8px"}}),(0,r.jsx)(ie.Z,{type:"vertical"}),(0,r.jsx)(oe.Z,{title:e.isLockHolder?"":"please grab the lock first",placement:"top",children:(0,r.jsx)(ge.Z,{title:a.formatMessage({id:"common.button.text.delete.confirm"}),onConfirm:function(){return z(e)},okText:a.formatMessage({id:"common.button.text.ok"}),cancelText:a.formatMessage({id:"common.button.text.cancel"}),children:(0,r.jsx)(T.ZP,{type:"link",danger:!0,size:"small",disabled:!(e!=null&&e.isLockHolder),children:a.formatMessage({id:"common.button.text.delete"})})})})]})}}];return(0,r.jsxs)(r.Fragment,{children:[c,(0,r.jsx)("div",{style:{marginBottom:"16px"},children:(0,r.jsxs)(T.ZP,{type:"link",onClick:P,style:{padding:0,fontSize:"14px"},children:["\u2190 ",a.formatMessage({id:"common.button.text.back"})]})}),(0,r.jsx)($.Z,{headerTitle:(0,r.jsx)("div",{className:_.Z.customTitle,children:(0,r.jsx)("span",{children:K==="GLOBAL_CONFIG"?a.formatMessage({id:"rule.text.global.config.whitelist"}):Y})}),scroll:{x:"max-content"},actionRef:G,search:{span:6,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},rowKey:"id",request:function(){var h=W()(g()().mark(function s(e){var f,v,l,y,b,n,L,H,X,te;return g()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return f=e.pageSize,v=e.current,l=e.ruleNameFilter,y=k()(e,he),b=o()(o()({},y),{},{ruleCode:K,ruleName:l,page:v,size:f}),M.prev=2,M.next=5,(0,i.queryWhiteRuleList)(b);case 5:return n=M.sent,L=n.content,H=n.code,X=[],te=0,Array.isArray(L)?(X=L,te=L.length):L&&O()(L)==="object"&&(X=Array.isArray(L.data)?L.data:[],te=L.total||X.length),M.abrupt("return",{data:X,total:te,success:H===200||!1});case 14:return M.prev=14,M.t0=M.catch(2),console.error("Error fetching detail data:",M.t0),M.abrupt("return",{data:[],total:0,success:!1});case 18:case"end":return M.stop()}},s,null,[[2,14]])}));return function(s){return h.apply(this,arguments)}}(),toolBarRender:function(){return[]},columns:Q,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}})]})},pe=ye,Ce=t(77603),Se=t(39380),xe=function(){var R=(0,m.useRef)(),G=(0,x.useIntl)(),K=se.ZP.useMessage(),Y=u()(K,2),P=Y[0],ne=Y[1],a=(0,m.useState)(!1),ee=u()(a,2),I=ee[0],j=ee[1],c=(0,m.useRef)({}),d=(0,x.useSearchParams)(),F=u()(d,2),z=F[0],Q=F[1],h=(0,m.useState)(""),s=u()(h,2),e=s[0],f=s[1],v=(0,m.useState)(""),l=u()(v,2),y=l[0],b=l[1],n=(0,m.useState)([]),L=u()(n,2),H=L[0],X=L[1],te=function(C){var B=H.find(function(le){return le.ruleCode===C});return B?B.ruleName:C};(0,m.useEffect)(function(){(0,i.queryAllRuleList)().then(function(p){p!=null&&p.content&&X(p.content)}).catch(function(p){console.error("Failed to load rules list:",p)})},[]),(0,m.useEffect)(function(){var p=z.get("ruleCode");if(p&&(f(p),H.length>0)){var C=te(p);b(C)}},[z,H]);var ce=z.get("ruleCode")?"detail":"aggregate",M=function(C){j(!0),c.current=C},Re=function(C){j(!0);var B=C.isLockHolder===!0;c.current=o()(o()({},C),{},{isEditMode:B})},Le=function(C,B){var le=new URLSearchParams;le.set("ruleCode",C),Q(le)},Me=function(){var C,B;Q({}),(C=R.current)===null||C===void 0||(B=C.reloadAndRest)===null||B===void 0||B.call(C)};return(0,r.jsxs)(Se._z,{ghost:!0,title:!1,breadcrumbRender:!1,children:[ne,ce==="aggregate"?(0,r.jsx)(Z,{tableActionRef:R,onEnterDetailView:Le,onCreateWhiteList:function(){return M({})}}):(0,r.jsx)(pe,{tableActionRef:R,selectedRuleCode:e,selectedRuleName:y,onBackToAggregate:Me,onViewWhiteList:Re}),(0,r.jsx)(Ce.Z,{editDrawerVisible:I,setEditDrawerVisible:j,whiteListDrawerInfo:c.current,tableActionRef:R})]})},je=xe},85674:function(q,V,t){var D={"./simpleWorker":18352,"./simpleWorker.js":18352};function o(S){return Promise.resolve().then(function(){if(!t.o(D,S)){var u=new Error("Cannot find module '"+S+"'");throw u.code="MODULE_NOT_FOUND",u}var w=D[S];return t(w)})}o.keys=function(){return Object.keys(D)},o.id=85674,q.exports=o},10131:function(q,V,t){var D={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function o(S){if(!t.o(D,S))return Promise.resolve().then(function(){var g=new Error("Cannot find module '"+S+"'");throw g.code="MODULE_NOT_FOUND",g});var u=D[S],w=u[0];return Promise.all(u.slice(1).map(t.e)).then(function(){return t(w)})}o.keys=function(){return Object.keys(D)},o.id=10131,q.exports=o}}]);
