(self.webpackChunk=self.webpackChunk||[]).push([[4559],{52078:function(Y,B,e){"use strict";var D=e(97857),f=e.n(D),S=e(27997),g=e(62435),w=e(86074),m=function(W){S.Mj.register({id:"json"});var z=W.value,k=z===void 0?"{}":z,H=W.onChange,O=W.editorStyle,q=O===void 0?{}:O,u=W.editorKey,V=u===void 0?"json-editor":u,x=W.readOnly,A=x===void 0?!1:x,y=(0,g.useRef)(),r=(0,g.useRef)(),N=function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse($),$}catch(E){return console.warn("Invalid JSON string:",E),"{}"}};return(0,g.useEffect)(function(){if(y.current)return r.current?r.current.setValue(k):(r.current=S.j6.create(y.current,{value:N(k),language:"json",theme:"vs",readOnly:A,folding:!0,automaticLayout:!0}),r.current.onDidChangeModelContent(function(){var b=r.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:b}),H==null||H(b)})),function(){if(r!=null&&r.current){var b;r==null||(b=r.current)===null||b===void 0||b.dispose(),r.current=null}}},[]),(0,g.useEffect)(function(){r.current&&k!==r.current.getValue()&&r.current.setValue(N(k))},[k]),(0,w.jsx)("div",{ref:y,style:f()({height:360,borderRadius:4,overflow:"hidden"},q)},V)};B.Z=m},29297:function(Y,B,e){"use strict";e.d(B,{q9:function(){return D.Z},Wy:function(){return W},mi:function(){return O}});var D=e(52078),f=e(97857),S=e.n(f),g=e(55171),w=e.n(g),m=e(86074),ne=function(u){var V=u.value,x=u.viewerStyle,A=x===void 0?{}:x,y=u.displayDataTypes,r=y===void 0?!1:y,N=u.name,b=N===void 0?"output json":N;return(0,m.jsx)(w(),{src:V,name:b,collapsed:!1,displayDataTypes:r,style:S()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},A)})},W=ne,z=e(27997),k=e(62435),H=function(u){z.Mj.register({id:"rego"});var V=u.value,x=u.onChange,A=u.editorStyle,y=A===void 0?{}:A,r=u.editorKey,N=u.readOnly,b=N===void 0?!1:N,$=(0,k.useRef)(),E=(0,k.useRef)();return(0,k.useEffect)(function(){if($.current)return E.current||(E.current=z.j6.create($.current,{value:V,language:"rego",theme:"vs",readOnly:b,automaticLayout:!0}),E.current.onDidChangeModelContent(function(){x==null||x(E.current.getValue())})),function(){if(E.current){var te;(te=E.current)===null||te===void 0||te.dispose(),E.current=null}}},[]),(0,m.jsx)("div",{ref:$,style:S()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},y)},r)},O=H},38805:function(Y,B,e){"use strict";e.r(B),e.d(B,{default:function(){return xe}});var D=e(97857),f=e.n(D),S=e(5574),g=e.n(S),w=e(15009),m=e.n(w),ne=e(52677),W=e.n(ne),z=e(13769),k=e.n(z),H=e(99289),O=e.n(H),q=e(53846),u=e(96655),V=e(90498),x=e(45830),A=e(83622),y=e(62435),r=e(86074),N=["pageSize","current","ruleCodeList"],b=function(j){var U=j.tableActionRef,J=j.onEnterDetailView,G=j.onCreateWhiteList,P=(0,x.useIntl)(),re=(0,x.useRequest)(function(){return(0,u.queryAllRuleList)({})},{formatResult:function(T){var s;return((s=T.content)===null||s===void 0?void 0:s.map(function(d){return f()(f()({},d),{},{key:d==null?void 0:d.id,label:d==null?void 0:d.ruleName,value:d==null?void 0:d.ruleCode})}))||[]}}),ae=re.data,a=[{title:P.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",align:"left",fieldProps:{mode:"multiple",placeholder:P.formatMessage({id:"common.select.text.placeholder"}),options:ae||[],allowClear:!0},hideInTable:!0},{title:P.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCode",valueType:"text",align:"left",hideInSearch:!0,render:function(T,s){var d=s.ruleCode==="GLOBAL_CONFIG";return(0,r.jsxs)(A.ZP,{type:"link",style:{padding:0,fontWeight:d?"bold":"normal"},onClick:function(){return J(s.ruleCode,s.ruleName)},children:[d&&(0,r.jsx)("span",{style:{marginRight:4},children:"\u{1F4CC}"}),d?P.formatMessage({id:"rule.text.global.config.whitelist"}):s.ruleName]})}},{title:P.formatMessage({id:"common.text.count"}),dataIndex:"count",valueType:"text",align:"center",hideInSearch:!0}];return(0,r.jsx)(V.Z,{headerTitle:(0,r.jsx)("div",{className:q.Z.customTitle,children:P.formatMessage({id:"rule.module.text.whiteList.inquiry"})}),scroll:{x:"max-content"},actionRef:U,search:{span:12,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},rowKey:"id",request:function(){var Z=O()(m()().mark(function T(s){var d,K,F,Q,_,h,n,t,o,v,c;return m()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return d=s.pageSize,K=s.current,F=s.ruleCodeList,Q=k()(s,N),_=f()(f()({},Q),{},{ruleCodeList:F,page:K,size:d}),i.prev=2,i.next=5,(0,u.listGroupByRuleCode)(_);case 5:return h=i.sent,n=h.content,t=h.code,o=[],v=0,Array.isArray(n)?(o=n,v=n.length):n&&W()(n)==="object"&&(o=Array.isArray(n.data)?n.data:[],v=n.total||o.length),c=o.sort(function(l,R){return l.ruleCode==="GLOBAL"?-1:R.ruleCode==="GLOBAL"?1:0}),i.abrupt("return",{data:c,total:v,success:t===200||!1});case 15:return i.prev=15,i.t0=i.catch(2),console.error("Error fetching aggregate data:",i.t0),i.abrupt("return",{data:[],total:0,success:!1});case 19:case"end":return i.stop()}},T,null,[[2,15]])}));return function(T){return Z.apply(this,arguments)}}(),toolBarRender:function(){return[(0,r.jsx)(A.ZP,{type:"primary",onClick:G,children:P.formatMessage({id:"rule.module.text.createWhiteList"})},"create")]},columns:a,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}})},$=b,E=e(24163),te=e(68431),fe=e(29448),ue=e(68872),se=e(96074),de=e(83062),ge=e(72269),ve=e(86738),me=["pageSize","current","ruleNameFilter"],he=function(j){var U=j.tableActionRef,J=j.selectedRuleCode,G=j.selectedRuleName,P=j.onBackToAggregate,re=j.onViewWhiteList,ae=j.onCreateWhiteList,a=(0,x.useIntl)();console.log("DetailList props - selectedRuleCode:",J),console.log("DetailList props - selectedRuleName:",G);var Z=ue.ZP.useMessage(),T=g()(Z,2),s=T[0],d=T[1],K=function(){var h=O()(m()().mark(function n(t){var o,v,c;return m()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o={id:t.id},i.next=3,(0,u.queryWhiteRuleGrabLock)(o);case 3:v=i.sent,v.code===200&&(s.success(a.formatMessage({id:"common.message.text.edit.success"})),(c=U.current)===null||c===void 0||c.reloadAndRest());case 5:case"end":return i.stop()}},n)}));return function(t){return h.apply(this,arguments)}}(),F=function(){var h=O()(m()().mark(function n(t){var o,v,c,L;return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t.isLockHolder){l.next=3;break}return s.warning(a.formatMessage({id:"rule.message.not.holding.lock"})),l.abrupt("return");case 3:return o={id:t==null?void 0:t.id,enable:(t==null?void 0:t.enable)===1?0:1},l.next=6,(0,u.queryChangeWhiteListRuleStatus)(o);case 6:v=l.sent,v.code===200&&(s.success(a.formatMessage({id:"common.message.text.edit.success"})),(c=U.current)===null||c===void 0||(L=c.reloadAndRest)===null||L===void 0||L.call(c));case 8:case"end":return l.stop()}},n)}));return function(t){return h.apply(this,arguments)}}(),Q=function(){var h=O()(m()().mark(function n(t){var o,v,c,L;return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t.isLockHolder){l.next=3;break}return s.warning(a.formatMessage({id:"rule.message.not.holding.lock"})),l.abrupt("return");case 3:return o={id:t==null?void 0:t.id},l.next=6,(0,u.queryDeleteWhiteListRuleById)(o);case 6:v=l.sent,v.code===200&&(s.success(a.formatMessage({id:"common.message.text.delete.success"})),(c=U.current)===null||c===void 0||(L=c.reloadAndRest)===null||L===void 0||L.call(c));case 8:case"end":return l.stop()}},n)}));return function(t){return h.apply(this,arguments)}}(),_=[{title:a.formatMessage({id:"cloudAccount.extend.title.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(n,t){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{children:(t==null?void 0:t.gmtCreate)||"-"}),(0,r.jsx)("section",{children:(t==null?void 0:t.gmtModified)||"-"})]})}},{title:a.formatMessage({id:"tenant.module.text.tenant.name"}),dataIndex:"tenantName",valueType:"text",align:"left",copyable:!1},{title:a.formatMessage({id:"rule.extend.text.whiteList.title"}),dataIndex:"ruleName",valueType:"text",align:"left",copyable:!0},{title:a.formatMessage({id:"rule.extend.text.whiteList.describe"}),dataIndex:"ruleDesc",valueType:"text",align:"left",hideInSearch:!0,render:function(n,t){return(0,r.jsx)(E.Z,{text:(t==null?void 0:t.ruleDesc)||"-",maxWidth:240,rows:1,style:{color:"rgb(51, 51, 51)"},placement:"topLeft"})}},{title:a.formatMessage({id:"rule.table.columns.text.type"}),dataIndex:"ruleType",valueType:"select",valueEnum:(0,fe.W_)(te.sN),align:"center"},{title:a.formatMessage({id:"rule.table.columns.text.creator"}),dataIndex:"creatorName",valueType:"text",align:"center",copyable:!0},{title:a.formatMessage({id:"rule.table.columns.text.config"}),dataIndex:"search",valueType:"text",align:"center",hideInTable:!0},{title:a.formatMessage({id:"rule.table.columns.text.lockor"}),dataIndex:"lockHolderName",valueType:"text",align:"center",hideInSearch:!0},{title:a.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(n,t){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.ZP,{size:"small",type:"link",onClick:function(){return re(t)},children:a.formatMessage({id:"common.button.text.view"})}),(0,r.jsx)(se.Z,{type:"vertical",style:{margin:"0 8px 0 0"}}),(0,r.jsx)(de.Z,{title:t.isLockHolder?"":"please grab the lock first",placement:"top",children:(0,r.jsx)(ge.Z,{disabled:!(t!=null&&t.isLockHolder),checkedChildren:a.formatMessage({id:"common.button.text.enable"}),unCheckedChildren:a.formatMessage({id:"common.button.text.disable"}),checked:(t==null?void 0:t.enable)===1,onClick:function(){return F(t)}})}),(0,r.jsx)(se.Z,{type:"vertical",style:{margin:"0 0 0 8px"}}),(0,r.jsx)(se.Z,{type:"vertical"}),(0,r.jsx)(de.Z,{title:t.isLockHolder?"":"please grab the lock first",placement:"top",children:(0,r.jsx)(ve.Z,{title:a.formatMessage({id:"common.button.text.delete.confirm"}),onConfirm:function(){return Q(t)},okText:a.formatMessage({id:"common.button.text.ok"}),cancelText:a.formatMessage({id:"common.button.text.cancel"}),children:(0,r.jsx)(A.ZP,{type:"link",danger:!0,size:"small",disabled:!(t!=null&&t.isLockHolder),children:a.formatMessage({id:"common.button.text.delete"})})})})]})}}];return(0,r.jsxs)(r.Fragment,{children:[d,(0,r.jsx)("div",{style:{marginBottom:"16px"},children:(0,r.jsxs)(A.ZP,{type:"link",onClick:P,style:{padding:0,fontSize:"14px"},children:["\u2190 ",a.formatMessage({id:"common.button.text.back"})]})}),(0,r.jsx)(V.Z,{headerTitle:(0,r.jsx)("div",{className:q.Z.customTitle,children:(0,r.jsx)("span",{children:J==="GLOBAL_CONFIG"?a.formatMessage({id:"rule.text.global.config.whitelist"}):G})}),scroll:{x:"max-content"},actionRef:U,search:{span:6,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},rowKey:"id",request:function(){var h=O()(m()().mark(function n(t){var o,v,c,L,i,l,R,ie,X,ee;return m()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return o=t.pageSize,v=t.current,c=t.ruleNameFilter,L=k()(t,me),i=f()(f()({},L),{},{ruleCode:J,ruleName:c,page:v,size:o}),M.prev=2,M.next=5,(0,u.queryWhiteRuleList)(i);case 5:return l=M.sent,R=l.content,ie=l.code,X=[],ee=0,Array.isArray(R)?(X=R,ee=R.length):R&&W()(R)==="object"&&(X=Array.isArray(R.data)?R.data:[],ee=R.total||X.length),M.abrupt("return",{data:X,total:ee,success:ie===200||!1});case 14:return M.prev=14,M.t0=M.catch(2),console.error("Error fetching detail data:",M.t0),M.abrupt("return",{data:[],total:0,success:!1});case 18:case"end":return M.stop()}},n,null,[[2,14]])}));return function(n){return h.apply(this,arguments)}}(),toolBarRender:function(){return[(0,r.jsx)(A.ZP,{type:"primary",onClick:ae,children:a.formatMessage({id:"rule.module.text.createWhiteList"})},"create")]},columns:_,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}})]})},ye=he,pe=e(77603),Ce=e(39380),Se=function(){var j=(0,y.useRef)(),U=(0,x.useIntl)(),J=ue.ZP.useMessage(),G=g()(J,2),P=G[0],re=G[1],ae=(0,y.useState)(!1),a=g()(ae,2),Z=a[0],T=a[1],s=(0,y.useRef)({}),d=(0,x.useSearchParams)(),K=g()(d,2),F=K[0],Q=K[1],_=(0,y.useState)(""),h=g()(_,2),n=h[0],t=h[1],o=(0,y.useState)(""),v=g()(o,2),c=v[0],L=v[1],i=(0,y.useState)([]),l=g()(i,2),R=l[0],ie=l[1],X=function(C){var I=R.find(function(le){return le.ruleCode===C});return I?I.ruleName:C};(0,y.useEffect)(function(){(0,u.queryAllRuleList)().then(function(p){p!=null&&p.content&&ie(p.content)}).catch(function(p){console.error("Failed to load rules list:",p)})},[]),(0,y.useEffect)(function(){var p=F.get("ruleCode");if(p&&(t(p),R.length>0)){var C=X(p);L(C)}},[F,R]);var ee=F.get("ruleCode")?"detail":"aggregate",oe=function(C){T(!0),s.current=C},M=function(C){T(!0);var I=C.isLockHolder===!0;s.current=f()(f()({},C),{},{isEditMode:I})},je=function(C,I){var le=new URLSearchParams;le.set("ruleCode",C),Q(le)},Re=function(){var C,I;Q({}),(C=j.current)===null||C===void 0||(I=C.reloadAndRest)===null||I===void 0||I.call(C)};return(0,r.jsxs)(Ce._z,{ghost:!0,title:!1,breadcrumbRender:!1,children:[re,ee==="aggregate"?(0,r.jsx)($,{tableActionRef:j,onEnterDetailView:je,onCreateWhiteList:function(){return oe({})}}):(0,r.jsx)(ye,{tableActionRef:j,selectedRuleCode:n,selectedRuleName:c,onBackToAggregate:Re,onViewWhiteList:M,onCreateWhiteList:function(){return oe({})}}),(0,r.jsx)(pe.Z,{editDrawerVisible:Z,setEditDrawerVisible:T,whiteListDrawerInfo:s.current,tableActionRef:j,ruleCode:n})]})},xe=Se},85674:function(Y,B,e){var D={"./simpleWorker":18352,"./simpleWorker.js":18352};function f(S){return Promise.resolve().then(function(){if(!e.o(D,S)){var g=new Error("Cannot find module '"+S+"'");throw g.code="MODULE_NOT_FOUND",g}var w=D[S];return e(w)})}f.keys=function(){return Object.keys(D)},f.id=85674,Y.exports=f},10131:function(Y,B,e){var D={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function f(S){if(!e.o(D,S))return Promise.resolve().then(function(){var m=new Error("Cannot find module '"+S+"'");throw m.code="MODULE_NOT_FOUND",m});var g=D[S],w=g[0];return Promise.all(g.slice(1).map(e.e)).then(function(){return e(w)})}f.keys=function(){return Object.keys(D)},f.id=10131,Y.exports=f}}]);
