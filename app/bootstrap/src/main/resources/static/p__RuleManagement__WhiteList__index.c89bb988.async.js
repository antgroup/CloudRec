(self.webpackChunk=self.webpackChunk||[]).push([[4559],{52078:function(Y,B,e){"use strict";var A=e(97857),f=e.n(A),S=e(27997),v=e(62435),w=e(86074),m=function(E){S.Mj.register({id:"json"});var H=E.value,T=H===void 0?"{}":H,z=E.onChange,O=E.editorStyle,q=O===void 0?{}:O,u=E.editorKey,V=u===void 0?"json-editor":u,x=E.readOnly,b=x===void 0?!1:x,y=(0,v.useRef)(),r=(0,v.useRef)(),N=function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse($),$}catch(W){return console.warn("Invalid JSON string:",W),"{}"}};return(0,v.useEffect)(function(){if(y.current)return r.current?r.current.setValue(T):(r.current=S.j6.create(y.current,{value:N(T),language:"json",theme:"vs",readOnly:b,folding:!0,automaticLayout:!0}),r.current.onDidChangeModelContent(function(){var D=r.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:D}),z==null||z(D)})),function(){if(r!=null&&r.current){var D;r==null||(D=r.current)===null||D===void 0||D.dispose(),r.current=null}}},[]),(0,v.useEffect)(function(){r.current&&T!==r.current.getValue()&&r.current.setValue(N(T))},[T]),(0,w.jsx)("div",{ref:y,style:f()({height:360,borderRadius:4,overflow:"hidden"},q)},V)};B.Z=m},29297:function(Y,B,e){"use strict";e.d(B,{q9:function(){return A.Z},Wy:function(){return E},mi:function(){return O}});var A=e(52078),f=e(97857),S=e.n(f),v=e(55171),w=e.n(v),m=e(86074),ne=function(u){var V=u.value,x=u.viewerStyle,b=x===void 0?{}:x,y=u.displayDataTypes,r=y===void 0?!1:y,N=u.name,D=N===void 0?"output json":N;return(0,m.jsx)(w(),{src:V,name:D,collapsed:!1,displayDataTypes:r,style:S()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},b)})},E=ne,H=e(27997),T=e(62435),z=function(u){H.Mj.register({id:"rego"});var V=u.value,x=u.onChange,b=u.editorStyle,y=b===void 0?{}:b,r=u.editorKey,N=u.readOnly,D=N===void 0?!1:N,$=(0,T.useRef)(),W=(0,T.useRef)();return(0,T.useEffect)(function(){if($.current)return W.current||(W.current=H.j6.create($.current,{value:V,language:"rego",theme:"vs",readOnly:D,automaticLayout:!0}),W.current.onDidChangeModelContent(function(){x==null||x(W.current.getValue())})),function(){if(W.current){var te;(te=W.current)===null||te===void 0||te.dispose(),W.current=null}}},[]),(0,m.jsx)("div",{ref:$,style:S()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},y)},r)},O=z},38805:function(Y,B,e){"use strict";e.r(B),e.d(B,{default:function(){return xe}});var A=e(97857),f=e.n(A),S=e(5574),v=e.n(S),w=e(15009),m=e.n(w),ne=e(52677),E=e.n(ne),H=e(13769),T=e.n(H),z=e(99289),O=e.n(z),q=e(53846),u=e(96655),V=e(90498),x=e(45830),b=e(83622),y=e(62435),r=e(86074),N=["pageSize","current","ruleCodeList"],D=function(j){var U=j.tableActionRef,G=j.onEnterDetailView,J=j.onCreateWhiteList,P=(0,x.useIntl)(),re=(0,x.useRequest)(function(){return(0,u.queryAllRuleList)({})},{formatResult:function(k){var s;return((s=k.content)===null||s===void 0?void 0:s.map(function(d){return f()(f()({},d),{},{key:d==null?void 0:d.id,label:d==null?void 0:d.ruleName,value:d==null?void 0:d.ruleCode})}))||[]}}),ae=re.data,a=[{title:P.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",align:"left",fieldProps:{mode:"multiple",placeholder:P.formatMessage({id:"common.select.text.placeholder"}),options:ae||[],allowClear:!0},hideInTable:!0},{title:P.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCode",valueType:"text",align:"left",hideInSearch:!0,render:function(k,s){var d=s.ruleCode==="GLOBAL_CONFIG";return(0,r.jsxs)(b.ZP,{type:"link",style:{padding:0,fontWeight:d?"bold":"normal"},onClick:function(){return G(s.ruleCode,s.ruleName)},children:[d&&(0,r.jsx)("span",{style:{marginRight:4},children:"\u{1F4CC}"}),d?P.formatMessage({id:"rule.text.global.config.whitelist"}):s.ruleName]})}},{title:P.formatMessage({id:"common.text.count"}),dataIndex:"count",valueType:"text",align:"center",hideInSearch:!0}];return(0,r.jsx)(V.Z,{headerTitle:(0,r.jsx)("div",{className:q.Z.customTitle,children:P.formatMessage({id:"rule.module.text.whiteList.inquiry"})}),scroll:{x:"max-content"},actionRef:U,search:{span:12,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},rowKey:"id",request:function(){var Z=O()(m()().mark(function k(s){var d,K,F,Q,_,h,n,t,o,g,c;return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return d=s.pageSize,K=s.current,F=s.ruleCodeList,Q=T()(s,N),_=f()(f()({},Q),{},{ruleCodeList:F,page:K,size:d}),l.prev=2,l.next=5,(0,u.listGroupByRuleCode)(_);case 5:return h=l.sent,n=h.content,t=h.code,o=[],g=0,Array.isArray(n)?(o=n,g=n.length):n&&E()(n)==="object"&&(o=Array.isArray(n.data)?n.data:[],g=n.total||o.length),c=o.sort(function(i,R){return i.ruleCode==="GLOBAL"?-1:R.ruleCode==="GLOBAL"?1:0}),l.abrupt("return",{data:c,total:g,success:t===200||!1});case 15:return l.prev=15,l.t0=l.catch(2),console.error("Error fetching aggregate data:",l.t0),l.abrupt("return",{data:[],total:0,success:!1});case 19:case"end":return l.stop()}},k,null,[[2,15]])}));return function(k){return Z.apply(this,arguments)}}(),toolBarRender:function(){return[(0,r.jsx)(b.ZP,{type:"primary",onClick:J,children:P.formatMessage({id:"rule.module.text.createWhiteList"})},"create")]},columns:a,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}})},$=D,W=e(24163),te=e(68431),fe=e(29448),ue=e(68872),se=e(96074),de=e(83062),ve=e(72269),ge=e(86738),me=["pageSize","current","ruleNameFilter"],he=function(j){var U=j.tableActionRef,G=j.selectedRuleCode,J=j.selectedRuleName,P=j.onBackToAggregate,re=j.onViewWhiteList,ae=j.onCreateWhiteList,a=(0,x.useIntl)();console.log("DetailList props - selectedRuleCode:",G),console.log("DetailList props - selectedRuleName:",J);var Z=ue.ZP.useMessage(),k=v()(Z,2),s=k[0],d=k[1],K=function(){var h=O()(m()().mark(function n(t){var o,g,c;return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return o={id:t.id},l.next=3,(0,u.queryWhiteRuleGrabLock)(o);case 3:g=l.sent,g.code===200&&(s.success(a.formatMessage({id:"common.message.text.edit.success"})),(c=U.current)===null||c===void 0||c.reloadAndRest());case 5:case"end":return l.stop()}},n)}));return function(t){return h.apply(this,arguments)}}(),F=function(){var h=O()(m()().mark(function n(t){var o,g,c,L;return m()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(t.isLockHolder){i.next=3;break}return s.warning(a.formatMessage({id:"rule.message.not.holding.lock"})),i.abrupt("return");case 3:return o={id:t==null?void 0:t.id,enable:(t==null?void 0:t.enable)===1?0:1},i.next=6,(0,u.queryChangeWhiteListRuleStatus)(o);case 6:g=i.sent,g.code===200&&(s.success(a.formatMessage({id:"common.message.text.edit.success"})),(c=U.current)===null||c===void 0||(L=c.reloadAndRest)===null||L===void 0||L.call(c));case 8:case"end":return i.stop()}},n)}));return function(t){return h.apply(this,arguments)}}(),Q=function(){var h=O()(m()().mark(function n(t){var o,g,c,L;return m()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(t.isLockHolder){i.next=3;break}return s.warning(a.formatMessage({id:"rule.message.not.holding.lock"})),i.abrupt("return");case 3:return o={id:t==null?void 0:t.id},i.next=6,(0,u.queryDeleteWhiteListRuleById)(o);case 6:g=i.sent,g.code===200&&(s.success(a.formatMessage({id:"common.message.text.delete.success"})),(c=U.current)===null||c===void 0||(L=c.reloadAndRest)===null||L===void 0||L.call(c));case 8:case"end":return i.stop()}},n)}));return function(t){return h.apply(this,arguments)}}(),_=[{title:a.formatMessage({id:"cloudAccount.extend.title.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(n,t){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{children:(t==null?void 0:t.gmtCreate)||"-"}),(0,r.jsx)("section",{children:(t==null?void 0:t.gmtModified)||"-"})]})}},{title:a.formatMessage({id:"tenant.module.text.tenant.name"}),dataIndex:"tenantName",valueType:"text",align:"left",copyable:!1},{title:a.formatMessage({id:"rule.extend.text.whiteList.title"}),dataIndex:"ruleName",valueType:"text",align:"left",copyable:!0},{title:a.formatMessage({id:"rule.extend.text.whiteList.describe"}),dataIndex:"ruleDesc",valueType:"text",align:"left",hideInSearch:!0,render:function(n,t){return(0,r.jsx)(W.Z,{text:(t==null?void 0:t.ruleDesc)||"-",maxWidth:240,rows:1,style:{color:"rgb(51, 51, 51)"},placement:"topLeft"})}},{title:a.formatMessage({id:"rule.table.columns.text.type"}),dataIndex:"ruleType",valueType:"select",valueEnum:(0,fe.W_)(te.sN),align:"center"},{title:a.formatMessage({id:"rule.table.columns.text.creator"}),dataIndex:"creatorName",valueType:"text",align:"center",copyable:!0},{title:a.formatMessage({id:"rule.table.columns.text.config"}),dataIndex:"search",valueType:"text",align:"center",hideInTable:!0},{title:a.formatMessage({id:"rule.table.columns.text.lockor"}),dataIndex:"lockHolderName",valueType:"text",align:"center",hideInSearch:!0},{title:a.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(n,t){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.ZP,{size:"small",type:"link",onClick:function(){return re(t)},children:a.formatMessage({id:"common.button.text.view"})}),(0,r.jsx)(se.Z,{type:"vertical",style:{margin:"0 8px 0 0"}}),(0,r.jsx)(de.Z,{title:t.isLockHolder?"":"please grab the lock first",placement:"top",children:(0,r.jsx)(ve.Z,{disabled:!(t!=null&&t.isLockHolder),checkedChildren:a.formatMessage({id:"common.button.text.enable"}),unCheckedChildren:a.formatMessage({id:"common.button.text.disable"}),checked:(t==null?void 0:t.enable)===1,onClick:function(){return F(t)}})}),(0,r.jsx)(se.Z,{type:"vertical",style:{margin:"0 0 0 8px"}}),(0,r.jsx)(se.Z,{type:"vertical"}),(0,r.jsx)(de.Z,{title:t.isLockHolder?"":"please grab the lock first",placement:"top",children:(0,r.jsx)(ge.Z,{title:a.formatMessage({id:"common.button.text.delete.confirm"}),onConfirm:function(){return Q(t)},okText:a.formatMessage({id:"common.button.text.ok"}),cancelText:a.formatMessage({id:"common.button.text.cancel"}),children:(0,r.jsx)(b.ZP,{type:"link",danger:!0,size:"small",disabled:!(t!=null&&t.isLockHolder),children:a.formatMessage({id:"common.button.text.delete"})})})})]})}}];return(0,r.jsxs)(r.Fragment,{children:[d,(0,r.jsx)("div",{style:{marginBottom:"16px"},children:(0,r.jsxs)(b.ZP,{type:"link",onClick:P,style:{padding:0,fontSize:"14px"},children:["\u2190 ",a.formatMessage({id:"common.button.text.back"})]})}),(0,r.jsx)(V.Z,{headerTitle:(0,r.jsx)("div",{className:q.Z.customTitle,children:(0,r.jsx)("span",{children:G==="GLOBAL_CONFIG"?a.formatMessage({id:"rule.text.global.config.whitelist"}):J})}),scroll:{x:"max-content"},actionRef:U,search:{span:6,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},rowKey:"id",request:function(){var h=O()(m()().mark(function n(t){var o,g,c,L,l,i,R,le,X,ee;return m()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return o=t.pageSize,g=t.current,c=t.ruleNameFilter,L=T()(t,me),l=f()(f()({},L),{},{ruleCode:G,ruleName:c,page:g,size:o}),M.prev=2,M.next=5,(0,u.queryWhiteRuleList)(l);case 5:return i=M.sent,R=i.content,le=i.code,X=[],ee=0,Array.isArray(R)?(X=R,ee=R.length):R&&E()(R)==="object"&&(X=Array.isArray(R.data)?R.data:[],ee=R.total||X.length),M.abrupt("return",{data:X,total:ee,success:le===200||!1});case 14:return M.prev=14,M.t0=M.catch(2),console.error("Error fetching detail data:",M.t0),M.abrupt("return",{data:[],total:0,success:!1});case 18:case"end":return M.stop()}},n,null,[[2,14]])}));return function(n){return h.apply(this,arguments)}}(),toolBarRender:function(){return[(0,r.jsx)(b.ZP,{type:"primary",onClick:ae,children:a.formatMessage({id:"rule.module.text.createWhiteList"})},"create")]},columns:_,pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}})]})},ye=he,pe=e(77603),Ce=e(39380),Se=function(){var j=(0,y.useRef)(),U=(0,x.useIntl)(),G=ue.ZP.useMessage(),J=v()(G,2),P=J[0],re=J[1],ae=(0,y.useState)(!1),a=v()(ae,2),Z=a[0],k=a[1],s=(0,y.useRef)({}),d=(0,x.useSearchParams)(),K=v()(d,2),F=K[0],Q=K[1],_=(0,y.useState)(""),h=v()(_,2),n=h[0],t=h[1],o=(0,y.useState)(""),g=v()(o,2),c=g[0],L=g[1],l=(0,y.useState)([]),i=v()(l,2),R=i[0],le=i[1],X=function(C){var I=R.find(function(ie){return ie.ruleCode===C});return I?I.ruleName:C};(0,y.useEffect)(function(){(0,u.queryAllRuleList)().then(function(p){p!=null&&p.content&&le(p.content)}).catch(function(p){console.error("Failed to load rules list:",p)})},[]),(0,y.useEffect)(function(){var p=F.get("ruleCode");if(p&&(t(p),R.length>0)){var C=X(p);L(C)}},[F,R]);var ee=F.get("ruleCode")?"detail":"aggregate",oe=function(C){k(!0),s.current=C},M=function(C){k(!0);var I=C.isLockHolder===!0;s.current=f()(f()({},C),{},{isEditMode:I})},je=function(C,I){var ie=new URLSearchParams;ie.set("ruleCode",C),Q(ie)},Re=function(){var C,I;Q({}),(C=j.current)===null||C===void 0||(I=C.reloadAndRest)===null||I===void 0||I.call(C)};return(0,r.jsxs)(Ce._z,{ghost:!0,title:!1,breadcrumbRender:!1,children:[re,ee==="aggregate"?(0,r.jsx)($,{tableActionRef:j,onEnterDetailView:je,onCreateWhiteList:function(){return oe({})}}):(0,r.jsx)(ye,{tableActionRef:j,selectedRuleCode:n,selectedRuleName:c,onBackToAggregate:Re,onViewWhiteList:M,onCreateWhiteList:function(){return oe({})}}),(0,r.jsx)(pe.Z,{editDrawerVisible:Z,setEditDrawerVisible:k,whiteListDrawerInfo:s.current,tableActionRef:j,ruleCode:n})]})},xe=Se},85674:function(Y,B,e){var A={"./simpleWorker":18352,"./simpleWorker.js":18352};function f(S){return Promise.resolve().then(function(){if(!e.o(A,S)){var v=new Error("Cannot find module '"+S+"'");throw v.code="MODULE_NOT_FOUND",v}var w=A[S];return e(w)})}f.keys=function(){return Object.keys(A)},f.id=85674,Y.exports=f},10131:function(Y,B,e){var A={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function f(S){if(!e.o(A,S))return Promise.resolve().then(function(){var m=new Error("Cannot find module '"+S+"'");throw m.code="MODULE_NOT_FOUND",m});var v=A[S],w=v[0];return Promise.all(v.slice(1).map(e.e)).then(function(){return e(w)})}f.keys=function(){return Object.keys(A)},f.id=10131,Y.exports=f}}]);
